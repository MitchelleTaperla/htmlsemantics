;/*FB_PKG_DELIM*/

__d("useCometHomeChatSettingsQuery.graphql",["useCometHomeChatSettingsQuery_facebookRelayOperation","relay-runtime"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"call_blocked_until",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"chat_sounds_on",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"chat_tabs_turned_off",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"chat_visibility",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"chat_sidebar_is_collapsed",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useCometHomeChatSettingsQuery",selections:a,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"useCometHomeChatSettingsQuery",selections:a},params:{id:b("useCometHomeChatSettingsQuery_facebookRelayOperation"),metadata:{},name:"useCometHomeChatSettingsQuery",operationKind:"query",text:null}}}();b("relay-runtime").PreloadableQueryRegistry.set(a.params.id,a);e.exports=a}),null);
__d("MWCallBlockedUntilSettingMutation_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="4850274235008928"}),null);
__d("MWCallBlockedUntilSettingMutation.graphql",["MWCallBlockedUntilSettingMutation_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],c=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"SetCallBlockedUntilSettingResponsePayload",kind:"LinkedField",name:"set_call_blocked_until_setting",plural:!1,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"call_blocked_until",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"MWCallBlockedUntilSettingMutation",selections:c,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"MWCallBlockedUntilSettingMutation",selections:c},params:{id:b("MWCallBlockedUntilSettingMutation_facebookRelayOperation"),metadata:{},name:"MWCallBlockedUntilSettingMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("MWChatChangeSoundsSettingMutation_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="4773571059407985"}),null);
__d("MWChatChangeSoundsSettingMutation.graphql",["MWChatChangeSoundsSettingMutation_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],c=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"SetChatSoundsSettingResponsePayload",kind:"LinkedField",name:"set_chat_sounds_setting",plural:!1,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"chat_sounds_on",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"MWChatChangeSoundsSettingMutation",selections:c,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"MWChatChangeSoundsSettingMutation",selections:c},params:{id:b("MWChatChangeSoundsSettingMutation_facebookRelayOperation"),metadata:{},name:"MWChatChangeSoundsSettingMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("MWChatChangeTurnOffTabsSettingMutation_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="5128673580550938"}),null);
__d("MWChatChangeTurnOffTabsSettingMutation.graphql",["MWChatChangeTurnOffTabsSettingMutation_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],c=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"SetTurnOffChatTabsSettingResponsePayload",kind:"LinkedField",name:"set_turn_off_chat_tabs_setting",plural:!1,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"chat_tabs_turned_off",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"MWChatChangeTurnOffTabsSettingMutation",selections:c,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"MWChatChangeTurnOffTabsSettingMutation",selections:c},params:{id:b("MWChatChangeTurnOffTabsSettingMutation_facebookRelayOperation"),metadata:{},name:"MWChatChangeTurnOffTabsSettingMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("MWChatSoundsSettingSubscription_MessengerSoundsSettingSubscription_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="7119327994775660"}),null);
__d("MWChatSoundsSettingSubscription_MessengerSoundsSettingSubscription.graphql",["MWChatSoundsSettingSubscription_MessengerSoundsSettingSubscription_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],c=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"MessengerChatSoundsSettingSubscribeResponsePayload",kind:"LinkedField",name:"messenger_chat_sounds_setting_subscribe",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"chat_sounds_enabled",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"MWChatSoundsSettingSubscription_MessengerSoundsSettingSubscription",selections:c,type:"Subscription",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"MWChatSoundsSettingSubscription_MessengerSoundsSettingSubscription",selections:c},params:{id:b("MWChatSoundsSettingSubscription_MessengerSoundsSettingSubscription_facebookRelayOperation"),metadata:{subscriptionName:"messenger_chat_sounds_setting_subscribe"},name:"MWChatSoundsSettingSubscription_MessengerSoundsSettingSubscription",operationKind:"subscription",text:null}}}();e.exports=a}),null);
__d("MWChatTabsSettingSubscription_MessengerChatTabsSettingSubscription_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="4706293842827361"}),null);
__d("MWChatTabsSettingSubscription_MessengerChatTabsSettingSubscription.graphql",["MWChatTabsSettingSubscription_MessengerChatTabsSettingSubscription_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],c=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"MessengerChatTabsSettingSubscribeResponsePayload",kind:"LinkedField",name:"messenger_chat_tabs_setting_subscribe",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"chat_tabs_enabled",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"MWChatTabsSettingSubscription_MessengerChatTabsSettingSubscription",selections:c,type:"Subscription",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"MWChatTabsSettingSubscription_MessengerChatTabsSettingSubscription",selections:c},params:{id:b("MWChatTabsSettingSubscription_MessengerChatTabsSettingSubscription_facebookRelayOperation"),metadata:{subscriptionName:"messenger_chat_tabs_setting_subscribe"},name:"MWChatTabsSettingSubscription_MessengerChatTabsSettingSubscription",operationKind:"subscription",text:null}}}();e.exports=a}),null);
__d("CometMenuItemWithSubmenu.react",["fbt","ix","BaseContextualLayerAvailableHeightContext","BaseMultiPageViewContext","CometComponentWithKeyCommands.react","CometIcon.react","CometKeys","CometMenuBase.react","CometMenuItemBase.react","CometMenuItemIcon.react","fbicon","react"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k=j||(j=d("react"));b=j;var l=b.useCallback,m=b.useContext,n=b.useMemo,o=b.useState,p=k.createContext([]);function a(a,b){var e=a.disabled,f=a.icon,g=a.iconColor,j=a.iconNode,r=a.iconSize,s=a.iconStyle,t=a.onClick,u=a.primaryText,v=a.secondaryText,w=a.submenu;a=babelHelpers.objectWithoutPropertiesLoose(a,["disabled","icon","iconColor","iconNode","iconSize","iconStyle","onClick","primaryText","secondaryText","submenu"]);var x=m(p),y=n(function(){return[].concat(x,[u])},[x,u]),z=o(!1),A=z[0],B=z[1];z=k.jsx(c("CometIcon.react"),{color:"secondary",icon:d("fbicon")._(i("492572"),20)});var C=m(c("BaseMultiPageViewContext")),D=l(function(){if(C==null)return;var a=w.header,b=babelHelpers.objectWithoutPropertiesLoose(w,["header"]),d=function(){B(!1),a==null?void 0:a.onPressBack==null?void 0:a.onPressBack(),C==null?void 0:C.popPage==null?void 0:C.popPage()},e={meta:a!=null?a.meta:v,onPressBack:d,title:a!=null?a.title:u};B(!0);C.pushPage(function(){var a=[{command:{key:c("CometKeys").LEFT},description:h._("__JHASH__L-rxpu3ax8O__JHASH__"),handler:d},{command:{key:c("CometKeys").ESCAPE},description:h._("__JHASH__L-rxpu3ax8O__JHASH__"),handler:d}];a=k.jsx(p.Provider,{value:y,children:k.jsx(c("CometComponentWithKeyCommands.react"),{commandConfigs:a,children:k.jsx(q,babelHelpers["extends"]({},b,{header:e}))})});for(var f=y.length-1;f>=0;f--)a=k.jsx("div",{"aria-label":y[f],role:"menu",children:a});return a})},[C,w,v,u,y]),E=function(a){t&&t(a),D()},F=n(function(){return[{command:{key:c("CometKeys").RIGHT},description:h._("__JHASH__hxu2eUUYT_R__JHASH__"),handler:D}]},[D]);return k.jsx(c("CometComponentWithKeyCommands.react"),{commandConfigs:F,children:k.jsx(c("CometMenuItemBase.react"),babelHelpers["extends"]({},a,{"aria-expanded":A,"aria-haspopup":"menu",aux:f?k.jsx("div",{className:"xz62fqu x16ldp7u",children:z}):z,disabled:e,iconNode:j!=null?j:f?k.jsx(c("CometMenuItemIcon.react"),{disabled:e,icon:f,iconColor:g,iconSize:r,use:s}):null,onClick:E,preventClosingMenuOnSelect:!0,primaryText:u,ref:b,role:"menuitem",secondaryText:v}))})}a.displayName=a.name+" [from "+f.id+"]";e=k.forwardRef(a);function q(a){var b=a.items,d=a.truncate;d=d===void 0?!0:d;a=babelHelpers.objectWithoutPropertiesLoose(a,["items","truncate"]);var e=m(c("BaseContextualLayerAvailableHeightContext"));return k.jsx(c("CometMenuBase.react"),babelHelpers["extends"]({},a,{maxHeight:d?(a=e)!=null?a:0:void 0,children:b}))}q.displayName=q.name+" [from "+f.id+"]";g["default"]=e}),98);
__d("MWCallBlockedUntilSettingMutation",["MWCallBlockedUntilSettingMutation.graphql","createCommitMutation_DEPRECATED"],(function(a,b,c,d,e,f,g){"use strict";var h;a=d("createCommitMutation_DEPRECATED").createCommitMutationForEnvironment_DEPRECATED({mutation:h!==void 0?h:h=b("MWCallBlockedUntilSettingMutation.graphql")});g.commit=a}),98);
__d("MWChatChangeSoundsSettingMutation",["MWChatChangeSoundsSettingMutation.graphql","createCommitMutation_DEPRECATED"],(function(a,b,c,d,e,f,g){"use strict";var h;a=d("createCommitMutation_DEPRECATED").createCommitMutationForEnvironment_DEPRECATED({mutation:h!==void 0?h:h=b("MWChatChangeSoundsSettingMutation.graphql")});g.commit=a}),98);
__d("MWChatChangeTurnOffTabsSettingMutation",["MWChatChangeTurnOffTabsSettingMutation.graphql","createCommitMutation_DEPRECATED"],(function(a,b,c,d,e,f,g){"use strict";var h;a=d("createCommitMutation_DEPRECATED").createCommitMutationForEnvironment_DEPRECATED({mutation:h!==void 0?h:h=b("MWChatChangeTurnOffTabsSettingMutation.graphql")});g.commit=a}),98);
__d("MWChatSoundsSettingSubscription",["CometRelay","MWChatSoundsSettingSubscription_MessengerSoundsSettingSubscription.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h!==void 0?h:h=b("MWChatSoundsSettingSubscription_MessengerSoundsSettingSubscription.graphql");function a(a,b){return d("CometRelay").requestSubscription(a,{onNext:b,subscription:i,variables:{input:{}}})}g.subscribe=a}),98);
__d("MWChatTabsSettingSubscription",["CometRelay","MWChatTabsSettingSubscription_MessengerChatTabsSettingSubscription.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h!==void 0?h:h=b("MWChatTabsSettingSubscription_MessengerChatTabsSettingSubscription.graphql");function a(a,b){return d("CometRelay").requestSubscription(a,{onNext:b,subscription:i,variables:{input:{}}})}g.subscribe=a}),98);
__d("useCometHomeChatSettings",["Actor","CometRelay","MWCallBlockedUntilSettingMutation","MWChatChangeSoundsSettingMutation","MWChatChangeTurnOffTabsSettingMutation","MWChatSidebarStateSettingMutation","MWChatSoundsSettingSubscription","MWChatTabsSettingSubscription","RTWebCallBlockedSettingSubscription","react","useCometHomeChatSettingsQuery.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h,i;f=i||d("react");var j=f.useCallback,k=f.useEffect,l=function(a,b){return function(c){c=c.getRoot();if(c==null)return;c=c.getLinkedRecord("viewer");if(c==null)return;c.setValue(b,a)}},m=h!==void 0?h:h=b("useCometHomeChatSettingsQuery.graphql");function a(a){var b,c,e,f;n();a=d("CometRelay").usePreloadedQuery(m,a);b=(b=(b=a.viewer)==null?void 0:b.call_blocked_until)!=null?b:0;c=(c=(c=a.viewer)==null?void 0:c.chat_sounds_on)!=null?c:!0;e=((e=a.viewer)==null?void 0:e.chat_tabs_turned_off)===!0;f=((f=a.viewer)==null?void 0:f.chat_sidebar_is_collapsed)===!0;a=((a=a.viewer)==null?void 0:a.chat_visibility)===!0;return{activeStatusOn:a,callBlockedUntil:b,chatSidebarIsCollapsed:f,chatSoundsOn:c,chatTabsTurnedOff:e}}function e(){var a=d("CometRelay").useRelayEnvironment();return{onChangeSidebarIsCollapsedSetting:function(b){c("MWChatSidebarStateSettingMutation")({environment:a,isCollapsed:b})},onChangeSoundsSetting:function(b){d("MWChatChangeSoundsSettingMutation").commit(a,{sounds_on:b})},onChangeTurnOffTabsSetting:function(b){d("MWChatChangeTurnOffTabsSettingMutation").commit(a,{turn_off_chat_tabs:b})},setCallBlockedUntil:function(b){d("MWCallBlockedUntilSettingMutation").commit(a,{call_blocked_until:b})}}}f=function(){var a=d("CometRelay").useQueryLoader(m),b=a[0],c=a[1];a=j(function(){return c({})},[c]);k(function(){return c({})},[c]);return[b,a]};function n(){var a=d("CometRelay").useRelayEnvironment(),b=d("Actor").useActor(),c=b[0];k(function(){var b={viewer_id:c},e=[d("RTWebCallBlockedSettingSubscription").subscribe(a,b,function(b){b=b==null?void 0:b.rtweb_call_blocked_setting_subscribe;b!=null&&a.commitUpdate(l("call_blocked_until",b.call_blocked_until))}),d("MWChatSoundsSettingSubscription").subscribe(a,function(b){b=b==null?void 0:b.messenger_chat_sounds_setting_subscribe;b!=null&&a.commitUpdate(l("chat_sounds_on",b.chat_sounds_enabled))}),d("MWChatTabsSettingSubscription").subscribe(a,function(b){b=b==null?void 0:b.messenger_chat_tabs_setting_subscribe;b!=null&&a.commitUpdate(l("chat_tabs_turned_off",!b.chat_tabs_enabled))})];return function(){e.forEach(function(a){return a.dispose()})}})}g.query=m;g.useCometHomeChatSettings=a;g.useCometHomeChatSettingsMutations=e;g.useCometHomeChatSettingsPreloadedQuery=f}),98);
__d("MAWReStoreDb",["MAWIndexedDb","MAWReStoreDbSetup"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){h==null&&(d("MAWIndexedDb").willSetupDB()?h=d("MAWIndexedDb").getDB().then(function(){return d("MAWReStoreDbSetup").getDB()}):h=d("MAWReStoreDbSetup").getDB());return h}g.getDB=a}),98);
__d("MAWReStoreTiming",["FBLogger","MAWErrorObject","MAWLLAMigrationUtils","MAWQplProxy","MAWReStoreDb","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h=["MWPTransactor"];function i(a){a=d("MAWLLAMigrationUtils").getTransactorQPLParam(a);a=a.length===2?a:[null,void 0];var b=a[0];a=a[1];return b!=null?d("MAWQplProxy").startQplUserFlow(b,a):null}var j=c("FBLogger")("messenger_e2ee_web");function k(a){if(a)return j.catching(a);else return j}function a(a,c){return b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=(yield d("MAWReStoreDb").getDB()),e=i(a),f;try{e==null?void 0:e.addPoint("transactor_execution_start");for(var g=arguments.length,j=new Array(g),l=0;l<g;l++)j[l]=arguments[l];f=(yield c.apply(void 0,[b].concat(j)));e==null?void 0:e.addPoint("transactor_execution_end");e==null?void 0:e.endSuccess()}catch(b){var m;e==null?void 0:e.endFail("transaction_fail");var n=d("MAWErrorObject").getErrorObject(b);throw k(n).mustfixThrow("[%s] Error performing %s transaction",h.join("|"),(m=a)!=null?m:"")}return f})}g.measureDuration=a}),98);
__d("LSQueryBulkUtils",["ReQL"],(function(a,b,c,d,e,f,g){"use strict";async function a(a,b){b=await Promise.all(b.map(function(b){return d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a).getKeyRange(b))}));return b.flat()}async function b(a,b){await Promise.all(b.map(function(b){return a.put(b)}));return b}g.bulkGetByIndex=a;g.bulkPut=b}),98);
__d("MAWRestoreDbMigration",["I64","LSQueryBulkUtils","MAWDbAppMeta","MAWDbObjEncryption","MAWReStoreDbSchema","MAWReStoreDbSetup","MAWReStoreMigrationUtils","MWEARKeychainV3","SignalDbTypes","WATagsLogger","err","gkx","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Incrementing failed migration counter: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Incrementing failure count as executeMigration returned false"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Marking DB as not needing migration in the future."]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Migration completed with status: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Starting DB migration"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Previous migration attempt purged"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Purging previous migration attempt"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Skipping due to previous failures"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["Migration is currently disabled, skipping the attempt"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["Already migrated db, no need to migrate"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["Skipping due to source db not existing"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["Skipping migration to ReStore since we're migrating back"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["Checking if we need to migrate the database"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["Completing migration"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["Data counts match.... completing migration"]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose(["Data moved, checking for consistency"]);x=function(){return a};return a}function y(){var a=babelHelpers.taggedTemplateLiteralLoose(["Moving data"]);y=function(){return a};return a}var z=d("WATagsLogger").TAGS(["DBInit","Migration"]),A=c("justknobx")._("1864"),B=c("justknobx")._("1871"),C=c("gkx")("5035"),D=new Map(d("MAWReStoreDbSchema").clientSchema.map(function(a){return[a.name,a]})),E=function(a){return new Promise(function(b){return setTimeout(b,a)})};async function F(a,b,c){var e="e2ee_"+c,f=await d("MAWReStoreMigrationUtils").fetchIDBBatch(null,b==null?void 0:b.transaction(c).objectStore(c)),g=async function(){var g=f.map(function(a){a[0];a=a[1];a=babelHelpers.extends({},d("MAWDbObjEncryption").decryptDbObj(a,c,d("MWEARKeychainV3").getDbEncryptionKey));var b=D.get(e)||{},f=b.auto_increment;b=b.primary_key;b=(b=b)!=null?b:[];b=b[0];b!=null&&f===!0&&(a[b]=(h||(h=d("I64"))).of_int32(a[b]));return a});await a.runInTransaction(async function(a){await d("LSQueryBulkUtils").bulkPut(a.table(e),g)},"readwrite");a.clearCacheIfSupported==null?void 0:a.clearCacheIfSupported();f=await d("MAWReStoreMigrationUtils").fetchIDBBatch(f[f.length-1][0],b==null?void 0:b.transaction(c).objectStore(c))};while(f.length)await g()}async function G(a,b,e){var f=Array.from(a.objectStoreNames).filter(function(a){return D.has("e2ee_"+a)});z.LOG(y());e==null?void 0:e.addPoint("table-migration-start");await f.reduce(function(c,d){return c.then(function(){return F(b,a,d)})},Promise.resolve());e==null?void 0:e.addPoint("table-migration-end");z.LOG(x());e==null?void 0:e.addPoint("data-verification-start");f=await f.reduce(function(c,e){return c.then(async function(c){var f=await Promise.all([d("MAWReStoreMigrationUtils").indexedDBCount(a,e),d("MAWReStoreMigrationUtils").restoreCount(b,e)]),g=f[0];f=f[1];b.clearCacheIfSupported==null?void 0:b.clearCacheIfSupported();return[].concat(c,[[e,g===f]])})},Promise.resolve([]));if(!f.every(function(a){a=a[1];return a})){f=f.filter(function(a){a=a[1];return!a}).map(function(a){a=a[0];return a});throw c("err")("count mismatch: "+f.join(",")+" ")}z.LOG(w());e==null?void 0:e.addPoint("data-verification-end");z.LOG(v());return!0}async function a(a,b,e){z.LOG(u());e==null?void 0:e.addPoint("open-source-db-start");a=await d("MAWReStoreMigrationUtils").getDBForMigration(a);e==null?void 0:e.addPoint("open-source-db-end");e==null?void 0:e.addAnnotations({bool:{shouldRunMigration:a!=null}});if(c("gkx")("5743")){z.LOG(t());e==null?void 0:e.addAnnotations({string:{migrationSkipReason:"revert-enabled"}});return!1}if(a==null){z.LOG(s());e==null?void 0:e.addAnnotations({string:{migrationSkipReason:"new-indexeddb"}});return!0}var f=await Promise.all([d("MAWReStoreMigrationUtils").fetchAppMetaKey(a,d("SignalDbTypes").MetaKeysEnum.restoreMigrationAttempts),d("MAWReStoreMigrationUtils").fetchAppMetaKey(a,d("MAWDbAppMeta").AppMetaKeysEnum.hasMigratedFromDexie)]),g=f[0];f=f[1];g=(g=g==null?void 0:(g=g.value)==null?void 0:g.restoreMigrationAttempts)!=null?g:0;f=(f=f==null?void 0:(f=f.value)==null?void 0:f.hasMigratedFromDexie)!=null?f:!1;if(f===!0){z.LOG(r());e==null?void 0:e.addAnnotations({string:{migrationSkipReason:"previously-migrated"}});a.close();return!0}if(C===!1){z.LOG(q());e==null?void 0:e.addAnnotations({string:{migrationSkipReason:"migration-disabled"}});a.close();return!1}if(g>B){e==null?void 0:e.addAnnotations({string:{migrationSkipReason:"exceeded-max-attempts"}});z.LOG(p());a.close();return!1}e==null?void 0:e.addPoint("checking-target-db-start");f=await d("MAWReStoreMigrationUtils").getDBForMigration(b);f!=null&&(z.LOG(o()),e==null?void 0:e.addAnnotations({bool:{purgedPreviousAttempt:!0}}),f.close(),await d("MAWReStoreDbSetup").closeDB(),await d("MAWReStoreMigrationUtils").deleteDB(b),z.LOG(n()));e==null?void 0:e.addPoint("checking-target-db-end");try{z.LOG(m());f=await d("MAWReStoreDbSetup").getDB();b=await Promise.race([E(A).then(function(){throw c("err")("timeout")}),G(a,f,e)]).then(function(a){return typeof a==="boolean"?a:!1});z.LOG(l(),b);b?(z.LOG(k()),await d("MAWReStoreMigrationUtils").putAppMetaKey(a,d("MAWDbAppMeta").AppMetaKeysEnum.hasMigratedFromDexie,!0)):(z.LOG(j()),await d("MAWReStoreMigrationUtils").putAppMetaKey(a,d("MAWDbAppMeta").AppMetaKeysEnum.restoreMigrationAttempts,g+1));return b}catch(b){a!=null&&(z.LOG(i(),b),await d("MAWReStoreMigrationUtils").putAppMetaKey(a,d("MAWDbAppMeta").AppMetaKeysEnum.restoreMigrationAttempts,g+1));throw b}finally{a==null?void 0:a.close()}}g.migrateToRestoreFromDexie=a}),98);
__d("MAWDbDeletedMessages",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({ChatDelete:"chat_delete",Revoke:"revoke"});f.DbDeletedMsgReasonEnum=a}),66);
__d("MAWDbParticipant",["MAWDbChatId","WAJids"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return a+"_"+b}function b(a){a=a.split("_");var b=d("MAWDbChatId").unsafeCoerceToChatId(parseInt(a[0],10));a=d("WAJids").unsafeCoerceToUserJid(a[1]);return{threadId:b,userJid:a}}g.craftParticipantId=a;g.getThreadIdAndUserJidFromParticipantId=b}),98);
__d("MAWDbPendingStanza",["WAAssertUnreachable"],(function(a,b,c,d,e,f,g){"use strict";var h="revoked",i="deleteForMe",j="deleteThread";b="Revoked";d="DeleteForMe";e="DeleteThread";f={DELETE_FOR_ME:d,DELETE_THREAD:e,REVOKED:b};function a(a){switch(a){case"Revoked":return h;case"DeleteForMe":return i;case"DeleteThread":return j;default:return c("WAAssertUnreachable")(a)}}g.PENDING_REVOKED=h;g.PENDING_DELETE_FOR_ME=i;g.REVOKED=b;g.DELETE_FOR_ME=d;g.PENDING_TYPE=f;g.getPendingSuffix=a}),98);
__d("MAWDbReaction",["MAWAckLevel","MAWGlobals","WAJids"],(function(a,b,c,d,e,f,g){"use strict";function a(a){if(a.reactToAuthor!=="@me"||a.reaction==null)return null;var b=a.author==="@me"||a.author==="@system"?null:a.author;return b==null?null:babelHelpers["extends"]({},a,{author:b,reaction:a.reaction,reactToAuthor:a.reactToAuthor})}function b(a,b,c){var e=d("MAWGlobals").getMyUserJid();return a.find(function(a){return a.threadJid===b&&d("WAJids").authorToUserId(a.author,e)===d("WAJids").authorToUserId(c,e)})}function c(a){return a}function e(a,b,c,e,f,g,h,i,j,k,l,m){m===void 0&&(m=d("MAWAckLevel").ACK.clock);m={ack:m,author:k,externalId:b,groupingKey:g,reaction:f,reactionId:c,reactToAuthor:h,reactToExternalId:e,reactToMsgId:i,threadJid:a,ts:j};return l!=null?babelHelpers["extends"]({},m,{rowId:l}):m}g.castToIncomingDbReaction=a;g.findMatchingReaction=b;g.reactionIdToMsgId=c;g.formatReactionForDb=e}),98);
__d("MAWAddQPLPointForHandleIncomingMsgApi",["MAWDexieTable","gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){if(!c("gkx")("1017"))return;var e=d("MAWDexieTable").getDexiePSDItem("transactorQPLEvent"),f=d("MAWDexieTable").getDexiePSDItem("offlineQueueSize");f===1&&(e==null?void 0:e.addPoint(a,b))}g.addQPLPointForHIMApi=a}),98);
__d("WAArrayZip",[],(function(a,b,c,d,e,f){function a(a,b){var c=Math.min(a.length,b.length);return a.slice(0,c).map(function(a,c){return[a,b[c]]})}f.zip=a}),66);
__d("MAWDbIdentityTxns",["MAWAddQPLPointForHandleIncomingMsgApi","MAWDexieTable","MAWGlobals","MAWJids","WAArrayZip","WABaseGlobals","WACryptoUtils","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Invalidate dhash for ",""]);h=function(){return a};return a}function i(a,b){if(b==null)return void 0;a=d("WAJids").isAuthorMe(a)?d("WABaseGlobals").getMyUserJid():a;return d("MAWJids").toDeviceJid(a,b)}function a(a,b){var c=Array.from(b.map(function(a){return a.msgData}).reduce(function(a,b){var c=b.device;b=b.id;b=i(b.author,c==null?void 0:c.id);return b==null?a:a.add(b)},new Set())),e=new Map();return a.identity.bulkGet(Array.from(c)).then(function(a){d("WAArrayZip").zip(c,a).forEach(function(a){var b=a[0];a=a[1];e.set(b,a==null);d("MAWAddQPLPointForHandleIncomingMsgApi").addQPLPointForHIMApi("hasDeviceJid",{bool:{knownDevice:a!=null}})});e.set(void 0,!0);return e})}function b(a,b){return j(a,b).then(function(a){return a.map(function(a){if(a==null)return;return{id:a.deviceJid,identity:a.identity}}).filter(Boolean)})}function c(a,b){return a.identity.bulkPut(b).then(function(){})}function e(a,b){return j(a,b).then(function(a){var c=new Map();for(var d=0;d<a.length;d++){var e=a[d],f=b[d];e!=null&&c.set(f,{pubKey:e.identity})}return c})}function j(a,b){return a.identity.bulkGet(b)}function k(a,b){return a.identity.where("userJid").equals(b).toArray()}function f(a,b){return a.identity.where("userJid").anyOf(b).toArray()}function l(a,b,c){var e=[],f=new Map();b.forEach(function(b){var d=k(a,b).then(function(a){var d=[];a.forEach(function(a){if(c!=null&&a.deviceJid===c)return;d.push(a)});d.length>0&&f.set(b,d)});e.push(d)});return d("MAWDexieTable").dexieAll(e).then(function(){return f})}function m(a,b){var c=b.find(function(a){return a.deviceJid===d("MAWGlobals").getMyDeviceJid()});if(c!=null)return a.identity.get(c.deviceJid).then(function(a){if(a!=null&&!d("WACryptoUtils").uint8ArraysEqual(c.identity,a.identity))return!0;else return!1});else return d("MAWDexieTable").dexieResolve(!1)}function n(a,b){d("WALogger").DEV(h(),b);return a.contacts.bulkGet(b).then(function(b){b=b.filter(Boolean);b.forEach(function(a){a.dhash=null});return a.contacts.bulkPut(b)}).then(function(){})}function o(a,b){return a.identity.bulkGet(b.map(function(a){a=a.deviceJid;return a})).then(function(a){a=new Set(a.map(function(a,c){return a==null?b[c]:null}).filter(Boolean).map(function(a){a=a.userJid;return a}));return Array.from(a)})}g.getDeviceJid=i;g.bulkGetUnknownDeviceStatus=a;g.bulkGetIdentities=b;g.bulkPutIdentities=c;g.getIdentitiesForDevices=e;g.bulkGetIdentityRows=j;g.getIdentitiesForUser=k;g.getIdentitiesForUsers=f;g.getIdentitiesForMultipleUsers=l;g.compareIdentityMismatch=m;g.invalidateDhash=n;g.getUsersWithNewDevices=o}),98);
__d("MAWCompareIdentity",["MAWDbIdentityTxns","MAWODSProxy","MAWQplProxy","SignalDbTypes","WABase64","WACryptoUtils","WAJids","WALogger","WAOdsEnums","WASignalKeys","gkx","qpl"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Got identity mismatch ",", "," in compare identity"]);h=function(){return a};return a}function a(a){return a.meta.bulkGet([d("SignalDbTypes").MetaKeysEnum.fbid,d("SignalDbTypes").MetaKeysEnum.deviceId,d("SignalDbTypes").MetaKeysEnum.identityKeyPair]).then(function(b){var e=b[0],f=b[1];b=b[2];e=e==null?void 0:e.value.fbid;f=f==null?void 0:f.value.deviceId;var g=b==null?void 0:b.value.identityKeyPair;if(e!=null&&f!=null){b=d("WAJids").toDeviceJid(d("WAJids").toMsgrUserJid(e),f);return d("MAWDbIdentityTxns").bulkGetIdentities(a,[b]).then(function(a){if(!(a.length===0)){a=a[0];if((g==null?void 0:g.publicKey)==null)return!0;if(!d("WACryptoUtils").serializedPubKeysEqual(a.identity,d("WASignalKeys").serializePubKey(g))){var b=d("MAWQplProxy").startQplUserFlow(c("qpl")._(741087294,"2028"));b.endSuccess();d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.COMPARE_IDENTITY,key:"meta_identity_mismatch"});c("gkx")("2378")&&c("gkx")("4283")&&d("WALogger").ERROR(h(),d("WABase64").encodeB64(a.identity),d("WABase64").encodeB64(d("WASignalKeys").serializePubKey(g)));return!1}}return!0})}return!0})}g.compareIdentityDexie=a}),98);
__d("MAWBridgeMsgCountdown",["MAWDbMsg","MAWLoggerUtils","WATagsLogger","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["createBridgeMsgsStartCountdown: msg ",", expiration ",", ms until countdown ",", duration ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Calling the messages starting countdown bridge event with remaning time less or equal to 0 (expired message)"]);i=function(){return a};return a}var j=d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.Ephemeral,d("MAWLoggerUtils").Tag.Countdown]);function a(a){return{msgs:a.map(function(a){var b,c=a.messageExpirationTs;b=(b=a.ephemeralSetting)==null?void 0:b.ephemeralExpirationInSec;if(c==null||b==null)return;var e=d("WATimeUtils").cappedMillisecondsUntil(c);if(e<=0){j.LOG(i());return}var f=b*1e3;e>f&&(e=f);j.LOG(h(),a.msgId,c,e,b);return{chatId:a.thread,countdownTs:c,millisecondsUntilCountdownTs:e,msgId:a.msgId,ts:d("MAWDbMsg").getCanonicalTsFromMsg(a)}}).filter(Boolean)}}function b(a,b){return{countdownTs:b,msgId:a}}g.createBridgeMsgsStartCountdown=a;g.createBridgeMsgClearCountdown=b}),98);
__d("MAWBridgeTypesCreators",["MAWDbMsg","MAWDbParticipant","MAWGlobals","MAWImageUtils","MAWMsgType","WAAssertUnreachable","WAJids","WAMediaUtils","WATimeUtils","gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return{threadId:a}}function h(a){var b,c=a.ts;switch(a.type){case d("MAWMsgType").MSG_TYPE.REVOKED:c=(b=a.originalTs)!=null?b:a.ts;break;default:c=d("MAWDbMsg").getCanonicalTsFromMsg(a)}return{msgId:a.msgId,threadId:a.thread,ts:c}}function b(a,b){b=b.map(h);return{messages:b,threadId:a}}function e(a){return{ravenMsgId:a.msgId,threadId:a.thread}}function f(a,b,e,f,g,h){var i,j=b.msgIds.filter(function(b){return d("MAWDbMsg").getThreadIdFromMsgId(b)===a});switch(b.mediaType){case"Image":return{duration:null,ephemeralMediaState:g==null?void 0:g.ephemeralMediaState,ephemeralMediaViewMode:g==null?void 0:g.ephemeralMediaViewMode,filesize:b.size,hasMedia:e,mediaId:b.mediaId,mediaType:b.mediaType,msgIds:j,offlineAttachmentId:h,previewHeight:(i=b.validatedImageInfo)==null?void 0:i.jpegThumbnailHeight,previewHeightLarge:(i=b.validatedImageInfo)==null?void 0:i.height,previewWidth:(i=b.validatedImageInfo)==null?void 0:i.jpegThumbnailWidth,previewWidthLarge:(i=b.validatedImageInfo)==null?void 0:i.width,threadId:a,ts:d("WATimeUtils").castToUnixTime(f!=null?f/1e3:b.ts)};case"Video":return{duration:((i=b.validatedVideoInfo)==null?void 0:i.duration)!=null?((i=b.validatedVideoInfo)==null?void 0:i.duration)*1e3:0,ephemeralMediaState:g==null?void 0:g.ephemeralMediaState,ephemeralMediaViewMode:g==null?void 0:g.ephemeralMediaViewMode,filesize:b.size,hasMedia:e,mediaId:b.mediaId,mediaType:b.mediaType,msgIds:j,offlineAttachmentId:h,previewHeight:(i=b.validatedVideoInfo)==null?void 0:i.jpegThumbnailHeight,previewHeightLarge:(g=b.validatedVideoInfo)==null?void 0:g.height,previewWidth:(i=b.validatedVideoInfo)==null?void 0:i.jpegThumbnailWidth,previewWidthLarge:(g=b.validatedVideoInfo)==null?void 0:g.width,threadId:a,ts:d("WATimeUtils").castToUnixTime(f!=null?f/1e3:b.ts)};case"Ptt":return{duration:((i=b.validatedAudioInfo)==null?void 0:i.duration)?b.validatedAudioInfo.duration*1e3:null,filesize:b.size,hasMedia:e,mediaId:b.mediaId,mediaType:b.mediaType,msgIds:j,offlineAttachmentId:h,previewHeight:null,previewHeightLarge:null,previewWidth:null,previewWidthLarge:null,threadId:a,ts:d("WATimeUtils").castToUnixTime(f!=null?f/1e3:b.ts)};case"Gif":return{duration:null,filesize:b.size,hasMedia:e,mediaId:b.mediaId,mediaType:b.mediaType,msgIds:b.msgIds,offlineAttachmentId:h,previewHeight:(g=b.validatedImageInfo)==null?void 0:g.jpegThumbnailHeight,previewHeightLarge:(i=b.validatedImageInfo)==null?void 0:i.height,previewWidth:(g=b.validatedImageInfo)==null?void 0:g.jpegThumbnailWidth,previewWidthLarge:(i=b.validatedImageInfo)==null?void 0:i.width,threadId:a,ts:d("WATimeUtils").castToUnixTime(f!=null?f/1e3:b.ts)};case"Sticker":g=d("MAWImageUtils").boundHeightWidth((g=b.validatedImageInfo)==null?void 0:g.jpegThumbnailHeight,(i=b.validatedImageInfo)==null?void 0:i.jpegThumbnailWidth,128);i=g.height;g=g.width;return{duration:null,filesize:b.size,hasMedia:e,mediaId:b.mediaId,mediaType:b.mediaType,msgIds:b.msgIds,offlineAttachmentId:h,previewHeight:i,previewHeightLarge:i,previewWidth:g,previewWidthLarge:g,threadId:a,ts:d("WATimeUtils").castToUnixTime(f!=null?f/1e3:b.ts)};case"DocumentFile":i={};for(var g=b.mediaEntries,k=Array.isArray(g),l=0,g=k?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var m;if(k){if(l>=g.length)break;m=g[l++]}else{l=g.next();if(l.done)break;m=l.value}m=m;var n=m[0];m=m[1];m=d("WAMediaUtils").mediaEntryDataToRawData(b.plaintextHash,m);m=m.filename;m!=null&&(i[n]=m)}return{defaultFilename:(n=b.validatedDocumentFileInfo)==null?void 0:n.filename,duration:null,filenames:i,filesize:b.size,hasMedia:e,mediaId:b.mediaId,mediaType:b.mediaType,msgIds:j,offlineAttachmentId:h,previewHeight:null,previewHeightLarge:null,previewWidth:null,previewWidthLarge:null,threadId:a,ts:d("WATimeUtils").castToUnixTime(f!=null?f/1e3:b.ts)};default:return c("WAAssertUnreachable")(b.mediaType)}}function i(a,b,c,e,f,g){return{chatJid:b,deliveredWatermarkTs:(b=e)!=null?b:d("WATimeUtils").castToUnixTime(0),fbid:c,lastReadActionTs:(e=g)!=null?e:d("WATimeUtils").castToUnixTime(0),lastReadWatermarkTs:(b=f)!=null?b:d("WATimeUtils").castToUnixTime(0),threadId:a}}function j(a){var b=a.cannotReplyReason,c=a.chatJid,d=a.folder,e=a.fromCheckIfParticipant,f=a.muteExpireTimeMs,g=a.snippetParams,h=a.snippetSenderContactId,i=a.snippetType;a=a.threadId;return{cannotReplyReason:b,chatJid:c,folder:d,fromCheckIfParticipant:e,muteExpireTimeMs:f,snippetContactIDs:g==null?void 0:g.contactIDs,snippetMentionJIDs:g==null?void 0:g.mentionJIDs,snippetParams:g==null?void 0:g.strings,snippetSenderContactId:h,snippetType:i,threadId:a}}function k(a){return{chatJid:a.groupJid,threadId:a.threadId,threadName:a.name}}function l(a,b,c,e,f,g,h,i){return{chatJid:b,description:i,lastActivityTs:c,lastReadTs:(b=e)!=null?b:d("WATimeUtils").castToMillisTime(0),snippetContactIDs:g.contactIDs,snippetMentionJIDs:(i=g.mentionJIDs)!=null?i:[],snippetParams:g.strings,snippetSenderContactId:h,snippetType:f,threadId:a}}function m(a,b,e,f,g,h,i){i===void 0&&(i="before");e=e;if(e.length===0)return{chatJid:b,rangeExtensionType:null,threadId:a};if(f)return{chatJid:b,rangeExtensionType:{hasMoreBefore:g,maxMsgId:e[0].msgId,minMsgId:e[e.length-1].msgId,minMsgTs:d("MAWDbMsg").getOriginalTsFromMsg(e[e.length-1])*1e3,rangeKind:"initial"},threadId:a};return c("gkx")("6884")?{chatJid:b,rangeExtensionType:{hasMoreAfter:h,hasMoreBefore:g,maxMsgId:e[0].msgId,maxMsgTs:d("MAWDbMsg").getOriginalTsFromMsg(e[0])*1e3,minMsgId:e[e.length-1].msgId,minMsgTs:d("MAWDbMsg").getOriginalTsFromMsg(e[e.length-1])*1e3,rangeKind:i==="before"?"before":"after"},threadId:a}:{chatJid:b,rangeExtensionType:{hasMoreBefore:g,minMsgId:e[e.length-1].msgId,minMsgTs:d("MAWDbMsg").getOriginalTsFromMsg(e[e.length-1])*1e3,rangeKind:"extensionBefore"},threadId:a}}function n(a,b,c,e,f){b=b;return{offsetMsgId:f,rangeExtensionType:b.length===0?null:{hasMoreAfter:e,hasMoreBefore:c,maxMsgId:b[b.length-1].msgId,maxMsgTs:d("MAWDbMsg").getOriginalTsFromMsg(b[b.length-1])*1e3,minMsgId:b[0].msgId,minMsgTs:d("MAWDbMsg").getOriginalTsFromMsg(b[0])*1e3,rangeKind:"extension"},threadId:a}}function o(a){var b=d("WAJids").extractDeviceIDParts(d("MAWGlobals").getMyDeviceJid()).userId,c=a.author,e=a.chatId,f=a.chatJid,g=a.reaction,h=a.reactToMsgId;a=a.ts;return{actorId:d("WAJids").authorToUserId(c,b),chatJid:f,messageId:h,reaction:g,threadId:e,ts:a}}function p(a){return{hasMoreAfter:!1,hasMoreBefore:!1,maxMsgId:a.newestMsg,maxMsgTs:a.newestMsgTs,minMsgId:a.oldestMsg,minMsgTs:d("WATimeUtils").castToMillisTime(0),threadId:a.chatId}}function q(a){var b=d("WAJids").extractDeviceIDParts(d("MAWGlobals").getMyDeviceJid()).userId,c=a.author,e=a.chatId,f=a.chatJid;a=a.reactToMsgId;return{actorId:d("WAJids").authorToUserId(c,b),chatJid:f,messageId:a,threadId:e}}function r(a){return{creationTs:a.creationTs,creator:a.creator,groupJid:a.groupJid,msgExpiration:a.msgExpiration,name:a.name,nameOwner:a.nameOwner,nameTs:a.nameTs,participantVersion:a.participantVersion,threadId:a.threadId}}function s(a){var b=d("MAWDbParticipant").getThreadIdAndUserJidFromParticipantId(a.invitedParticipantId),c=b.threadId;b=b.userJid;return{caption:a.caption,inviteCode:a.inviteCode,inviteeId:d("WAJids").extractUserId(b),inviteExpireTs:a.inviteExpirationTs,inviterId:d("WAJids").extractUserId(a.inviterJid),threadId:c}}function t(a){a=d("MAWDbParticipant").getThreadIdAndUserJidFromParticipantId(a);a=a.threadId;return{threadId:a}}function u(a){return{fbid:d("WAJids").extractUserId(a.contactJid)}}function v(a,b,c){return{senderId:d("WAJids").extractUserId(b),state:c,threadId:a}}g.createBridgeUpdateE2EEMetadataParticipants=a;g.createBridgeDeleteMessages=b;g.createBridgeRavenAction=e;g.createBridgeMedia=f;g.createBridgeReceivedReceipt=i;g.createBridgeUpdatedThread=j;g.createBridgeUpdatedGroupInfo=k;g.createBridgeBumpedThread=l;g.createBridgeMsgsLoadedInfo=m;g.createBridgeMsgRangeLoadedInfo=n;g.createBridgeUpsertReaction=o;g.createBridgeUpdateMessageRange=p;g.createBridgeDeleteReaction=q;g.createBridgeGroupInfo=r;g.createBridgeGroupInvite=s;g.createBridgeDeleteGroupInvite=t;g.createBridgeContact=u;g.createBridgeReceivedChatState=v}),98);
__d("MAWBridgeXMA",["MAWDbMedia","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["MAWBridge - createBridgeXMA received unexpected media type - ",""]);h=function(){return a};return a}function i(a){if(a==null)return void 0;switch(a){case"Image":case"Sticker":return"image/png";case"Gif":return"image/gif";case"Video":return"video/mp4";case"Ptt":return"audio/wav"}}function a(a,b,c){var e=c.contentRef,f=c.ctas,g=c.defaultCTA,j=c.defaultPreviewMediaId,k=c.faviconMediaId,l=c.headerMediaId,m=c.headerTitle,n=c.maxSubtitleNumOfLines,o=c.maxTitleNumOfLines,p=c.msgId,q=c.offlineAttachmentId,r=c.overlayIconGlyph,s=c.overlayTitle,t=c.subtitleText,u=c.targetId,v=c.targetType,w=c.targetUsername,x=c.titleText,y=c.xmaId;c=c.xmaLayoutType;b!=null&&b.mediaType!==d("MAWDbMedia").IMAGE&&d("WALogger").WARN(h(),b.mediaType);return{contentRef:e,ctas:f,defaultCTA:g,defaultPreviewMediaId:j,duration:null,faviconMediaId:k,filesize:b==null?void 0:b.size,headerMediaId:l,headerTitle:m,maxSubtitleNumOfLines:n,maxTitleNumOfLines:o,mediaType:b==null?void 0:b.mediaType,msgId:p,offlineAttachmentId:q,overlayIconGlyph:r,overlayTitle:s,playableUrlMimeType:i(b==null?void 0:b.mediaType),previewHeight:b==null?void 0:(e=b.validatedImageInfo)==null?void 0:e.jpegThumbnailHeight,previewHeightLarge:b==null?void 0:(f=b.validatedImageInfo)==null?void 0:f.height,previewUrlMimeType:i(b==null?void 0:b.mediaType),previewWidth:b==null?void 0:(g=b.validatedImageInfo)==null?void 0:g.jpegThumbnailWidth,previewWidthLarge:b==null?void 0:(j=b.validatedImageInfo)==null?void 0:j.width,subtitleText:t,targetId:u,targetType:v,targetUsername:w,threadId:a,titleText:x,ts:b==null?void 0:b.ts,xmaId:y,xmaLayoutType:c}}function b(a,b){var c=a.msgId;a=a.thread;return{chatId:a,msgId:c,xmaId:b}}function c(a,b){var c=a.msgId;a=a.thread;return{msgId:c,threadId:a,xmaId:b}}g.createBridgeXMA=a;g.createBridgeXMAShareExpired=b;g.createBridgeXMAShareTombstoned=c}),98);
__d("WAErrorMessage",[],(function(a,b,c,d,e,f){"use strict";var g="NoErrorMessageProvided";function a(a){var b;a instanceof Error?b=a.message:typeof a==="string"?b=a:typeof a==="object"?typeof (a==null?void 0:a.description)==="string"?b=a.description:typeof (a==null?void 0:a.message)==="string"?b=a.message:b=g:b=g;return b}f.NO_ERROR_MESSAGE_PROVIDED=g;f.maybeGetMessageFromError=a}),66);
__d("MAWDbChunkTxns",["WAErrorMessage","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to add chunk. Possible duplicate? Will attempt a retry. Error: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to add chunk. Possible duplicate? Will attempt a retry. For hashedPlaintextHash: ",". Error: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to add chunk after retry. Error: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to add chunk for hashedPlaintextHash: ",". Error: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Chunk found after retry for hashedPlaintextHash: ",""]);l=function(){return a};return a}var m=d("WATagsLogger").TAGS(["MAWDbChunkTxns"]);b=function a(b,c,e,f,g,n){n===void 0&&(n=0);return b.chunk.where("hashedPlaintextHash").equals(e).first().then(function(o){if(o){n>0&&m.LOG(l(),e);return o}else{var p={blobData:f,hashedPlaintextHash:e,mimetype:g,plaintextHash:c};return b.chunk.add(p).then(function(a){return babelHelpers["extends"]({},p,{chunkId:a})})["catch"](function(l){var o=d("WAErrorMessage").maybeGetMessageFromError(l);if(n>0){m.WARN(k(),e,o);m.ERROR(j(),o);throw l}else{m.WARN(i(),e,o);m.ERROR(h(),o);return a(b,c,e,f,g,n+1)}})}})};c=function(a,b){return n(a,b).then(function(a){return a!=null})};var n=function(a,b){return a.chunk.where("hashedPlaintextHash").equals(b).first()};e=function(a,b){return a.chunk.where("hashedPlaintextHash").anyOf(b).toArray().then(function(a){return new Map(a.map(function(a){return[a.hashedPlaintextHash,a]}))})};function a(a,b){return a.chunk.bulkGet(b)}g.getOrCreateMediaChunk=b;g.hasMediaChunk=c;g.maybeGetChunkFromHash=n;g.maybeBulkGetChunksFromHash=e;g.bulkGetChunks=a}),98);
__d("MAWDbMediaTxns",["MAWDbMsg","MAWDexieTable","MAWMsgType","WALogger","WAResultOrError","err"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["mediaId is null for media msg with msgId: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["mediaId is null for media msg with msgId: ",""]);i=function(){return a};return a}function a(a,b){return b==null?d("MAWDexieTable").dexieResolve():a.media.get({mediaId:b})}function b(a,b){return a.media.where("hashedPlaintextHash").equals(b).first()}function e(a,b){return a.media.where("hashedPlaintextHash").anyOf(b).toArray()}function f(a,b){return b==null?d("MAWDexieTable").dexieResolve():j(a,b).then(function(c){c=c==null?void 0:c.mediaId;return c!=null?a.media.get({mediaId:c}):a.media.get({objectId:b})})}function j(a,b){return b==null?d("MAWDexieTable").dexieResolve():a.mediaBackup.get({objectId:b})}function k(a,b){a=a.mediaBackup.where("objectId").anyOf(b).toArray();return a.then(function(a){return new Map(a.map(function(a){return[a.objectId,a]}))})}function l(a,b){return k(a,b).then(function(b){b=Array.from(b.values()).map(function(a){return a.mediaId});return a.media.bulkGet(b)})}function m(a,b){if(b==null)return d("MAWDexieTable").dexieResolve();a=a.mediaBackup.where("msgId").equals(b).toArray();return a}function n(a,b){if(b.length===0)return d("MAWDexieTable").dexieResolve([]);b=b.filter(d("MAWDbMsg").isMediaMsg);var e=b.reduce(function(a,b){if(b.mediaId==null){d("WALogger").ERROR(i(),b.msgId);return a}return a.set(b.mediaId,b)},new Map());b=Array.from(e.keys());return q(a,b).then(function(a){var b=[];a.forEach(function(a){if(a==null)throw c("err")("Error missing media");var d=e.get(a.mediaId);if(d==null)throw c("err")("Error missing media");b.push([d,a])});return b})}function o(a,b){if(b.length===0)return d("MAWDexieTable").dexieResolve([]);b=b.filter(d("MAWDbMsg").isMediaMsg).map(function(a){var b=a.mediaId;if(b==null){d("WALogger").ERROR(h(),a.msgId);throw c("err")("mediaId is missing")}else return b});return q(a,b).then(function(a){var b=[];a.forEach(function(a){a!=null&&b.push(a)});return b})}function p(a,b){if(b.type===d("MAWMsgType").MSG_TYPE.DELETE_FOR_ME||d("MAWDbMsg").isMediaMsg(b)){var c=b.mediaId;return c==null?b.type===d("MAWMsgType").MSG_TYPE.DELETE_FOR_ME?d("MAWDexieTable").dexieResolve(d("WAResultOrError").makeResult()):d("MAWDexieTable").dexieResolve(d("WAResultOrError").makeError("missing")):a.media.get(c).then(function(a){return a==null?d("WAResultOrError").makeError("missing"):d("WAResultOrError").makeResult(a)})}else return d("MAWDexieTable").dexieResolve(d("WAResultOrError").makeResult())}function q(a,b){return a.media.bulkGet(b)}function r(a,b){var c=b.previewMediaIds!=null?q(a,b.previewMediaIds):d("MAWDexieTable").dexieResolve(),e=b.headerMediaId!=null?a.media.get(b.headerMediaId):d("MAWDexieTable").dexieResolve();a=b.faviconMediaId!=null?a.media.get(b.faviconMediaId):d("MAWDexieTable").dexieResolve();return d("MAWDexieTable").dexieAll([c,e,a]).then(function(a){var c=a[0],e=a[1];a=a[2];if(b.headerMediaId!=null&&e==null)return d("WAResultOrError").makeError("missing");if(b.faviconMediaId!=null&&a==null)return d("WAResultOrError").makeError("missing");if(c==null)return d("WAResultOrError").makeError("missing");var f=[];for(var c=c,g=Array.isArray(c),h=0,c=g?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(g){if(h>=c.length)break;i=c[h++]}else{h=c.next();if(h.done)break;i=h.value}i=i;if(i==null)return d("WAResultOrError").makeError("missing");else f.push(i)}return d("WAResultOrError").makeResult({favicon:a,header:e,previews:f})})}function s(a,b,c){b=babelHelpers["extends"]({},b,c);return a.media.put(b)}g.maybeGetMediaFromMediaId=a;g.maybeGetMediaFromHash=b;g.maybeBulkGetMediaFromHash=e;g.maybeGetMediaFromObjectId=f;g.maybeGetMediaBackupRowFromObjectId=j;g.maybeGetMediaBackupRowsFromObjectIds=k;g.maybeGetBulkMediaFromObjectIds=l;g.maybeGetMediaBackupRowFromMsgId=m;g.getMsgMediaPairFromMsgs=n;g.getMediaFromMsgs=o;g.getAndCheckMediaFromMsg=p;g.bulkGetMedias=q;g.getMediaForXMA=r;g.updateMedia=s}),98);
__d("MAWJidUtils",["FBLogger","WAJids"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,e){if(d("WAJids").isAuthorSystem(a)||b==null||e==null){c("FBLogger")("messenger_e2ee_web").warn("Failed to create protocolMsgId with externalId %s for a msg to edit",e);return}return{author:a,chat:b,externalId:e}}function a(a){var b;return h(a.author,a.threadJid,(b=a.externalId)!=null?b:a.editExternalId)}g.maybeToProtocolMsgId=h;g.toProtocolMsgId=a}),98);
__d("MAWLoadReplyMediaTxns",["MAWDbChunkTxns","MAWDbMedia","MAWDbMsg","MAWDbXMATxns","MAWDexieTable","MAWGlobals","MAWJidUtils","MAWMsgType","MAWXMAUtils","WAAssertUnreachable","WAJids","WALogger","WAMsgType","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unable to fetch reply media XMA with id ",": ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unable to fetch reply media with id ",": ",""]);i=function(){return a};return a}function j(a,b){return a.media.get(b).then(function(b){return b==null?[void 0,void 0]:d("MAWDbChunkTxns").maybeGetChunkFromHash(a,b.hashedPlaintextHash).then(function(a){return a==null?[void 0,void 0]:[a,b]})})}var k=new Set([(e=d("MAWDbMedia")).MEDIA_TYPE.IMAGE,e.MEDIA_TYPE.GIF,e.MEDIA_TYPE.PTT,e.MEDIA_TYPE.STICKER,e.MEDIA_TYPE.VIDEO,e.MEDIA_TYPE.DOCUMENT_FILE]);function l(a){var b;switch(a.mediaType){case d("MAWDbMedia").MEDIA_TYPE.IMAGE:case d("MAWDbMedia").MEDIA_TYPE.GIF:case d("MAWDbMedia").MEDIA_TYPE.STICKER:b=a.validatedImageInfo;break;case d("MAWDbMedia").MEDIA_TYPE.VIDEO:b=a.validatedVideoInfo;break}a=b||{};var c=a.jpegThumbnailHeight;a=a.jpegThumbnailWidth;return{replyMediaPreviewHeight:c,replyMediaPreviewWidth:a}}function m(a){switch(a.type){case d("MAWMsgType").MSG_TYPE.IMAGE:case d("MAWMsgType").MSG_TYPE.VIDEO:case d("MAWMsgType").MSG_TYPE.PTT:case d("MAWMsgType").MSG_TYPE.GIF:case d("MAWMsgType").MSG_TYPE.STICKER:case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:return!0;case d("MAWMsgType").MSG_TYPE.XMA:return d("MAWXMAUtils").isXMAShare(a.xmaMessageType);case d("MAWMsgType").MSG_TYPE.TEXT:case d("MAWMsgType").MSG_TYPE.UNAVAILABLE:case d("MAWMsgType").MSG_TYPE.REVOKED:case d("MAWMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:case d("MAWMsgType").MSG_TYPE.GROUP_INVITE:case d("MAWMsgType").MSG_TYPE.CIPHERTEXT:case d("WAMsgType").NOTE_REPLY:return!1;default:return c("WAAssertUnreachable")(a.type)}}function n(a,b){return b==null?d("MAWDexieTable").dexieResolve():j(a,b).then(function(a){var c=a[0];a=a[1];if(c==null||a==null)return d("WAResultOrError").makeError("reply_media_not_found");if(!k.has(a.mediaType))return d("WAResultOrError").makeError("reply_media_type_unknown");a=l(a);var e=a.replyMediaPreviewHeight;a=a.replyMediaPreviewWidth;return d("WAResultOrError").makeResult({replyMediaId:b,replyMediaPreviewHeight:e,replyMediaPreviewWidth:a,replyMediaUrlMimeType:c.mimetype})}).then(function(a){if(a.success!==!0){d("WALogger").ERROR(i(),b,a.error);return}return a.value})}function o(a,b){var c=b.defaultPreviewMediaId;return c==null?d("MAWDexieTable").dexieResolve({replyXMAId:b.xmaId}):j(a,c).then(function(a){var c=a[0];a=a[1];if(c==null||a==null)return d("WAResultOrError").makeError("reply_xma_media_not_found");if(!k.has(a.mediaType))return d("WAResultOrError").makeError("reply_xma_media_type_unknown");a=l(a);var e=a.replyMediaPreviewHeight;a=a.replyMediaPreviewWidth;return d("WAResultOrError").makeResult({replyMediaPreviewHeight:e,replyMediaPreviewWidth:a,replyMediaUrlMimeType:c.mimetype,replyXMAId:b.xmaId})}).then(function(a){if(a.success!==!0){d("WALogger").ERROR(h(),b.xmaId,a.error);return}return a.value})}function a(a,b){var c,e;c=((c=b.quote)==null?void 0:c.content)||{};var f=c.author,g=c.externalId,h=c.mediaId;c=c.xmaMessageType;if(((e=b.quote)==null?void 0:e.content)==null||!m((e=b.quote)==null?void 0:e.content))return d("MAWDexieTable").dexieResolve();e=b.threadJid;b=f===d("MAWGlobals").getMyUserJid();b=b?d("WAJids").AUTHOR_ME:f;return d("MAWXMAUtils").isXMAShare(c)?p(a,d("MAWJidUtils").maybeToProtocolMsgId(b,e,g)):n(a,h)}function p(a,b){return b==null?d("MAWDexieTable").dexieResolve():d("MAWDbXMATxns").maybeGetXMAFromProtocolMsgId(a,b).then(function(b){if(b==null||d("MAWXMAUtils").isXMAExpired(b.isTombstoned,b.targetExpiringAtSec))return;return o(a,b)})}function b(a,b){var c=b.author,e=b.externalId,f=b.mediaId,g=b.threadJid,h=b.xmaMessageType;h=d("MAWXMAUtils").isXMAShare(h);return!d("MAWDbMsg").isMediaMsg(b)&&!h?d("MAWDexieTable").dexieResolve():h?p(a,d("MAWJidUtils").maybeToProtocolMsgId(c,g,e)):n(a,f)}g.isMediaReplyContent=m;g.getReplyMediaForMsgQuote=a;g.getReplyMediaForMsg=b}),98);
__d("WAMsgMap",[],(function(a,b,c,d,e,f){a=function(){function a(a){var b=this;this.$1=new Map();a==null?void 0:a.forEach(function(a){var c=a[0];a=a[1];b.set(c,a)})}var b=a.prototype;b.clear=function(){this.$1.clear()};b["delete"]=function(a){var b;(b=this.$1.get(a.externalId))==null?void 0:(b=b.get(a.author))==null?void 0:b["delete"](a.chat)};b.get=function(a){var b;return(b=this.$1.get(a.externalId))==null?void 0:(b=b.get(a.author))==null?void 0:b.get(a.chat)};b.has=function(a){var b;return(b=(b=this.$1.get(a.externalId))==null?void 0:(b=b.get(a.author))==null?void 0:b.has(a.chat))!=null?b:!1};b.set=function(a,b){var c,d;c=(c=this.$1.get(a.externalId))!=null?c:new Map();this.$1.has(a.externalId)||this.$1.set(a.externalId,c);d=(d=c.get(a.author))!=null?d:new Map();c.has(a.author)||c.set(a.author,d);d.set(a.chat,b);return this};b.keys=function(){var a=[],b=this.$1;for(var c=b.keys(),d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f,g;if(d){if(e>=c.length)break;g=c[e++]}else{e=c.next();if(e.done)break;g=e.value}g=g;f=(f=b.get(g))!=null?f:new Map();for(var h=f.keys(),i=Array.isArray(h),j=0,h=i?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var k,l;if(i){if(j>=h.length)break;l=h[j++]}else{j=h.next();if(j.done)break;l=j.value}l=l;k=(k=f.get(l))!=null?k:new Map();for(var k=k.keys(),m=Array.isArray(k),n=0,k=m?k:k[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var o;if(m){if(n>=k.length)break;o=k[n++]}else{n=k.next();if(n.done)break;o=n.value}o=o;a.push({externalId:g,author:l,chat:o})}}}return a};b.entries=function(){var a=[],b=this.$1;for(var c=b.keys(),d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f,g;if(d){if(e>=c.length)break;g=c[e++]}else{e=c.next();if(e.done)break;g=e.value}g=g;f=(f=b.get(g))!=null?f:new Map();for(var h=f.keys(),i=Array.isArray(h),j=0,h=i?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var k,l;if(i){if(j>=h.length)break;l=h[j++]}else{j=h.next();if(j.done)break;l=j.value}l=l;k=(k=f.get(l))!=null?k:new Map();for(var m=k.keys(),n=Array.isArray(m),o=0,m=n?m:m[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var p;if(n){if(o>=m.length)break;p=m[o++]}else{o=m.next();if(o.done)break;p=o.value}p=p;var q=k.get(p);q!=null&&a.push([{externalId:g,author:l,chat:p},q])}}}return a};b.values=function(){return this.entries().map(function(a){return a[1]})};return a}();f.MsgMap=a}),66);
__d("MAWDbMsgUtil",["WAJids","WALogger","WAMsgMap"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Invalid author when converting msg array to map"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Missing jid prevents adding message to array map"]);i=function(){return a};return a}function a(a){return a.reduce(function(a,b){var c=b.threadJid;if(c==null){d("WALogger").ERROR(i());return a}if(b.author==="@system"){d("WALogger").ERROR(h());return a}a.set({author:b.author,chat:c,externalId:b.externalId},b);return a},new(d("WAMsgMap").MsgMap)())}function b(a){return d("WAJids").isAuthorSystem(a.author)||a.threadJid==null?null:{author:a.author,chat:a.threadJid,externalId:a.externalId}}g.convertMsgArrayToMap=a;g.getProtocolMsgIdFromDbMsg=b}),98);
__d("MAWDbUnrenderedMsgTxns",["MAWAckLevel","MAWDbMsg","MAWDbMsgUtil","MAWDexieTable","WAJids","WALogger","WAMsgMap","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["bulkUpdateSystemAck on sent message"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["bulkUpdateSystemAck on incoming message"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["updateSystemAckForUnrenderedMsg on non existing message"]);j=function(){return a};return a}function a(a,b){var c=b.author,e=b.chat,f=b.externalId;return a.threads.get({jid:e}).then(function(b){return b==null?d("WAResultOrError").makeError("missing_thread_unrendered_msg"):k(a,f,b.chatId,c).then(function(a){return a==null?d("WAResultOrError").makeError("missing_unrendered_msg"):d("WAResultOrError").makeResult(a)})})}function b(a,b){var c=b.map(function(a){a=a.externalId;return a});return a.unrenderedMessages.where("externalId").anyOf(c).toArray().then(function(a){var c=d("MAWDbMsgUtil").convertMsgArrayToMap(a),e=new(d("WAMsgMap").MsgMap)();b.forEach(function(a){var b=c.get(a);b!=null&&e.set(a,b)});return e})}function k(a,b,c,d){return a.unrenderedMessages.where("externalId").equals(b).filter(function(a){return a.author===d&&a.thread===c}).first()}function l(a,b){return a+"_"+b}function c(a,b){var c=b.map(function(a){a=a.externalId;return a}),e=Array.from(new Set(b.map(function(a){return a.chat})));return d("MAWDexieTable").dexieAll([a.threads.where("jid").anyOf(e).toArray(),a.unrenderedMessages.where("externalId").anyOf(c).toArray()]).then(function(a){var c=a[0];a=a[1];if(a.length===0||c.length===0)return{msgs:[],threadIdToJid:new Map()};var d=new Map();c.forEach(function(a){return d.set(a.chatId,a.jid)});var e=new Map();b.forEach(function(a){var b=a.author,c=a.chat;a=a.externalId;var d=e.get(a)||new Set();d.add(l(b,c));e.set(a,d)});return{msgs:a.filter(function(a){var b=a.author,c=a.externalId;a=a.thread;a=d.get(a);c=e.get(c);return c!=null&&a!=null&&c.has(l(b,a))}),threadIdToJid:d}})}function e(a,b,c){return m(a,[{ack:c,msgId:b}]).then(function(a){a=a[0];if(a==null){d("WALogger").LOG(j());return null}return a})}function m(a,b){var c=b.map(function(a){return a.msgId}),e=new Map();b.forEach(function(a){return e.set(a.msgId,{ack:a.ack})});return a.unrenderedMessages.where("msgId").anyOf(c).toArray().then(function(b){if(b.length===0)return b;var c=[],f=[];b.forEach(function(a){var b;if(a.author!==d("WAJids").AUTHOR_ME){d("WALogger").ERROR(i());c.push(a);return}if(a.ack>d("MAWAckLevel").ACK.clock){d("WALogger").LOG(h());c.push(a);return}b=(b=e.get(a.msgId))==null?void 0:b.ack;if(b==null)return null;a=babelHelpers["extends"]({},a,{ack:b});b===d("MAWAckLevel").ACK.sent&&delete a.resendCount;f.push(a)});return a.unrenderedMessages.bulkPut(f).then(function(){return[].concat(f,c)})})}function f(a,b){b=b.map(function(b){return a.unrenderedMessages.get({msgId:b})});return d("MAWDexieTable").dexieAll(b)}function n(a,b){return a.unrenderedMessages.where("msgId").between(d("MAWDbMsg").msgIdsInChatLowerBound(b.chatId),d("MAWDbMsg").msgIdsInChatUpperBound(b.chatId)).last().then(function(a){a=a==null?0:d("MAWDbMsg").getInChatMsgIdFromMsgId(a.msgId);return a+1})}g.maybeGetUnrenderedMsgByProtocolMsgId=a;g.getUnrenderedMsgMapByProtocolMsgId=b;g.maybeGetUnrenderedMsgByExternalId=k;g.getUnrenderedMsgsByProtocolMsgId=c;g.updateSystemAckForUnrenderedMsg=e;g.bulkUpdateSystemAckForUnrenderedMsgs=m;g.getUnrenderedMsgsByMsgIds=f;g.getNextUnrenderedMsgIdNumberForThread=n}),98);
__d("MAWDbThreadTxns",["MAWBridgeTypesCreators","MAWDexieTable","MAWFolderTypes","MAWIndexedDb","WAArrayZip","WALogger","WAResultOrError","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["markCutoverThreadAsNotMigratedLocally failed because thread is already unmigrated"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["markThreadAsMigratedLocally failed because thread is already migrated"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["markThreadAsMigratedLocally failed to get the thread"]);j=function(){return a};return a}function a(a,b){return a.threads.get(b).then(function(a){return a==null?d("WAResultOrError").makeError("missing"):d("WAResultOrError").makeResult(a)})}function b(a,b){return a.threads.get({deduplicationKey:b}).then(function(a){return a==null?d("WAResultOrError").makeError("missing"):d("WAResultOrError").makeResult(a)})}function k(a,b){return a.threads.get({jid:b}).then(function(a){return a==null?d("WAResultOrError").makeError("missing"):d("WAResultOrError").makeResult(a)})}function c(a,b){return a.threads.where("jid").anyOf(b).toArray()}function e(a,b){return a.threads.where("jid").startsWith(b+"@").first().then(function(a){return a==null?d("WAResultOrError").makeError("missing"):d("WAResultOrError").makeResult(a)})}function f(a,b){return d("MAWDexieTable").dexieAll([a.threads["delete"](b),a.participants.where("threadId").equals(b)["delete"]()]).then(function(){})}function l(a,b){return a.participants.where("userJid").equals(b).toArray().then(function(b){b=b.map(function(a){return a.threadId});return a.threads.bulkGet(b).then(function(a){return a.filter(Boolean)})})}function m(a,b){return a.participants.where("userJid").anyOf(b).toArray().then(function(b){var c=new Map();b.forEach(function(a){var b;c.has(a.userJid)||c.set(a.userJid,[]);(b=c.get(a.userJid))==null?void 0:b.push(a.threadId)});b=Array.from(c.values()).reduce(function(a,b){return a.concat(b)},[]);b=Array.from(new Set(b));return a.threads.bulkGet(b).then(function(a){return a.reduce(function(a,b){b!=null&&b.chatId!=null&&a.set(b.chatId,b);return a},new Map())}).then(function(a){return new Map(Array.from(c.entries()).map(function(b){var c=b[0];b=b[1];return[c,b.map(function(b){return a.get(b)}).filter(Boolean)]}))})})}function n(a,b){return a.threads.get(b.thread).then(function(a){return a==null||a.lastReadMsgReceiptSent==null?!1:b.msgId<=a.lastReadMsgReceiptSent})}function o(a,b){var c=b.map(function(a){return a.thread});return a.threads.bulkGet(c).then(function(a){return d("WAArrayZip").zip(b,a).map(function(a){var b=a[0];a=a[1];return a==null||a.lastReadMsgReceiptSent==null?!1:b.msgId<=a.lastReadMsgReceiptSent})})}function p(a,b,c){return a.threads.bulkGet(b).then(function(b){var e=b.filter(Boolean).map(function(a){return babelHelpers["extends"]({},a,{archived:!0,cannotReplyReason:c?"viewer_not_subscribed":a.cannotReplyReason,folder:d("MAWFolderTypes").FOLDER_ID.ARCHIVED})});return a.threads.bulkPut(e).then(function(){e.forEach(function(a){c&&d("WALogger").LOG(["[Occamadillo] Leaving a group thread\n          "+a.jid.toString()+", showing a VIEWER_NOT_SUBSCRIBED composer blocker"]),d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({cannotReplyReason:a.cannotReplyReason,chatJid:a.jid,folder:d("MAWFolderTypes").FOLDER_ID.ARCHIVED,threadId:a.chatId})})})})})}function q(a,b){return a.threads.bulkGet(b).then(function(c){var b=c.filter(Boolean).map(function(a){return babelHelpers["extends"]({},a,{cannotReplyReason:null})});return a.threads.bulkPut(b).then(function(){b.forEach(function(a){a={cannotReplyReason:null,chatJid:a.jid,threadId:a.chatId};d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread(a)})})})})}function r(a,b){return a.threads.bulkGet(b).then(function(b){var c=b.filter(Boolean).map(function(a){return babelHelpers["extends"]({},a,{archived:!1,cannotReplyReason:a.cannotReplyReason==="viewer_not_subscribed"?a.cannotReplyReason:null,folder:d("MAWFolderTypes").FOLDER_ID.INBOX})});return a.threads.bulkPut(c).then(function(){c.forEach(function(a){d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({cannotReplyReason:a.cannotReplyReason,chatJid:a.jid,folder:d("MAWFolderTypes").FOLDER_ID.INBOX,threadId:a.chatId})})})})})}function s(a,b){return a.threads.bulkGet(b)}function t(a,b){return a.threads.bulkGet(b).then(function(b){var c=b.filter(Boolean).map(function(a){return babelHelpers["extends"]({},a,{cannotReplyReason:"viewer_not_subscribed"})});return a.threads.bulkPut(c).then(function(){c.forEach(function(a){var b={cannotReplyReason:"viewer_not_subscribed",chatJid:a.jid,threadId:a.chatId};d("WALogger").LOG(["[Occamadillo] User is unsubscribed from thread\n          "+a.jid.toString()+", showing a VIEWER_NOT_SUBSCRIBED composer blocker"]);d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread(b)})})})})}function u(a,b){return k(a,b).then(function(b){if(!b.success){d("WALogger").WARN(j());return}b=b.value;if(b.isMigratedLocally===!0){d("WALogger").WARN(i());return}b=babelHelpers["extends"]({},b,{isMigratedLocally:!0});return a.threads.put(b).then(function(){})})}function v(a,b){if(b.isMigratedLocally===!1){d("WALogger").WARN(h());return d("MAWDexieTable").dexieResolve(b)}var c=babelHelpers["extends"]({},b,{isMigratedLocally:!1});return a.threads.put(c).then(function(){return c})}function w(a,b){return a.threads.put(b).then(function(){})}function x(a,b,c,e,f,g){c=c===(e==null?void 0:e.msgId);f=f===(g==null?void 0:g.msgId);return c&&f?d("MAWDexieTable").dexieResolve():a.threads.update(b.chatId,{newestMsg:g==null?void 0:g.msgId,newestMsgTs:f?b.newestMsgTs:(g==null?void 0:g.ts)==null?null:d("WATimeUtils").castUnixTimeToMillisTime(g.ts),oldestMsg:e==null?void 0:e.msgId})}g.getThread=a;g.getThreadByDeduplicationKey=b;g.getThreadByJid=k;g.getThreadsByJids=c;g.getThreadByJidPrimaryId=e;g.deleteThreadRow=f;g.getAllThreadsForUser=l;g.getAllThreadsForUsers=m;g.needsRetroactiveReadReceiptInThread=n;g.bulkNeedsRetroactiveReadReceiptInThread=o;g.archiveThreads=p;g.subscribeToThreads=q;g.unarchiveThreads=r;g.getThreads=s;g.unsubscribeFromThreads=t;g.markCutoverThreadAsMigratedLocally=u;g.markCutoverThreadAsNotMigratedLocally=v;g.updateThread=w;g.updateThreadMsgsForUndefinedOldestOrNewestMsgs=x}),98);
__d("MAWUpdateThreadMsgMetadataApi",["MAWDbThreadTxns","MAWDexieTable","MAWIndexedDb","MAWTransactionMode","WALogger","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["updated oldestMsg from id "," to id "," when oldestMsg is undefined"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["updated newestMsg from id "," to id ",", and newestMsgTs from "," to "," when newestMsg is undefined"]);i=function(){return a};return a}a=d("MAWIndexedDb").makeMsgrTransactor({threads:d("MAWTransactionMode").READWRITE},"updateThreadMsgMetadataApiTransactor",function(a){return function(b,c,e,f,g){var j=c===(e==null?void 0:e.msgId),k=f===(g==null?void 0:g.msgId);if(j&&k)return d("MAWDexieTable").dexieResolve();k||d("WALogger").ERROR(i(),f,g==null?void 0:g.msgId,b.newestMsgTs,(g==null?void 0:g.ts)==null?null:d("WATimeUtils").castUnixTimeToMillisTime(g.ts));j||d("WALogger").ERROR(h(),c,e==null?void 0:e.msgId);return d("MAWDbThreadTxns").updateThreadMsgsForUndefinedOldestOrNewestMsgs(a,b,c,e,f,g).then(function(){})}});b=a;g["default"]=b}),98);
__d("MAWDbMsgTxns",["MAWAckLevel","MAWBridgeMsg","MAWDbMsg","MAWDbMsgUtil","MAWDbUnrenderedMsgTxns","MAWDbXMATxns","MAWDexieTable","MAWIndexedDb","MAWJidUtils","MAWLoadReplyMediaTxns","MAWMsgType","MAWUpdateThreadMsgMetadataApi","ODS","Random","WAJids","WALogger","WAMsgMap","WAResultOrError","WATimeUtils","err","gkx","justknobx","nullthrows","promiseDone","qex"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Invalid sortOrder in getMsgRangeWithOffsetUsingSortOrder. Oldest sortMs: ","(msgType=","), Offset: ","(msgType=","), newest: ","(msgType=",")"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Successfull deleted "," messages"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["updateMediaId on message "," that already has this mediaId ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Replacing mediaId for message with pre-existing media. mediaCreationStatus="," caller="," type=",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["updateMediaId on message "," that already has this mediaId ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["getFutureproofMsg gets a message "," with unsupported type ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Inconsistent getMsgsFromOffset return between legacy and v2. Reason: ",".\n            Thread chatId: ",", jid: ",".\n            Legacy result length: ",", V2 result length: ",".\n            Legacy result first sortOrderMs: ",".\n            Legacy result last sortOrderMs: ",".\n            V2 result first sortOrderMs: ",".\n            V2 result last sortOrderMs: ",".\n            Input params: offsetMsgId: ",", numMsgs: ",", includeOffset: ",", includeExpired: ",", direction: ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["getMsgsFromOffsetV2 newest msg thread jid is not equal to thread jid.\n            msg.threadJid: ",",\n            msg.thread: ",",\n            thread.jid: ",",\n            thread.chatId: ",",\n            threadId: ",",\n            offsetMsgId: ","."]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["Invalid sortOrder in getMsgsFromOffset. Offset msg sortOrderMs out of bound - oldest: ","(msgType=","), offset: ","(msgType=","), newest: ","(msgType=","). Thread chatId: ","."]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["Invalid sortOrder in getMsgsFromOffset. Some msg has null sortOrderMs - oldest: ","(msgType=","), offset: ","(msgType=","), newest: ","(msgType=","). Thread chatId: ","."]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["Invalid sortOrder in getMsgsFromOffset. Some msg is null - oldest: ",", newest: ",", offset: ",". Thread chatId: ","."]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["maybeUpdateThreadMsgsForUndefinedOldestOrNewestMsgs fixes an incorrect newest/oldest values:\n    thread id: ",", thread jid: ",", oldestMsgId: ",", newestMsgId: ",",\n    validOldestMsg: ",", validNewestMsg: ",""]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["bulkUpdateSystemAck on sent message"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["bulkUpdateSystemAck on incoming message"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["updateSystemAck on non existing message"]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose(["[maybeGetMsgByExternalId] Found "," messages with external id ",""]);x=function(){return a};return a}function y(){var a=babelHelpers.taggedTemplateLiteralLoose(["[maybeGetMsgByProtocolMsgId] Can't have "," messages with the same protocolMsgId!"]);y=function(){return a};return a}function a(a,b){return b==null?d("MAWDexieTable").dexieResolve():a.messages.get({msgId:b})}function z(a,b){return a.messages.where("[thread+sortOrderMs]").between([b,Number.MIN_SAFE_INTEGER],[b,Number.MAX_SAFE_INTEGER],!1,!1).last()}function b(a,b,c){return a.messages.where("[thread+sortOrderMs]").between([b,Number.MIN_SAFE_INTEGER],[b,Number.MAX_SAFE_INTEGER],!1,!1).reverse().limit(c).toArray()}function A(a,b){return a.messages.where("[thread+sortOrderMs]").between([b,Number.MIN_SAFE_INTEGER],[b,Number.MAX_SAFE_INTEGER],!1,!1).first()}function e(a,b){return a.messages.where("[thread+serverTs]").between([b,Number.MIN_SAFE_INTEGER],[b,Number.MAX_SAFE_INTEGER],!1,!1).last()}function f(a,b,c){return a.messages.where("[thread+serverTs]").between([b,Number.MIN_SAFE_INTEGER],[b,Number.MAX_SAFE_INTEGER],!1,!1).reverse().limit(c).toArray()}function B(a,b){return a.messages.where("externalId").equals(b.externalId).filter(function(a){return a.author===b.author&&a.threadJid===b.chat}).toArray().then(function(a){a.length>1&&d("WALogger").ERROR(y(),a.length);return a[0]})}function C(a,b){return a.messages.where("msgId").equals(b).toArray()}function D(a,b){return F(a,b).then(function(a){return a.success?a:a})}function E(a,b){var c=b.map(function(a){a=a.externalId;return a});return a.messages.where("externalId").anyOf(c).toArray().then(function(a){var c=d("MAWDbMsgUtil").convertMsgArrayToMap(a),e=new(d("WAMsgMap").MsgMap)();b.forEach(function(a){var b=c.get(a);b!=null&&e.set(a,b)});return e})}function F(a,b){var c=b.author,e=b.chat,f=b.externalId;return a.threads.get({jid:e}).then(function(b){return b==null?d("WAResultOrError").makeError("missing_thread_msg"):H(a,f,b.chatId,c).then(function(a){return a==null?d("WAResultOrError").makeError("missing_msg"):d("WAResultOrError").makeResult(a)})})}function G(a,b){var c=b.author,d=b.chat,e=b.externalId;return a.threads.get({jid:d}).then(function(b){if(b==null)return;return a.messages.where("revokedExternalId").equals(e).filter(function(a){return a.author===c&&a.thread===b.chatId&&a.type==="Revoked"}).first()})}function H(a,b,c,e){return a.messages.where("externalId").equals(b).filter(function(a){return a.author===e&&a.thread===c}).toArray().then(function(a){a.length>1&&d("WALogger").ERROR(x(),a.length,b);return a[0]})}function I(a,b,c,e){var f=a.messages.where("revokedExternalId").equals(b).filter(function(a){return a.author===e&&a.thread===c&&a.type===d("MAWMsgType").MSG_TYPE.REVOKED}).first();a=d("MAWDbUnrenderedMsgTxns").maybeGetUnrenderedMsgByExternalId(a,b,c,e).then(function(a){if((a==null?void 0:a.type)===d("MAWMsgType").MSG_TYPE.DELETE_FOR_ME)return a});return d("MAWDexieTable").dexieAll([f,a]).then(function(a){var b=a[0];a=a[1];return b!=null||a!=null})}function J(a,b){return a+"_"+b}function K(a,b){var c=b.map(function(a){return a.externalId});return d("MAWDexieTable").dexieAll([a.threads.where("jid").anyOf(Array.from(new Set(b.map(function(a){return a.chat})))).toArray(),a.messages.where("externalId").anyOf(c).toArray()]).then(function(a){var c=a[0];a=a[1];if(a.length===0||c.length===0)return{msgs:[],threadIdToJid:new Map()};var d=new Map(),e=new Map();c.forEach(function(a){return d.set(a.chatId,a.jid)});b.forEach(function(a){var b=a.author,c=a.chat;a=a.externalId;var d=e.get(a)||new Set();d.add(J(b,c));e.set(a,d)});return{msgs:a.filter(function(a){var b=a.author,c=a.externalId;a=a.threadJid;c=e.get(c);return c!=null&&a!=null&&c.has(J(b,a))}),threadIdToJid:d}})}function L(a,b,c,e,f){return M(a,[{ack:c,msgId:b,reportingMeta:f,serverTs:e}]).then(function(a){a=a.find(function(a){return a.msgId===b});if(a==null){d("WALogger").LOG(w());return null}return a})}function M(a,b){var c=b.map(function(a){return a.msgId});return d("MAWDbXMATxns").getXMAMsgIdsFromAssociatedMsgIds(a,c).then(function(e){var f=new Map();b.forEach(function(a){f.set(a.msgId,{ack:a.ack,reportingMeta:a.reportingMeta,serverTs:a.serverTs});var b=e.get(a.msgId);b!=null&&f.set(b,{ack:a.ack,reportingMeta:a.reportingMeta,serverTs:a.serverTs})});var g=Array.from(new Set(c.concat(Array.from(e.values()))));return a.messages.where("msgId").anyOf(g).toArray().then(function(b){if(b.length===0)return b;var c=[],e=[];b.forEach(function(a){var b,g;if(a.author!==d("WAJids").AUTHOR_ME){d("WALogger").ERROR(v());c.push(a);return}if(a.ack>d("MAWAckLevel").ACK.clock){d("WALogger").LOG(u());c.push(a);return}b=(b=f.get(a.msgId))==null?void 0:b.ack;g=(g=f.get(a.msgId))==null?void 0:g.serverTs;if(b==null)return null;var h=babelHelpers["extends"]({},a,{ack:b});g!=null&&(h.serverTs=g);a=(g=f.get(a.msgId))==null?void 0:g.reportingMeta;a!=null&&(h.reportingMeta=a);b===d("MAWAckLevel").ACK.sent&&delete h.resendCount;e.push(h)});return a.messages.bulkPut(e).then(function(){return d("MAWDexieTable").dexieAll(e.map(function(b){return d("MAWLoadReplyMediaTxns").getReplyMediaForMsgQuote(a,b)}))}).then(function(a){e.forEach(function(b,c){d("MAWIndexedDb").afterTransaction({tag:"MsgUpdated",value:d("MAWBridgeMsg").createBridgeMsg(b,void 0,a[c])})});return[].concat(e,c)})})})}function N(a,b,c){return a.threads.get(b).then(function(e){if(e==null||e.oldestMsg!==c&&e.newestMsg!==c)return;return d("MAWDexieTable").dexieAll([a.messages.where("msgId").above(c).first(),a.messages.where("msgId").below(c).last()]).then(function(f){var g=f[0];f=f[1];return a.threads.update(b,{newestMsg:e.newestMsg===c?f==null?void 0:f.msgId:e.newestMsg,newestMsgTs:e.newestMsg===c?(f==null?void 0:f.ts)==null?null:d("WATimeUtils").castUnixTimeToMillisTime(f.ts):e.newestMsgTs,oldestMsg:e.oldestMsg===c?g==null?void 0:g.msgId:e.oldestMsg}).then(function(){})})})}function O(a,b,e,f,g){if(b===(e==null?void 0:e.msgId)&&f===(g==null?void 0:g.msgId))return d("MAWDexieTable").dexieResolve();d("WALogger").ERROR(t(),a.chatId,a.jid,b,f,e==null?void 0:e.msgId,g==null?void 0:g.msgId);d("MAWIndexedDb").afterTransactionEffect(function(){c("promiseDone")(c("MAWUpdateThreadMsgMetadataApi")(a,b,e,f,g))})}function P(a,b,c,e){var f;if(b==null||c==null||e==null){d("WALogger").ERROR(s(),b==null,c==null,e==null,a);return{hasMoreAfter:!1,hasMoreBefore:!1,msgs:[]}}if(c.sortOrderMs==null||e.sortOrderMs==null){d("WALogger").ERROR(r(),b==null?void 0:b.sortOrderMs,b==null?void 0:b.type,e==null?void 0:e.sortOrderMs,e==null?void 0:e.type,c==null?void 0:c.sortOrderMs,c==null?void 0:c.type,a);return{hasMoreAfter:!1,hasMoreBefore:!1,msgs:[]}}if(e.sortOrderMs>c.sortOrderMs||e.sortOrderMs<((f=b.sortOrderMs)!=null?f:0)){d("WALogger").ERROR(q(),b==null?void 0:b.sortOrderMs,b==null?void 0:b.type,e==null?void 0:e.sortOrderMs,e==null?void 0:e.type,c==null?void 0:c.sortOrderMs,c==null?void 0:c.type,a);return{hasMoreAfter:!1,hasMoreBefore:!1,msgs:[]}}}function Q(a,b,e,f,g,h,i){g===void 0&&(g=!1);h===void 0&&(h=!1);i===void 0&&(i="before");return f===0||e==null?d("MAWDexieTable").dexieResolve({hasMoreAfter:!1,hasMoreBefore:!1,msgs:[],threadJid:null}):d("MAWDexieTable").dexieAll([a.threads.get(b),a.messages.get({msgId:e})]).then(function(j){var k=j[0],l=j[1],m=k==null?void 0:k.oldestMsg,n=k==null?void 0:k.newestMsg;if(k==null||m==null||n==null||l==null)return{hasMoreAfter:!1,hasMoreBefore:!1,msgs:[],threadJid:null};var o=h?function(a){return!0}:function(a){return a.messageExpirationTs==null||a.messageExpirationTs>d("WATimeUtils").unixTime()};j=d("MAWDexieTable").dexieResolve([]);f===1&&g&&(j=a.messages.get({msgId:e}).then(function(a){return a!=null?[a].filter(o):[]}));return j.then(function(h){h=h.length>0?d("MAWDexieTable").dexieResolve(h):ga(a,k.chatId,l,g,f,o,i);var j=c("gkx")("6884");return d("MAWDexieTable").dexieAll([h,z(a,k.chatId),A(a,k.chatId)]).then(function(a){var c=a[0],g=a[1];a=a[2];O(k,m,a,n,g);if(c.length===0)return{hasMoreAfter:!1,hasMoreBefore:!1,msgs:[],threadJid:k.jid};var h=c[c.length-1],i=c[0];h=j?h.msgId!==(a==null?void 0:a.msgId):h.msgId!==(a==null?void 0:a.msgId)&&c.length===f;a=j?i.msgId!==(g==null?void 0:g.msgId):!1;i.threadJid!==k.jid&&d("WALogger").ERROR(p(),i.threadJid,i.thread,k.jid,k.chatId,b,e);return{hasMoreAfter:a,hasMoreBefore:h,msgs:c,threadJid:k.jid}})})})}function R(a,b,e,f,g,i,j){g===void 0&&(g=!1);i===void 0&&(i=!1);j===void 0&&(j="before");if(c("qex")._("546")===!0){var k=d("Random").coinflip(c("justknobx")._("1707"));return d("MAWDexieTable").dexieAll([Q(a,b,e,f,g,i,j),k?S(a,b,e,f,g,i,j):d("MAWDexieTable").dexieResolve(null)]).then(function(a){var c=a[0],k=a[1];if(k!=null){a=c.hasMoreAfter===k.hasMoreAfter&&c.hasMoreBefore===k.hasMoreBefore&&c.msgs.length===k.msgs.length&&c.msgs.every(function(a,b){b=k.msgs[b];return a.msgId===b.msgId});(h||(h=d("ODS"))).bumpEntityKey(3185,"armadillo_get_msgs_from_offset_v2",a?"consistent":"inconsistent");if(!a){a=c.hasMoreAfter!==k.hasMoreAfter?"inconsistent_hasMoreAfter":c.hasMoreBefore!==k.hasMoreBefore?"inconsistent_hasMoreBefore":c.msgs.length>k.msgs.length?"inconsistent_v2LengthGreater":c.msgs.length<k.msgs.length?"inconsistent_legacyLengthGreater":"inconsistent_other";(h||(h=d("ODS"))).bumpEntityKey(3185,"armadillo_get_msgs_from_offset_v2",a);d("WALogger").ERROR(o(),a,b,c.threadJid,k.msgs.length,c.msgs.length,(a=k.msgs[0])==null?void 0:a.sortOrderMs,(a=k.msgs[k.msgs.length-1])==null?void 0:a.sortOrderMs,(a=c.msgs[0])==null?void 0:a.sortOrderMs,(a=c.msgs[c.msgs.length-1])==null?void 0:a.sortOrderMs,e,f,g,i,j)}}return{hasMoreAfter:c.hasMoreAfter,hasMoreBefore:c.hasMoreBefore,msgs:c.msgs}})}return S(a,b,e,f,g,i,j)}function S(a,b,e,f,g,h,i){g===void 0&&(g=!1);h===void 0&&(h=!1);i===void 0&&(i="before");return f===0?d("MAWDexieTable").dexieResolve({hasMoreAfter:!1,hasMoreBefore:!1,msgs:[]}):a.threads.get(b).then(function(b){var j=b==null?void 0:b.oldestMsg,k=b==null?void 0:b.newestMsg;return b==null||j==null||k==null||e==null?{hasMoreAfter:!1,hasMoreBefore:!1,msgs:[]}:d("MAWDexieTable").dexieAll([a.messages.where("msgId").aboveOrEqual(j).first(),a.messages.where("msgId").belowOrEqual(k).last(),a.messages.get({msgId:e})]).then(function(e){var l=e[0],m=e[1];e=e[2];var n=(e=e)!=null?e:m,o=l==null?void 0:l.msgId;e=n==null?void 0:n.msgId;var p=m==null?void 0:m.msgId,q=d("WATimeUtils").unixTime();O(b,j,l,k,m);var r=P(b.chatId,l,m,n);if(r!=null)return r;r=d("MAWDexieTable").dexieResolve([]);var s=h?function(a){return!0}:function(a){return a.messageExpirationTs==null||a.messageExpirationTs>q};f===1&&g&&(r=a.messages.get({msgId:e}).then(function(a){return a!=null?[a].filter(s):[]}));return r.then(function(e){e=e.length>0?d("MAWDexieTable").dexieResolve(e):ha(a,b.chatId,c("nullthrows")(l),c("nullthrows")(m),c("nullthrows")(n),g,f,s,i);return e.then(function(a){if(a.length===0)return{hasMoreAfter:!1,hasMoreBefore:!1,msgs:[]};var b=a[a.length-1],d=a[0];b=c("gkx")("6884")?b.msgId!==o:b.msgId!==o&&a.length===f;d=c("gkx")("6884")?d.msgId!==p:!1;return{hasMoreAfter:d,hasMoreBefore:b,msgs:a}})})})})}function T(a){return a.messages.where("altIndex").equals(d("MAWDbMsg").FUTUREPROOF_ALT_INDEX).toArray().then(function(a){var b=[];a.forEach(function(a){if(a.type!==d("MAWMsgType").MSG_TYPE.FUTUREPROOF){d("WALogger").ERROR(n(),a.msgId,a.type);return}b.push(a)});return b})}function U(a){return a.toString()}function V(a,b,c,e,f){var g=b.mediaId;if(g===c){d("WALogger").LOG(m(),b.msgId,c);return d("MAWDexieTable").dexieResolve()}g=g!=null?a.media.get(g):d("MAWDexieTable").dexieResolve();return g.then(function(g){g&&d("WALogger").ERROR(l(),e,f,b.type);g=babelHelpers["extends"]({},b,{mediaId:c});return a.messages.put(g).then(function(){})})}function W(a,b){var e=Array.from(b.keys());return a.messages.where("msgId").anyOf(e).toArray().then(function(e){var f=[];e.map(function(a){var e=b.get(a.msgId),g=a.mediaId;if(g!=null&&g!==e){if(e!=null)throw c("err")("mediaId "+U(g)+" in message "+a.msgId+" is different with the "+U(e)+" in bulkUpdateMediaId");d("WALogger").LOG(k(),a.msgId,e);return}g=babelHelpers["extends"]({},a,{mediaId:e});f.push(g)});return a.messages.bulkPut(f).then(function(){})})}function X(a,b){return Y(a,[b]).then(function(){})}function Y(a,b){return a.messages.where("msgId").anyOf(b).toArray().then(function(b){var c=b.map(function(a){return babelHelpers["extends"]({},a,{isExpiredXmaMsg:!0})});return a.messages.bulkPut(c).then(function(){return c})})}function aa(a,b,c){return b>c?d("MAWDexieTable").dexieResolve():a.messages.where("msgId").between(b,c,!0,!0).toArray().then(function(a){var b;a.forEach(function(a){var c=b||0;b=a.ts>c?a.ts:b});return b})}function Z(a,b,c,e){if(e!=null&&e<=0)return d("MAWDexieTable").dexieResolve([]);a=a.messages.where("altIndex").equals(d("MAWDbMsg").craftToBeReadAltIndex(b)).filter(function(a){return a.msgId<=c});e!=null&&(a=a.limit(e));return a.toArray()}function ba(a,b,c){return Z(a,b,c).then(function(b){var c=b.map(function(a){return babelHelpers["extends"]({},a,{altIndex:null})});return a.messages.bulkPut(c).then(function(){return c})})}function ca(a,b){return a.messages["delete"](b)}function da(a,b,c){var e=b.map(function(a){return a.rowId});b=c!=null?b.map(function(a){a=d("MAWJidUtils").toProtocolMsgId(a);if(!a)return;return babelHelpers["extends"]({},a,{reason:c})}).filter(Boolean):[];return d("MAWDexieTable").dexieAll([a.deletedMessages.bulkAdd(b),a.messages.bulkDelete(e)]).then(function(a){a[0];a=a[1];d("WALogger").LOG(j(),a)})}function ea(a,b){return a.messages.where("msgId").anyOf(b).toArray()}function fa(a){return a.messages.where("altIndex").anyOf([d("MAWDbMsg").SPAM_ALT_INDEX,d("MAWDbMsg").FUTUREPROOF_SPAM_ALT_INDEX]).toArray()}function ga(a,b,c,e,f,g,h){h===void 0&&(h="before");c=d("MAWDbMsg").getSortOrderWithFallback(c);if(h==="before")return a.messages.where("[thread+sortOrderMs]").between([b,Number.MIN_SAFE_INTEGER],[b,c],!0,e).reverse().filter(g).limit(f).toArray();else return a.messages.where("[thread+sortOrderMs]").between([b,c],[b,Number.MAX_SAFE_INTEGER],e,!0).filter(g).limit(f).toArray().then(function(a){return a.sort(function(a,b){return b.ts-a.ts})})}function ha(a,b,e,f,g,h,i,j,k){k===void 0&&(k="before");e=d("MAWDbMsg").getSortOrderWithFallback(e);g=d("MAWDbMsg").getSortOrderWithFallback(g);f=d("MAWDbMsg").getSortOrderWithFallback(f);var l=c("qex")._("549")===!0;if(k==="before")return e===g&&!l?d("MAWDexieTable").dexieResolve([]):a.messages.where("[thread+sortOrderMs]").between([b,e],[b,g],!0,h).reverse().filter(j).limit(i).toArray();else return f===g&&!l?d("MAWDexieTable").dexieResolve([]):a.messages.where("[thread+sortOrderMs]").between([b,g],[b,f],h,!0).filter(j).limit(i).toArray().then(function(a){return a.sort(function(a,b){return b.ts-a.ts})})}function ia(a,b,c,e,f){f===void 0&&(f=!1);return e===0?d("MAWDexieTable").dexieResolve({hasMoreAfter:!1,hasMoreBefore:!1,msgs:[]}):a.threads.get(b).then(function(b){var g=b==null?void 0:b.oldestMsg,h=b==null?void 0:b.newestMsg;return b==null||g==null||h==null||c==null?{hasMoreAfter:!1,hasMoreBefore:!1,msgs:[]}:d("MAWDexieTable").dexieAll([a.messages.where("msgId").aboveOrEqual(g).first(),a.messages.where("msgId").belowOrEqual(h).last(),a.messages.get({msgId:c})]).then(function(c){var g,h=c[0],j=c[1];c=c[2];var k=c,l=h==null?void 0:h.msgId;c=k==null?void 0:k.msgId;var m=j==null?void 0:j.msgId,n=d("WATimeUtils").unixTime();if(h==null||j==null||k==null||j.sortOrderMs==null||k.sortOrderMs==null||k.sortOrderMs>j.sortOrderMs||k.sortOrderMs<((g=h.sortOrderMs)!=null?g:0)){d("WALogger").ERROR(i(),h==null?void 0:h.sortOrderMs,h==null?void 0:h.type,k==null?void 0:k.sortOrderMs,k==null?void 0:k.type,j==null?void 0:j.sortOrderMs,j==null?void 0:j.type);return{hasMoreAfter:!1,hasMoreBefore:!1,msgs:[]}}g=d("MAWDexieTable").dexieResolve([]);var o=f?function(a){return!0}:function(a){return a.messageExpirationTs==null||a.messageExpirationTs>n};e===1&&(g=a.messages.get({msgId:c}).then(function(a){return a!=null?[a].filter(o):[]}));return g.then(function(c){c=c.length>0?d("MAWDexieTable").dexieResolve(c):ja(a,b.chatId,h,j,k,e,o);return c.then(function(a){if(a.length===0)return{hasMoreAfter:!1,hasMoreBefore:!1,msgs:[]};var b=a[a.length-1],c=a[0];return{hasMoreAfter:c.msgId!==m,hasMoreBefore:b.msgId!==l,msgs:a}})})})})}function ja(a,b,c,e,f,g,h){var i=d("MAWDbMsg").getSortOrderWithFallback(c),j=d("MAWDbMsg").getSortOrderWithFallback(f),k=d("MAWDbMsg").getSortOrderWithFallback(e),l=Math.ceil(g/2);c.msgId===f.msgId&&(l=1);e.msgId===f.msgId&&(l=g);return a.messages.where("[thread+sortOrderMs]").between([b,i],[b,j],!0,!0).reverse().filter(h).limit(l).toArray().then(function(c){var d=c.length;d=g-d;return a.messages.where("[thread+sortOrderMs]").between([b,j],[b,k],!1,!0).filter(h).limit(d).toArray().then(function(a){return[].concat(c,a).sort(function(a,b){return b.ts-a.ts})})})}function ka(a,b,c,e,f){var g=e.msgId;if(b==null&&c==null)return d("MAWDexieTable").dexieResolve({newestMsg:g,oldestMsg:g});if(f==null){var h;return d("MAWDexieTable").dexieResolve({newestMsg:g,oldestMsg:(h=b)!=null?h:g})}return d("MAWDexieTable").dexieAll([b!=null?a.messages.get({msgId:b}):null,c!=null?a.messages.get({msgId:c}):null]).then(function(a){var b=a[0];a=a[1];b=[b,a,e].filter(Boolean);return{newestMsg:b.reduce(function(a,b){return $(b,g,f)>=$(a,g,f)?b:a}).msgId,oldestMsg:b.reduce(function(a,b){return $(a,g,f)<$(b,g,f)?a:b}).msgId}})}function $(a,b,c){return a.msgId===b?c:d("MAWDbMsg").getSortOrderWithFallback(a)}function la(a,b){return a.messages.where("msgId").between(d("MAWDbMsg").msgIdsInChatLowerBound(b.chatId),d("MAWDbMsg").msgIdsInChatUpperBound(b.chatId)).last().then(function(a){a=a==null?0:d("MAWDbMsg").getInChatMsgIdFromMsgId(a.msgId);return a+1})}g.maybeGetMsg=a;g.getThreadNewestMessageBySortOrder=z;g.getThreadNewestNumMessagesBySortOrder=b;g.getThreadNewestMessageByServerTs=e;g.getThreadNewestNumMessagesByServerTs=f;g.maybeGetMsgByProtocolMsgId=B;g.maybeGetMsgListByMsgId_I_KNOW_WHAT_I_AM_DOING=C;g.maybeGetMsgResultByProtocolMsgId=D;g.getMsgMapByProtocolMsgId=E;g.maybeGetRevokedMsgByProtocolMsgId=G;g.maybeGetMsgByExternalId=H;g.checkIfMsgIsDeletedForMeOrRevoked=I;g.getMsgsByProtocolMsgId=K;g.updateSystemAck=L;g.bulkUpdateSystemAck=M;g.maybeUpdateThreadMsgsForDeleteForMe=N;g.getMsgsFromOffsetV2=Q;g.getMsgsFromOffset=R;g.getMsgsFromOffsetLegacy=S;g.getFutureProofMsgs=T;g.updateMediaId=V;g.bulkUpdateMediaId=W;g.updateDbMsgXMAExpiration=X;g.bulkUpdateDbMsgXMAExpired=Y;g.getMaxLastReadMsgTsBetween=aa;g.getMsgsNeedingRetroactiveReadReceiptsUpTo=Z;g.clearRetroactiveReadReceiptStatusFromMsgsUpTo=ba;g.deleteDbMsg=ca;g.deleteMessages=da;g.getMsgsByMsgIds=ea;g.getSpamMsgs=fa;g.getMsgRangeWithOffsetUsingSortOrder=ia;g.calculateOldestAndNewestMsg=ka;g.getNextMsgIdNumberForThread=la}),98);
__d("MAWDbXMATxns",["MAWDbMediaTxns","MAWDbMsg","MAWDbMsgTxns","MAWDbThreadTxns","MAWDexieTable","MAWJidUtils","MAWXMAUtils","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return a.xma.bulkGet(b)}function b(a,b){return b==null?d("MAWDexieTable").dexieResolve():a.xma.get({xmaId:b})}function h(a,b){return b==null?d("MAWDexieTable").dexieResolve():a.xma.where("associatedMessageId").equals(b).first()}function i(a,b){return b==null?d("MAWDexieTable").dexieResolve():a.xma.where("externalId").equals(b.externalId).filter(function(a){return a.author===b.author&&a.threadJid===b.chat}).first()}function c(a,b){return i(a,b).then(function(b){return b==null?d("WAResultOrError").makeError("missing"):d("MAWDexieTable").dexieAll([d("MAWDbMediaTxns").getMediaForXMA(a,b),d("MAWDbMsgTxns").maybeGetMsg(a,b.associatedMessageId)]).then(function(a){var c=a[0];a=a[1];if(!c.success)return d("WAResultOrError").makeError("missing");c=c.value;var e=c.favicon,f=c.header;c=c.previews;return d("WAResultOrError").makeResult({associatedMessage:a,favicon:e,header:f,previews:c,xma:b})})})}function e(a,b){return h(a,b).then(function(b){if(b==null)return;return d("MAWDbMsgTxns").maybeGetMsg(a,b.msgId)})}function f(a,b){if(b.length===0)return d("MAWDexieTable").dexieResolve([]);b=b.filter(d("MAWDbMsg").isXMAMsg).map(function(a){return d("MAWJidUtils").maybeToProtocolMsgId(a.author,a.threadJid,a.externalId)}).filter(Boolean);b=b.map(function(b){return i(a,b)});return d("MAWDexieTable").dexieAll(b).then(function(a){return a.filter(Boolean)})}function j(a,b){return a.xma.where("associatedMessageId").anyOf(b).toArray().then(function(a){a=a.filter(function(a){return a.msgId!=null&&d("MAWXMAUtils").isXMAShare(a.targetType)});return a.reduce(function(a,b){return b.associatedMessageId!=null&&b.msgId!=null?a.set(b.associatedMessageId,b.msgId):a},new Map())})}function k(a,b){return a.xma.where("associatedMessageId").equals(b).first()}function l(a,b){return a.xma.where("associatedMessageId").equals(b).first().then(function(b){if(b==null)return;b=d("MAWJidUtils").maybeToProtocolMsgId(b.author,b.threadJid,b.externalId);if(b==null)return;return d("MAWDbMsgTxns").maybeGetMsgByProtocolMsgId(a,b)})}function m(a,b){return k(a,b).then(function(b){return b==null?d("WAResultOrError").makeResult():d("MAWDexieTable").dexieAll([d("MAWDbMediaTxns").getMediaForXMA(a,b),d("MAWDbMsgTxns").maybeGetMsg(a,b.associatedMessageId)]).then(function(a){var c=a[0];a=a[1];if(!c.success)return d("WAResultOrError").makeError("missing");c=c.value;var e=c.favicon,f=c.header;c=c.previews;return d("WAResultOrError").makeResult({associatedMessage:a,favicon:e,header:f,previews:c,xma:b})})})}function n(a,b,c){return d("MAWDbThreadTxns").getThreadByJid(a,c).then(function(c){if(!c.success)return;c=c.value;if(b==null)return d("MAWDexieTable").dexieResolve();c={author:b.author,chat:c.jid,externalId:b.externalId};return d("MAWDbMsgTxns").maybeGetMsgByProtocolMsgId(a,c)})}g.bulkGetXMAs=a;g.maybeGetXMAFromXMAId=b;g.maybeGetXMAFromAssociatedMsgId=h;g.maybeGetXMAFromProtocolMsgId=i;g.maybeGetXMAPayloadFromProtocolMsgId=c;g.getDbXMAMsgFromAssociatedMsgId=e;g.getXMAFromMsgs=f;g.getXMAMsgIdsFromAssociatedMsgIds=j;g.maybeGetDbXMAMsgByAssociatedMsgId=l;g.maybeGetXMAPayloadFromAssociatedMsgId=m;g.maybeGetAssociatedXMAMsg=n}),98);
__d("MAWDbReactionUtils",["MAWBridgeTypesCreators","MAWIndexedDb"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var c=a.author,e=a.reaction,f=a.reactToMsgId,g=a.threadJid;a=a.ts;if(f==null)return;d("MAWIndexedDb").afterTransaction(e==null?{tag:"DeleteReaction",value:d("MAWBridgeTypesCreators").createBridgeDeleteReaction({author:c,chatId:b,chatJid:g,reactToMsgId:f})}:{tag:"UpsertReaction",value:d("MAWBridgeTypesCreators").createBridgeUpsertReaction({author:c,chatId:b,chatJid:g,reaction:e||"",reactToMsgId:f,ts:a})})}g.dispatchReaction=a}),98);
__d("MAWAuthor",["MAWGlobals","WAJids"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){return a==null||a===d("WAJids").AUTHOR_SYSTEM?null:d("WAJids").isAuthorMe(a)?d("MAWGlobals").getMyUserJid():d("WAJids").authorAsUserJid(a)};g.getAuthorUserJid=a}),98);
__d("MAWDbReactionsTxns",["FBLogger","MAWAuthor","MAWBridgeTypesCreators","MAWDbMsg","MAWDbMsgUtil","MAWDexieTable","MAWIndexedDb","WALogger","WAMsgMap"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Deleted "," reactions"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Successfully deleted: "," reactions rows."]);i=function(){return a};return a}var j=function(a){return a};function a(a,b,c){b=babelHelpers["extends"]({},b);return d("MAWDexieTable").dexieAll([a.threads.put(b),a.reactions.put(j(c))]).then(function(a){a=a[1];return a})}function b(a,b){return a.reactions.where("externalId").equals(b.externalId).filter(function(a){return a.author===b.author&&a.threadJid===b.chat}).first()}function k(a,b){var d=b.reduce(function(a,b){a.set(b.msgId,b);return a},new Map());return a.reactions.where("reactToMsgId").anyOf(b.map(function(a){return a.msgId})).toArray().then(function(a){var b=a.filter(function(a){var b=a.reactToExternalId;a=a.reactToMsgId;return a!=null&&b===((b=d.get(a))==null?void 0:b.externalId)});b.length<a.length&&c("FBLogger")("messenger_e2ee_web").mustfix("Reactions query by reactToMsgId returns reactions with mismatching externalId");return b})}function e(a,b){return k(a,[b])}function f(a,b){var c=b.author,d=b.chat;b=b.externalId;return a.reactions.where("externalId").equals(b).filter(function(a){return a.author===c&&a.threadJid===d}).first()}function l(a,b){var c=b.map(function(a){a=a.externalId;return a});return a.reactions.where("externalId").anyOf(c).toArray().then(function(a){var c=d("MAWDbMsgUtil").convertMsgArrayToMap(a),e=new(d("WAMsgMap").MsgMap)();b.forEach(function(a){var b=c.get(a);b!=null&&e.set(a,b)});return e})}function m(a,b){return d("MAWDexieTable").dexieAll(b.map(function(b){var c=b.author,e=b.chatId;b=b.externalId;var f=d("MAWAuthor").getAuthorUserJid(c);return a.reactions.where("reactToExternalId").equals(b).filter(function(a){return d("MAWAuthor").getAuthorUserJid(a.reactToAuthor)===f&&d("MAWDbMsg").getThreadIdFromMsgId(a.reactionId)===e}).toArray()})).then(function(b){b=b.reduce(function(a,b){return a.concat(b)},[]);b.forEach(function(a){var b=a.author,c=a.reactionId,e=a.reactToMsgId;a=a.threadJid;if(e==null)return;d("MAWIndexedDb").afterTransaction({tag:"DeleteReaction",value:d("MAWBridgeTypesCreators").createBridgeDeleteReaction({author:b,chatId:d("MAWDbMsg").getThreadIdFromMsgId(c),chatJid:a,reactToMsgId:e})})});d("WALogger").LOG(i(),b.length);return a.reactions.bulkDelete(b.map(function(a){return a.rowId}))})}function n(a,b){return a.reactions.where("reactToMsgId").anyOf(b.map(function(a){return a.msgId}))["delete"]().then(function(a){d("WALogger").LOG(h(),a)})}function o(a,b){return a.reactions.where("reactionId").between(d("MAWDbMsg").msgIdsInChatLowerBound(b.chatId),d("MAWDbMsg").msgIdsInChatUpperBound(b.chatId)).last().then(function(a){a=a==null?0:d("MAWDbMsg").getInChatMsgIdFromMsgId(a.reactionId);return a+1})}g.coerceToReaction=j;g.putReaction=a;g.getReaction=b;g.getReactionsFromMessages=k;g.getReactionsFromMessage=e;g.maybeGetReactionByProtocolMsgId=f;g.getReactionMapByProtocolMsgId=l;g.deleteReactionsByUniqueMsgIdentifiers=m;g.deleteAllReactionsForMessages=n;g.getNextReactionIdNumberForThread=o}),98);
__d("MAWMediaAfterTxns",["MAWBridgeTypesCreators","MAWIndexedDb","MAWRavenUtils"],(function(a,b,c,d,e,f,g){"use strict";var h=function(a,b){return{ephemeralMediaState:b,ephemeralMediaViewMode:d("MAWRavenUtils").getEphemeralMediaViewMode(a)}};function a(a,b,c){b=a.ravenEphemeralType!=null&&a.ravenEphemeralMediaState!=null?d("MAWBridgeTypesCreators").createBridgeMedia(a.thread,b,c,a.sortOrderMs,h(a.ravenEphemeralType,a.ravenEphemeralMediaState)):d("MAWBridgeTypesCreators").createBridgeMedia(a.thread,b,c,a.sortOrderMs);d("MAWIndexedDb").afterTransaction({tag:"NewMedia",value:b})}g.handleNewMediaAfterTxn=a}),98);
__d("MAWLoadMsgsTxns",["MAWBridgeMsg","MAWBridgeMsgCountdown","MAWBridgeTypesCreators","MAWBridgeXMA","MAWDbChunkTxns","MAWDbMediaTxns","MAWDbMsgTxns","MAWDbReactionUtils","MAWDbReactionsTxns","MAWDbXMATxns","MAWDexieTable","MAWIndexedDb","MAWLoadReplyMediaTxns","MAWLoggerUtils","MAWMediaAfterTxns","MAWXMAUtils","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["EphemeralCounter: Showing UI counter for ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["EphemeralCounter: Showing UI counter for ",""]);i=function(){return a};return a}function j(a,b){return d("MAWDbMediaTxns").getMsgMediaPairFromMsgs(a,b).then(function(b){return d("MAWDexieTable").dexieAll(b.map(function(b){var c=b[0],e=b[1];return d("MAWDbChunkTxns").hasMediaChunk(a,e.hashedPlaintextHash).then(function(a){d("MAWMediaAfterTxns").handleNewMediaAfterTxn(c,e,a)})}))})}function k(a,b,c){return d("MAWDbXMATxns").getXMAFromMsgs(a,b).then(function(b){return d("MAWDexieTable").dexieAll(b.map(function(b){if(d("MAWXMAUtils").isXMAStoryReply(b.targetType))return;return d("MAWDbMediaTxns").maybeGetMediaFromMediaId(a,b.defaultPreviewMediaId).then(function(a){d("MAWIndexedDb").afterTransaction({tag:"NewXMA",value:d("MAWBridgeXMA").createBridgeXMA(c,a,b)})})}))})}function l(a,b,c){return d("MAWDbReactionsTxns").getReactionsFromMessages(a,b).then(function(a){a.forEach(function(a){return d("MAWDbReactionUtils").dispatchReaction(a,c)});return a})}function a(a,b,c,e,f,g,h){g===void 0&&(g=!1);return d("MAWDbMsgTxns").getMsgsFromOffset(a,b,e,f,g,!1,h).then(function(b){var c=b.msgs,e=babelHelpers.objectWithoutPropertiesLoose(b,["msgs"]);return d("MAWDexieTable").dexieAll(c.map(function(b){return d("MAWLoadReplyMediaTxns").getReplyMediaForMsgQuote(a,b)})).then(function(a){return babelHelpers["extends"]({msgs:c,replyMediaInfo:a},e)})}).then(function(e){var f=e.hasMoreAfter,m=e.hasMoreBefore,n=e.msgs,o=e.replyMediaInfo;if(n.length>0){e=n.filter(function(a){return a.ephemeralCounterStarted});var p=n.map(function(a,b){if(d("MAWXMAUtils").isXMAStoryReply(a.xmaMessageType))return;return d("MAWBridgeMsg").createBridgeMsg(a,void 0,(o||[])[b])}).filter(Boolean);p.length>0&&d("MAWIndexedDb").afterTransaction({tag:"NewMsgs",value:{msgs:p}});e.length>0&&(d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.Ephemeral,d("MAWLoggerUtils").Tag.Countdown,d("MAWLoggerUtils").Tag.OnLoad]).LOG(i(),e.map(function(a){return a.msgId})),d("MAWIndexedDb").afterTransaction({tag:"MsgsStartCountdown",value:d("MAWBridgeMsgCountdown").createBridgeMsgsStartCountdown(e)}));d("MAWIndexedDb").afterTransaction({tag:"MsgsLoaded",value:d("MAWBridgeTypesCreators").createBridgeMsgsLoadedInfo(b,c,n,g,m,f,h)})}return d("MAWDexieTable").dexieAll([l(a,n,b),j(a,n),k(a,n,b)]).then(function(a){a=a[0];return{hasMoreAfter:f,hasMoreBefore:m,msgs:n,reactions:a}})})}function b(a,b,c,e){return d("MAWDbMsgTxns").getMsgRangeWithOffsetUsingSortOrder(a,b,c,e,!1).then(function(b){var c=b.msgs,e=babelHelpers.objectWithoutPropertiesLoose(b,["msgs"]);return d("MAWDexieTable").dexieAll(c.map(function(b){return d("MAWLoadReplyMediaTxns").getReplyMediaForMsgQuote(a,b)})).then(function(a){return babelHelpers["extends"]({msgs:c,replyMediaInfo:a},e)})}).then(function(e){var f=e.hasMoreAfter,g=e.hasMoreBefore,i=e.msgs,m=e.replyMediaInfo;if(i.length>0){e=i.filter(function(a){return a.ephemeralCounterStarted});var n=i.map(function(a,b){if(d("MAWXMAUtils").isXMAStoryReply(a.xmaMessageType))return;return d("MAWBridgeMsg").createBridgeMsg(a,void 0,(m||[])[b])}).filter(Boolean);n.length>0&&d("MAWIndexedDb").afterTransaction({tag:"NewMsgs",value:{msgs:n}});e.length>0&&(d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.Ephemeral,d("MAWLoggerUtils").Tag.Countdown,d("MAWLoggerUtils").Tag.OnLoad]).LOG(h(),e.map(function(a){return a.msgId})),d("MAWIndexedDb").afterTransaction({tag:"MsgsStartCountdown",value:d("MAWBridgeMsgCountdown").createBridgeMsgsStartCountdown(e)}));d("MAWIndexedDb").afterTransaction({tag:"MsgRangeLoaded",value:d("MAWBridgeTypesCreators").createBridgeMsgRangeLoadedInfo(b,i,g,f,c)})}return d("MAWDexieTable").dexieAll([l(a,i,b),j(a,i),k(a,i,b)]).then(function(a){a=a[0];return{hasMoreAfter:f,hasMoreBefore:g,msgs:i,reactions:a}})})}g.loadMsgsAndMediaFromOffset=a;g.loadMsgRangeWithOffset=b}),98);
__d("MAWBridgeParticipants",["WAJids","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(a){var b=a.deliveredWatermarkTs,c=a.lastReadActionTs,e=a.lastReadWatermarkTs,f=a.threadId,g=a.type;a=a.userJid;return{deliveredWatermarkTs:b||d("WATimeUtils").castToUnixTime(0),fbid:d("WAJids").extractUserId(a),isAdmin:g==="superadmin"||g==="admin",isInvited:g==="invitedParticipant",isSuperAdmin:g==="superadmin",lastReadActionTs:(b=c)!=null?b:d("WATimeUtils").castToUnixTime(0),readWatermarkTs:e||d("WATimeUtils").castToUnixTime(0),threadId:f}}function a(a){return{participants:a.map(function(a){return h(a)})}}g.createBridgeParticipant=h;g.createBridgeParticipants=a}),98);
__d("MAWDbParticipantTxns",["MAWBridgeParticipants","MAWBridgeTypesCreators","MAWCurrentUser","MAWDbParticipant","MAWDexieTable","MAWIndexedDb","MAWODSProxy","WAArrayZip","WAJids","WAOdsEnums","WAResultOrError","WATimeUtils","err"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c,d,e,f){e===void 0&&(e="participant");return h(a,b,c,[{addressable:f,type:e,userJid:d}]).then(function(a){return a[0]})}function h(a,b,c,d){return i(a,d.map(function(a){return babelHelpers["extends"]({},a,{threadId:b,threadJid:c})}))}function i(a,b){if(b.length===0)return d("MAWDexieTable").dexieResolve([]);var c=[];b.forEach(function(a){var b=a.addressable,e=a.threadId,f=a.threadJid,g=a.type;a=a.userJid;c.push({addressable:b,deliveredWatermarkTs:d("WATimeUtils").castToUnixTime(0),id:d("MAWDbParticipant").craftParticipantId(e,a),lastReadWatermarkTs:d("WATimeUtils").castToUnixTime(0),threadId:e,threadJid:f,type:g,userJid:a})});return a.participants.bulkPut(c).then(function(){d("MAWIndexedDb").afterTransaction({tag:"ParticipantsUpdated",value:d("MAWBridgeParticipants").createBridgeParticipants(c)});return c})}function b(a,b,c,e){return o(a,c).then(function(f){var g=[],i=new Set(e.map(function(a){return a.userJid}));for(var j=f,l=Array.isArray(j),m=0,j=l?j:j[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var n;if(l){if(m>=j.length)break;n=j[m++]}else{m=j.next();if(m.done)break;n=m.value}n=n;var o=i.has(n.userJid);o||g.push([n.threadJid,n.userJid])}o=[];n=new Set(f.map(function(a){return a.userJid}));for(m=0;m<e.length;m++){l=e[m];j=n.has(l.userJid);j||o.push(l)}g.length>0&&d("MAWODSProxy").odsBumpEntityKey({amount:1,entity:d("WAOdsEnums").Entity.MAW_ONE_TO_ONE_THREAD_PARTICIPANT_CLEANUP,key:d("MAWCurrentUser").isEmployee()?"employee":"public"});return d("MAWDexieTable").dexieAll([h(a,b,c,o),k(a,g)]).then(function(a){var b=a[0];a[1];a=e.reduce(function(a,c){var d=b.find(function(a){return a.userJid===c.userJid}),e=f.find(function(a){return a.userJid===c.userJid});d!=null&&e==null?a.push(d):e!=null&&a.push(e);return a},[]);return a})})}function e(a,b){return a.participants.bulkPut(b).then(function(){b.length>0&&d("MAWIndexedDb").afterTransaction({tag:"ParticipantsUpdated",value:d("MAWBridgeParticipants").createBridgeParticipants(b)});return b})}function f(a,b,c){if(c.length===0)return d("MAWDexieTable").dexieResolve();c=c.map(function(a){return[b,a]});return k(a,c)}function j(a,b,c){if(b.length===0)return d("MAWDexieTable").dexieResolve();b=b.map(function(a){return[a,c]});return k(a,b)}function k(a,b){return a.participants.where(["threadJid","userJid"]).anyOf(b).toArray().then(function(b){return a.participants.bulkDelete(b.map(function(a){return a.id})).then(function(){return a.threads.where("jid").anyOf(Array.from(new Set(b.map(function(a){return a.threadJid})))).toArray()}).then(function(a){var c=new Map(a.map(function(a){return[a.jid,a.chatId]}));b.forEach(function(a){var b=c.get(a.threadJid);b!=null&&d("MAWIndexedDb").afterTransaction({tag:"ParticipantRemoved",value:{threadId:b,userId:d("WAJids").extractUserId(a.userJid)}})})})})}function l(a,b){return a.participants.where("threadJid").equals(b)["delete"]()}function m(a,b,c,d,e){return n(a,[{deliveredWatermarkTs:c,lastReadActionTs:e,lastReadWatermarkTs:d,participantKey:b}]).then(function(a){return a[0]})}function n(a,b){if(b.length===0)return d("MAWDexieTable").dexieResolve([]);var c=new Map(),e=[];b.forEach(function(a){e.push(a.participantKey),c.set(JSON.stringify(a.participantKey),a)});return a.participants.where(["threadJid","userJid"]).anyOf(e).toArray().then(function(b){var e=[],f=[];b.forEach(function(a){var b=c.get(JSON.stringify([a.threadJid,a.userJid]));if(b==null)return;var d=b.deliveredWatermarkTs,g=b.lastReadActionTs;b=b.lastReadWatermarkTs;var h=a.deliveredWatermarkTs,i=a.lastReadWatermarkTs,j=a.lastReadActionTs,k=d>h,l=b>i,m=j==null||g>j;if(!k&&!l&&!m){f.push(a);return}e.push(babelHelpers["extends"]({},a,{deliveredWatermarkTs:k?d:h,lastReadActionTs:m?g:j,lastReadWatermarkTs:l?b:i}))});return a.participants.bulkPut(e).then(function(){e.forEach(function(a){d("MAWIndexedDb").afterTransaction({tag:"ReceivedReceipt",value:d("MAWBridgeTypesCreators").createBridgeReceivedReceipt(a.threadId,a.threadJid,d("WAJids").extractUserId(a.userJid),a.deliveredWatermarkTs,a.lastReadWatermarkTs,a.lastReadActionTs)})});return[].concat(e,f)})})}function o(a,b){return a.participants.where("threadJid").equals(b).toArray()}function p(a,b){return a.participants.where("threadJid").anyOf(b).toArray()}function q(a,b){return o(a,b).then(function(a){return a.filter(function(a){return a.type==="invitedParticipant"})})}function r(a,b,c){return a.participants.get(d("MAWDbParticipant").craftParticipantId(b,c)).then(function(a){return a==null?d("WAResultOrError").makeError("missing"):d("WAResultOrError").makeResult(a)})}function s(a,b,e){var f=new Map(d("WAArrayZip").zip(b,e));b=Array.from(f.keys()).filter(Boolean);return a.participants.where("threadId").anyOf(b).toArray().then(function(b){var d=b.map(function(a){return[a.threadJid,a.userJid]}),e=b.map(function(a){var b=f.get(a.threadId);if(b==null)throw c("err")("New Thread Id is null - should not happen flow");return{addressable:a.addressable,threadId:b,threadJid:a.threadJid,type:a.type,userJid:a.userJid}});return k(a,d).then(function(){return i(a,e)}).then(function(){})})}function t(a,b){return a.participants.where(["threadJid","userJid"]).anyOf(b).toArray().then(function(a){var c=new Map(a.map(function(a){return[JSON.stringify([a.threadJid,a.userJid]),a]}));return b.map(function(a){return c.get(JSON.stringify(a))})})}g.addParticipant=a;g.bulkAddParticipants=h;g.bulkAddParticipantsInThreads=i;g.bulkUpsertParticiantsInThread=b;g.bulkUpdateParticipants=e;g.bulkDeleteParticipantsInThread=f;g.bulkDeleteParticipantAcrossThreads=j;g.bulkDeleteParticipants=k;g.deleteAllParticipantsForThread=l;g.updateParticipantTimestamps=m;g.bulkUpdateParticipantTimestamps=n;g.getParticipantsInThread=o;g.getParticipantsInThreads=p;g.getInvitedParticipantsInThread=q;g.getParticipant=r;g.bulkMigrateParticipantsToNewThreads=s;g.bulkGetParticipants=t}),98);
__d("MAWDbContactsTxns",["MAWDexieTable"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return a.contacts.where("contactJid").anyOf(b).toArray()}function b(a,b){return a.contacts.get({contactJid:b})}function c(a,b){return b==null?d("MAWDexieTable").dexieResolve():a.contacts.get({contactJid:b}).then(function(a){return a==null?null:a.nameForSearch})}g.getContacts=a;g.getContact=b;g.maybeGetContactName=c}),98);
__d("WAIdentityUtils",["WABinary","WACryptoDependencies","WASignalOther"],(function(a,b,c,d,e,f,g){"use strict";function h(a){var b=a.length===33&&a[0]===5;return b?a.slice(1):a}function i(a,b){for(var c=0;c<a.length&&c<b.length;++c)if(a[c]!==b[c])return a[c]-b[c];return a.length-b.length}function a(a){a=a.map(function(a){return h(a)});var b=new(d("WABinary").Binary)();a.sort(i).forEach(function(a){return b.writeByteArray(a)});a=d("WACryptoDependencies").getCrypto().subtle.digest("SHA-256",b.readByteArray());return a.then(function(a){a=new Uint8Array(a);return d("WASignalOther").sliceBytes(a,0,10)})}g.removeKeyTypeIfNeeded=h;g.computeIdentitiesHash=a}),98);
__d("MAWRecipientDevicesTxns",["MAWDbContactsTxns","MAWDbIdentityTxns","MAWDbParticipantTxns","MAWGlobals","WAIdentityUtils","WAJids","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("MAWDbParticipantTxns").getParticipantsInThread(a,b).then(function(b){if(b.length===0)return d("WAResultOrError").makeError("missing_participants");b=b.map(function(a){return a.userJid});return h(a,b).then(d("WAResultOrError").makeResult)})}function h(a,b){return d("MAWDbIdentityTxns").getIdentitiesForMultipleUsers(a,b,d("MAWGlobals").getMyDeviceJid()).then(function(a){var b=[];a.forEach(function(a,c){a.forEach(function(a){return b.push(a.deviceJid)})});return b})}function b(a,b){return a.receipts.get(b).then(function(b){if(b==null)return d("WAResultOrError").makeError("missing_receipt");b=b.statusTsPerUser;b=Array.from(b.keys());return d("MAWDbIdentityTxns").getIdentitiesForMultipleUsers(a,b,d("MAWGlobals").getMyDeviceJid()).then(function(a){var b=[];a.forEach(function(a,c){a.forEach(function(a){return b.push(a.deviceJid)})});return d("WAResultOrError").makeResult(b)})})}function c(a,b){return d("MAWDbParticipantTxns").getParticipantsInThread(a,b).then(function(b){if(b.length===0)return d("WAResultOrError").makeError("missing_participants");var c=b.map(function(a){return a.userJid});return d("MAWDbContactsTxns").getContacts(a,c).then(function(b){var e=[];b.forEach(function(a){a.lastSyncTs!=null&&e.push({lastSyncTs:a.lastSyncTs,user:a.contactJid})});return d("MAWDbIdentityTxns").getIdentitiesForMultipleUsers(a,c).then(function(a){var c=[],f=new Map();a.forEach(function(a,b){a.forEach(function(a){return f.set(a.deviceJid,{pubKey:a.identity})})});var g=new Map();f.forEach(function(a,b){g.set(d("WAIdentityUtils").removeKeyTypeIfNeeded(a.pubKey).toString(),b)});b.forEach(function(a){var b=a.icdcInfo;if(b==null)return;var e=b.devices,f=b.signingDeviceIndex;if(f>=e.length)return;e=e.map(function(a){var b=g.get(a.toString());if(b==null)return;return{id:d("WAJids").extractDeviceId(b),identity:a}}).filter(Boolean);c.push({devices:e,sequence:b.sequence,signingDeviceIndex:f,timestamp:b.timestamp,user:a.contactJid})});return d("WAResultOrError").makeResult({contactsSyncInfo:e,icdcInfoList:c})})})})}g.getRecipientDevicesByThread=a;g.getRecipientDevicesByUserJids=h;g.getRecipientDevicesByMsgId=b;g.getICDCInfoForUsersInThread=c}),98);
__d("MAWMsgReceiptPreparationTxns",["MAWDbIdentityTxns","MAWDbParticipantTxns","MAWDexieTable","MAWIndexedDb","MAWRecipientDevicesTxns","MAWTransactionMode","WAGlobals","WALogger","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["MAWMsgReceiptPreparationTxns - isRevoked: "," - savePermittedIdentities: "," - permittedIdentitiesPerDevice: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["MAWMsgReceiptPreparationTxns -- permittedIdentitiesPerDevice is null or empty"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["MAWMsgReceiptPreparationTxns -- deviceJids is empty"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["MAWMsgReceiptPreparationTxns -- There is only "," participants in chat"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["MAWMsgReceiptPreparationTxns -- prepareReceiptForMsg -- there is no thread in db"]);l=function(){return a};return a}b=d("MAWIndexedDb").makeSignalTransactor({identity:d("MAWTransactionMode").READONLY,receipts:d("MAWTransactionMode").READWRITE},"prepareReceiptForUsers",function(a){return function(b,c){return m(a,b,c)}});function m(a,b,c){return a.receipts.get(b).then(function(e){return e!=null?d("WAResultOrError").makeResult(e):d("MAWDexieTable").dexieAll(c.map(function(b){return d("MAWDbIdentityTxns").getIdentitiesForUser(a,b)})).then(function(a){return a.flatMap(function(a){return a})}).then(function(a){var b=new Map();for(var a=a,c=Array.isArray(a),e=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(c){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;if(f==null||f.deviceJid===d("WAGlobals").getMyDeviceJid())continue;b.set(f.deviceJid,{pubKey:f.identity})}return b}).then(function(e){if(e==null||e.size===0)return d("WAResultOrError").makeError("no-recipients");var f=new Set(e.keys()),g=new Map();c.forEach(function(a){return g.set(a,{})});var h={msgId:b,permittedIdentitiesPerDevice:e,recipientDevices:f,statusTsPerUser:g};return a.receipts.put(h).then(function(){return d("WAResultOrError").makeResult(h)})})})}function a(a,b,c,e,f){e===void 0&&(e=!0);f===void 0&&(f=!1);return a.receipts.get(b).then(function(g){return g!=null&&!f?g:a.threads.get({jid:c}).then(function(c){if(c==null){d("WALogger").ERROR(l());return}return d("MAWDbParticipantTxns").getParticipantsInThread(a,c.jid).then(function(c){if(c.length===0||c.length===1){var g=!1;if(c.length===1){var l=c[0];l=l.userJid;g=l===d("WAGlobals").getMyUserJid()}g||d("WALogger").ERROR(k(),c.length)}var m=c.map(function(a){return a.userJid});l=f?d("MAWRecipientDevicesTxns").getRecipientDevicesByMsgId(a,b):d("MAWRecipientDevicesTxns").getRecipientDevicesByUserJids(a,m).then(d("WAResultOrError").makeResult);return l.then(function(a){return a.success?a.value:[]}).then(function(c){c.length===0&&d("WALogger").ERROR(j());var g=new Set(c);c=e?d("MAWDbIdentityTxns").getIdentitiesForDevices(a,c):d("MAWDexieTable").dexieResolve();return c.then(function(c){e&&(c==null||c.size===0)&&d("WALogger").ERROR(i());d("WALogger").LOG(h(),f,e,c==null?void 0:c.size);var j=new Map();m.forEach(function(a){return j.set(a,{})});var k={msgId:b,permittedIdentitiesPerDevice:c,recipientDevices:g,statusTsPerUser:j};return a.receipts.put(k).then(function(){return k})})})})})})}g.prepareReceiptForUsersTxn=b;g.prepareReceiptForMsg=a}),98);
__d("MAWAdminMsgTxnsUtils",["MAWGlobals","MAWIndexedDb","MAWJids","MAWODSProxy","WAOdsEnums"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.map(function(a){return d("MAWJids").userIdFromJid(a)});a.forEach(function(){d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.ADMIN_MESSAGE,key:"missing_user_id"})});d("MAWIndexedDb").afterTransaction({tag:"SyncContacts",value:b})}function b(a){return a==null||a===""}function c(){return d("MAWGlobals").getConfig().defaultUnknownContactText()}g.afterTransactionFetchContactsNames=a;g.isUnknownName=b;g.getUnknownUserName=c}),98);
__d("LSEBPayloadSerializerError",[],(function(a,b,c,d,e,f){a=Object.freeze({INVALID_BACKUP_OPERATION:-7,INVALID_CONTENT_TYPE:-6,INVALID_PAYLOAD_FORMAT:-5,CQL_DB_ERROR:-4,REQUIRED_COLUMN_NOT_PRESENT_ON_CLIENT:-3,DEPRECATED_SPROC:-2,UNKNOWN_ERROR:-1,NOT_AN_ERROR:0,BACKUP_NOT_FOUND:1,REQUIRED_TABLE_NOT_FOUND:2,NATIVE_OP_NOT_FOUND:3,BACKUP_UPLOAD_KILLSWITCHED:4,TASK_ID_NOT_FOUND:5,NOT_IMPLEMENTED:6,NOT_SUPPORTED_ON_WEB:7,DUPLICATE_TASK:8,CLIENT_STATE_NOT_LOADED:9,RECOVERY_CODE_NOT_FOUND:10,EPOCH_KEYS_NOT_FOUND:11,DEVICE_PAYLOAD_NOT_CREATED:12,NULL_DEVICE_PAYLOAD:13,EPOCH_PAYLOAD_NOT_CREATED:14,NULL_EPOCH_PAYLOAD:15,VIRTUAL_DEVICE_PAYLOAD_NOT_CREATED:16,NULL_VIRTUAL_DEVICE_PAYLOAD:17,DEVICE_METADATA_NOT_FOUND:18,NO_MATCHING_DEVICE_PUBLIC_KEY:19,NULL_MAILBOX_ROOT_KEY:20,NULL_ENCRYPTION_VERSION:21,NULL_OCMF_KEY:22,NULL_EPOCH_KEYS:23,NULL_DEVICE_ID:24,OPE_KEY_DERIVATION_FAILED:25,MESSAGE_KEY_DERIVATION_FAILED:26,NULL_MAILBOX_ROOT_KEY_V2:27,ECHO_DOCUMENT_ENCODING_FAILED:30,MESSAGE_PAYLOAD_ENCRYPTION_FAILED:40,SERVER_THREAD_ID_NOT_FOUND_FOR_JID:52,UNKNOWN_PROTOBUF_TYPE:60,SUPPLEMENTARY_DATA_KEY_UNEXPECTED:61,PROTOBUF_ENCRYPTION_FAILED:62,PROTOBUF_NOT_FOUND_IN_TOPLEVEL_TABLE:63,PROTOBUF_NOT_FOUND_IN_SUPPLEMENTAL_TABLE:64,SUPPLEMENTAL_KEY_NOT_SET_IN_CONTEXT_TABLE:65,SUPPLEMENTAL_ENCRYPTION_FAILED:66,PROTOBUF_CONTEXT_ROW_NOT_FOUND:67,THREAD_PK_NOT_FOUND_FOR_JID:100,MESSAGE_DECRYPTION_FAILED:101,EPOCH_KEY_FETCH_FAILED:102,TOO_MANY_OPEN_EPOCHS:103,MESSAGE_RANGE_PREPARE_FAILURE:104,ECHO_DOCUMENT_RESTORE_FAILED:105,MISMATCH_POINT_QUERY_MESSAGE_AND_RANGE_LENGTH:106,INITIAL_THREADS_FETCH_FOR_RESTORE_FAILED:107,MISSING_SUPPLEMENTAL_KEY_CIPHERTEXT:108,SUPPLEMENTAL_KEY_DECRYPTION_FAILURE:109,DEVICE_ID_MISMATCH:110,RESTORE_TO_TAM_INFO:111,MESSAGE_PK_NOT_FOUND_IN_CLIENT_MESSAGES:200,OTID_NOT_FOUND_IN_ACT_MESSAGES:201,THREAD_ID_NOT_FOUND_IN_ACT_THREADS:202,THREAD_PK_NOT_FOUND_IN_CLIENT_THREADS:203,FAILED_TO_GET_THREAD_SORT_KEY:204,MEDIA_INFO_INVALID:205,SKIPPED_EB_DISABLED:300,SKIPPED_THREAD_NOT_ELIGIBLE:301,SKIPPED_MESSAGE_NOT_ELIGIBLE:302,NO_EPOCHS_FOUND:400,LATEST_EPOCH_QUERY_BY_ID_FAILED:401,FOUND_EPOCH_WITH_NULL_ROOT_KEY:402,FOUND_EPOCH_WITH_NULL_ANON_ID:403,NO_RECOVERY_CODE:501,NO_ERROR:601,ERROR_GENERAL:602,UNKNOWN:603,ONBOARDING_MATERIAL_DERIVATION_FAILURE:604,NULL_DEVICE_HMAC:605,MISSING_LATEST_EPOCH_AT_ONBOARDING:606,NO_THREADS_TO_COMPARE:701,START_SORT_KEY_FAILURE:702,END_SORT_KEY_FAILURE:703,LOOPING_UPLOAD_PAYLOAD_NOT_FOUND:704,NULL_ECHO_IDENTIFIERS:705,ECHO_TIMESTAMP_CONVERSION_FAILED:706,ECHO_PROTOBUF_THREAD_ID_MISMATCH:707,ECHO_PROTOBUF_TIMESTAMP_MISMATCH:708,ECHO_PROTOBUF_OTID_MISMATCH:709,NULL_ECHO_DOCUMENT:710,INVALID_PROTOBUF_BACKUP_ACTION:711,EMPTY_ENCODED_ECHO_DOCUMENT:712,ECHO_DOCUMENT_ENCODING_UNKNOWN_ENCODING_ERROR:750,ECHO_DOCUMENT_ENCODING_MESSAGE_PK_NOT_FOUND_ERROR:751,ECHO_DOCUMENT_ENCODING_DISK_WRITE_CHECK_FAILED:752,ECHO_DOCUMENT_ENCODING_THREAD_TRANSPORT_ID_FETCH_FAILED:753,ECHO_DOCUMENT_ENCODING_FILE_WRITE_FAILED:754,ECHO_DOCUMENT_ENCODING_DISK_WRITE_DISABLED:755,ECHO_DOCUMENT_ENCODING_SHOULD_NOT_PERSIST:756,MISSING_SUPPLEMENTAL_DATA:757,ECHO_DOCUMENT_ENCODING_MESSAGE_FIELDS_REPLY_PROXY_ERROR:758,ECHO_DOCUMENT_ENCODING_MESSAGE_FIELDS_EDIT_MESSAGE_QUERY_ERROR:759,ECHO_DOCUMENT_ENCODING_MESSAGE_FIELDS_EDIT_MESSAGE_ERROR:760,ECHO_DOCUMENT_ENCODING_MESSAGE_FIELDS_RECEIPTS_ERROR:761,ECHO_DOCUMENT_ENCODING_MESSAGE_FIELDS_REACTIONS_ERROR:762,ECHO_DOCUMENT_ENCODING_MESSAGE_FIELDS_VISUAL_MESSAGE_ACTIONS_ERROR:763,ECHO_DOCUMENT_ENCODING_MESSAGE_FIELDS_POLLS_ERROR:764});f["default"]=a}),66);
__d("MAWBridgeUpload",[],(function(a,b,c,d,e,f){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l){return{actionType:g,authTs:d,echoDocument:f,echoEncodingLatencyNs:e,errorCode:h,errorMessage:i,messageId:a,protoMsg:l,sortOrderMs:c,threadId:b,traceId:j,uploadTrackingInstanceKey:k}}function b(a,b,c,d,e,f){return{actionType:f,echoDocument:e,folderType:b,threadId:a,transportKey:c,ts:d}}function c(a,b,c,d,e,f,g,h){return{chatId:a,deliveryObjectId:b,mediaType:c,messageId:d,productType:e,threadId:f,traceId:h,ts:g}}f.createBridgeUploadMessage=a;f.createBridgeDeleteMessagesOfThread=b;f.createBridgeUploadAttachment=c}),66);
__d("MAWUploadThreadTxns",["$InternalEnum","MAWFolderTypes"],(function(a,b,c,d,e,f,g){"use strict";var h=b("$InternalEnum")({INBOX:0,PENDING:1,OTHER:2,SPAM:3,ARCHIVED:4,HIDDEN:5});function i(a){switch(a){case d("MAWFolderTypes").FOLDER_ID.INBOX:return h.INBOX;case d("MAWFolderTypes").FOLDER_ID.PENDING:return h.PENDING;case d("MAWFolderTypes").FOLDER_ID.ARCHIVED:return h.ARCHIVED;default:return h.INBOX}}function a(a){return i(a).toString()}g.FolderType=h;g.getFolderTypeAsText=a}),98);
__d("MAWBridgeEventTransmitter",["MAWBridge","MAWBridgeMsg","MAWBridgeTrace","MAWBridgeTypesCreators","MAWBridgeUpload","MAWIndexedDb","MAWTimeUtils","MAWUploadThreadTxns","WAJids","WATimeUtils","qpl"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c,e,f){d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:[{tag:"IssuePointQuery",value:{jid:f,messageId:a,startSortKey:c,taskSource:e,threadId:b}}]})}function b(a){d("MAWIndexedDb").afterTransaction({tag:"DeleteMessagesOfThread",value:d("MAWBridgeUpload").createBridgeDeleteMessagesOfThread(d("WAJids").threadIdForChatJid(a.jid),d("MAWUploadThreadTxns").getFolderTypeAsText(a.folder),"AdvancedCrypto",(a=d("MAWTimeUtils").ensureValidMillisTime(a.newestMsgTs))!=null?a:d("WATimeUtils").castToMillisTime(1),null,2)})}function e(a,b,c,e,f,g){d("MAWIndexedDb").afterTransaction({tag:"MsgsLoaded",value:d("MAWBridgeTypesCreators").createBridgeMsgsLoadedInfo(a,b,c,e,f,g)})}function f(a,b,c){d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:[{tag:"StartTrace",value:d("MAWBridgeTrace").createBridgeStartTraceData(a,b,c)}]})}function h(a,b,e){var f=c("qpl")._(521482576,"1069");(e==null?void 0:e.get(a.externalId))!=null?d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:[{tag:"NewMsg",value:d("MAWBridgeMsg").createBridgeMsg(a,e.get(a.externalId),void 0,f,b)}]}):d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:[{tag:"NewMsg",value:d("MAWBridgeMsg").createBridgeMsg(a,void 0,void 0,f,b)}]})}function i(a,b,c,e,f,g,h){d("MAWIndexedDb").afterTransaction({tag:"ThreadBumped",value:d("MAWBridgeTypesCreators").createBridgeBumpedThread(a,b,c,e,f,g,h)})}function j(a,b,c,e){d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:[{tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({cannotReplyReason:a,chatJid:e,folder:b,threadId:c})}]})}function k(a,b,c){d("MAWIndexedDb").afterTransaction({tag:"DeleteMessageRangesV2",value:{minMsgId:a,minTimestampMs:b,threadId:c}})}g.issuePointQueryOutsideTxn=a;g.deleteMessagesOfThreadAfterTxn=b;g.issueMsgLoadedEventAfterTxn=e;g.startTraceOutsideTxn=f;g.issueNewMsgUiEventOutsideTxn=h;g.bumpThreadAfterTxn=i;g.updateThreadOutsideTxn=j;g.deleteMessageRangesV2AfterTxn=k}),98);
__d("MAWConvertExtendedContentOverlayIconGlyphToXMAGatingType",["EchoMessageXMAFieldUtils","WAArmadilloXMA.pb","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Not a valid ExtendedContentOverlayIconGlyph: ",""]);h=function(){return a};return a}function a(a){switch(a){case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.INFO:return d("EchoMessageXMAFieldUtils").XMAGatingType.INFO;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.EYE_OFF:return d("EchoMessageXMAFieldUtils").XMAGatingType.EYE_OFF;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.NEWS_OFF:return d("EchoMessageXMAFieldUtils").XMAGatingType.NEWS_OFF;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.WARNING:return d("EchoMessageXMAFieldUtils").XMAGatingType.WARNING;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.PRIVATE:return d("EchoMessageXMAFieldUtils").XMAGatingType.PRIVATE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.NONE:return d("EchoMessageXMAFieldUtils").XMAGatingType.NONE;default:d("WALogger").ERROR(h(),a);return d("EchoMessageXMAFieldUtils").XMAGatingType.NONE}}g.convertExtendedContentOverlayIconGlyphToXMAGatingType=a}),98);
__d("MAWConvertExtendedContentTargetTypeToXMATargetType",["EchoMessageXMAFieldUtils","WAArmadilloXMA.pb","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Not a valid ExtendedContentTargetType: ",""]);h=function(){return a};return a}function a(a){switch(a){case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_MENTION:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_PHOTO_MENTION;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_IMAGE_POST_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_SINGLE_IMAGE_POST_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_MULTIPOST_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_MULTIPOST_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_VIDEO_POST_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_SINGLE_VIDEO_POST_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_PHOTO_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_VIDEO_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_CLIPS_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_CLIPS_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_IGTV_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_IGTV_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SHOP_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_SHOP_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_PROFILE_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_PROFILE_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_HIGHLIGHT_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_PHOTO_HIGHLIGHT_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_HIGHLIGHT_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_VIDEO_HIGHLIGHT_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REPLY:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_REPLY;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REACTION:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_REACTION;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.FB_FEED_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_REPLY:return d("EchoMessageXMAFieldUtils").XMAContentType.FB_STORY_REPLY;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.FB_STORY_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_MENTION:return d("EchoMessageXMAFieldUtils").XMAContentType.FB_STORY_MENTION;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_VIDEO_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.FB_FEED_VIDEO_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_GAMING_CUSTOM_UPDATE:return d("EchoMessageXMAFieldUtils").XMAContentType.FB_GAMING_CUSTOM_UPDATE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_PRODUCER_STORY_REPLY:return d("EchoMessageXMAFieldUtils").XMAContentType.FB_PRODUCER_STORY_REPLY;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_EXTERNAL_LINK_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.MSG_EXTERNAL_LINK_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_AUDIO_CALL:return d("EchoMessageXMAFieldUtils").XMAContentType.RTC_AUDIO_CALL;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_VIDEO_CALL:return d("EchoMessageXMAFieldUtils").XMAContentType.RTC_VIDEO_CALL;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_AUDIO_CALL:return d("EchoMessageXMAFieldUtils").XMAContentType.RTC_MISSED_AUDIO_CALL;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_VIDEO_CALL:return d("EchoMessageXMAFieldUtils").XMAContentType.RTC_MISSED_VIDEO_CALL;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_AUDIO_CALL:return d("EchoMessageXMAFieldUtils").XMAContentType.RTC_GROUP_AUDIO_CALL;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_VIDEO_CALL:return d("EchoMessageXMAFieldUtils").XMAContentType.RTC_GROUP_VIDEO_CALL;default:d("WALogger").ERROR(h(),a);return d("EchoMessageXMAFieldUtils").XMAContentType.NONE}}g.convertExtendedContentTargetTypeToXMATargetType=a}),98);
__d("MAWConvertExtendedContentXMLLayoutTypeToXMALayoutType",["EchoMessageXMAFieldUtils","WAArmadilloXMA.pb","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Not a valid ExtendedContentXMLLayoutType: ",""]);h=function(){return a};return a}function a(a){switch(a){case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_XMA_LAYOUT_TYPE.SINGLE:return d("EchoMessageXMAFieldUtils").XMALayoutType.SINGLE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_XMA_LAYOUT_TYPE.PORTRAIT:return d("EchoMessageXMAFieldUtils").XMALayoutType.PORTRAIT;default:d("WALogger").ERROR(h(),a);return d("EchoMessageXMAFieldUtils").XMALayoutType.SINGLE}}g.convertExtendedContentXMLLayoutTypeToXMALayoutType=a}),98);
__d("MAWDbEditMsgHistoryTxns",["MAWDexieTable"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return b==null?d("MAWDexieTable").dexieResolve():a.editMsgHistory.get({editMsgHistoryId:b})}function b(a,b){return b==null?d("MAWDexieTable").dexieResolve([]):a.editMsgHistory.where("originalMsgExternalId").equals(b.externalId).filter(function(a){return a.author===b.author&&a.threadJid===b.chat}).toArray().then(function(a){var b=[];a.forEach(function(a){if(a==null)return;b.push(a)});return b})}function c(a,b){return a.editMsgHistory.bulkGet(b)}function e(a,b,c,d){return d.then(function(d){return h(a,b,c,d)})}function h(a,b,c,d){var e=[];return a.editMsgHistory.where("originalMsgExternalId").equals(b).filter(function(a){return a.threadJid===d&&a.author===c}).toArray().then(function(a){a.forEach(function(a){e.push({messageId:a.editExternalId,originalMessageId:a.originalMsgExternalId,text:a.msgContent.content,timestamp:(a=a.editTs)!=null?a:0})});return e})}function f(a,b,c,d){return a.editMsgHistory.where("originalMsgExternalId").equals(b).filter(function(a){return a.threadJid===d&&a.author===c})["delete"]().then(function(){})}g.maybeGetEditMsgHistoryFromEditMsgHistoryId=a;g.maybeGetEditMsgHistoryFromProtocolMsgId=b;g.bulkGetEditMsgHistorys=c;g.getEditHistoryAsEchoWithJidPromise=e;g.getEditHistoryAsEcho=h;g.bulkRemoveEditHistory=f}),98);
__d("MAWEBUploadMessageUtils",["I64","MAWDbMsg","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[sortOrder] externalId is not a valid int64"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[sortOrder] Timestamp bits in externalId not valid"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[sortOrder] ExternalId is not present for ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["echoOverrideMessageSortOrder called without ID"]);l=function(){return a};return a}var m=2199023255551;function a(a){var b=a.revokedExternalId!=null?a.revokedExternalId:a.externalId;b==null&&d("WALogger").ERROR(l());b=(h||(h=d("I64"))).of_string_opt(b);if(a.serverTs==null){if(a.sortOrderMs!=null)return a.sortOrderMs;b==null&&d("WALogger").WARN(k(),a.type);var c=b==null?null:o(b);return d("MAWDbMsg").getCanonicalTsFromMsg(a)*1e3+((c=c)!=null?c:0)}if(b!=null){c=o(b);if(c!=null){b=a.originalTs!=null?a.originalTs:a.serverTs;return Number(b)*1e3+c}else d("WALogger").WARN(j())}else d("WALogger").WARN(i());return d("MAWDbMsg").getSortOrderWithFallback(a)}function n(a){return new Date(a).getTime()>0}function o(a){a=Number((h||(h=d("I64"))).to_string(h.and_(h.lsr_(a,22),h.of_float(m))));if(n(a)){a=Math.floor(Number(a)%1e5/100);return a}}g.echoOverrideMessageSortOrder=a}),98);
__d("MAWEncryptedBackupCacheManager",[],(function(a,b,c,d,e,f){"use strict";var g=new Map(),h=new Map(),i=new Map();function a(a,b){h.set(a,{cache:b,status:"restoring"})}function b(a){a.forEach(function(a){var b=h.get(a);b!=null&&h.set(a,{cache:b.cache,status:"done"})})}function c(a){a=h.get(a);if(a!=null)return a.status;else return"none"}function d(a){return(a=h.get(a))==null?void 0:a.cache}function e(a){return h["delete"](a)}function j(a,b){var c=g.get(a)||new Set();c.add(b);g.set(a,c)}function k(a,b){a=g.get(a);return a!=null?a==null?void 0:a.has(b):!1}function l(a,b){a=g.get(a);a!=null&&a["delete"](b)}function m(a){return h.has(a)}function n(a){return i.has(a)}function o(a){return i.get(a)}function p(a){n(a)&&i["delete"](a)}function q(a,b){i.set(a,b)}f.restoredCache=h;f.addMsgEntryToRestoredCache=a;f.setRestoredCacheStatusAsDone=b;f.getRestoredCacheStatus=c;f.getRestoredCache=d;f.removeFromRestoredCache=e;f.addMsgEntryToReuploadCache=j;f.checkForMsgEntryInReuploadCache=k;f.removeMsgEntryFromReuploadCache=l;f.peekRestoreCache=m;f.peekPendingStanzaCache=n;f.getPendingStanzaCacheValue=o;f.removePendingStanzaCacheValue=p;f.addPendingStanzaToPendingStanzaCache=q}),66);
__d("MAWGetAttachmentTypeForServerMediaType",["EchoMessageMediaFieldUtils","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Not a valid AttachmentType: ",""]);h=function(){return a};return a}function a(a){switch(a){case"image":return d("EchoMessageMediaFieldUtils").AttachmentType.IMAGE;case"video":return d("EchoMessageMediaFieldUtils").AttachmentType.VIDEO;case"ptt":return d("EchoMessageMediaFieldUtils").AttachmentType.PTT;case"gif":return d("EchoMessageMediaFieldUtils").AttachmentType.GIF;case"sticker":return d("EchoMessageMediaFieldUtils").AttachmentType.STICKER;case"xma-image":return d("EchoMessageMediaFieldUtils").AttachmentType.XMA;case"document":return d("EchoMessageMediaFieldUtils").AttachmentType.DOCUMENT;default:d("WALogger").WARN(h(),a);return null}}g.getAttachmentTypeForServerMediaType=a}),98);
__d("MAWGetMediaAttachmentTypeForServerMediaType",["EchoMessageMediaFieldUtils","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Not a valid EchoMessageActMediaAttachmentType: ",""]);h=function(){return a};return a}function a(a){switch(a){case"image":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.IMAGE;case"video":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.VIDEO;case"ptt":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.AUDIO;case"gif":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.GIF;case"sticker":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.STICKER;case"audio":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.AUDIO;case"document":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.DOCUMENT;case"ppic":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.PROFILE_PICTURE;case"md-app-state":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.APP_STATE;case"md-msg-hist":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.HISTORY_SYNC;case"thumbnail-image":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.THUMBNAIL_IMAGE;case"thumbnail-video":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.THUMBNAIL_VIDEO;case"thumbnail-gif":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.THUMBNAIL_GIF;case"thumbnail-document":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.THUMBNAIL_DOCUMENT;case"thumbnail-link":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.THUMBNAIL_LINK;case"novi-video":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.NOVI_VIDEO;case"novi-image":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.NOVI_IMAGE;case"xma-image":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.XMA_IMAGE;default:d("WALogger").ERROR(h(),a);return null}}g.getMediaAttachmentTypeForServerMediaType=a}),98);
__d("MAWGetPreviewContentTypeForMediaType",["EchoMessageMediaFieldUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a){case"image":return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.IMAGE_JPEG;case"gif":return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.GIF;case"sticker":return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.STICKER;case"video":return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.AUDIO_MP4;case"ptt":return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.AUDIO_WAV;case"xma-image":return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.IMAGE_JPEG;default:return null}}g.getPreviewContentTypeForMediaType=a}),98);
__d("WAArmadilloApplication.pb",["WAArmadilloXMA.pb","WACommon.pb","WAProtoConst"],(function(a,b,c,d,e,f,g){var h,i;a={ES_OPEN:1,ES_CLOSE:2};b={PAYMENT_UNKNOWN:-1,REQUEST_INITED:4,REQUEST_DECLINED:5,REQUEST_TRANSFER_INITED:6,REQUEST_TRANSFER_COMPLETED:7,REQUEST_TRANSFER_FAILED:8,REQUEST_CANCELED:9,REQUEST_EXPIRED:10,TRANSFER_INITED:11,TRANSFER_PENDING:12,TRANSFER_PENDING_RECIPIENT_VERIFICATION:13,TRANSFER_CANCELED:14,TRANSFER_COMPLETED:15,TRANSFER_NO_RECEIVER_CREDENTIAL_NO_RTS_PENDING_CANCELED:16,TRANSFER_NO_RECEIVER_CREDENTIAL_NO_RTS_PENDING_OTHER:17,TRANSFER_REFUNDED:18,TRANSFER_PARTIAL_REFUND:19,TRANSFER_CHARGED_BACK:20,TRANSFER_EXPIRED:21,TRANSFER_DECLINED:22,TRANSFER_UNAVAILABLE:23};c={SCREENSHOT_IMAGE:1,SCREEN_RECORDING:2};e={PLAYED:0,SCREENSHOT:1,FORCE_DISABLE:2};f={VIEW_ONCE:0,ALLOW_REPLAY:1,KEEP_IN_CHAT:2};var j={SMALL_LIKE:1,MEDIUM_LIKE:2,LARGE_LIKE:3},k={},l={},m={},n={},o={},p={},q={},r={},s={},t={},u={},v={},w={},x={},y={},z={},A={},B={},C={},D={},E={},F={},G={},H={},I={},J={},K={},L={},M={};k.internalSpec={payload:[1,(h=d("WAProtoConst")).TYPES.MESSAGE,m],metadata:[2,h.TYPES.MESSAGE,l]};l.internalSpec={};m.internalSpec={content:[1,h.TYPES.MESSAGE,D],applicationData:[2,h.TYPES.MESSAGE,r],signal:[3,h.TYPES.MESSAGE,o],subProtocol:[4,h.TYPES.MESSAGE,n],__oneofs__:{payload:["content","applicationData","signal","subProtocol"]}};n.internalSpec={futureProof:[1,h.TYPES.ENUM,(i=d("WACommon.pb")).FUTURE_PROOF_BEHAVIOR]};o.internalSpec={encryptedBackupsSecrets:[1,h.TYPES.MESSAGE,p],__oneofs__:{signal:["encryptedBackupsSecrets"]}};p.internalSpec={backupId:[1,h.TYPES.UINT64],serverDataId:[2,h.TYPES.UINT64],epoch:[3,h.FLAGS.REPEATED|h.TYPES.MESSAGE,q],tempOcmfClientState:[4,h.TYPES.BYTES],mailboxRootKey:[5,h.TYPES.BYTES],obliviousValidationToken:[6,h.TYPES.BYTES]};q.internalSpec={id:[1,h.TYPES.UINT64],anonId:[2,h.TYPES.BYTES],rootKey:[3,h.TYPES.BYTES],status:[4,h.TYPES.ENUM,a]};r.internalSpec={metadataSync:[1,h.TYPES.MESSAGE,C],aiBotResponse:[2,h.TYPES.MESSAGE,s],__oneofs__:{applicationData:["metadataSync","aiBotResponse"]}};s.internalSpec={summonToken:[1,h.TYPES.STRING],messageText:[2,h.TYPES.STRING],serializedExtras:[3,h.TYPES.STRING]};t.internalSpec={actionTimestamp:[1,h.TYPES.INT64],chatAction:[101,h.TYPES.MESSAGE,w],messageAction:[102,h.TYPES.MESSAGE,u],__oneofs__:{actionType:["chatAction","messageAction"]}};u.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec],messageDelete:[101,h.TYPES.MESSAGE,v],__oneofs__:{action:["messageDelete"]}};v.internalSpec={};w.internalSpec={chatId:[1,h.TYPES.STRING],chatArchive:[101,h.TYPES.MESSAGE,z],chatDelete:[102,h.TYPES.MESSAGE,y],chatRead:[103,h.TYPES.MESSAGE,x],__oneofs__:{action:["chatArchive","chatDelete","chatRead"]}};x.internalSpec={messageRange:[1,h.TYPES.MESSAGE,B],read:[2,h.TYPES.BOOL]};y.internalSpec={messageRange:[1,h.TYPES.MESSAGE,B]};z.internalSpec={messageRange:[1,h.TYPES.MESSAGE,B],archived:[2,h.TYPES.BOOL]};A.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec],timestamp:[2,h.TYPES.INT64]};B.internalSpec={lastMessageTimestamp:[1,h.TYPES.INT64],lastSystemMessageTimestamp:[2,h.TYPES.INT64],messages:[3,h.FLAGS.REPEATED|h.TYPES.MESSAGE,A]};C.internalSpec={actions:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,t]};D.internalSpec={commonSticker:[1,h.TYPES.MESSAGE,M],screenshotAction:[3,h.TYPES.MESSAGE,I],extendedContentMessage:[4,h.TYPES.MESSAGE,d("WAArmadilloXMA.pb").ExtendedContentMessageSpec],ravenMessage:[5,h.TYPES.MESSAGE,L],ravenActionNotifMessage:[6,h.TYPES.MESSAGE,K],extendedMessageContentWithSear:[7,h.TYPES.MESSAGE,J],imageGalleryMessage:[8,h.TYPES.MESSAGE,H],paymentsTransactionMessage:[10,h.TYPES.MESSAGE,E],bumpExistingMessage:[11,h.TYPES.MESSAGE,G],noteReplyMessage:[13,h.TYPES.MESSAGE,F],__oneofs__:{content:["commonSticker","screenshotAction","extendedContentMessage","ravenMessage","ravenActionNotifMessage","extendedMessageContentWithSear","imageGalleryMessage","paymentsTransactionMessage","bumpExistingMessage","noteReplyMessage"]}};E.internalSpec={transactionId:[1,h.TYPES.UINT64],amount:[2,h.TYPES.STRING],currency:[3,h.TYPES.STRING],paymentStatus:[4,h.TYPES.ENUM,b],extendedContentMessage:[5,h.TYPES.MESSAGE,d("WAArmadilloXMA.pb").ExtendedContentMessageSpec]};F.internalSpec={noteId:[1,h.TYPES.STRING],noteText:[2,h.TYPES.MESSAGE,i.MessageTextSpec],noteTimestampMs:[3,h.TYPES.INT64],noteReplyText:[4,h.TYPES.MESSAGE,i.MessageTextSpec]};G.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec]};H.internalSpec={images:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,i.SubProtocolSpec]};I.internalSpec={screenshotType:[1,h.TYPES.ENUM,c]};J.internalSpec={searId:[1,h.TYPES.STRING],payload:[2,h.TYPES.BYTES],nativeUrl:[3,h.TYPES.STRING],searAssociatedMessage:[4,h.TYPES.MESSAGE,i.SubProtocolSpec],searSentWithMessageId:[5,h.TYPES.STRING]};K.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec],actionTimestamp:[2,h.TYPES.INT64],actionType:[3,h.TYPES.ENUM,e]};L.internalSpec={ephemeralType:[1,h.TYPES.ENUM,f],imageMessage:[2,h.TYPES.MESSAGE,i.SubProtocolSpec],videoMessage:[3,h.TYPES.MESSAGE,i.SubProtocolSpec],__oneofs__:{mediaContent:["imageMessage","videoMessage"]}};M.internalSpec={stickerType:[1,h.TYPES.ENUM,j]};g.ARMADILLO_SIGNAL_ENCRYPTED_BACKUPS_SECRETS_EPOCH_EPOCH_STATUS=a;g.ARMADILLO_CONTENT_PAYMENTS_TRANSACTION_MESSAGE_PAYMENT_STATUS=b;g.ARMADILLO_CONTENT_SCREENSHOT_ACTION_SCREENSHOT_TYPE=c;g.ARMADILLO_CONTENT_RAVEN_ACTION_NOTIF_MESSAGE_ACTION_TYPE=e;g.ARMADILLO_CONTENT_RAVEN_MESSAGE_EPHEMERAL_TYPE=f;g.ARMADILLO_CONTENT_COMMON_STICKER_STICKER_TYPE=j;g.ArmadilloSpec=k;g.Armadillo$MetadataSpec=l;g.Armadillo$PayloadSpec=m;g.Armadillo$SubProtocolPayloadSpec=n;g.Armadillo$SignalSpec=o;g.Armadillo$Signal$EncryptedBackupsSecretsSpec=p;g.Armadillo$Signal$EncryptedBackupsSecrets$EpochSpec=q;g.Armadillo$ApplicationDataSpec=r;g.Armadillo$ApplicationData$AIBotResponseMessageSpec=s;g.Armadillo$ApplicationData$MetadataSyncActionSpec=t;g.Armadillo$ApplicationData$MetadataSyncAction$SyncMessageActionSpec=u;g.Armadillo$ApplicationData$MetadataSyncAction$SyncMessageAction$ActionMessageDeleteSpec=v;g.Armadillo$ApplicationData$MetadataSyncAction$SyncChatActionSpec=w;g.Armadillo$ApplicationData$MetadataSyncAction$SyncChatAction$ActionChatReadSpec=x;g.Armadillo$ApplicationData$MetadataSyncAction$SyncChatAction$ActionChatDeleteSpec=y;g.Armadillo$ApplicationData$MetadataSyncAction$SyncChatAction$ActionChatArchiveSpec=z;g.Armadillo$ApplicationData$MetadataSyncAction$SyncActionMessageSpec=A;g.Armadillo$ApplicationData$MetadataSyncAction$SyncActionMessageRangeSpec=B;g.Armadillo$ApplicationData$MetadataSyncNotificationSpec=C;g.Armadillo$ContentSpec=D;g.Armadillo$Content$PaymentsTransactionMessageSpec=E;g.Armadillo$Content$NoteReplyMessageSpec=F;g.Armadillo$Content$BumpExistingMessageSpec=G;g.Armadillo$Content$ImageGalleryMessageSpec=H;g.Armadillo$Content$ScreenshotActionSpec=I;g.Armadillo$Content$ExtendedContentMessageWithSearSpec=J;g.Armadillo$Content$RavenActionNotifMessageSpec=K;g.Armadillo$Content$RavenMessageSpec=L;g.Armadillo$Content$CommonStickerSpec=M}),98);
__d("MAWEphemeralUtils",["MAWEphemeralGatingUtil","MAWGlobals","MAWLocalizationType","WAArmadilloApplication.pb","WAJids","err"],(function(a,b,c,d,e,f,g){"use strict";var h=60,i=60*h,j=24*i;function a(a,b,c,e,f){var g=[],l=a===d("MAWGlobals").getMyUserJid();a=d("WAJids").extractUserId(a).toString();var m=b===j&&d("MAWEphemeralGatingUtil").isSendBasedDisappearingMessageEnabled();b===0?f?f=d("MAWLocalizationType").LOCALIZATION_TYPE.EPHEMERAL_SETTINGS_AUTO_RESET:l?f=d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_OFF:e?f=d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_OFF:(f=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_OFF,g.push(a)):b<h?(l?f=c?d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_SECONDS:d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_SECONDS:e?f=c?d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_SECONDS:d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_SECONDS:(f=c?d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_SECONDS:d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_SECONDS,g.push(a)),g.push(b.toString())):b<i?(l?f=c?d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_MINUTES:d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_MINUTES:e?f=c?d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_MINUTES:d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_MINUTES:(f=c?d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_MINUTES:d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_MINUTES,g.push(a)),g.push((b/h).toString())):b<j||m?(l?f=c?d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_HOURS:d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_HOURS:e?f=c?d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_HOURS:d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_HOURS:(f=c?d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_HOURS:d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_HOURS,g.push(a)),g.push((b/i).toString())):(l?f=c?d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_DAYS:d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_DAYS:e?f=c?d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_DAYS:d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_DAYS:(f=c?d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_DAYS:d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_DAYS,g.push(a)),g.push((b/j).toString()));return{ephemeralSettingChangeContent:g,ephemeralSettingChangeType:k(f)}}function k(a){return!d("MAWEphemeralGatingUtil").isSendBasedDisappearingMessageEnabled()||!(a in l)?a:l[a.toString()]}function b(a,b,e,f){var g,h=[];b=d("WAJids").extractUserId(b).toString();switch(a){case d("WAArmadilloApplication.pb").ARMADILLO_CONTENT_SCREENSHOT_ACTION_SCREENSHOT_TYPE.SCREENSHOT_IMAGE:f?g=d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_TAKE_SCREENSHOT:e?g=d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_TAKE_SCREENSHOT:(g=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_TAKE_SCREENSHOT,h.push(b));break;case d("WAArmadilloApplication.pb").ARMADILLO_CONTENT_SCREENSHOT_ACTION_SCREENSHOT_TYPE.SCREEN_RECORDING:f?g=d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_RECORD_SCREEN:e?g=d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_RECORD_SCREEN:(g=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_RECORD_SCREEN,h.push(b));break;default:throw c("err")("Received unexpected screenshot action type")}return{ephemeralScreenshotActionContent:h,ephemeralScreenshotActionType:g}}var l=(e={},e[(f=d("MAWLocalizationType")).LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_SECONDS]=f.LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_SECONDS,e[f.LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_MINUTES]=f.LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_MINUTES,e[f.LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_HOURS]=f.LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_HOURS,e[f.LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_DAYS]=f.LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_DAYS,e[f.LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_SECONDS]=f.LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_TURNED_ON_SECONDS,e[f.LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_MINUTES]=f.LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_TURNED_ON_MINUTES,e[f.LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_HOURS]=f.LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_TURNED_ON_HOURS,e[f.LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_DAYS]=f.LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_TURNED_ON_DAYS,e[f.LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_SECONDS]=f.LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_SECONDS,e[f.LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_MINUTES]=f.LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_MINUTES,e[f.LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_HOURS]=f.LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_HOURS,e[f.LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_DAYS]=f.LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_DAYS,e[f.LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_SECONDS]=f.LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_SECONDS,e[f.LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_MINUTES]=f.LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_MINUTES,e[f.LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_HOURS]=f.LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_HOURS,e[f.LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_DAYS]=f.LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_DAYS,e[f.LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_SECONDS]=f.LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_CHANGE_SECONDS,e[f.LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_MINUTES]=f.LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_CHANGE_MINUTES,e[f.LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_HOURS]=f.LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_CHANGE_HOURS,e[f.LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_DAYS]=f.LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_CHANGE_DAYS,e[f.LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_SECONDS]=f.LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_CHANGE_SECONDS,e[f.LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_MINUTES]=f.LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_CHANGE_MINUTES,e[f.LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_HOURS]=f.LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_CHANGE_HOURS,e[f.LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_DAYS]=f.LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_CHANGE_DAYS,e);g.getEphemeralSettingChangeData=a;g.getEphemeralScreenshotActionData=b}),98);
__d("MAWDbGroupInfoTxns",["MAWBridgeTypesCreators","MAWIndexedDb","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c){return h(a,c.jid).then(function(d){var e=c.participantVersion;d.success&&d.value.participantVersion!=null&&c.participantVersion==null&&(e=d.value.participantVersion);d=c.subject.content;d!=null&&d.length===0&&(d=void 0);var f={creationTs:c.creationTs,creator:c.creator,groupJid:c.jid,inviter:c.inviter,name:d,nameOwner:c.subject.user,nameTs:c.subject.ts,participantVersion:e,threadId:b};return i(a,f).then(function(){return f})})}function h(a,b){return a.groupInfo.get({groupJid:b}).then(function(a){return a==null?d("WAResultOrError").makeError("missing"):d("WAResultOrError").makeResult(a)})}function i(a,b){return a.groupInfo.put(b).then(function(){d("MAWIndexedDb").afterTransaction({tag:"GroupInfoUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedGroupInfo(b)})})}function b(a,b){return a.groupInfo.bulkPut(b).then(function(){b.forEach(function(a){return d("MAWIndexedDb").afterTransaction({tag:"GroupInfoUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedGroupInfo(a)})})})}function c(a,b){return a.groupInfo.bulkGet(b)}function e(a,b){return a.groupInfo.get({threadId:b}).then(function(a){return a==null?d("WAResultOrError").makeError("missing"):d("WAResultOrError").makeResult(a)})}function f(a,b){return a.groupInfo["delete"](b)}g.putGroupInfo=a;g.getGroupInfo=h;g.updateGroupInfo=i;g.bulkUpdateGroupInfo=b;g.getGroupInfos=c;g.getGroupInfoByThreadId=e;g.deleteGroupInfo=f}),98);
__d("MAWLocalizationUtils",["MAWAckLevel","MAWGlobals","MAWLocalizationType","MAWMsgType","WAJids","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c,e,f){return{ack:d("MAWAckLevel").ACK.sent,altIndex:(f=f)!=null?f:void 0,author:d("WAJids").AUTHOR_SYSTEM,externalId:d("MAWGlobals").getDependencies().generateExternalId(),msgContent:a,thread:b,threadJid:c,ts:(f=e)!=null?f:d("WATimeUtils").unixTime(),type:d("MAWMsgType").MSG_TYPE.ADMIN}}function b(a){switch(a){case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_NAMED_GROUP:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_NAMED_GROUP:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_NAMED_GROUP:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_ONE_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_MORE_THAN_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU_AND_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU_AND_MORE_THAN_ONE_USERS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_MORE_THAN_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_ONE_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_MORE_THAN_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU_AND_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU_AND_MORE_THAN_ONE_USERS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_MORE_THAN_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_LEFT_GROUP:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SELF_DEMOTED:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_PROMOTED_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_DEMOTED_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_GOT_PROMOTED:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_GOT_DEMOTED:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_GOT_PROMOTED:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_GOT_DEMOTED:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_PROMOTED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_DEMOTED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_PROMOTED_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SELF_DEMOTED:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_DEMOTED_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_UPDATED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_UPDATED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_HOTLIKE:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_THEME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_HOTLIKE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_THEME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_PARTICIPANT_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CLEAR_PARTICIPANT_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_CURRENT_USER_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SET_OWN_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CLEAR_OWN_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CLEAR_PARTICIPANT_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SET_OWN_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CLEAR_OWN_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CLEAR_CURRENT_USER_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_MINUTES:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_MINUTES:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_HOURS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_HOURS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_DAYS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_DAYS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_OFF:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_SECONDS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_SECONDS:case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_MINUTES:case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_CHANGE_MINUTES:case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_HOURS:case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_CHANGE_HOURS:case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_DAYS:case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_CHANGE_DAYS:case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_SECONDS:case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_CHANGE_SECONDS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_TAKE_SCREENSHOT:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_RECORD_SCREEN:return!0}return!1}function c(a){switch(a){case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_UPDATED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_UPDATED_DEVICE:return!0}return!1}function e(a){switch(a){case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_ONE_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_MORE_THAN_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU_AND_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU_AND_MORE_THAN_ONE_USERS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_MORE_THAN_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_YOU_AND_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_YOU_AND_MORE_THAN_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_MORE_THAN_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_ONE_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_MORE_THAN_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU_AND_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU_AND_MORE_THAN_ONE_USERS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_MORE_THAN_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_REMOVED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_REMOVED_YOU_AND_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_REMOVED_YOU_AND_MORE_THAN_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_REMOVED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_REMOVED_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_REMOVED_MORE_THAN_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_LEFT_GROUP:return!0}return!1}g.buildUnstoredDbAdminMsg=a;g.isAdminMsgNormalized=b;g.isDeviceChangeAdminMsg=c;g.isParticipantChangeAdminMsg=e}),98);
__d("MAWThreadSnippetForAdminOrEphemeralMsg",["MAWAdminMsgNormalized","MAWLocalizationUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var c=a.msgContent.adminType;a=d("MAWLocalizationUtils").isAdminMsgNormalized(c)?d("MAWAdminMsgNormalized").deconstructContactIdsFromAdminContent(c,a.msgContent.adminMsgContent):{contactIds:[],contents:a.msgContent.adminMsgContent};var e=a.contactIds;a=a.contents;return{snippetParams:{contactIDs:[].concat(e),strings:[].concat(a)},snippetSenderContactId:b,snippetType:c}}g["default"]=a}),98);
__d("MAWThreadSnippetForDocumentFileMsg",["MAWLocalizationType","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Document file message can not have AUTHOR_SYSTEM"]);h=function(){return a};return a}function a(a,b){var c,e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET;c={contactIDs:[],mentionJIDs:(c=a.msgContent)==null?void 0:c.mentionedJids,strings:[]};d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_ATTACHMENT:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(h()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_ATTACHMENT,c.contactIDs.push(b));return{snippetParams:c,snippetSenderContactId:b,snippetType:e}}g["default"]=a}),98);
__d("MAWThreadSnippetForGifMsg",["MAWLocalizationType","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Animated message can not have AUTHOR_SYSTEM"]);h=function(){return a};return a}function a(a,b){var c,e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET;c={contactIDs:[],mentionJIDs:(c=a.msgContent)==null?void 0:c.mentionedJids,strings:[]};d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_GIF:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(h()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_GIF,c.contactIDs.push(b));return{snippetParams:c,snippetSenderContactId:b,snippetType:e}}g["default"]=a}),98);
__d("MAWThreadSnippetForImageMsg",["MAWLocalizationType","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Image message can not have AUTHOR_SYSTEM"]);h=function(){return a};return a}function a(a,b){var c,e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET;c={contactIDs:[],mentionJIDs:(c=a.msgContent)==null?void 0:c.mentionedJids,strings:[]};d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_IMAGE:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(h()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_IMAGE,c.contactIDs.push(b));return{snippetParams:c,snippetSenderContactId:b,snippetType:e}}g["default"]=a}),98);
__d("MAWThreadSnippetForPttMsg",["MAWLocalizationType","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Ptt message can not have AUTHOR_SYSTEM"]);h=function(){return a};return a}function a(a,b){var c,e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET;c={contactIDs:[],mentionJIDs:(c=a.msgContent)==null?void 0:c.mentionedJids,strings:[]};d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_AUDIO:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(h()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_AUDIO,c.contactIDs.push(b));return{snippetParams:c,snippetSenderContactId:b,snippetType:e}}g["default"]=a}),98);
__d("MAWThreadSnippetForRevokedMsg",["MAWLocalizationType","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Revoked message can not have AUTHOR_SYSTEM"]);h=function(){return a};return a}function a(a,b){var c,e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET;c={contactIDs:[],mentionJIDs:(c=a.msgContent)==null?void 0:c.mentionedJids,strings:[]};d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_UNSENT_MESSAGE:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(h()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_UNSENT_MESSAGE,c.contactIDs.push(b));return{snippetParams:c,snippetSenderContactId:b,snippetType:e}}g["default"]=a}),98);
__d("MAWThreadSnippetForStickerMsg",["MAWLocalizationType","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Sticker message can not have AUTHOR_SYSTEM"]);h=function(){return a};return a}function a(a,b){var c,e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET;c={contactIDs:[],mentionJIDs:(c=a.msgContent)==null?void 0:c.mentionedJids,strings:[]};d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_STICKER:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(h()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_STICKER,c.contactIDs.push(b));return{snippetParams:c,snippetSenderContactId:b,snippetType:e}}g["default"]=a}),98);
__d("MAWThreadSnippetForTextMsg",["MAWLocalizationType","MAWVault","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Text message can not have AUTHOR_SYSTEM"]);h=function(){return a};return a}function a(a,b,c){var e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET,f={contactIDs:[],mentionJIDs:a.msgContent.mentionedJids,strings:[]};d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_TEXT:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(h()):(e=c?d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_TEXT_IN_GROUP:d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_TEXT,f.contactIDs.push(b));if(a.specialTextSize===1||a.specialTextSize===2||a.specialTextSize===3){c=d("MAWVault").unvault(a.msgContent.content);f.strings.push(c==="\ud83d\udc4d"?"(Y)":a.msgContent.content)}else f.strings.push(a.msgContent.content);return{snippetParams:f,snippetSenderContactId:b,snippetType:e}}g["default"]=a}),98);
__d("MAWThreadSnippetForVideoMsg",["MAWLocalizationType","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Video message can not have AUTHOR_SYSTEM"]);h=function(){return a};return a}function a(a,b){var c,e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET;c={contactIDs:[],mentionJIDs:(c=a.msgContent)==null?void 0:c.mentionedJids,strings:[]};d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_VIDEO:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(h()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_VIDEO,c.contactIDs.push(b));return{snippetParams:c,snippetSenderContactId:b,snippetType:e}}g["default"]=a}),98);
__d("MAWThreadSnippetForXMAMsg",["MAWJids","MAWLocalizationType","WAArmadilloXMA.pb","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Encountered unexpected XMAMessageType when building a thread snippet"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA story mentions must have a target Jid"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose(["XMA message does not have xmaMessageType"]);x=function(){return a};return a}function a(a,b){var c,e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET;c={contactIDs:[],mentionJIDs:(c=a.msgContent)==null?void 0:c.mentionedJids,strings:[]};a.xmaMessageType==null&&d("WALogger").ERROR(x());switch(a.xmaMessageType){case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_GAMING_CUSTOM_UPDATE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_RECEIVER_FETCH:d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_ATTACHMENT:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(w()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_ATTACHMENT,c.contactIDs.push(b));break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_EXTERNAL_LINK_SHARE:if(d("WAJids").isAuthorMe(a.author)){var f;if(a.msgContent!=null&&((f=a.msgContent)==null?void 0:f.content)!=null){e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_TEXT;c.strings.push((f=a.msgContent)==null?void 0:f.content)}else e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_ATTACHMENT}else if(d("WAJids").isAuthorSystem(a.author)||b==null)d("WALogger").ERROR(v());else{e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_TEXT;c.contactIDs.push(b);if(a.msgContent!=null&&((f=a.msgContent)==null?void 0:f.content)!=null){c.strings.push((f=a.msgContent)==null?void 0:f.content)}}break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_SHARE:d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SENT_STORY:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(u()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SENT_STORY,c.contactIDs.push(b));break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_CLIPS_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_SHORT:d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SENT_REEL:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(t()):e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SENT_REEL;break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_POST_PRIVATE_REPLY:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_MULTIPOST_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_IMAGE_POST_SHARE:d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SENT_POST:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(s()):e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SENT_POST;break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REPLY:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REACTION:d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SENT_STORY:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(r()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SENT_STORY,c.contactIDs.push(b));break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_HIGHLIGHT_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_HIGHLIGHT_SHARE:d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SENT_STORY_HIGHLIGHT:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(q()):e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SENT_STORY_HIGHLIGHT;break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_MENTION:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_MENTION:if(d("WAJids").isAuthorMe(a.author)){e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_MENTIONED_STORY_IG;f=a.threadJid;var g;f!=null&&(g=d("WAJids").interpretAsUserJid(f));if(g!=null){f=d("MAWJids").userIdFromJid(g);c.contactIDs.push(f)}else d("WALogger").ERROR(p())}else d("WAJids").isAuthorSystem(a.author)?d("WALogger").ERROR(o()):e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_RECEIVED_STORY_MENTION_IG;break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_AUDIO_CALL:d("WAJids").isAuthorMe(a.author)&&b!=null?(e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_AUDIO_CALLED,c.contactIDs.push(b)):d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(n()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_AUDIO_CALLED,c.contactIDs.push(b));break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_VIDEO_CALL:d("WAJids").isAuthorMe(a.author)&&b!=null?(e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_VIDEO_CALLED,c.contactIDs.push(b)):d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(m()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_VIDEO_CALLED,c.contactIDs.push(b));break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_AUDIO_CALL:d("WAJids").isAuthorMe(a.author)&&b!=null?(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_MISSED_AUDIO_CALL,c.contactIDs.push(b)):d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(l()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_MISSED_AUDIO_CALL,c.contactIDs.push(b));break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_VIDEO_CALL:d("WAJids").isAuthorMe(a.author)&&b!=null?(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_MISSED_VIDEO_CALL,c.contactIDs.push(b)):d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(k()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_MISSED_VIDEO_CALL,c.contactIDs.push(b));break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_AUDIO_CALL:d("WAJids").isAuthorMe(a.author)&&b!=null?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_STARTED_GROUP_AUDIO_CALL:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(j()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_STARTED_GROUP_AUDIO_CALL,c.contactIDs.push(b));break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_VIDEO_CALL:d("WAJids").isAuthorMe(a.author)&&b!=null?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_STARTED_GROUP_VIDEO_CALL:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(i()):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_STARTED_GROUP_VIDEO_CALL,c.contactIDs.push(b));break;default:d("WALogger").ERROR(h())}return{snippetParams:c,snippetSenderContactId:b,snippetType:e}}g["default"]=a}),98);
__d("MAWEphemeralMsgUtils",[],(function(a,b,c,d,e,f){"use strict";function a(a){return function(b){return!a.has(b.msgId)&&b.ephemeralMsgDisappeared!==!0}}f.filterNonExpiredMsg=a}),66);
__d("MAWThreadSnippetUtils",["MAWEphemeralMsgUtils","MAWLocalizationType","MAWLocalizationUtils","MAWMsgType","MAWXMAUtils","qex"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){var e;if(a.type===d("MAWMsgType").MSG_TYPE.REVOKED)return!0;if(d("MAWXMAUtils").isXMAStoryReply(a.xmaMessageType))return!0;e=((e=a.msgContent)==null?void 0:e.adminType)!=null?d("MAWLocalizationUtils").isDeviceChangeAdminMsg(a.msgContent.adminType):!1;if(c("qex")._("794")===!0&&a.sortOrderMs!=null&&(b==null?void 0:b.newestMsgTs)!=null&&a.sortOrderMs<b.newestMsgTs&&!e)return!0;if(a.type!==d("MAWMsgType").MSG_TYPE.ADMIN)return!1;b=a.msgContent.adminType;return b===d("MAWLocalizationType").LOCALIZATION_TYPE.DEBUG_MSG?!0:e}function a(a,b,c){return a.messages.where("[thread+sortOrderMs]").between([b.chatId,Number.MIN_SAFE_INTEGER],[b.chatId,Number.MAX_SAFE_INTEGER],!1,!1).filter(function(a){return(c==null||d("MAWEphemeralMsgUtils").filterNonExpiredMsg(c)(a))&&!h(a)}).reverse().first()}g.isDbMsgDisabledForThreadSnippet=h;g.findMostRecentSnippetMsgFromThread=a}),98);
__d("WAProtocolMsgId",[],(function(a,b,c,d,e,f){function a(a,b){return a.externalId===b.externalId&&a.author===b.author&&a.chat===b.chat}f.equals=a}),66);
__d("MAWThreadSnippetBuildTxns",["FBLogger","MAWBridgeTypesCreators","MAWDbGroupInfoTxns","MAWDbMsg","MAWDexieTable","MAWGlobals","MAWIndexedDb","MAWJidUtils","MAWJids","MAWLocalizationType","MAWMsgType","MAWThreadSnippetForAdminOrEphemeralMsg","MAWThreadSnippetForDocumentFileMsg","MAWThreadSnippetForGifMsg","MAWThreadSnippetForImageMsg","MAWThreadSnippetForPttMsg","MAWThreadSnippetForRevokedMsg","MAWThreadSnippetForStickerMsg","MAWThreadSnippetForTextMsg","MAWThreadSnippetForVideoMsg","MAWThreadSnippetForXMAMsg","MAWThreadSnippetUtils","WAJids","WAProtocolMsgId","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return/^\d+$/.test(a)}function i(a){if(d("WAJids").isAuthorSystem(a))return;a=d("WAJids").isAuthorMe(a)?d("MAWJids").userIdFromJid(d("MAWGlobals").getMyUserJid()):d("MAWJids").userIdFromJid(a);if(!h(a)){c("FBLogger")("mpf_web_foundations").mustfix("[MAWThreadSnippetBuildTxns] Snippet sender contact id is invalid");return}return a}function j(a,b,e){var f=i(b.author);return d("MAWDexieTable").dexieAll([d("MAWDbGroupInfoTxns").getGroupInfoByThreadId(a,e.chatId)]).then(function(a){a=a[0];a=a.success;switch(b.type){case d("MAWMsgType").MSG_TYPE.TEXT:return c("MAWThreadSnippetForTextMsg")(b,f,a);case d("MAWMsgType").MSG_TYPE.IMAGE:return c("MAWThreadSnippetForImageMsg")(b,f);case d("MAWMsgType").MSG_TYPE.VIDEO:return c("MAWThreadSnippetForVideoMsg")(b,f);case d("MAWMsgType").MSG_TYPE.PTT:return c("MAWThreadSnippetForPttMsg")(b,f);case d("MAWMsgType").MSG_TYPE.ADMIN:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:return c("MAWThreadSnippetForAdminOrEphemeralMsg")(b,f);case d("MAWMsgType").MSG_TYPE.GIF:return c("MAWThreadSnippetForGifMsg")(b,f);case d("MAWMsgType").MSG_TYPE.STICKER:return c("MAWThreadSnippetForStickerMsg")(b,f);case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:return c("MAWThreadSnippetForDocumentFileMsg")(b,f);case d("MAWMsgType").MSG_TYPE.REVOKED:return c("MAWThreadSnippetForRevokedMsg")(b,f);case d("MAWMsgType").MSG_TYPE.XMA:return c("MAWThreadSnippetForXMAMsg")(b,f);default:return{snippetParams:{contactIDs:[],strings:[]},snippetSenderContactId:f,snippetType:d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET}}})}function a(a,b,c,e){return d("MAWDexieTable").dexieAll([d("MAWDbGroupInfoTxns").getGroupInfoByThreadId(a,e)]).then(function(a){a=a[0];a=a.success;return k(b,c,a)})}function k(a,b,e){var f;d("WAJids").isAuthorMe(a)?(c("FBLogger")("mpf_web_foundations").warn("[MAWThreadSnippetBuildTxns] Reaction snippet author should not be @me"),f=d("MAWJids").userIdFromJid(d("MAWGlobals").getMyUserJid())):f=d("MAWJids").userIdFromJid(a);a={contactIDs:[],strings:[]};e=e?d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REACT_MESSAGE_IN_GROUP:d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REACT_MESSAGE;a.contactIDs.push(f);a.strings.push(b);return{snippetParams:a,snippetSenderContactId:f,snippetType:e}}function b(a,b,c,e){var f=c.newestReaction,g=c.reactionsToClear;if(f!=null&&d("WATimeUtils").castUnixTimeToMillisTime(f.ts)>((c=b.snippetMsgTs)!=null?c:0))return d("MAWDexieTable").dexieResolve(l(b,f,e));return g!=null&&b.snippetMsg!=null?a.reactions.get({reactionId:b.snippetMsg}).then(function(c){var e=!1;if(c==null)e=!0;else{var f=d("MAWJidUtils").maybeToProtocolMsgId(c.author,c.threadJid,c.reactToExternalId);f!=null&&(e=g.some(function(a){a=d("MAWJidUtils").maybeToProtocolMsgId(a.author,a.threadJid,a.reactToExternalId);return a!=null&&d("WAProtocolMsgId").equals(a,f)}))}return e?m(a,b):d("MAWDexieTable").dexieResolve(b)}):d("MAWDexieTable").dexieResolve(b)}function l(a,b,c){var e=d("WATimeUtils").castUnixTimeToMillisTime(b.ts);c=k(b.author,b.reaction,c);var f=c.snippetParams,g=c.snippetSenderContactId;c=c.snippetType;d("MAWIndexedDb").afterTransaction({tag:"ThreadBumped",value:d("MAWBridgeTypesCreators").createBridgeBumpedThread(a.chatId,a.jid,e,a.lastReadMsgTs,c,f,g)});d("MAWIndexedDb").afterTransaction({tag:"ThreadBumpedServer",value:{isCurrentDeviceSendingMsg:!1,lastActivityTs:e,threadId:a.chatId}});return babelHelpers["extends"]({},a,{snippetMsg:b.reactionId,snippetMsgTs:d("WATimeUtils").castUnixTimeToMillisTime(b.ts)})}function m(a,b){return d("MAWThreadSnippetUtils").findMostRecentSnippetMsgFromThread(a,b).then(function(c){if(c==null){d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({chatJid:b.jid,snippetParams:{contactIDs:[],strings:[]},snippetSenderContactId:"0",snippetType:d("MAWLocalizationType").LOCALIZATION_TYPE.EMPTY_SNIPPET,threadId:b.chatId})});return babelHelpers["extends"]({},b,{snippetMsg:void 0,snippetMsgTs:void 0})}return j(a,c,b).then(function(a){var e=a.snippetParams,f=a.snippetSenderContactId;a=a.snippetType;d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({chatJid:b.jid,snippetParams:e,snippetSenderContactId:f,snippetType:a,threadId:b.chatId})});return babelHelpers["extends"]({},b,{snippetMsg:c.msgId,snippetMsgTs:d("WATimeUtils").castUnixTimeToMillisTime(d("MAWDbMsg").getCanonicalTsFromMsg(c))})})})}function e(a,b){return m(a,b).then(function(b){return a.threads.put(b).then(function(){})})}g.getSnippetContactId=i;g.buildThreadSnippet=j;g.buildReactionThreadSnippet=a;g.getThreadChangesetForReactionChanges=b;g.refreshThreadSnippet=e}),98);
__d("MAWEphemeralAdminMsgBuildTxns",["MAWAckLevel","MAWAdminMsgTxnsUtils","MAWBridgeMsg","MAWBridgeTypesCreators","MAWDbContactsTxns","MAWDbMsgTxns","MAWDexieTable","MAWEphemeralUtils","MAWGlobals","MAWIndexedDb","MAWMsgType","MAWThreadSnippetBuildTxns","MAWWriteMsgTxns","WAJids","err"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e,f,g,h,i,j){return d("MAWDbContactsTxns").maybeGetContactName(a,b).then(function(k){var l=d("MAWAdminMsgTxnsUtils").isUnknownName(k);if(e<0)throw c("err")("Received unexpected ephemeral time setting");k=d("MAWEphemeralUtils").getEphemeralSettingChangeData(b,e,h,l,i);var m=k.ephemeralSettingChangeContent;k=k.ephemeralSettingChangeType;var n={ack:d("MAWAckLevel").ACK.sent,altIndex:void 0,author:b,msgContent:{adminMsgContent:m,adminType:k,version:1},type:d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN};m=j!=null?d("MAWDbMsgTxns").maybeGetMsgByExternalId(a,j,g.chatId,b):d("MAWDexieTable").dexieResolve();return m.then(function(c){if(c==null){var e,h=babelHelpers["extends"]({},n,{externalId:(e=j)!=null?e:d("MAWGlobals").getDependencies().generateExternalId(),thread:g.chatId,threadJid:g.jid,ts:f});return d("MAWWriteMsgTxns").writeMsg(a,h,g).then(function(a){l&&d("MAWAdminMsgTxnsUtils").afterTransactionFetchContactsNames([b]);return babelHelpers["extends"]({},h,{msgId:a.msgId,rowId:a.rowId})})}else if(c.type===d("MAWMsgType").MSG_TYPE.CIPHERTEXT){var i=babelHelpers["extends"]({},c,n);return a.messages.put(i).then(function(){d("MAWIndexedDb").afterTransaction({tag:"DeleteMessages",value:d("MAWBridgeTypesCreators").createBridgeDeleteMessages(c.thread,[c])});d("MAWIndexedDb").afterTransaction({tag:"NewMsg",value:d("MAWBridgeMsg").createBridgeMsg(i)});if(i.msgId===g.newestMsg)return d("MAWThreadSnippetBuildTxns").buildThreadSnippet(a,i,g).then(function(a){var b=a.snippetParams,c=a.snippetSenderContactId;a=a.snippetType;d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({chatJid:g.jid,snippetParams:b,snippetSenderContactId:c,snippetType:a,threadId:g.chatId})});return i});l&&d("MAWAdminMsgTxnsUtils").afterTransactionFetchContactsNames([b]);return i})}else return null})})}function b(a,b,c,e,f,g,h,i){var j=d("MAWAdminMsgTxnsUtils").isUnknownName(h);h=b===d("MAWGlobals").getMyUserJid();var k=d("MAWEphemeralUtils").getEphemeralScreenshotActionData(f,b,j,h),l=k.ephemeralScreenshotActionContent;k=k.ephemeralScreenshotActionType;if(i==null){var m={ack:d("MAWAckLevel").ACK.received,altIndex:void 0,author:h?d("WAJids").AUTHOR_ME:b,externalId:g,msgContent:{adminMsgContent:l,adminType:k,screenshotActionType:f,version:1},thread:c.chatId,threadJid:c.jid,ts:e,type:d("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION};return d("MAWWriteMsgTxns").writeMsg(a,m,c).then(function(a){j&&d("MAWAdminMsgTxnsUtils").afterTransactionFetchContactsNames([b]);return babelHelpers["extends"]({},m,{msgId:a.msgId,rowId:a.rowId})})}else if(i.type===d("MAWMsgType").MSG_TYPE.CIPHERTEXT){var n=babelHelpers["extends"]({},i,{ack:d("MAWAckLevel").ACK.received,altIndex:void 0,author:h?d("WAJids").AUTHOR_ME:b,msgContent:{adminMsgContent:l,adminType:k,screenshotActionType:f,version:1},type:d("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION});return a.messages.put(n).then(function(){d("MAWIndexedDb").afterTransaction({tag:"DeleteMessages",value:d("MAWBridgeTypesCreators").createBridgeDeleteMessages(i.thread,[i])});d("MAWIndexedDb").afterTransaction({tag:"NewMsg",value:d("MAWBridgeMsg").createBridgeMsg(n)});if(n.msgId===c.newestMsg)return d("MAWThreadSnippetBuildTxns").buildThreadSnippet(a,n,c).then(function(a){var b=a.snippetParams,e=a.snippetSenderContactId;a=a.snippetType;d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({chatJid:c.jid,snippetParams:b,snippetSenderContactId:e,snippetType:a,threadId:c.chatId})});return n});j&&d("MAWAdminMsgTxnsUtils").afterTransactionFetchContactsNames([b]);return n})}else return d("MAWDexieTable").dexieResolve(null)}g.writeEphemeralSettingAdminMsg=a;g.writeEphemeralScreenshotActionMsg=b}),98);
__d("MAWMsgCleaner",["MAWLoggerUtils","Promise","WAAssertUnreachable","WAShiftTimer","WATagsLogger","WATimeUtils","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["","::_purgeNow "," msgs' content cleaned"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["","::_purgeNow"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["","::update ",""]);k=function(){return a};return a}a="Unsend";e="Ephemeral";f="DeleteForMe";var l="PendingStanza",m="Xma";f={DELETE_FOR_ME:f,EPHEMERAL:e,PENDING_STANZA:l,UNSEND:a,XMA:m};e=function(){function a(a,b){var e=this;this.$1=new(d("WAShiftTimer").ShiftTimer)(function(){c("promiseDone")(e.$2())});this.getNextTs=a.getNextTs;this.removeExpired=a.removeExpired;this.cleanerType=b;this.purgeEnabled=a.purgeEnabled;this.$1.forceRunNow()}var e=a.prototype;e.update=function(a){var b=n(this.cleanerType);d("WATagsLogger").TAGS([b,d("MAWLoggerUtils").Tag.MsgCleaner,d("MAWLoggerUtils").Tag.CleanerUpdate]).LOG(k(),b,a);this.$1.onOrBefore(d("WATimeUtils").cappedMillisecondsUntil(a))};e.$2=function(){var a=this;if(!this.purgeEnabled())return(h||(h=b("Promise"))).resolve();var c=n(this.cleanerType);d("WATagsLogger").TAGS([c,d("MAWLoggerUtils").Tag.MsgCleaner,d("MAWLoggerUtils").Tag.CleanerPurge]).LOG(j(),c);return this.removeExpired().then(function(b){b>0&&d("WATagsLogger").TAGS([c,d("MAWLoggerUtils").Tag.MsgCleaner,d("MAWLoggerUtils").Tag.CleanerPurge]).LOG(i(),c,b);return a.getNextTs()}).then(function(b){b!=null&&a.update(b)})};return a}();function n(a){switch(a){case"Unsend":return"UnsendMsgCleaner";case"Ephemeral":return"EphemeralCleaner";case"DeleteForMe":return"DeleteForMeCleaner";case"PendingStanza":return"PendingStanzaCleaner";case"Xma":return"XmaCleaner";default:return c("WAAssertUnreachable")(a)}}l=e;g.CLEANER_TYPE=f;g.MsgCleaner=e;g.MSG_CLEANER_FOR_TESTING_ONLY=l}),98);
__d("MAWEphemeralCleaner",["MAWLoggerUtils","MAWMsgCleaner","WATagsLogger","err"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["EphemeralCleaner: Adding timestamps for UI(",") and backend(",")"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["startEphemeralCleaner invoked"]);j=function(){return a};return a}var k=null;function a(a){var b=a.backendFns;a=a.uiFns;d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.Ephemeral,d("MAWLoggerUtils").Tag.MsgCleaner,d("MAWLoggerUtils").Tag.CleanerStart]).LOG(j());if(k==null){var c;k={backend:new((c=d("MAWMsgCleaner")).MsgCleaner)(b,c.CLEANER_TYPE.EPHEMERAL),ui:new c.MsgCleaner(a,c.CLEANER_TYPE.EPHEMERAL)}}}function b(a,b){if(k==null){var e="Trying to add new ephemeral timestamp before the cleaner is initialized!";d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.Ephemeral,d("MAWLoggerUtils").Tag.MsgCleaner,d("MAWLoggerUtils").Tag.CleanerTimestamp]).ERROR(i(),e);throw c("err")(e)}else{e=k;var f=e.backend;e=e.ui;d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.Ephemeral,d("MAWLoggerUtils").Tag.MsgCleaner,d("MAWLoggerUtils").Tag.CleanerTimestamp]).DEV(h(),a,b);e.update(a);f.update(b)}}function e(){return k}function f(){k=null}g.startEphemeralCleaner=a;g.addNewEphemeralTimestamp=b;g.getEphemeralCleaner_FOR_TESTING_ONLY=e;g.resetEphemeralCleaner_FOR_TESTING_ONLY=f}),98);
__d("WAGetHashFromProtocolMsgId",[],(function(a,b,c,d,e,f){function a(a){return a.externalId+"_"+a.author+"_"+a.chat}f.getHashFromProtocolMsgId=a}),66);
__d("MAWEphemeralMsgTxns",["MAWBridgeMsgCountdown","MAWBridgeTypesCreators","MAWDbMsg","MAWDbMsgTxns","MAWDbThreadTxns","MAWDbXMATxns","MAWDexieTable","MAWEphemeralCleaner","MAWEphemeralConsts","MAWEphemeralMsgUtils","MAWEphemeralSettingsTxns","MAWIndexedDb","MAWLocalizationType","MAWLoggerUtils","MAWThreadSnippetBuildTxns","MAWThreadSnippetUtils","MAWXMAUtils","WAGetHashFromProtocolMsgId","WAJids","WATagsLogger","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["incoming msg is not out of sync"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["incoming msg is out of sync: correct duration ",", correct timestamp ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["incoming msg is ephemeral: duration ",", timestamp ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["incoming msg is non-ephemeral"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["maybeUpdateEphemeralSettingOrCheckOutOfSyncAfterWritingIncomingMsg: Message from ",", chat ",", type ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["trying to update ephemeral timestamp to a later ts then previously set - expiration: "," ",", deletion: ","  ",", storedTs: ",", readTs: ",", ephemeralDuration ","  - ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["updating ephemeral timestamp msg ",", existing expiration ",", existing deletion ",", updated expiration ",", updated deletion ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["markEphemeralMessageAsSent EphemeralCounter: Showing UI counter for ",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["bulkMarkEphemeralMessageAsRead EphemeralCounter: Showing UI counter for ",""]);q=function(){return a};return a}var r=d("WATagsLogger").TAGS([(h=d("MAWLoggerUtils")).Tag.Ephemeral,h.Tag.SettingSync,h.Tag.Incoming]),s=d("WATagsLogger").TAGS([h.Tag.Ephemeral,h.Tag.OnRead,h.Tag.Countdown]);function t(a,b,c,d){d===void 0&&(d=function(){return!0});return a.messages.where("msgId").between(b,c,!1,!0).filter(d).limit(1).toArray().then(function(a){return{needsUpdate:!0,value:(a=a[0])!=null?a:null}})}function u(a,b,c){return c.size===0?d("MAWDexieTable").dexieResolve():d("MAWDbThreadTxns").getThread(a,b).then(function(e){if(!e.success)return;var f=e.value,g=f.oldestMsg,h=f.newestMsg;if(g==null||h==null)return;e=d("MAWEphemeralMsgUtils").filterNonExpiredMsg(c);var i=c.has(g)?t(a,g,h,e):d("MAWDexieTable").dexieResolve({needsUpdate:!1});e=c.has(h)?a.messages.where("msgId").between(g,h,!0,!1).filter(e).reverse().limit(1).toArray().then(function(b){b=b[0];return b!=null&&d("MAWThreadSnippetUtils").isDbMsgDisabledForThreadSnippet(b)?d("MAWThreadSnippetUtils").findMostRecentSnippetMsgFromThread(a,f,c).then(function(a){return{needsUpdate:!0,value:(a=a)!=null?a:null}}):{needsUpdate:!0,value:(b=b)!=null?b:null}}):d("MAWDexieTable").dexieResolve({needsUpdate:!1});return d("MAWDexieTable").dexieAll([i,e]).then(function(c){var e=c[0],i=c[1];if(!e.needsUpdate&&!i.needsUpdate)return;c=i.needsUpdate?(c=(c=i.value)==null?void 0:c.msgId)!=null?c:void 0:h;var j=i.needsUpdate?i.value!=null?d("WATimeUtils").castUnixTimeToMillisTime(d("MAWDbMsg").getCanonicalTsFromMsg(i.value)):void 0:f.snippetMsgTs,k=babelHelpers["extends"]({},f,{newestMsg:c,oldestMsg:e.needsUpdate?(e=(e=e.value)==null?void 0:e.msgId)!=null?e:null:g,snippetMsg:c,snippetMsgTs:j});return a.threads.put(k).then(function(){if(i.needsUpdate){var c=i.value;if(c==null)d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({chatJid:k.jid,snippetParams:{contactIDs:[],strings:[]},snippetSenderContactId:"0",snippetType:d("MAWLocalizationType").LOCALIZATION_TYPE.EMPTY_SNIPPET,threadId:b})});else return d("MAWThreadSnippetBuildTxns").buildThreadSnippet(a,c,k).then(function(a){var c=a.snippetParams,e=a.snippetSenderContactId;a=a.snippetType;d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({chatJid:k.jid,snippetParams:c,snippetSenderContactId:e,snippetType:a,threadId:b})})})}})})})}function a(a,b){var c={};b.map(function(a){var b=a.msgId;a=a.ts;b=d("WAGetHashFromProtocolMsgId").getHashFromProtocolMsgId(b);c[b]=a});return d("MAWDbMsgTxns").getMsgsByProtocolMsgId(a,b.map(function(a){return babelHelpers["extends"]({},a.msgId)})).then(function(b){b=b.msgs;b=b.map(function(a){var b,e=a.author;if(a.threadJid==null||d("WAJids").isAuthorSystem(e))return null;e=d("WAGetHashFromProtocolMsgId").getHashFromProtocolMsgId({author:e,chat:a.threadJid,externalId:a.externalId});e=c[e];b=(b=a.ephemeralSetting)==null?void 0:b.ephemeralExpirationInSec;if(b==null||b===0)return null;b=d("WATimeUtils").castToUnixTime(e+b);var f=d("WATimeUtils").castToUnixTime(b+d("MAWEphemeralConsts").ephemeralReportingWindowInSeconds);return{messageDeleteTs:f,messageExpirationTs:b,msgId:a.msgId,readTsForLogging:e}}).filter(Boolean);return v(a,b,"bulkMarkEphemeralMessageAsRead")}).then(function(a){var b=a[0],c=a[1];a=a[2];a.length>0&&(s.LOG(q(),a.map(function(a){return a.msgId})),d("MAWIndexedDb").afterTransaction({tag:"MsgsStartCountdown",value:d("MAWBridgeMsgCountdown").createBridgeMsgsStartCountdown(a)}));b!=null&&c!=null&&d("MAWEphemeralCleaner").addNewEphemeralTimestamp(b,c)})}function b(a,b){if(b==null||b.ephemeralSetting==null||b.ephemeralSetting.ephemeralExpirationInSec===0)return d("MAWDexieTable").dexieResolve();var c=d("WATimeUtils").castToUnixTime(b.ts+b.ephemeralSetting.ephemeralExpirationInSec),e=d("WATimeUtils").castToUnixTime(c+d("MAWEphemeralConsts").ephemeralReportingWindowInSeconds);return v(a,[{messageDeleteTs:e,messageExpirationTs:c,msgId:b.msgId,readTsForLogging:b.ts}]).then(function(a){var b=a[0],c=a[1];a=a[2];a.length>0&&(s.LOG(p(),a.map(function(a){return a.msgId})),d("MAWIndexedDb").afterTransaction({tag:"MsgsStartCountdown",value:d("MAWBridgeMsgCountdown").createBridgeMsgsStartCountdown(a)}));b!=null&&c!=null&&d("MAWEphemeralCleaner").addNewEphemeralTimestamp(b,c)})}function v(a,b,c){var e=b.map(function(a){return a.msgId});return d("MAWDbXMATxns").getXMAMsgIdsFromAssociatedMsgIds(a,e).then(function(d){var f=new Map();b.forEach(function(a){f.set(a.msgId,{messageDeleteTs:a.messageDeleteTs,messageExpirationTs:a.messageExpirationTs,readTsForLogging:a.readTsForLogging});var b=d.get(a.msgId);b!=null&&f.set(b,{messageDeleteTs:a.messageDeleteTs,messageExpirationTs:a.messageExpirationTs,readTsForLogging:a.readTsForLogging})});var g=null,h=null,i=[],j=Array.from(new Set(e.concat(Array.from(d.values()))));return a.messages.where("msgId").anyOf(j).toArray().then(function(b){if(b.length===0)return;b.forEach(function(a){var b=a.messageExpirationTs,d=a.messageDeleteTs,e=f.get(a.msgId),j=e==null?void 0:e.messageExpirationTs,k=e==null?void 0:e.messageDeleteTs;e=e==null?void 0:e.readTsForLogging;s.LOG(o(),a.msgId,b,d,j,k);if(j==null||k==null)return;if(b!=null&&j>b||d!=null&&j>d){s.ERROR(n(),j,b,k,d,a.ts,e,(b=a.ephemeralSetting)==null?void 0:b.ephemeralExpirationInSec,c);return}if(a.ephemeralCounterStarted===!0)return;g==null?g=j:j<g&&(g=j);h==null?h=k:k<h&&(h=k);d=babelHelpers["extends"]({},a,{ephemeralCounterStarted:!0,messageDeleteTs:k,messageExpirationTs:j});i.push(d)});return a.messages.bulkPut(i)}).then(function(){return[g,h,i]})})}function c(a,b){if(b.size===0)return d("MAWDexieTable").dexieResolve();var c=[];b.forEach(function(b,d){c.push(u(a,d,b))});return d("MAWDexieTable").dexieAll(c).then(function(){})}function e(a,b,c){if(b==null||b.ephemeralSetting==null||b.ephemeralSetting.ephemeralExpirationInSec===0)return d("MAWDexieTable").dexieResolve();var e=d("WATimeUtils").castToUnixTime(c+d("MAWEphemeralConsts").ephemeralMaxDelectionWindowForUnseenMessage);return d("MAWDbXMATxns").getDbXMAMsgFromAssociatedMsgId(a,b.msgId).then(function(c){var f=[babelHelpers["extends"]({},b,{messageDeleteTs:e,messageExpirationTs:e})];c!=null&&d("MAWXMAUtils").isXMAShare(c.xmaMessageType)&&f.push(babelHelpers["extends"]({},c,{messageDeleteTs:e,messageExpirationTs:e}));return a.messages.bulkPut(f).then(function(){})})}function f(a,b,c,e,f,g){if(b==null||f==null)return d("MAWDexieTable").dexieResolve();r.LOG(m(),c,e.jid,b.type);var h=d("MAWDexieTable").dexieResolve();if(b.ephemeralSetting==null)d("WAJids").switchOnMsgrChatJidType(e.jid,{group:function(){return d("MAWEphemeralSettingsTxns").maybeResetEphemeralSyncResponseBackoffInfo(a,c).then(function(){})},user:function(){d("MAWDbMsg").isMsgEligibleForTriggeringEphemeralSyncResponse(b)&&(r.LOG(l()),h=d("MAWEphemeralSettingsTxns").getOutOfSyncEphemeralSettingForIncomingNonEphemeralMsg(a,e.jid).then(function(a){return a==null?void 0:(a=a.value)==null?void 0:a.outOfSyncEphemeralSetting}))}});else if(b.messageExpirationTs!=null&&b.messageDeleteTs!=null){var n=b.ephemeralSetting,o=b.messageDeleteTs,p=b.messageExpirationTs;r.LOG(k(),n.ephemeralExpirationInSec,n.ephemeralLastUpdatedOrSetTimestamp);d("MAWEphemeralCleaner").addNewEphemeralTimestamp(p,o);h=d("MAWEphemeralSettingsTxns").handleAndWriteIncomingEphemeralSetting(a,c,f,n.ephemeralExpirationInSec,n.ephemeralLastUpdatedOrSetTimestamp,!1,e,g,null,!0).then(function(a){return a==null?void 0:a.outOfSyncEphemeralSetting})}return h.then(function(b){if(b!=null){r.LOG(j(),b.correctEphemeralExpirationInSec,b.correctEphemeralLastUpdatedOrSetTimestamp);return b}else{r.LOG(i());return d("MAWEphemeralSettingsTxns").maybeResetEphemeralSyncResponseBackoffInfo(a,c).then(function(){})}})}g.bulkMarkEphemeralMessageAsRead=a;g.markEphemeralMessageAsSent=b;g.bulkUpdateEphemeralMessageTimestamps=v;g.updateThreadsOnMessagesExpiredFromUi=c;g.maybeUpdateEphemeralMessageWhenMarkedSent=e;g.syncEphemeralSettingOnIncomingMsg=f}),98);
__d("MAWEphemeralSettingsCache",["MAWBridge","WATimeUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h=new Map();function i(a,b){h.set(a,b)}function a(a){var b={ephemeralExpirationInSec:0,ephemeralLastUpdatedOrSetTimestamp:d("WATimeUtils").castToUnixTime(0)};return(a=h.get(a))!=null?a:b}function c(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b={ephemeralExpirationInSec:0,ephemeralLastUpdatedOrSetTimestamp:d("WATimeUtils").castToUnixTime(0)};if(!h.has(a)){var c=(yield d("MAWBridge").getBridge().sendAndReceive("event","getLSDBEphemeralSetting",{chatJid:a}));i(a,(a=c)!=null?a:b)}});return j.apply(this,arguments)}g.setEphemeralSettingCache=i;g.getEphemeralSettingCache=a;g.requestLSDBCacheForJid=c}),98);
__d("MAWEphemeralUtil",["MAWAckLevel","MAWBridgeMsgCountdown","MAWGlobals","MAWIndexedDb","MAWLocalizationType","MAWMsgType","WAArmadilloApplication.pb","WAJids","WALogger","err"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["The new ephemeral setting timestamp should be greater than the existing timestamp"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["New ephemeral duration should be different from the existing duration"]);i=function(){return a};return a}function a(a,b,c){var e=d("MAWGlobals").getMyDeviceJid();e=b.ephemeralExpirationInSec!==a.ephemeralExpirationInSec&&b.ephemeralLastUpdatedOrSetTimestamp===a.ephemeralLastUpdatedOrSetTimestamp&&e<=c;return e||a.ephemeralLastUpdatedOrSetTimestamp>b.ephemeralLastUpdatedOrSetTimestamp}function b(a,b,c){if(a==null)return!0;a=a.ephemeralSetting;if(a!=null&&a.ephemeralExpirationInSec===b){d("WALogger").ERROR(i());return!1}if(a!=null&&a.ephemeralLastUpdatedOrSetTimestamp>c){d("WALogger").ERROR(h());return!1}return!0}function e(a){a={ack:d("MAWAckLevel").ACK.sent,altIndex:void 0,author:d("WAJids").AUTHOR_SYSTEM,externalId:d("MAWGlobals").getDependencies().generateExternalId(),msgContent:{adminMsgContent:[],adminType:d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_MINUTES},ts:a,type:d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN};return{unstoredDbMedia:null,unstoredDbMsg:a,unstoredDbReaction:null}}function f(a,b){var e;switch(b){case d("WAArmadilloApplication.pb").ARMADILLO_CONTENT_SCREENSHOT_ACTION_SCREENSHOT_TYPE.SCREENSHOT_IMAGE:e=d("WAArmadilloApplication.pb").ARMADILLO_CONTENT_SCREENSHOT_ACTION_SCREENSHOT_TYPE.SCREENSHOT_IMAGE;break;case d("WAArmadilloApplication.pb").ARMADILLO_CONTENT_SCREENSHOT_ACTION_SCREENSHOT_TYPE.SCREEN_RECORDING:e=d("WAArmadilloApplication.pb").ARMADILLO_CONTENT_SCREENSHOT_ACTION_SCREENSHOT_TYPE.SCREEN_RECORDING;break;default:throw c("err")("Received unexpected screenshot action type")}b={ack:d("MAWAckLevel").ACK.sent,altIndex:void 0,author:d("WAJids").AUTHOR_SYSTEM,externalId:d("MAWGlobals").getDependencies().generateExternalId(),msgContent:{adminMsgContent:[],adminType:d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_TAKE_SCREENSHOT,screenshotActionType:e},ts:a,type:d("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION};return{unstoredDbMedia:null,unstoredDbMsg:b,unstoredDbReaction:void 0}}function j(a){return d("WAJids").switchOnMsgrChatJidType(a,{group:function(a){throw c("err")("Received invalid chatJid. We only support ephemeral messaging in 1:1 threads.")},user:function(a){return a}})}function k(a){a!=null&&a.messageExpirationTs!=null&&a.ephemeralCounterStarted===!0&&d("MAWIndexedDb").afterTransaction({tag:"MsgClearCountdown",value:d("MAWBridgeMsgCountdown").createBridgeMsgClearCountdown(a.msgId,a.messageExpirationTs)})}g.isLocalSettingOutdated=a;g.shouldUpdateForOutgoingUserEphemeralSettingChange=b;g.buildUnstoredDbEphemeralSettingMsgWithoutContentPlaceholder=e;g.buildUnstoredDbEphemeralScreenshotActionMsgWithoutContentPlaceholder=f;g.getUserJidForEphemeralSetting=j;g.maybeClearEphemeralMsgCountdown=k}),98);
__d("MAWEphemeralSettingsTxns",["MAWDbContactsTxns","MAWDbThreadTxns","MAWDexieTable","MAWEphemeralAdminMsgBuildTxns","MAWEphemeralSettingsCache","MAWEphemeralUtil","MAWGlobals","MAWIndexedDb","MAWJids","MAWLoggerUtils","WAJids","WALogger","WAResultOrError","WATagsLogger","WATimeUtils","err","gkx","qex"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["maybeResetEphemeralSyncResponseBackoffInfo reset for ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["maybeResetEphemeralSyncResponseBackoffInfo no op for ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["maybeResetEphemeralSyncResponseBackoffInfo but missing contact for ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Contact "," "," and ephemeral setting "," should not be null when receiving the server ack for outgoing ephemeral setting change"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Writing ephemeral duration "," with ts "," , previous duration "," with ts ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleAndWriteIncomingEphemeralSetting - ephemeral setting in sync"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleAndWriteIncomingEphemeralSetting - Sending Sync Response with duration ",", timestamp ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Received invalid chat jid for incoming ephemeral settings"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleAndWriteIncomingEphemeralSetting - Handle Incoming Ephemeral Setting duration: ",", lastUpdated: ",""]);q=function(){return a};return a}var r=d("WATagsLogger").TAGS([(h=d("MAWLoggerUtils")).Tag.Ephemeral,h.Tag.SettingChange,h.Tag.Incoming]),s=d("WATagsLogger").TAGS([h.Tag.Ephemeral,h.Tag.SettingChange,h.Tag.Outgoing]);function t(){return c("gkx")("9025")||c("qex")._("93")===!0}var u=null;function a(a,b,e,f,g,h,i,j,k,l){if(f<0||f>86400){var s=d("WAJids").interpretAndValidateJid(i.jid).toString();throw c("err")("EphemeralSetting duration is invalid "+f+", jidType: "+s)}var v={ephemeralExpirationInSec:f,ephemeralLastUpdatedOrSetTimestamp:g};d("WALogger").LOG(q(),f,g);s=d("WAJids").interpretAsUserJid(i.jid);var w=t();if(s==null){r.ERROR(p());return d("MAWDexieTable").dexieResolve(u)}var x=d("WAJids").isAuthorMe(b)?d("MAWGlobals").getMyUserJid():b,y=e!=null?d("MAWJids").toDeviceJid(x,e.id):null;return d("MAWDbContactsTxns").getContact(a,s).then(function(c){var e=w?d("MAWEphemeralSettingsCache").getEphemeralSettingCache(i.jid):c==null?void 0:c.ephemeralSetting,p=e==null?void 0:e.ephemeralExpirationInSec,q=e==null?void 0:e.ephemeralLastUpdatedOrSetTimestamp;if(l){if(e!=null&&y!=null&&!d("MAWEphemeralUtil").isLocalSettingOutdated(v,e,y))if(g!==q){d("WALogger").LOG(o(),p,q);return{dbMsg:null,outOfSyncEphemeralSetting:{chatJid:i.jid,correctEphemeralExpirationInSec:e.ephemeralExpirationInSec,correctEphemeralLastUpdatedOrSetTimestamp:e.ephemeralLastUpdatedOrSetTimestamp}}}else{d("WALogger").WARN(n());return u}d("MAWIndexedDb").afterTransaction({tag:"EphemeralSettingsUpdatedForUI",value:{author:d("MAWJids").userIdFromJid(x),chatJid:i.jid,ephemeralSettingArgs:v}});if(w)return u}c=babelHelpers["extends"]({},c,{contactJid:(q=c==null?void 0:c.contactJid)!=null?q:x,dhash:(q=c==null?void 0:c.dhash)!=null?q:void 0,ephemeralSetting:v,ephemeralSyncResponseBackoffInfo:void 0});return a.contacts.put(c).then(function(){if(!w&&(e==null||p!==f)){r.LOG(m(),f,g,e==null?void 0:e.ephemeralLastUpdatedOrSetTimestamp,e==null?void 0:e.ephemeralExpirationInSec);var c=(e==null||p===0)&&f>0;return d("MAWEphemeralAdminMsgBuildTxns").writeEphemeralSettingAdminMsg(a,b,f,j,i,c,h,k).then(function(a){return{dbMsg:a}})}else return u})})}function b(a,b,e,f,g){var h=e;if(h<0)throw c("err")("Ephemeral duration should be 0 or more");var i=d("MAWEphemeralUtil").getUserJidForEphemeralSetting(b);return d("MAWDbThreadTxns").getThreadByJid(a,b).then(function(b){return!b.success?{success:!1}:d("MAWDbContactsTxns").getContact(a,i).then(function(c){if(!d("MAWEphemeralUtil").shouldUpdateForOutgoingUserEphemeralSettingChange(c,h,f))return{success:!1};var e,j=!0;if(c==null)e={contactJid:i,dhash:void 0,ephemeralSetting:{ephemeralExpirationInSec:h,ephemeralLastUpdatedOrSetTimestamp:f}};else{var k=c.ephemeralSetting;j=k==null||k.ephemeralExpirationInSec===0;e=babelHelpers["extends"]({},c,{ephemeralSetting:{ephemeralExpirationInSec:h,ephemeralLastUpdatedOrSetTimestamp:f}})}k=t();return d("MAWDexieTable").dexieAll([a.contacts.put(e),k?d("MAWDexieTable").dexieResolve():d("MAWEphemeralAdminMsgBuildTxns").writeEphemeralSettingAdminMsg(a,d("MAWGlobals").getMyUserJid(),h,f,b.value,j,g)]).then(function(){return{success:!0}})})})}function e(a,b,e){var f=d("MAWEphemeralUtil").getUserJidForEphemeralSetting(b);return d("MAWDbContactsTxns").getContact(a,f).then(function(b){if(b==null||b.ephemeralSetting==null){s.ERROR(l(),f,b,b==null?void 0:b.ephemeralSetting);throw c("err")("Contact and ephemeral setting should not be null when receiving the server ack for outgoing ephemeral setting change")}b=babelHelpers["extends"]({},b,{ephemeralSetting:{ephemeralExpirationInSec:b.ephemeralSetting.ephemeralExpirationInSec,ephemeralLastUpdatedOrSetTimestamp:e}});return a.contacts.put(b).then(function(){})})}function f(a,b){var e=[d("WAJids").interpretAsUserJid(b),t()],f=e[0],g=e[1];if(f==null)throw c("err")("Unexpected chatJid input to isEphemeralMessagesEnabledForContact");var h=d("MAWEphemeralSettingsCache").getEphemeralSettingCache(b);return d("MAWDbContactsTxns").getContact(a,f).then(function(a){if(g&&h.ephemeralLastUpdatedOrSetTimestamp===d("WATimeUtils").castToUnixTime(0)||a==null)return d("WAResultOrError").makeError("no_ephemeral_setting");a=g?h:a.ephemeralSetting;return a!=null&&a.ephemeralExpirationInSec>0?d("WAResultOrError").makeResult({outOfSyncEphemeralSetting:{chatJid:b,correctEphemeralExpirationInSec:a.ephemeralExpirationInSec,correctEphemeralLastUpdatedOrSetTimestamp:a.ephemeralLastUpdatedOrSetTimestamp}}):d("WAResultOrError").makeError("no_ephemeral_setting")})}function v(a,b){return d("MAWDbContactsTxns").getContact(a,b).then(function(c){if(c==null){r.ERROR(k(),b);return d("WAResultOrError").makeError("missing_contact")}if(c.ephemeralSyncResponseBackoffInfo==null){r.LOG(j(),b);return d("WAResultOrError").makeResult()}c.ephemeralSyncResponseBackoffInfo=void 0;r.LOG(i(),b);return a.contacts.put(c).then(function(){return d("WAResultOrError").makeResult()})})}g.getOccamMIEnabled=t;g.handleAndWriteIncomingEphemeralSetting=a;g.handleAndWriteOutgoingUserEphemeralSettingChange=b;g.updateContactWhenEphemeralSettingChangeMarkedSent=e;g.getOutOfSyncEphemeralSettingForIncomingNonEphemeralMsg=f;g.maybeResetEphemeralSyncResponseBackoffInfo=v}),98);
__d("MAWBridgeThread",["MAWTimeUtils","WAJids","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c){var e=d("WAJids").switchOnMsgrChatJidType(a.jid,{group:function(a){return!0},user:function(a){return!1}});return{authoritativeThreadKey:c,cannotReplyReason:a.cannotReplyReason,chatId:a.chatId,clientThreadKey:b,folder:a.folder,isGroup:e,jid:a.jid,lastActivityTs:d("MAWTimeUtils").ensureValidMillisTime(a.snippetMsgTs!=null&&d("WATimeUtils").fromMillisTime(a.snippetMsgTs)!==0?a.snippetMsgTs:a.newestMsgTs)||d("WATimeUtils").castToMillisTime(0),lastReadTs:d("MAWTimeUtils").ensureValidMillisTime(a.lastReadMsgTs)||d("WATimeUtils").castToMillisTime(0),muteExpireTimeMs:(c=a.muteExpireTimeMs)!=null?c:0}}function b(a,b,c){return{lastActivityTimestampMs:c,lastReadWatermarkTs:b,threadId:a}}g.createBridgeThread=a;g.createBridgeThreadTimestampsUpdated=b}),98);
__d("MAWGetOrCreateThreadTxns",["MAWAdminMsgTxns","MAWBridgeThread","MAWBridgeTypesCreators","MAWDbThread","MAWDexieTable","MAWFolderTypes","MAWIndexedDb","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){if(a!=null&&b!=null){var c=d("WATimeUtils").fromMillisTime(a),e=d("WATimeUtils").fromMillisTime(b);return d("WATimeUtils").castToMillisTime(Math.max(c,e))}return(c=a)!=null?c:b}function i(a,b){return a.threads.get({jid:b})}function a(a,b){var c=b.deduplicationKey,e=b.jid;c=b.deduplicationKey!=null?a.threads.get({deduplicationKey:c}):d("MAWDexieTable").dexieResolve();return d("MAWDexieTable").dexieAll([c,i(a,e)]).then(function(c){var d=c[0];c=c[1];if(d!=null)return{created:!1,thread:d};if(c==null)return j(a,b).then(function(a){return{created:!0,thread:a}});else return k(a,b,c).then(function(a){return{created:!1,thread:a}})})}function j(a,b){var c=b.authoritativeThreadKey,e=b.clientThreadKey,f=b.createTs,g=b.deduplicationKey,h=b.folder,i=b.jid,j=b.lastActivityTimestamp,k=b.lastReadWatermarkTimestamp,l=b.skipVerifyThread;b=(j=(b=j)!=null?b:f)!=null?j:d("WATimeUtils").millisTime();f=b!=null?d("WATimeUtils").castToMillisTime(Math.max(b-1,0)):null;k=(j=k)!=null?j:f;var m={authoritativeThreadKey:c!=null?c:void 0,deduplicationKey:g,folder:h!=null?h:d("MAWFolderTypes").FOLDER_ID.INBOX,jid:i,lastReadMsg:null,lastReadMsgReceiptSent:null,lastReadMsgTs:k,newestMsg:null,newestMsgTs:b,oldestMsg:null,optimisticThreadKey:(j=e)!=null?j:void 0,threadOrder:d("MAWDbThread").craftThreadOrder(b,i)};return a.threads.add(m).then(function(b){b=babelHelpers["extends"]({},m,{chatId:b});l!==!0&&d("MAWIndexedDb").afterTransaction({tag:"VerifyThreadExists",value:d("MAWBridgeThread").createBridgeThread(b,b.optimisticThreadKey,c)});return d("MAWAdminMsgTxns").writeE2EEThreadDescriptionMsg(a,b.chatId)})}function k(a,b,c){var e=b.authoritativeThreadKey,f=b.clientThreadKey,g=b.deduplicationKey,i=b.folder,j=b.lastActivityTimestamp,k=b.lastReadWatermarkTimestamp,l=b.skipVerifyThread,m=babelHelpers["extends"]({},c,{authoritativeThreadKey:(b=e)!=null?b:c.authoritativeThreadKey,cannotReplyReason:i!=null||f!=null?null:c.cannotReplyReason,deduplicationKey:i!=null||f!=null?g:c.deduplicationKey,folder:(b=i)!=null?b:c.folder,lastReadMsgTs:h(c.lastReadMsgTs,k),newestMsgTs:h(c.newestMsgTs,j),optimisticThreadKey:(g=f)!=null?g:c.optimisticThreadKey});return a.threads.update(c.chatId,m).then(function(){var a;l!==!0&&d("MAWIndexedDb").afterTransaction({tag:"VerifyThreadExists",value:d("MAWBridgeThread").createBridgeThread(c,c.optimisticThreadKey,e)});d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({chatJid:c.jid,folder:(a=c==null?void 0:c.folder)!=null?a:d("MAWFolderTypes").FOLDER_ID.INBOX,threadId:c.chatId})});return m})}g.getExistingThread=i;g.getOrCreateThread=a;g.createThread=j}),98);
__d("MAWDbGroupInviteTxns",["MAWDbParticipant","MAWDexieTable","MAWGlobals","MAWMsgType","WAJids"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return a.groupInvites.put(b).then(function(){return b})}function b(a,b,c){return a.groupInvites["delete"]([c,b])}function c(a,b){return a.groupInvites.where(["invitedParticipantId","inviterJid"]).between([b,d("MAWDexieTable").DEXIE_MIN_KEY],[b,d("MAWDexieTable").DEXIE_MAX_KEY])["delete"]()}function h(a,b,c){return a.groupInvites.get([c,b])}function e(a,b){return a.groupInvites.where(["invitedParticipantId","inviterJid"]).between([b,d("MAWDexieTable").DEXIE_MIN_KEY],[b,d("MAWDexieTable").DEXIE_MAX_KEY]).toArray()}function f(a,b){if(b.type===d("MAWMsgType").MSG_TYPE.GROUP_INVITE){var c=b.author;b=d("MAWDbParticipant").craftParticipantId(b.thread,b.invitedParticipantUserJid);c=c===d("WAJids").AUTHOR_ME?d("MAWGlobals").getMyUserJid():d("WAJids").authorAsUserJid(c);return c==null?d("MAWDexieTable").dexieResolve():h(a,c,b)}return d("MAWDexieTable").dexieResolve()}g.putGroupInvite=a;g.deleteGroupInvite=b;g.deleteGroupInvitesByInvitedParticipantId=c;g.maybeGetGroupInvite=h;g.getGroupInvitesByInvitedParticipantId=e;g.getAndCheckGroupInviteFromMsg=f}),98);
__d("MAWLoadGroupInvitesTxns",["MAWBridgeTypesCreators","MAWDbGroupInviteTxns","MAWDbParticipant","MAWDexieTable","MAWIndexedDb","WAGlobals","WAJids"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var c=[],e=d("WAGlobals").getMyUserJid();b.forEach(function(b){return d("WAJids").switchOnMsgrChatJidType(b.jid,{group:function(){var f=d("MAWDbParticipant").craftParticipantId(b.chatId,e);c.push(d("MAWDbGroupInviteTxns").getGroupInvitesByInvitedParticipantId(a,f))},user:function(){}})});return d("MAWDexieTable").dexieAll(c).then(function(a){a.forEach(function(a,b){a.forEach(function(b,a){d("MAWIndexedDb").afterTransaction({tag:"GroupInviteUpdate",value:d("MAWBridgeTypesCreators").createBridgeGroupInvite(b)})})})})}g.loadGroupInvites=a}),98);
__d("MAWLoadMessageRequestCapabilitiesTxns",["MAWDexieTable","MAWIndexedDb","WAJids"],(function(a,b,c,d,e,f,g){"use strict";function a(a){for(var b=0;b<a.length;b++){var c=a[b],e=d("WAJids").interpretAsUserJid(c.jid);if(e==null)continue;d("MAWIndexedDb").afterTransaction({tag:"OneToOneMessageRequestLoaded",value:{fbid:d("WAJids").extractUserId(e),threadId:c.chatId}})}return d("MAWDexieTable").dexieResolve()}g.loadMessageRequestDataForThreads=a}),98);
__d("MAWLoadThreadsTxns",["FBLogger","MAWBridgeParticipants","MAWBridgeThread","MAWBridgeTypesCreators","MAWDbMsg","MAWDbParticipantTxns","MAWDbReaction","MAWDbReactionUtils","MAWDexieTable","MAWGlobals","MAWIndexedDb","MAWLoadGroupInvitesTxns","MAWLoadMessageRequestCapabilitiesTxns","MAWLoadMsgsTxns","MAWThreadSnippetBuildTxns","MAWTransactionMode","WAJids","WALogger","err","gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c,e){b.forEach(function(a){d("MAWIndexedDb").afterTransaction({tag:"VerifyThreadExists",value:d("MAWBridgeThread").createBridgeThread(a,e==null?void 0:e.get(a.jid))})});return d("MAWDexieTable").dexieAll([].concat(b.map(function(b){return j(a,b,c)}),[h(a,b),l(a,b),d("MAWLoadMessageRequestCapabilitiesTxns").loadMessageRequestDataForThreads(b),d("MAWLoadGroupInvitesTxns").loadGroupInvites(a,b)])).then(function(){return b})}function b(a,b,c,e){return d("MAWDexieTable").dexieAll([h(a,[c]),j(a,c,e),i(a,c)]).then(function(){b||n(a,c.jid,c.chatId,d("WAJids").interpretAsGroupJid(c.jid)!=null,!1,c.cannotReplyReason,c.archived)})}function h(a,b){return b.length===0?d("MAWDexieTable").dexieResolve():d("MAWDbParticipantTxns").getParticipantsInThreads(a,b.map(function(a){return a.jid})).then(function(a){d("MAWIndexedDb").afterTransaction({tag:"ParticipantsUpdated",value:d("MAWBridgeParticipants").createBridgeParticipants(a)})})}function i(a,b){var e=b.chatId,f=b.newestMsg,g=b.snippetMsg;g=(g=g)!=null?g:f;return g==null?d("MAWDexieTable").dexieResolve():d("MAWDexieTable").dexieAll([a.messages.get({msgId:g}),a.reactions.get({reactionId:g})]).then(function(f){var g=f[0];f=f[1];f!=null&&d("MAWDbReactionUtils").dispatchReaction(f,e);g!=null&&f!=null&&c("FBLogger")("mpf_web_foundations").warn("[MAWLoadThreadsTxns] msgId collision detected between Reaction and Message");return k(a,g,b,f).then(function(a){if(a!=null){var c=a.snippetParams,e=a.snippetSenderContactId;a=a.snippetType;d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({chatJid:b.jid,snippetParams:c,snippetSenderContactId:e,snippetType:a,threadId:b.chatId})})}})})}function j(a,b,e){var f=b.chatId,g=b.newestMsg;return g==null?c("gkx")("9636")?a.messages.where("threadJid").equals(b.jid).count().then(function(a){a>0&&c("FBLogger")("messenger_e2ee_web").mustfix("MAWLoadThreadsTxns skip message loading by mistake")}):d("MAWDexieTable").dexieResolve():d("MAWLoadMsgsTxns").loadMsgsAndMediaFromOffset(a,f,b.jid,g,e,!0)}function k(a,b,c,e){e=e!=null?d("MAWDbReaction").castToIncomingDbReaction(e):e;return e!=null&&e.ts>(b!=null?d("MAWDbMsg").getCanonicalTsFromMsg(b):0)?d("MAWThreadSnippetBuildTxns").buildReactionThreadSnippet(a,e.author,e.reaction,c.chatId):b==null?d("MAWDexieTable").dexieResolve(null):d("MAWThreadSnippetBuildTxns").buildThreadSnippet(a,b,c)}function l(a,b){var c=[];b.forEach(function(a){return d("WAJids").switchOnMsgrChatJidType(a.jid,{group:function(a){return c.push(a)},user:function(){}})});return a.groupInfo.bulkGet(c).then(function(a){a.forEach(function(a){a!=null&&d("MAWIndexedDb").afterTransaction({tag:"GroupInfoUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedGroupInfo(a)})})})}e=function(a){var b=a.threadId;a=a.threadJid;return m(a,b)};var m=d("MAWIndexedDb").makeMsgrTransactor({participants:d("MAWTransactionMode").READONLY},"checkIfGroupParticipant",function(a){return function(){for(var b=arguments.length,c=new Array(b),d=0;d<b;d++)c[d]=arguments[d];return n.apply(void 0,[a].concat(c))}});function n(a,b,e,f,g,h,i){f===void 0&&(f=!0);g===void 0&&(g=!0);var j=d("MAWGlobals").getMyUserJid();return d("MAWDbParticipantTxns").getParticipant(a,e,j).then(function(a){if(!a.success){var k=f?"group":"one_to_one";d("WALogger").LOG(["[Occamadillo] User is not a participant of "+k+" thread\n        "+e.toString()+", showing a VIEWER_NOT_SUBSCRIBED composer blocker"]);if(h==null){var l;c("FBLogger")("mpf_web_foundations","checkIfParticipant").catching((l=a.payload)!=null?l:c("err")(a.error)).warn("[Occamdillo] User %s is not a participant of %s thread %s, occam: %s, archived: %s, cannotReplyReason null.",j,k,e.toString(),g,i)}l={cannotReplyReason:"viewer_not_subscribed",chatJid:b,fromCheckIfParticipant:!0,threadId:e};d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread(l)})}})}g.loadContentsForThreads=a;g.loadParticipantsAndMsgs=b;g.loadParticipants=h;g.loadGroups=l;g.checkIfGroupParticipant=e}),98);
__d("MAWThreadFetchAndEmitTxns",["MAWBridge","MAWBridgeTypesCreators","MAWDexieTable","MAWLoadGroupInvitesTxns","MAWLoadMessageRequestCapabilitiesTxns","MAWLoadThreadsTxns","MAWThreadManagementTxns","WAJids","WATimeUtils","gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c,e){return d("WAJids").switchOnMsgrChatJidType(b,{group:function(b){return d("MAWThreadManagementTxns").getOrRepairGroupThread(a,b,c).then(function(a){return a==null?null:{created:a.created,thread:a.thread}})},user:function(b){var f;return d("MAWThreadManagementTxns").getOrSetupOneToOneThread(a,{createTs:e==null?void 0:d("WATimeUtils").castUnixTimeToMillisTime(e),folder:(f=c)!=null?f:void 0,userJid:b})}}).then(function(b){return b==null||b.thread==null?null:d("MAWLoadThreadsTxns").loadContentsForThreads(a,[b.thread],1).then(function(){return b})})}function b(a,b){if(b.size===0)return d("MAWDexieTable").dexieResolve();b=Array.from(b);return a.threads.where("jid").anyOf(b).toArray().then(function(b){var e=b.filter(Boolean);c("gkx")("6398")&&d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:b.map(function(a){return{tag:"UpdateMessageRange",value:d("MAWBridgeTypesCreators").createBridgeUpdateMessageRange(babelHelpers["extends"]({},a,{newestMsg:null,newestMsgTs:null}))}})});return d("MAWDexieTable").dexieAll([d("MAWLoadThreadsTxns").loadParticipants(a,e),d("MAWLoadThreadsTxns").loadGroups(a,e),d("MAWLoadMessageRequestCapabilitiesTxns").loadMessageRequestDataForThreads(e),d("MAWLoadGroupInvitesTxns").loadGroupInvites(a,e)])}).then(function(){})}g.fetchAndEmitThread=a;g.emitThreadContents=b}),98);
__d("MAWDbReceiptTxns",["WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unexpectedly fetched null data from a msgIdToReceiptData map"]);h=function(){return a};return a}function a(a,b,c,d){return i(a,[{deliveryReceipts:c==="delivered"?d:[],msgId:b,readReceipts:c==="read"?d:[],senderReceipts:c==="sender"?d:[]}]).then(function(a){return a[0]||{type:"missing"}})}function i(a,b){var c=b.map(function(a){return a.msgId}),e=new Map();b.forEach(function(a){e.set(a.msgId,a)});return a.receipts.where("msgId").anyOf(c).toArray().then(function(b){var c=b.map(function(a){var b=e.get(a.msgId);if(b==null){d("WALogger").ERROR(h());return null}var c=new Set(),f=a.statusTsPerUser,g=a.permittedIdentitiesPerDevice,i=b.deliveryReceipts,m=b.readReceipts;b=b.senderReceipts;[{receiptType:"delivered",receivers:i},{receiptType:"read",receivers:m},{receiptType:"sender",receivers:b}].forEach(function(a){var b=a.receiptType;a=a.receivers;a.forEach(function(a){var e=a.device;a=a.ts;var h=d("WAJids").extractUserJid(e),i=!1;if(b!=="sender"){var l=f.get(h);if(l==null)return;a=j(l,b,a);f.set(h,a);i=k(l,a)}l=g!=null?g["delete"](e):!1;(l||i)&&c.add(h)})});i=babelHelpers["extends"]({},a,{permittedIdentitiesPerDevice:l(g),statusTsPerUser:f});return{affectedUserJids:c,receipt:i,type:c.size>0?"updated":"unchanged"}}).filter(Boolean);return a.receipts.bulkPut(c.map(function(a){return a.receipt})).then(function(){return c})})}function j(a,b,c){var d;d=(d=a==null?void 0:a.deliveredTs)!=null?d:c;a=a==null?void 0:a.readTs;b==="read"&&a==null&&(a=c);return{deliveredTs:d,readTs:a}}function k(a,b){return((b==null?void 0:b.deliveredTs)||0)>((a==null?void 0:a.deliveredTs)||0)||((b==null?void 0:b.readTs)||0)>((a==null?void 0:a.readTs)||0)}function l(a){if(a==null||a.size===0)return;return a}function b(a,b){b=b.map(function(a){return a.msgId});return a.receipts.bulkDelete(b)}function c(a,b){return a.receipts.bulkGet(b)}g.writeReceiptsForDevices=a;g.bulkWriteReceiptsForDevices=i;g.bulkDeleteAllReceiptsForMessages=b;g.getReceipts=c}),98);
__d("MAWGroupInviteManagementTxns",["MAWDbGroupInviteTxns","MAWDbParticipant","MAWDbParticipantTxns","MAWDexieTable","MAWGlobals"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c){var e=!1;return d("MAWDbParticipantTxns").getInvitedParticipantsInThread(a,c).then(function(c){if(c.length===0){e=!0;var f=d("MAWGlobals").getMyUserJid();f=d("MAWDbParticipant").craftParticipantId(b,f);return d("MAWDbGroupInviteTxns").deleteGroupInvitesByInvitedParticipantId(a,f).then(function(){return e})}else{var g=[];c.forEach(function(c){c=d("MAWDbParticipant").craftParticipantId(b,c.userJid);g.push(d("MAWDbGroupInviteTxns").deleteGroupInvitesByInvitedParticipantId(a,c))});return d("MAWDexieTable").dexieAll(g).then(function(){return e})}})}g.deleteGroupInvitesByThread=a}),98);
__d("WASortedLists",[],(function(a,b,c,d,e,f){function a(){return[]}function b(){return[]}function c(a,b){return a.filter(b)}function d(a,b){return l(a.map(b))}function e(a,b){var c=a.length===b.length;for(var d=0;c&&d<a.length;d++)a[d]!==b[d]&&(c=!1);return c}function g(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return a;return a.concat([b]).sort()}function h(a,b){if(a.length<b.length)return!1;var c=!0;for(var d=0,e=0;c&&e<b.length;e++)do c=a[d]===b[e];while(!c&&++d<a.length);return c}function i(a,b){var c=[];for(var d=0,e=0;d<a.length;d++){var f=a[d];while(e<b.length&&f>b[e])e++;(e===b.length||f<b[e])&&c.push(f)}return c}function j(a,b){var c=[],d=0,e=0;while(d<a.length&&e<b.length){var f=a[d],g=b[e];f<g?d++:f===g?(c.push(f),d++,e++):e++}return c}function k(a,b){var c=[],d=0,e=0;while(d<a.length&&e<b.length)a[d]<b[e]?c.push(a[d++]):a[d]===b[e]?(c.push(a[d++]),e++):c.push(b[e++]);while(d<a.length)c.push(a[d++]);while(e<b.length)c.push(b[e++]);return c}function l(a){return m(a.slice().sort())}function m(a){var b=!1;for(var c=0;c<a.length-1;c++)a[c]===a[c+1]&&(b=!0);if(!b)return a;c=[];for(b=0;b<a.length-1;b++)a[b]!==a[b+1]&&c.push(a[b]);c.push(a[a.length-1]);return c}function n(a){return Array.from(a).sort()}function o(a){return a.slice().sort()}function p(a,b,c){var d=null;for(var e=0;!d&&e<a.length;e++)a[e]===b&&(d=a.slice(),d[e]=c,d=m(d.sort()));return d||a}function q(a){return[a]}function r(a){return a.length<1}function s(a,b,c){return a.slice(b,c)}f.emptySet=a;f.emptyList=b;f.filter=c;f.map=d;f.areEqual=e;f.addToSet=g;f.contains=h;f.subtract=i;f.intersect=j;f.joinUniq=k;f.sortAndDedupe=l;f.asSortedSet=n;f.sort=o;f.swapIn=p;f.singleElement=q;f.isEmpty=r;f.slice=s}),66);
__d("MAWThreadManagementTxns",["MAWBridgeEventTransmitter","MAWBridgeParticipants","MAWBridgeTypesCreators","MAWDbGroupInfoTxns","MAWDbMsg","MAWDbMsgTxns","MAWDbParticipant","MAWDbParticipantTxns","MAWDbReactionsTxns","MAWDbReceiptTxns","MAWDbThreadTxns","MAWDexieTable","MAWGetOrCreateThreadTxns","MAWGlobals","MAWGroupInviteManagementTxns","MAWIndexedDb","MAWLoadMessageRequestCapabilitiesTxns","WAJids","WALogger","WAMsgType","WASortedLists","WATimeUtils","gkx"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Successfully deleted "," media rows and "," chunk rows"]);h=function(){return a};return a}function a(a,b){var e=b.authoritativeThreadKey,f=b.createTs,g=b.folder,h=b.lastActivityTimestamp,i=b.lastReadWatermarkTimestamp,j=b.offlineThreadingId,k=b.userJid;return d("MAWGetOrCreateThreadTxns").getOrCreateThread(a,{authoritativeThreadKey:e,clientThreadKey:j,createTs:f,folder:g,jid:k,lastActivityTimestamp:h,lastReadWatermarkTimestamp:i}).then(function(b){var e=b.created,f=b.thread;b=[d("MAWLoadMessageRequestCapabilitiesTxns").loadMessageRequestDataForThreads([f])];var g=[{type:"participant",userJid:k}],h=d("MAWGlobals").getMyUserJid();h!==f.jid&&g.push({type:"participant",userJid:h});if(c("gkx")("2027")){b.push(d("MAWDbParticipantTxns").bulkUpsertParticiantsInThread(a,f.chatId,f.jid,g).then(function(a){d("MAWIndexedDb").afterTransaction({tag:"ParticipantsUpdated",value:d("MAWBridgeParticipants").createBridgeParticipants(a)})}));return d("MAWDexieTable").dexieAll(b).then(function(){return{created:e,thread:f}})}e?b.push(d("MAWDbParticipantTxns").bulkAddParticipants(a,f.chatId,f.jid,g).then(function(){})):b.push(d("MAWDbParticipantTxns").getParticipantsInThread(a,f.jid).then(function(a){d("MAWIndexedDb").afterTransaction({tag:"ParticipantsUpdated",value:d("MAWBridgeParticipants").createBridgeParticipants(a)})}));return d("MAWDexieTable").dexieAll(b).then(function(){return{created:e,thread:f}})})}function b(a,b,c,e){return d("MAWDbGroupInfoTxns").getGroupInfo(a,b).then(function(b){if(!b.success)return null;var f=b.value;return d("MAWGetOrCreateThreadTxns").getOrCreateThread(a,{createTs:d("WATimeUtils").castUnixTimeToMillisTime(f.creationTs),folder:c,jid:f.groupJid,skipVerifyThread:e}).then(function(b){var c=b.created,e=b.thread;b=e.chatId;if(c){var g=babelHelpers["extends"]({},f,{threadId:b});return d("MAWDexieTable").dexieAll([d("MAWDbGroupInfoTxns").updateGroupInfo(a,g)]).then(function(){return{created:c,groupInfo:g,thread:e}})}return{created:c,groupInfo:f,thread:e}})})}function i(a,b){var c=[],e=[];b.forEach(function(a){d("MAWDbMsg").isMediaMsg(a)&&a.mediaId!=null&&(c.push(a.mediaId),e.push(a.msgId))});return a.media.bulkGet(c).then(function(b){var c=[],f=[];b.forEach(function(a,b){if(a!=null){var g=e[b];a.msgIds=d("WASortedLists").filter(a.msgIds,function(a){return a!==g});a.mediaEntries["delete"](g);a.msgIds.length===0&&a.mediaEntries.size===0&&(a.plaintextHash!=null&&c.push(a.hashedPlaintextHash),f.push(a.mediaId))}});b=a.media.bulkDelete(f);var g=a.chunk.where("hashedPlaintextHash").anyOf(c)["delete"]();return d("MAWDexieTable").dexieAll([b,g]).then(function(){d("WALogger").LOG(h(),f.length,c.length)})})}function j(a,b){return a.messages.where("thread").equals(b.chatId).toArray().then(function(c){return k(a,b,c,!0)})}function e(a,b,c,e){var f=c==null?void 0:c.lastMessageTimestamp;if(c==null)return j(a,b);var g=a.messages.where("thread").equals(b.chatId).toArray();return g.then(function(g){var h=[],i=new Set();f!=null&&g.forEach(function(a){a.ts<=f+1&&(i.add(a.msgId),h.push(a))});if((c==null?void 0:c.messages.length)!==0){var j=new Set();c.messages.forEach(function(a){j.add((a=a.key)==null?void 0:a.id)});g.forEach(function(a){j.has(a.externalId)&&!i.has(a.msgId)&&(i.add(a.msgId),h.push(a))})}if(h.length!==g.length)for(var l=g,m=Array.isArray(l),n=0,l=m?l:l[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var o;if(m){if(n>=l.length)break;o=l[n++]}else{n=l.next();if(n.done)break;o=n.value}o=o;if(!i.has(o.msgId)&&o.type!==d("WAMsgType").ADMIN)return k(a,b,h,!1,e)}return k(a,b,g,!0,e)})}function k(a,b,c,e,f){var g=d("WAJids").interpretAsGroupJid(b.jid),h=e?d("MAWDbThreadTxns").deleteThreadRow(a,b.chatId):d("MAWDexieTable").dexieResolve(),j=g==null&&e?d("MAWDbParticipantTxns").deleteAllParticipantsForThread(a,b.jid):d("MAWDexieTable").dexieResolve(),k=d("MAWDexieTable").dexieResolve(!1),l=d("MAWDexieTable").dexieResolve();g!=null&&e&&(k=d("MAWGroupInviteManagementTxns").deleteGroupInvitesByThread(a,b.chatId,g),l=d("MAWDbGroupInfoTxns").deleteGroupInfo(a,g));return d("MAWDexieTable").dexieAll([i(a,c),d("MAWDbReceiptTxns").bulkDeleteAllReceiptsForMessages(a,c),d("MAWDbReactionsTxns").deleteAllReactionsForMessages(a,c),d("MAWDbMsgTxns").deleteMessages(a,c,f),h,j,l,k]).then(function(a){a[0];a[1];a[2];a[3];a[4];a[5];a[6];a=a[7];if(e){d("MAWBridgeEventTransmitter").deleteMessagesOfThreadAfterTxn(b);if(g!=null&&a){a=d("MAWGlobals").getMyUserJid();a=d("MAWDbParticipant").craftParticipantId(b.chatId,a);d("MAWIndexedDb").afterTransaction({tag:"DeleteGroupInvite",value:d("MAWBridgeTypesCreators").createBridgeDeleteGroupInvite(a)})}d("MAWIndexedDb").afterTransaction({tag:"ThreadHidden",value:b.chatId})}else d("MAWIndexedDb").afterTransaction({tag:"DeleteMessages",value:d("MAWBridgeTypesCreators").createBridgeDeleteMessages(b.chatId,c)})})}g.getOrSetupOneToOneThread=a;g.getOrRepairGroupThread=b;g.deleteAllThreadData=j;g.metaSyncChatDeleteThread=e}),98);
__d("MAWAfterWriteMsgUtil",["ArmadilloDataTraceType","MAWBridgeMsg","MAWBridgeTrace","MAWBridgeTypesCreators","MAWDbMsg","MAWIndexedDb","MAWXMAUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.dbMsg,c=a.ebRestore,e=a.hasMoreAfter,f=a.hasMoreBefore,g=a.isFirstMsg,h=a.isOldestMsgUpdated,i=a.openMessageOtid,j=a.openMessageParticipantCount,k=a.optimisticMsg,l=a.participantCount,m=a.prevOldestMsg,n=a.quotedReplyAttachmentMeta,o=a.snippet;a=a.updatedThread;var p=a.authoritativeThreadKey,q=a.chatId,r=a.jid,s=a.lastReadMsgTs,t=a.newestMsgTs;a=a.oldestMsg;if(b.altIndex===d("MAWDbMsg").SPAM_ALT_INDEX||b.altIndex===d("MAWDbMsg").FUTUREPROOF_SPAM_ALT_INDEX)return;d("MAWIndexedDb").afterTransaction({tag:"StartTrace",value:d("MAWBridgeTrace").createBridgeStartTraceData(b,r,d("ArmadilloDataTraceType").armadilloMessageSend,i,g,j,l,p)});d("MAWXMAUtils").isXMAStoryReply(b.xmaMessageType)||d("MAWIndexedDb").afterTransaction({tag:"NewMsg",value:d("MAWBridgeMsg").createBridgeMsg(b,k,n)});if(o!=null&&t!=null&&(c==null||!c)&&!d("MAWXMAUtils").isXMAStoryReply(b.xmaMessageType)){i=o.snippetParams;g=o.snippetSenderContactId;j=o.snippetType;d("MAWIndexedDb").afterTransaction({tag:"ThreadBumped",value:d("MAWBridgeTypesCreators").createBridgeBumpedThread(q,r,t,s,j,i,g)})}if(m==null){d("MAWIndexedDb").afterTransaction({tag:"MsgsLoaded",value:d("MAWBridgeTypesCreators").createBridgeMsgsLoadedInfo(q,r,[b],!0,(l=f)!=null?l:!1,(p=e)!=null?p:!1)})}h&&a!=null&&d("MAWIndexedDb").afterTransaction({tag:"UpdateMinMessage",value:{minMessageId:a,minTimestampMs:d("MAWDbMsg").getCanonicalTsFromMsg(b)*1e3,threadId:q}})}g.writeMsgAfterTransaction=a}),98);
__d("MAWAdminMsgTxns",["MAWAfterWriteMsgUtil","MAWDbMsg","MAWDbThread","MAWDbThreadTxns","MAWLocalizationType","MAWLocalizationUtils","MAWThreadSnippetUtils","MAWTimeUtils","MAWWriteBulkWriteIncomingAdminMsgTxns","MAWWriteMsgTxns","WALogger","WATimeUtils","err"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["writeReachabilityErrorAdminMsg failed to create or get 1:1 thread"]);h=function(){return a};return a}function a(a,b){var c=a.ts;c=d("WATimeUtils").castUnixTimeToMillisTime(c);var e=d("MAWTimeUtils").ensureValidMillisTime(b.newestMsgTs)||d("WATimeUtils").castToMillisTime(0);c=c>e?c:e;e=d("MAWThreadSnippetUtils").isDbMsgDisabledForThreadSnippet(a,b);return babelHelpers["extends"]({},b,{newestMsg:a.msgId,newestMsgTs:c,oldestMsg:a.msgId,snippetMsg:e?void 0:a.msgId,snippetMsgTs:e?void 0:d("WATimeUtils").castUnixTimeToMillisTime(d("MAWDbMsg").getCanonicalTsFromMsg(a)),threadOrder:d("MAWDbThread").craftThreadOrder(c,b.jid)})}function b(a){a.forEach(function(a){return d("MAWAfterWriteMsgUtil").writeMsgAfterTransaction(a)})}function e(a,b){return d("MAWDbThreadTxns").getThreadByJid(a,b).then(function(b){if(!b.success){d("WALogger").WARN(h());return}b=b.value;var c=d("MAWLocalizationUtils").buildUnstoredDbAdminMsg({adminMsgContent:[],adminType:d("MAWLocalizationType").LOCALIZATION_TYPE.REACHABILITY_ERROR,version:0},b.chatId,b.jid,d("WATimeUtils").castMillisTimeToUnixTime(b.lastReadMsgTs));return d("MAWWriteMsgTxns").writeMsg(a,c,b).then(function(){})})}function f(a,b){return d("MAWDbThreadTxns").getThread(a,b).then(function(e){if(!e.success)throw c("err")("missing thread when write e2ee thread description");return d("MAWWriteBulkWriteIncomingAdminMsgTxns").writeE2EEAdminMsgsForIncomingCreatedThreads(a,[e.value]).then(function(){return d("MAWDbThreadTxns").getThread(a,b).then(function(a){if(!a.success)throw c("err")("missing thread when write e2ee thread description");return a.value})})})}function i(a){var b=d("MAWDbMsg").craftE2eeAdminMsgAltIndex(a.chatId);b=d("MAWLocalizationUtils").buildUnstoredDbAdminMsg({adminMsgContent:[],adminType:d("MAWLocalizationType").LOCALIZATION_TYPE.E2EE_THREAD_DESCRIPTION,version:0},a.chatId,a.jid,d("WATimeUtils").castToUnixTime(0),b);return babelHelpers["extends"]({},b,{msgId:d("MAWDbMsg").craftMsgIdV2(a.chatId,1,b),sortOrderMs:0})}g.getUpdatedThreadForAdminMsg=a;g.syncMsgsDataAfterTransaction=b;g.writeReachabilityErrorAdminMsg=e;g.writeE2EEThreadDescriptionMsg=f;g.buildE2EEThreadDescriptionMsg=i}),98);
__d("MAWWriteBulkWriteIncomingAdminMsgTxns",["MAWAdminMsgTxns","MAWDexieTable","MAWThreadSnippetBuildTxns","MAWThreadSnippetForAdminOrEphemeralMsg","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["OfflineBulkWriteAdminmsg - Missing thread when write e2ee thread description"]);h=function(){return a};return a}function i(a){var b=[],e=[],f=[];a.forEach(function(a){a==null&&d("WALogger").ERROR(h());var g=d("MAWAdminMsgTxns").buildE2EEThreadDescriptionMsg(a),i=d("MAWAdminMsgTxns").getUpdatedThreadForAdminMsg(g,a),j=c("MAWThreadSnippetForAdminOrEphemeralMsg")(g,d("MAWThreadSnippetBuildTxns").getSnippetContactId(g.author));b.push(g);f.push(i);e.push({dbMsg:g,isFirstMsg:!1,isOldestMsgUpdated:a.oldestMsg!=null&&g.msgId!==a.oldestMsg,prevOldestMsg:a.oldestMsg==null?void 0:a.oldestMsg,snippet:j,updatedThread:i})});return{afterTransactionSyncMsgsData:e,e2eeThreadAdminMsgs:b,threadsToUpdate:f}}function a(a,b){b=i(b);var c=b.afterTransactionSyncMsgsData,e=b.e2eeThreadAdminMsgs,f=b.threadsToUpdate;return d("MAWDexieTable").dexieAll([a.messages.bulkAdd(e),a.threads.bulkPut(f)]).then(function(){d("MAWAdminMsgTxns").syncMsgsDataAfterTransaction(c);return f})}g.writeE2EEAdminMsgsForIncomingCreatedThreads=a}),98);
__d("MAWDeleteForMeMsgContentCleaner",["MAWMsgCleaner","WALogger","err"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["DeleteForMeMsgContentCleaner: Adding timestamps (",")"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["startDeleteForMeMsgContentCleaner invoked"]);j=function(){return a};return a}var k=null;function a(a){d("WALogger").LOG(j()),k==null&&(k=new(d("MAWMsgCleaner").MsgCleaner)(a,d("MAWMsgCleaner").CLEANER_TYPE.DELETE_FOR_ME))}function b(a){if(k==null){var b="Trying to add new DeleteForMeContentCleanerTimestamp before the cleaner is initialized!";d("WALogger").ERROR(i(),b);throw c("err")(b)}else d("WALogger").DEV(h(),a),k.update(a)}function e(){return k}function f(){k=null}g.startDeleteForMeMsgContentCleaner=a;g.addNewDeleteForMeMsgContentCleanerTimestamp=b;g.getDeleteForMeMsgContentCleaner_FOR_TESTING_ONLY=e;g.resetDeleteForMeMsgContentCleaner_FOR_TESTING_ONLY=f}),98);
__d("MAWPendingStanzaCleaner",["MAWMsgCleaner","WALogger","err"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["PendingStanzaCleaner: Adding timestamps (",")"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);i=function(){return a};return a}var j=null;function a(a){j==null&&(j=new(d("MAWMsgCleaner").MsgCleaner)(a,d("MAWMsgCleaner").CLEANER_TYPE.PENDING_STANZA))}function b(a){if(j==null){var b="Trying to add new PendingStanzaCleanerTimestamp before the cleaner is initialized!";d("WALogger").ERROR(i(),b);throw c("err")(b)}else d("WALogger").DEV(h(),a),j.update(a)}function e(){return j}function f(){j=null}g.startPendingStanzaCleaner=a;g.addNewPendingStanzaCleanerTimestamp=b;g.getPendingStanzaCleaner_FOR_TESTING_ONLY=e;g.resetPendingStanzaCleaner_FOR_TESTING_ONLY=f}),98);
__d("MAWUpdateQuotedMsgTxns",["MAWAuthor","MAWBridgeMsg","MAWDexieTable","MAWIndexedDb","MAWMsgType"],(function(a,b,c,d,e,f,g){"use strict";var h=function(a,b,c,e,f,g){var h=d("MAWAuthor").getAuthorUserJid(e);return a.messages.where("quoteExternalId").equals(c).toArray().then(function(c){if(c.length===0)return;c=c.filter(function(a){var c=a.quote;a=a.thread;return d("MAWAuthor").getAuthorUserJid(c==null?void 0:c.content.author)===h&&a===b});var e=c.map(function(a){var b;b=Object.assign({},(b=a.quote)==null?void 0:b.content,f.content);b=babelHelpers["extends"]({},a.quote,f,{content:b});b.content.msgId==null&&g!=null&&(b.content.msgId=g);return babelHelpers["extends"]({},a,{quote:b})});return a.messages.bulkPut(e).then(function(){return e})})},i=function(a,b,c,e,f){f===void 0&&(f=d("MAWMsgType").MSG_TYPE.UNAVAILABLE);f={content:{mediaId:void 0,msgContent:void 0,type:f}};return h(a,b,c,e,f).then(function(a){if(a==null)return;a.forEach(function(a){d("MAWIndexedDb").afterTransaction({tag:"MsgUpdated",value:d("MAWBridgeMsg").createBridgeMsg(a)})})})};a=function(a,b,c){c===void 0&&(c=d("MAWMsgType").MSG_TYPE.UNAVAILABLE);var e=b.author,f=b.chat,g=b.externalId;return a.threads.get({jid:f}).then(function(b){if(b==null)return;return i(a,b.chatId,g,e,c)})};b=function(a,b,c){var e=c.author,f=c.externalId,g=c.mediaId,i=c.msgContent,j=c.msgId,k=c.ts;c=c.type;if(!d("MAWMsgType").isQuotedMsgType(c))return d("MAWDexieTable").dexieResolve();g={author:e,externalId:f,mediaId:g,msgContent:i,ts:k,type:c};return h(a,b,f,e,{content:g},j)};g.disassociateQuotedMsg=i;g.disassociateQuotedMessageByProtocolMsgId=a;g.associateQuotedMessage=b}),98);
__d("MAWWriteDeleteMessageTxns",["MAWAckLevel","MAWBridgeTypesCreators","MAWDbMsg","MAWDbMsgTxns","MAWDbPendingStanza","MAWDbReactionsTxns","MAWDbXMATxns","MAWDeleteForMeMsgContentCleaner","MAWDexieTable","MAWIndexedDb","MAWMsgType","MAWPendingStanzaCleaner","MAWThreadFetchAndEmitTxns","MAWThreadSnippetBuildTxns","MAWUpdateQuotedMsgTxns","MAWUploadMessagesBackup","MAWXMAUtils","WAResultOrError","WATimeUtils","gkx","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h=6*d("WATimeUtils").HOUR_SECONDS,i=30*d("WATimeUtils").DAY_SECONDS;function a(a,b){var c=b.protocolMsgId,e=c.author;b=c.chat;var f=c.externalId;return d("MAWDexieTable").dexieAll([d("MAWThreadFetchAndEmitTxns").fetchAndEmitThread(a,b),a.unrenderedMessages.get({externalId:f})]).then(function(b){var g=b[0];b=b[1];if(g==null)return d("WAResultOrError").makeError("missing_thread");return b!=null&&b.thread===g.thread.chatId&&b.author===e?d("WAResultOrError").makeError("duplicate_delete_for_me"):d("MAWDbMsgTxns").maybeGetMsgByProtocolMsgId(a,c).then(function(b){if(b==null){var h={ack:d("MAWAckLevel").ACK.received,author:e,externalId:f,thread:g.thread.chatId,threadJid:g.thread.jid,type:d("MAWMsgType").MSG_TYPE.DELETE_FOR_ME},k=d("WATimeUtils").castToUnixTime(d("WATimeUtils").unixTime()+i);h={deleteTs:k,externalIdWithType:f+"_"+d("MAWDbPendingStanza").PENDING_DELETE_FOR_ME,pendingContent:{content:h,type:d("MAWDbPendingStanza").PENDING_TYPE.DELETE_FOR_ME}};return a.pendingStanzas.add(h).then(function(){d("MAWPendingStanzaCleaner").addNewPendingStanzaCleanerTimestamp(k);return d("WAResultOrError").makeResult()})}return d("MAWDexieTable").dexieResolve(j(a,b,e,c.chat,g.thread)).then(function(){return d("WAResultOrError").makeResult()})})})}function j(a,b,e,f,g){var i,j=d("MAWDexieTable").dexieResolve();d("MAWXMAUtils").isXMAStoryReply((i=b.quote)==null?void 0:i.content.xmaMessageType)&&(j=k(a,b));var l={ack:b.ack,author:e,externalId:b.externalId,mediaId:b.mediaId,messageDeleteForMeTs:d("WATimeUtils").castToUnixTime(d("WATimeUtils").unixTime()+h),msgContent:(i=d("MAWDbMsg").getMsgContent(b))==null?void 0:i.content,msgId:b.msgId,quote:b.quote,reportingMeta:b.reportingMeta,serverTs:c("justknobx")._("1753")?void 0:b.serverTs,thread:b.thread,threadJid:f,ts:b.ts,type:d("MAWMsgType").MSG_TYPE.DELETE_FOR_ME,xmaMessageType:b.xmaMessageType};i=d("MAWDexieTable").dexieAll([d("MAWDbMsgTxns").deleteDbMsg(a,b.rowId),j]).then(function(){d("MAWIndexedDb").afterTransaction({tag:"DeleteMessages",value:d("MAWBridgeTypesCreators").createBridgeDeleteMessages(b.thread,[b])});c("gkx")("7110")&&c("justknobx")._("1071")&&d("MAWUploadMessagesBackup").sendDeleteEchoMessage(b,g.jid);if(d("MAWDbMsg").isMediaMsg(b)){var e=b.mediaId;e!=null&&d("MAWIndexedDb").afterTransaction({tag:"MediaExpired",value:{mediaId:e,msgId:b.msgId,threadId:b.thread}})}return d("MAWThreadSnippetBuildTxns").refreshThreadSnippet(a,g)});return d("MAWDexieTable").dexieAll([i,a.unrenderedMessages.add(l),d("MAWDbReactionsTxns").deleteReactionsByUniqueMsgIdentifiers(a,[{author:e,chatId:b.thread,externalId:b.externalId}]),d("MAWUpdateQuotedMsgTxns").disassociateQuotedMsg(a,b.thread,b.externalId,b.author,d("MAWMsgType").MSG_TYPE.REVOKED)]).then(function(){return d("MAWDbMsgTxns").maybeUpdateThreadMsgsForDeleteForMe(a,g.chatId,b.msgId).then(function(){d("MAWDeleteForMeMsgContentCleaner").addNewDeleteForMeMsgContentCleanerTimestamp(l.messageDeleteForMeTs);return d("WAResultOrError").makeResult()})})}function k(a,b){return d("MAWDbXMATxns").maybeGetXMAFromAssociatedMsgId(a,b.msgId).then(function(b){return d("MAWDbMsgTxns").maybeGetMsg(a,b==null?void 0:b.msgId).then(function(b){if(b!=null)return d("MAWDbMsgTxns").deleteDbMsg(a,b.rowId)})})}g.REVOKE_CONTENT_EXPIRATION_IN_SEC=h;g.handleDeleteForMe=a;g.deleteXMAStoryReplyMsg=k}),98);
__d("MAWBuildIncomingMsgs",["MAWAckLevel","MAWDbMsg","MAWMsgType","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h=6*d("WATimeUtils").HOUR_SECONDS;function a(a,b){var c=a.author;a=a.externalId;return{ack:d("MAWAckLevel").ACK.received,altIndex:void 0,author:c,externalId:a,serverTs:b,ts:b,type:d("MAWMsgType").MSG_TYPE.CIPHERTEXT}}function b(a,b){var c=a.author;a=a.externalId;return{ack:d("MAWAckLevel").ACK.failed,altIndex:void 0,author:c,externalId:a,serverTs:b,ts:b,type:d("MAWMsgType").MSG_TYPE.UNAVAILABLE}}function c(a,b){var c;return{ack:a.ack,author:a.author,externalId:a.externalId,messageDeleteForMeTs:d("WATimeUtils").castToUnixTime(d("WATimeUtils").unixTime()+h),msgContent:(c=d("MAWDbMsg").getMsgContent(a))==null?void 0:c.content,thread:b.chatId,threadJid:b.jid,ts:a.ts,type:d("MAWMsgType").MSG_TYPE.DELETE_FOR_ME}}function e(a,b,c){return{ack:a.ack,altIndex:void 0,author:a.author,externalId:c.externalId,msgContent:d("MAWDbMsg").getMsgContent(a),originalTs:a.ts,revokedExternalId:c.revokedExternalId,thread:b.chatId,threadJid:b.jid,ts:c.ts,type:d("MAWMsgType").MSG_TYPE.REVOKED,unsendMsgContentDeleteTs:d("WATimeUtils").castToUnixTime(d("WATimeUtils").unixTime()+h)}}g.REVOKE_CONTENT_EXPIRATION_IN_SEC=h;g.buildUnstoredCiphertextMsg=a;g.buildUnstoredUnavailableMsg=b;g.buildUnstoredDeleteForMeMsg=c;g.buildUnstoredRevokedMsg=e}),98);
__d("MAWDeleteThreadUtil",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=[];a.forEach(function(a){if(a.pendingContent.type==="DeleteThread"){a=a.pendingContent.content.metaSyncMessageRange.lastMessageTimestamp;a!=null&&b.push(a)}});if(b.length===0)return null;b.sort(function(a,b){return b-a});a=b[0];return{lastMessageTimestamp:a}}function b(a,b){return b!=null&&b.lastMessageTimestamp>=a}f.getLatestDeleteThreadInfo=a;f.isMsgDeletedViaDeleteThread=b}),66);
__d("MAWDbPendingStanzaTxns",["MAWDbPendingStanza","MAWDeleteThreadUtil","MAWPendingStanzaCleaner","WAJids","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c,e,f){var g=d("MAWDbPendingStanza").getPendingSuffix(f);return a.pendingStanzas.where("externalIdWithType").equals(b+"_"+g).filter(function(a){a=a.pendingContent;return a.type===f&&a.content.author===c&&a.content.thread!=null&&a.content.thread===e}).first()}function a(a,b,c,e){return h(a,b,c,e,d("MAWDbPendingStanza").PENDING_TYPE.REVOKED)}function b(a,b,c,e){return h(a,b,c,e,d("MAWDbPendingStanza").PENDING_TYPE.DELETE_FOR_ME)}function c(a,b){var c=b.map(function(a){a=a.expirationInSeconds;return d("WATimeUtils").castToUnixTime(d("WATimeUtils").unixTime()+a)});b=b.map(function(a,b){var e=a.content,f=a.externalId;a=a.pendingStanzaType;return{deleteTs:c[b],externalIdWithType:f+"_"+d("MAWDbPendingStanza").getPendingSuffix(a),pendingContent:e}});return a.pendingStanzas.bulkAdd(b).then(function(){return c.forEach(d("MAWPendingStanzaCleaner").addNewPendingStanzaCleanerTimestamp)}).then(function(){})}function e(a,b,c,e,f){f=d("MAWDbPendingStanza").getPendingSuffix(f);var g=d("WATimeUtils").castToUnixTime(d("WATimeUtils").unixTime()+c);c={deleteTs:g,externalIdWithType:e+"_"+f,pendingContent:b};return a.pendingStanzas.add(c).then(function(){d("MAWPendingStanzaCleaner").addNewPendingStanzaCleanerTimestamp(g)})}function f(a,b){var c=d("MAWDbPendingStanza").getPendingSuffix(d("MAWDbPendingStanza").PENDING_TYPE.DELETE_THREAD);return a.pendingStanzas.where("externalIdWithType").equals(b+"_"+c).toArray().then(function(a){return d("MAWDeleteThreadUtil").getLatestDeleteThreadInfo(a)})}function i(a){return a.pendingStanzas.toArray()}function j(a,b){b=b.map(function(a){return a.rowId});return a.pendingStanzas.bulkDelete(b)}function k(a){var b;return(a==null?void 0:(b=a.pendingContent)==null?void 0:b.type)===d("MAWDbPendingStanza").PENDING_TYPE.REVOKED?a==null?void 0:(b=a.pendingContent)==null?void 0:b.content:null}function l(a,b){var c=d("MAWDbPendingStanza").getPendingSuffix(d("MAWDbPendingStanza").PENDING_TYPE.DELETE_THREAD);b=b.map(function(a){return a+"_"+c});return a.pendingStanzas.where("externalIdWithType").anyOf(b).toArray().then(function(a){a=a.reduce(function(a,b){var c=a.get(b.externalIdWithType);c==null?a.set(b.externalIdWithType,[b]):c.push(b);return a},new Map());var b=new Map();a.forEach(function(a,c){c=d("WAJids").unsafeCoerceToChatJid(c.split("_")[0]);a=d("MAWDeleteThreadUtil").getLatestDeleteThreadInfo(a);a!=null&&b.set(c,a)});return b})}g.maybeGetPendingStanzaByExternalId=h;g.maybeGetPendingRevokedStanza=a;g.maybeGetPendingDeletedStanza=b;g.bulkPutPendingStanzas=c;g.putPendingStanza=e;g.maybeGetDeleteThreadFromPendingStanza=f;g.getAllPendingStanzas=i;g.deletePendingStanzas=j;g.getRevokedContent=k;g.bulkGetDeleteThreadPendingStanzas=l}),98);
__d("MAWWriteMsgSideEffectTxns",["MAWDbMsg","MAWDbParticipantTxns","MAWDexieTable"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var c=d("MAWDbMsg").getCanonicalTsFromMsg(b),e=b.author;return e!=="@me"&&e!=="@system"?d("MAWDbParticipantTxns").updateParticipantTimestamps(a,[b.threadJid,e],c,c,c):d("MAWDexieTable").dexieResolve()}g.updateParticipantTimestampsForMsg=a}),98);
__d("MAWWriteMsgTxns",["MAWAddQPLPointForHandleIncomingMsgApi","MAWAfterWriteMsgUtil","MAWBridgeMsg","MAWBridgeTypesCreators","MAWBuildIncomingMsgs","MAWDbMsg","MAWDbMsgTxns","MAWDbPendingStanzaTxns","MAWDbReactionsTxns","MAWDbThread","MAWDbThreadTxns","MAWDbUnrenderedMsgTxns","MAWDeleteForMeMsgContentCleaner","MAWDeleteThreadUtil","MAWDexieTable","MAWEBUploadMessageUtils","MAWEphemeralGatingUtil","MAWEphemeralMsgTxns","MAWFolderTypes","MAWGetOrCreateThreadTxns","MAWIndexedDb","MAWLoadReplyMediaTxns","MAWLocalizationUtils","MAWMsgType","MAWThreadEvent","MAWThreadSnippetBuildTxns","MAWThreadSnippetUtils","MAWTimeUtils","MAWUpdateQuotedMsgTxns","MAWWriteMsgSideEffectTxns","MAWWriteRevokeMessageTxns","WAJids","WALogger","WATimeUtils","err","gkx"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["handle"," Msg: Message from ",", chat ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["writeMsgAfterTransaction - sortOrderMs is in the future. sortOrderMs: ",", current time: ",", serverTs: ",", suppliedSortOrder: ",", ts: ",", originalTs: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["writeMsgAfterTransaction - sortOrderMs: ",""]);j=function(){return a};return a}function k(a,b,e,f){var g=e.ts;g=[d("WATimeUtils").castUnixTimeToMillisTime(g),e.type===d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN];var h=g[0],i=g[1];return d("MAWGetOrCreateThreadTxns").getExistingThread(a,b.jid).then(function(b){if(b==null)throw c("err")("at this point there's always a thread - checking for updates");return d("MAWDbMsgTxns").getNextMsgIdNumberForThread(a,b).then(function(c){var g,j=d("MAWTimeUtils").ensureValidMillisTime(b.newestMsgTs)||d("WATimeUtils").castToMillisTime(0),k=h>j&&!i?h:j;j=(j=d("MAWTimeUtils").ensureValidMillisTime(b.lastReadMsgTs))!=null?j:0;g=(g=d("MAWTimeUtils").ensureValidMillisTime(b.newestMsgTs))!=null?g:0;j=j<g;var l=e.author===d("WAJids").AUTHOR_ME||e.type===d("MAWMsgType").MSG_TYPE.ADMIN&&d("MAWLocalizationUtils").isParticipantChangeAdminMsg(e.msgContent.adminType)&&!j,m=babelHelpers["extends"]({},e,{msgId:d("MAWDbMsg").craftMsgIdV2(b.chatId,c,e)});return d("MAWDbMsgTxns").calculateOldestAndNewestMsg(a,b.oldestMsg,b.newestMsg,m,f).then(function(a){var c=a.newestMsg;a=a.oldestMsg;var f=d("MAWThreadSnippetUtils").isDbMsgDisabledForThreadSnippet(m,b);return{msgId:m.msgId,updatedThread:babelHelpers["extends"]({},b,{lastReadMsg:l?m.msgId:b.lastReadMsg,lastReadMsgTs:l?k:b.lastReadMsgTs,newestMsg:c,newestMsgTs:k,oldestMsg:a,snippetMsg:f?b.snippetMsg:m.msgId,snippetMsgTs:f?b.snippetMsgTs:d("WATimeUtils").castUnixTimeToMillisTime(d("MAWDbMsg").getCanonicalTsFromMsg(e)),threadOrder:d("MAWDbThread").craftThreadOrder(k,b.jid)})}})})})}function l(a,b,e,f,g,h,l){f===void 0&&(f={});f=f;var m=f.isFirstMsg,n=m===void 0?!1:m;m=f.isOutgoing;var o=m===void 0?!1:m,p=f.openMessageOtid,q=f.openMessageParticipantCount,r=f.optimisticMsg,s=f.participantCount,t=f.quotedReplyAttachmentMeta,u=f.sortOrderMs;m=c("gkx")("5605");f=m?(f=u)!=null?f:d("MAWEBUploadMessageUtils").echoOverrideMessageSortOrder(b):u;m=m?(m=u)!=null?m:d("MAWEBUploadMessageUtils").echoOverrideMessageSortOrder(b):d("MAWEBUploadMessageUtils").echoOverrideMessageSortOrder(b);var v=babelHelpers["extends"]({},b,{sortOrderMs:m});return k(a,e,b,f).then(function(b){var c=b.msgId,f=b.updatedThread,k=e.oldestMsg!=null&&f.oldestMsg!==e.oldestMsg,m=babelHelpers["extends"]({},v,{msgId:c});return d("MAWDexieTable").dexieAll([a.messages.add(m).then(function(a){return babelHelpers["extends"]({},m,{rowId:a})}),a.threads.put(f),d("MAWThreadSnippetUtils").isDbMsgDisabledForThreadSnippet(m,e)?null:d("MAWThreadSnippetBuildTxns").buildThreadSnippet(a,m,e)]).then(function(a){var b=a[0];a[1];a=a[2];o&&(d("WALogger").LOG(j(),b.sortOrderMs),b.sortOrderMs!=null&&b.sortOrderMs>Date.now()+60*1e3&&d("WALogger").ERROR(i(),b.sortOrderMs,Date.now(),b.serverTs,u,b.ts,b.originalTs));d("MAWAfterWriteMsgUtil").writeMsgAfterTransaction({dbMsg:b,ebRestore:g,hasMoreAfter:l,hasMoreBefore:h,isFirstMsg:n,isOldestMsgUpdated:k,openMessageOtid:p,openMessageParticipantCount:q,optimisticMsg:r,participantCount:s,prevOldestMsg:e.oldestMsg==null?void 0:e.oldestMsg,quotedReplyAttachmentMeta:t,snippet:a,updatedThread:f});return b})})}function m(a,b,e){return d("MAWGetOrCreateThreadTxns").getExistingThread(a,e.jid).then(function(e){if(e==null)throw c("err")("at this point there's always a thread - checking for updates");return d("MAWDbUnrenderedMsgTxns").getNextUnrenderedMsgIdNumberForThread(a,e).then(function(c){var f=babelHelpers["extends"]({},b,{msgId:d("MAWDbMsg").craftUnrenderedMsgId(e.chatId,c)});return d("MAWDexieTable").dexieAll([a.unrenderedMessages.add(f),a.threads.put(e)]).then(function(a){var b=a[0];a[1];return babelHelpers["extends"]({},f,{rowId:b})})})})}function a(a,b,c){var e=[b.externalId,c.chatId,b.author],f=e[0],g=e[1];e=e[2];d("MAWAddQPLPointForHandleIncomingMsgApi").addQPLPointForHIMApi("msg_queries_start");return d("MAWDexieTable").dexieAll([d("MAWDbMsgTxns").maybeGetMsgByExternalId(a,f,g,e),d("MAWDbPendingStanzaTxns").maybeGetPendingRevokedStanza(a,f,e,g),d("MAWDbPendingStanzaTxns").maybeGetPendingDeletedStanza(a,f,e,g),d("MAWDbMsgTxns").checkIfMsgIsDeletedForMeOrRevoked(a,f,g,e),d("MAWDbPendingStanzaTxns").maybeGetDeleteThreadFromPendingStanza(a,c.jid).then(function(a){return d("MAWDeleteThreadUtil").isMsgDeletedViaDeleteThread(b.ts,a)})]).then(function(a){var b=a[0],c=a[1],e=a[2],f=a[3];a=a[4];d("MAWAddQPLPointForHandleIncomingMsgApi").addQPLPointForHIMApi("msg_queries_end");return{existingMessage:(b=b)!=null?b:null,isDeletedWithThread:a,isDeleteForMeOrRevoked:f,pendingDeleteForMeStanza:(b=e)!=null?b:null,pendingRevokedStanza:(a=c)!=null?a:null}})}function b(a,b,c){var e=b.author;d("WALogger").DEV(h(),b.type,e,c.jid);var f=babelHelpers["extends"]({},babelHelpers["extends"]({},b,{thread:c.chatId,threadJid:c.jid}));c.folder===d("MAWFolderTypes").FOLDER_ID.OTHER&&(f.altIndex=f.altIndex===d("MAWDbMsg").FUTUREPROOF_ALT_INDEX?d("MAWDbMsg").FUTUREPROOF_SPAM_ALT_INDEX:d("MAWDbMsg").SPAM_ALT_INDEX);return d("MAWDexieTable").dexieAll([d("MAWUpdateQuotedMsgTxns").associateQuotedMessage(a,c.chatId,f),d("MAWLoadReplyMediaTxns").getReplyMediaForMsgQuote(a,f),d("MAWLoadReplyMediaTxns").getReplyMediaForMsg(a,f)]).then(function(b){var e=b[0],g=b[1],h=b[2];d("MAWAddQPLPointForHandleIncomingMsgApi").addQPLPointForHIMApi("write_incoming_msg_start");return l(a,f,c,{quotedReplyAttachmentMeta:g}).then(function(b){f.altIndex!==d("MAWDbMsg").SPAM_ALT_INDEX&&f.altIndex!==d("MAWDbMsg").FUTUREPROOF_SPAM_ALT_INDEX&&f.author!==d("WAJids").AUTHOR_ME&&d("MAWIndexedDb").afterTransaction({tag:"ThreadBumpedServer",value:{isCurrentDeviceSendingMsg:!1,lastActivityTs:d("WATimeUtils").castUnixTimeToMillisTime(f.ts),threadId:c.chatId}});d("MAWAddQPLPointForHandleIncomingMsgApi").addQPLPointForHIMApi("write_msg_additional_steps");return d("MAWDexieTable").dexieAll([d("MAWWriteMsgSideEffectTxns").updateParticipantTimestampsForMsg(a,f),d("MAWEphemeralGatingUtil").isSendBasedDisappearingMessageEnabled()?d("MAWEphemeralMsgTxns").markEphemeralMessageAsSent(a,b):d("MAWDexieTable").dexieResolve()]).then(function(){e!=null&&e.forEach(function(a){d("MAWIndexedDb").afterTransaction({tag:"MsgUpdated",value:d("MAWBridgeMsg").createBridgeMsg(a,void 0,h)})});d("MAWAddQPLPointForHandleIncomingMsgApi").addQPLPointForHIMApi("write_incoming_msg_end");return b})})})}function e(a,b,c,e){var f=babelHelpers["extends"]({},babelHelpers["extends"]({},b,{msgId:c.msgId,rowId:c.rowId,serverTs:c.serverTs,sortOrderMs:c.sortOrderMs,thread:c.thread,threadJid:e.jid,ts:c.ts}));return d("MAWDexieTable").dexieAll([d("MAWUpdateQuotedMsgTxns").associateQuotedMessage(a,e.chatId,f),d("MAWLoadReplyMediaTxns").getReplyMediaForMsgQuote(a,f),d("MAWLoadReplyMediaTxns").getReplyMediaForMsg(a,f)]).then(function(b){var c=b[0],g=b[1],h=b[2];d("MAWAddQPLPointForHandleIncomingMsgApi").addQPLPointForHIMApi("handle_ciphertext_start");return a.messages.put(f).then(function(){return d("MAWDbThreadTxns").needsRetroactiveReadReceiptInThread(a,f)}).then(function(b){if(b){f.altIndex=d("MAWDbMsg").craftToBeReadAltIndex(f.thread);return a.messages.put(f)}}).then(function(){d("MAWIndexedDb").afterTransaction({tag:"MsgUpdated",value:d("MAWBridgeMsg").createBridgeMsg(f,void 0,h)});d("MAWIndexedDb").afterTransaction({tag:"MsgUpdated",value:d("MAWBridgeMsg").createBridgeMsg(f,void 0,g)});d("MAWIndexedDb").afterTransactionThreadEvent({chatJid:e.jid,msgId:f.msgId},d("MAWThreadEvent").PLACEHOLDER_CONVERT_SUBSCRIPTION);c!=null&&c.forEach(function(a){d("MAWIndexedDb").afterTransaction({tag:"MsgUpdated",value:d("MAWBridgeMsg").createBridgeMsg(a,void 0,h)})});if(f.msgId===e.newestMsg){f.rowId;var b=babelHelpers.objectWithoutPropertiesLoose(f,["rowId"]);return d("MAWDexieTable").dexieAll([d("MAWThreadSnippetBuildTxns").buildThreadSnippet(a,f,e),d("MAWWriteMsgSideEffectTxns").updateParticipantTimestampsForMsg(a,b)]).then(function(a){a=a[0];var b=a.snippetParams,c=a.snippetSenderContactId;a=a.snippetType;d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({chatJid:e.jid,snippetParams:b,snippetSenderContactId:c,snippetType:a,threadId:e.chatId})});return f})}d("MAWAddQPLPointForHandleIncomingMsgApi").addQPLPointForHIMApi("handle_ciphertext_end");return f})})}function f(a,b,c,e){d("MAWAddQPLPointForHandleIncomingMsgApi").addQPLPointForHIMApi("handle_dfm_message_start");var f=d("MAWBuildIncomingMsgs").buildUnstoredDeleteForMeMsg(b,c);return d("MAWDexieTable").dexieAll([d("MAWDbReactionsTxns").deleteReactionsByUniqueMsgIdentifiers(a,[{author:f.author,chatId:f.thread,externalId:f.externalId}]),m(a,f,c),a.pendingStanzas["delete"](e.rowId)]).then(function(a){a[0];a=a[1];d("MAWAddQPLPointForHandleIncomingMsgApi").addQPLPointForHIMApi("handle_dfm_message_end");d("MAWDeleteForMeMsgContentCleaner").addNewDeleteForMeMsgContentCleanerTimestamp(f.messageDeleteForMeTs);return babelHelpers["extends"]({},f,{msgId:a.msgId,rowId:a.rowId})})}function n(a,b,e,f){var g=d("MAWDbPendingStanzaTxns").getRevokedContent(f);if(g==null)throw c("err")("missing revoked content");b=d("MAWBuildIncomingMsgs").buildUnstoredRevokedMsg(b,e,g);d("MAWAddQPLPointForHandleIncomingMsgApi").addQPLPointForHIMApi("handle_revoke_message_start");return d("MAWDexieTable").dexieAll([l(a,b,e),a.pendingStanzas["delete"](f.rowId)]).then(function(b){var c=b[0];return d("MAWWriteRevokeMessageTxns").markIncomingMessageRevoked(a,c,e).then(function(){d("MAWAddQPLPointForHandleIncomingMsgApi").addQPLPointForHIMApi("handle_revoke_message_end");return c})})}g.writeMsg=l;g.writeUnrenderedMsg=m;g.prepareMsgWriteData=a;g.writeNewIncomingMsg=b;g.writeCiphertextUpdate=e;g.handleDeleteForMeMessage=f;g.handleOutOfOrderRevokedMessage=n}),98);
__d("MAWUnsendMsgContentCleaner",["MAWMsgCleaner","WALogger","err"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["UnsendMsgContentCleaner: Adding timestamps (",")"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["startUnsendMsgContentCleaner invoked"]);j=function(){return a};return a}var k=null;function a(a){d("WALogger").LOG(j()),k==null&&(k=new(d("MAWMsgCleaner").MsgCleaner)(a,d("MAWMsgCleaner").CLEANER_TYPE.UNSEND))}function b(a){if(k==null){var b="Trying to add new UnsendMsgContentCleanerTimestamp before the cleaner is initialized!";d("WALogger").ERROR(i(),b);throw c("err")(b)}else d("WALogger").DEV(h(),a),k.update(a)}function e(){return k}function f(){k=null}g.startUnsendMsgContentCleaner=a;g.addNewUnsendMsgContentCleanerTimestamp=b;g.getUnsendMsgContentCleaner_FOR_TESTING_ONLY=e;g.resetUnsendMsgContentCleaner_FOR_TESTING_ONLY=f}),98);
__d("MAWWriteRevokeMessageTxns",["MAWAckLevel","MAWBridgeMsg","MAWBridgeTypesCreators","MAWDbDeletedMessages","MAWDbMsg","MAWDbPendingStanza","MAWDbReactionsTxns","MAWDexieTable","MAWEphemeralUtil","MAWIndexedDb","MAWJidUtils","MAWMsgType","MAWPendingStanzaCleaner","MAWThreadSnippetBuildTxns","MAWUnsendMsgContentCleaner","MAWUpdateQuotedMsgTxns","MAWUploadMessagesBackup","MAWWriteDeleteMessageTxns","MAWXMAUtils","WATimeUtils","err"],(function(a,b,c,d,e,f,g){"use strict";var h=6*d("WATimeUtils").HOUR_SECONDS,i=30*d("WATimeUtils").DAY_SECONDS;function a(a,b,c,e,f){var g=d("WATimeUtils").castToUnixTime(d("WATimeUtils").unixTime()+i),h=b.author,k=b.externalId,m=b.revokedExternalId;f=f!=null?l(a,f):d("MAWDexieTable").dexieResolve();if(e==null){h={deleteTs:g,externalIdWithType:m+"_"+d("MAWDbPendingStanza").PENDING_REVOKED,pendingContent:{content:{ack:d("MAWAckLevel").ACK.received,altIndex:void 0,author:h,externalId:k,revokedExternalId:m,thread:c.chatId,threadJid:c.jid,ts:b.ts,type:"Revoked"},type:d("MAWDbPendingStanza").PENDING_TYPE.REVOKED}};return d("MAWDexieTable").dexieAll([a.pendingStanzas.add(h),f]).then(function(b){b[0];b=b[1];d("MAWPendingStanzaCleaner").addNewPendingStanzaCleanerTimestamp(g);b===!0&&d("MAWThreadSnippetBuildTxns").refreshThreadSnippet(a,c)})}return f.then(function(){return j(a,e,c,b.externalId,b.revokedExternalId,b.serverTs,b.ts,!1)})}function j(a,b,c,e,f,g,i,j){var l=babelHelpers["extends"]({},b,{altIndex:void 0,externalId:e,msgContent:d("MAWDbMsg").getMsgContent(b),originalTs:(e=b.serverTs)!=null?e:b.ts,revokedExternalId:f,serverTs:g,threadJid:c.jid,ts:i,type:"Revoked",unsendMsgContentDeleteTs:d("WATimeUtils").castToUnixTime(d("WATimeUtils").unixTime()+h)});if(j){d("MAWUploadMessagesBackup").sendDeleteEchoMessage(b,c.jid);return d("MAWDexieTable").dexieResolve(l)}return k(a,b,l,c).then(function(){return l})}function k(a,b,c,e){var f;f=d("MAWXMAUtils").isXMAStoryReply((f=b.quote)==null?void 0:f.content.xmaMessageType)?d("MAWWriteDeleteMessageTxns").deleteXMAStoryReplyMsg(a,b):d("MAWDexieTable").dexieResolve();var g=d("MAWJidUtils").toProtocolMsgId(b);g=g!=null?a.deletedMessages.add(babelHelpers["extends"]({},g,{reason:d("MAWDbDeletedMessages").DbDeletedMsgReasonEnum.Revoke})):d("MAWDexieTable").dexieResolve();return d("MAWDexieTable").dexieAll([a.messages.put(c),d("MAWDbReactionsTxns").deleteReactionsByUniqueMsgIdentifiers(a,[{author:c.author,chatId:c.thread,externalId:c.revokedExternalId}]),d("MAWUpdateQuotedMsgTxns").disassociateQuotedMsg(a,c.thread,c.revokedExternalId,c.author,d("MAWMsgType").MSG_TYPE.REVOKED),f,g]).then(function(){d("MAWUnsendMsgContentCleaner").addNewUnsendMsgContentCleanerTimestamp(c.unsendMsgContentDeleteTs);return d("MAWThreadSnippetBuildTxns").refreshThreadSnippet(a,e)}).then(function(){b!=null&&d("MAWUploadMessagesBackup").sendDeleteEchoMessage(b,b.threadJid);d("MAWIndexedDb").afterTransaction({tag:"MsgUpdated",value:d("MAWBridgeMsg").createBridgeMsg(c)});if(b!=null&&d("MAWDbMsg").isMediaMsg(b)){var a=b.mediaId;a!=null&&d("MAWIndexedDb").afterTransaction({tag:"MediaExpired",value:{mediaId:a,msgId:b.msgId,threadId:b.thread}})}d("MAWEphemeralUtil").maybeClearEphemeralMsgCountdown(b)})}function b(a,b,e){if(b.type!==d("MAWMsgType").MSG_TYPE.REVOKED)throw c("err")("Cant mark unrevoked message revoked");var f=d("MAWJidUtils").toProtocolMsgId(b);f=f!=null?a.deletedMessages.add(babelHelpers["extends"]({},f,{reason:d("MAWDbDeletedMessages").DbDeletedMsgReasonEnum.Revoke})):d("MAWDexieTable").dexieResolve();return d("MAWDexieTable").dexieAll([d("MAWDbReactionsTxns").deleteReactionsByUniqueMsgIdentifiers(a,[{author:b.author,chatId:b.thread,externalId:b.revokedExternalId}]),d("MAWThreadSnippetBuildTxns").refreshThreadSnippet(a,e),f]).then(function(){d("MAWUnsendMsgContentCleaner").addNewUnsendMsgContentCleanerTimestamp(b.unsendMsgContentDeleteTs),d("MAWIndexedDb").afterTransaction({tag:"NewMsg",value:d("MAWBridgeMsg").createBridgeMsg(b)})})}function l(a,b){return b.type===d("MAWMsgType").MSG_TYPE.CIPHERTEXT?a.messages["delete"](b.rowId).then(function(){d("MAWIndexedDb").afterTransaction({tag:"DeleteMessages",value:d("MAWBridgeTypesCreators").createBridgeDeleteMessages(b.thread,[b])});return!0}):d("MAWDexieTable").dexieResolve(!1)}g.REVOKE_CONTENT_EXPIRATION_IN_SEC=h;g.writeIncomingRevokeMsg=a;g.revokeUnstoredMsg=j;g.markExistingMsgRevoked=k;g.markIncomingMessageRevoked=b}),98);
__d("EchoBackupCompareUtils",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b;return{contentSubtype:a.contentSubtype,contentType:a.contentType,reactionTsList:(b=a.reactionAuthoritativeTimestampMs)==null?void 0:b.map(function(a){return a.displayName==null?null:Number(a.displayName)/1e3}).filter(Boolean).sort(),receiptTsList:(b=a.receiptStatusList)==null?void 0:b.map(function(a){return a.timestampMs==null?null:a.timestampMs/1e3}).filter(Boolean).sort()}}function g(a,b){if(a==null&&b==null)return!0;if(a!=null&&b!=null)return a.length===b.length&&a.every(function(a,c){return a===b[c]});return a==null&&(b==null?void 0:b.length)===0||b==null&&(a==null?void 0:a.length)===0?!0:!1}function b(a,b){return b!=null&&a.contentSubtype===b.contentSubtype&&a.contentType===b.contentType&&g(a.reactionTsList,b.reactionTsList)}f.buildEchoDocCacheValue=a;f.echoEquals=b}),66);
__d("MAWConstants",[],(function(a,b,c,d,e,f){"use strict";a=5;b="Facebook user";c="Instagram user";d=24;e=3;var g=50;f.MESSAGE_RETRY_COUNT_LIMIT=a;f.FB_UNKNOWN_USER=b;f.INS_UNKNOWN_USER=c;f.MAX_APPDATA_RECIPIENTS=d;f.CURRENT_REGISTRATION_VERSION=e;f.BRIDGE_UPLOAD_BATCH_SIZE=g}),66);
__d("MAWEBBackendQPLUtils",["MAWEBSwitch","MAWQplProxy","Random","gkx","hashString","qpl"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){b=(b=b)!=null?b:c("Random").uint32();d("MAWQplProxy").startQplUserFlow(c("qpl")._(521479468,"1752"),{"int":{numMessagesRestored:0},string:{threadId:a}},b);return b}function b(a,b){d("MAWQplProxy").sendQPLSuccessThroughBridge(c("qpl")._(521479468,"1752"),{string:{threadId:b}},a)}function e(a){return a.dyiBatch.each(function(a){if(a.isThread===!1)return;d("MAWQplProxy").sendQPLFailThroughBridge(c("qpl")._(521479468,"1752"),"dyi_backup_restore_error",{string:{threadId:a.threadId}},a.qplInstanceKeyForThread)})}function f(a,b){if(b.qplInstanceKeyForThread==null)return;a=a===!1?"dyi_backup_restore_continuing":"dyi_backup_restore_finished";var e=b.qplInstanceKeyForThread;d("MAWQplProxy").sendQplPointThroughBridge(c("qpl")._(521479468,"1752"),a,{annotations:{"int":{numMessages:b.numMessages,numMessagesRestored:b.numMessagesRestored},string:{threadId:b.threadId}},instanceKey:(a=e)!=null?a:void 0})}function h(a,b){if(a==null)return;d("MAWQplProxy").sendQPLErrorThroughBridge(c("qpl")._(521479468,"1752"),"dyi_backup_restore_thread_halted",{debugInfo:"DYI attempting to re-restore previous batch - halting DYI for thread "+b,instanceKey:a})}function i(a,b){if(a==null)return;d("MAWQplProxy").sendQPLErrorThroughBridge(c("qpl")._(521479468,"1752"),"dyi_backup_restore_batch_not_in_progress",{debugInfo:"DYI for thread with jid "+b+" is not currently in progress",instanceKey:a})}function j(a,b){if(a==null)return;d("MAWQplProxy").sendQPLErrorThroughBridge(c("qpl")._(521479468,"1752"),"dyi_backup_restore_stopping_dyi",{debugInfo:"Error occurred on restore - stopping DYI for thread with chat jid "+b,instanceKey:a})}function k(a,b){if(a==null)return;d("MAWQplProxy").sendQplPointThroughBridge(c("qpl")._(521478596,"1329"),"dyi_get_thread_list",{annotations:{"int":{threadsToRestore:b}},instanceKey:a})}function l(a){return c("hashString")(a)}function m(a,b){if(c("gkx")("497")!==!0)return;var e=l(b);d("MAWQplProxy").startQplUserFlow(c("qpl")._(521485625,"1876"),{bool:{eb_switch:c("MAWEBSwitch").isEnabled(),is_retroactive_backups_upload:a},string:{trace_id:b}},e)}function n(a,b,e){if(c("gkx")("497")!==!0||a==null)return;a=l(a);d("MAWQplProxy").sendQplPointThroughBridge(c("qpl")._(521485625,"1876"),b,{annotations:e,instanceKey:a})}function o(a,b,e){if(c("gkx")("497")!==!0||a==null)return;a=l(a);d("MAWQplProxy").sendQPLFailThroughBridge(c("qpl")._(521485625,"1876"),b,e,a)}g.startDYIBackupRestoreQplUserFlow=a;g.endSuccessDYIBackupRestoreQplUserFlow=b;g.cleanupDYIBackupRestoreQplUserFlow=e;g.addPointDYIBackupRestoreQplUserFlow=f;g.markErrorDyiBackupRestoreThreadHalt=h;g.markErrorDyiBackupRestoreBatchNotInProgress=i;g.markErrorDyiBackupRestoreStoppingDyi=j;g.logDyiE2EGetThreadList=k;g.getQplInstanceKey=l;g.startEBBackupUploadQplUserFlow=m;g.addPointEBBackupUpload=n;g.endFailEBBackupUpload=o}),98);
__d("MAWEBUploadTrackingUtils",["MAWEBSwitch","MAWExternalId","MAWQplProxy","hashString","qpl"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e,f){if(!c("MAWEBSwitch").isEnabled())return;d("MAWQplProxy").startQplUserFlow(c("qpl")._(521480745,"830"),{bool:{eb_switch:c("MAWEBSwitch").isEnabled()},string:{externalId:a,msgType:b,sendOrReceive:e}},f);h(f,"upload_tracking_started")}function h(a,b,e){d("MAWQplProxy").sendQplPointThroughBridge(c("qpl")._(521480745,"830"),b,{annotations:e,instanceKey:a})}function b(a,b,e){h(a,"upload_tracking_failed"),d("MAWQplProxy").sendQPLFailThroughBridge(c("qpl")._(521485625,"1876"),b,e,a)}var i=new Map();function e(a){if(i.get(a)!=null)return null;var b=c("hashString")(d("MAWExternalId").generateExternalId());i.set(a,b);return b}function f(){var a=new Map(i);i.clear();return a}function j(a){a=i.get(a);return a!=null?a:null}g.startUploadTracking=a;g.addPoint=h;g.endFail=b;g.genInstanceKey=e;g.cloneAndClearInstanceMap=f;g.removeInstanceKey=j}),98);
__d("MAWUploadRetryStatusUtil",["FBLogger","MAWGlobals","MAWIndexedDb","MAWReStoreTiming","MAWTransactionMode","ReQL","WALogger","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Unhandled error in postBackupWriteCompletionHook job: ",""]);h=function(){return a};return a}a=c("gkx")("529")?d("MAWReStoreTiming").measureDuration("checkRetroactiveBackupsStateStore",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.table("e2ee_retroactiveBackupsState"),[])))!=null});return function(b){return a.apply(this,arguments)}}()):d("MAWIndexedDb").makeMsgrTransactor({retroactiveBackupsState:d("MAWTransactionMode").READONLY},"checkRetroactiveBackupsStateStore",function(a){return function(){return a.retroactiveBackupsState.count().then(function(a){return a>0?!0:!1})}});e=d("MAWIndexedDb").makeMsgrTransactor({uploadRetryStatus:d("MAWTransactionMode").READWRITE},"uploadRetry",function(a){return function(b){return a.uploadRetryStatus.bulkAdd(b.map(function(a){return{externalId:a.msg.externalId,lastRetryTs:a.lastRetryTs,retriedTimes:a.retriedTimes,traceId:a.traceId}})).then(function(a){})}});var i=d("MAWIndexedDb").makeMsgrTransactor({uploadRetryStatus:d("MAWTransactionMode").READWRITE},"bulkRemoveRetries",function(a){return function(b){return a.uploadRetryStatus.where("traceId").anyOf(b)["delete"]()}});f=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("postBackupWriteCompletionHook",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.traceIdArray;if(!c("gkx")("8100"))return;if(a==null||a.length===0){c("FBLogger")("labyrinth_web").info("[labyrinth_web] postBackupWriteCompletionHook get null/empty input.");return}try{yield i(a)}catch(a){d("WALogger").ERROR(h(),a)}});return function(b){return a.apply(this,arguments)}}()).end();g.checkRetroactiveBackupsStateStore=a;g.bulkInsert=e;g.bulkRemove=i;g.postBackupWriteCompletionHook=f}),98);
__d("MAWUploadMessagesBackup",["$InternalEnum","EchoBackupCompareUtils","EchoMessage","FBLogger","LSDataTraceCheckPoint","LSDataTraceType","LSEBPayloadSerializerError","LSIntEnum","LSMEBTaskCreationSource","MAWBridge","MAWBridgeEventTransmitter","MAWBridgeTrace","MAWBridgeUpload","MAWConstants","MAWDbMsg","MAWDbMsgTxns","MAWDbMsgUtil","MAWDbPendingStanza","MAWDbThreadTxns","MAWDbXMA","MAWDexieTable","MAWEBBackendQPLUtils","MAWEBSwitch","MAWEBUploadMessageUtils","MAWEBUploadTrackingUtils","MAWEncryptedBackupCacheManager","MAWGlobals","MAWHMACKey","MAWHandlePendingStanzasInRestoreV2","MAWIndexedDb","MAWMsgType","MAWQplProxy","MAWReceiveToUploadUtils","MAWTraceUtils","MAWTransactionMode","MAWUploadRetryStatusUtil","Promise","WAGlobals","WAJids","WALogger","WAProtocolMsgId","WAStanzaUtils","WATimeUtils","asyncToGeneratorRuntime","cr:5916","gkx","qpl","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Cannot proceed with encodeAndSendEchoMessage: Encrypted Backups are not enabled"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] possible error when constructing echo message: ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Duplicated upload stopped by cache, extId: ",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] threadJid is null for pendingStanza"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] thread is null for pendingStanza"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] externalId is null for pendingStanza"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] pendingStanzaMessageType: "," not supported"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Unhandled error in uploadMessagesBackup job: ",""]);u=function(){return a};return a}var v=c("requireDeferred")("EchoSerializationFailureFalcoEvent").__setRef("MAWUploadMessagesBackup"),w=c("requireDeferred")("EchoSerializationSuccessFalcoEvent").__setRef("MAWUploadMessagesBackup");f=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("echoSerialization",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.messageIds,c=a.oldTraceIdMap,e=a.pendingStanzaIds,f=a.reactionIds,g=a.uploadTrackingInstanceMap;a=a.xmaIds;try{a=d("MAWDbXMA").convertNumbersToXMAIds(a);e=(e=e)!=null?e:[];yield y(b,e,f,a,c,g)}catch(a){d("WALogger").ERROR(u(),a)}});return function(b){return a.apply(this,arguments)}}()).end();function a(a){return a==null?[]:a.filter(Boolean).map(function(a){if(a!=null)return d("MAWDbMsg").toMsgId(a)}).filter(Boolean)}var x=b("$InternalEnum").Mirrored(["FATAL","WARN"]);function y(a,b,c,d,e,f){a=D(a,b,c,d).then(function(a){return P(a,void 0,!1,e,f)});return a.then(function(){})}function z(a,b){return a.messages.bulkGet(b).then(function(a){return a.filter(Boolean)})}function A(a,b){return a.pendingStanzas.bulkGet(b).then(function(a){return a.filter(Boolean).map(function(a){var b=a.pendingContent.type;if(b==null||b!==d("MAWDbPendingStanza").PENDING_TYPE.REVOKED&&b!==d("MAWDbPendingStanza").PENDING_TYPE.DELETE_FOR_ME){d("WALogger").WARN(t(),b);return}b=a.pendingContent.content.externalId;if(b==null){d("WALogger").WARN(s());return}b=a.pendingContent.content.thread;if(b==null){d("WALogger").WARN(r());return}b=a.pendingContent.content.threadJid;if(b==null){d("WALogger").WARN(q());return}d("MAWHandlePendingStanzasInRestoreV2").issuePointQueryForPendingStanza(a)})}).then(function(a){return[]})}function B(a,b){return a.reactions.bulkGet(b).then(function(b){b=b.filter(Boolean).map(function(b){return d("MAWDbThreadTxns").getThreadByJid(a,b.threadJid).then(function(e){var f=e.success?e.value:null;if(f!=null&&f.chatId!=null){e=b.reactToAuthor;e=e===d("WAGlobals").getMyUserJid()?d("WAJids").AUTHOR_ME:e;return d("MAWDbMsgTxns").maybeGetMsgByExternalId(a,b.reactToExternalId,f.chatId,e).then(function(a){if(a==null&&!d("MAWEncryptedBackupCacheManager").peekRestoreCache(b.reactToExternalId)){var e=d("WAJids").threadIdForChatJid(f.jid);d("MAWEncryptedBackupCacheManager").addMsgEntryToReuploadCache(f.chatId,b.reactToExternalId);d("MAWBridgeEventTransmitter").issuePointQueryOutsideTxn(b.reactToExternalId,e,void 0,c("LSMEBTaskCreationSource").EB_POINT_QUERY_IN_ACT)}return a})}})});return d("MAWDexieTable").dexieAll(b).then(function(a){return a.filter(Boolean)})})}function C(a,b){b=b.filter(Boolean);return a.xma.bulkGet(b).then(function(b){b=b.map(function(a){return a==null?void 0:a.associatedMessageId}).filter(Boolean);return a.messages.where("msgId").anyOf(b).toArray()})}var D=d("MAWIndexedDb").makeMsgrAndSignalTransactor({messages:(j=d("MAWTransactionMode")).READONLY,pendingStanzas:j.READONLY,reactions:j.READONLY,threads:j.READONLY,xma:j.READONLY},"uploadMsgBackupGetMsgs",function(a){return function(b,c,d,e){return R(a,b,c,d,e)}});function E(a,b,c){F({tag:"UploadMessageByBatch",value:{checkPoint:a,messages:b,qpl:c}})}function F(a){a=[a];d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:a})}function G(a,b){var e=[],f=[];if(a!=null){var g=c("gkx")("497"),h=c("qpl")._(521485625,"1876");b.forEach(function(b){var c=b.checkPoint;b=b.pointName;g&&b!=null&&e.push({action:{name:b,type:"point"},annotations:null,event:h,instanceKey:d("MAWEBBackendQPLUtils").getQplInstanceKey(a),timestamp:d("MAWQplProxy").performanceAbsoluteNow()});f.push(d("MAWBridgeTrace").createBridgeTraceRecordCheckpointData((i||(i=d("LSIntEnum"))).ofNumber(c),a,void 0,!1,-1,void 0))})}return{checkPointArray:f,qplArray:e}}function H(a,b,c,e,f,g){var h=b.xOfflineThreadingId;if(h==null)return!1;var i=d("WAStanzaUtils").toStanzaId(h);if(d("MAWEncryptedBackupCacheManager").getRestoredCacheStatus(i)==="done"){var j=d("EchoBackupCompareUtils").buildEchoDocCacheValue(b);j=d("EchoBackupCompareUtils").echoEquals(j,d("MAWEncryptedBackupCacheManager").getRestoredCache(i));d("MAWEncryptedBackupCacheManager").removeFromRestoredCache(i);if(j){d("WALogger").LOG(p(),i);return!1}}if(c!=null&&e!=null){j=window.performance.now();i=d("EchoMessage").encodeEchoMessage(b);var k=window.performance.now();a.push(d("MAWBridgeUpload").createBridgeUploadMessage(h,b.threadId,d("MAWEBUploadMessageUtils").echoOverrideMessageSortOrder(c),c.serverTs,(k-j)*1e6,i,1,null,null,e,L(g,c.externalId),f));M(g,c.externalId,"construct_echo_success");J(c.externalId,e);return!0}return!1}function I(a,b){a!=null&&d("MAWReceiveToUploadUtils").checkUploadEligbility(a)&&void v.load().then(function(c){return c.log(function(){return{message_id:a,trace_id:b}})})}function J(a,b){a!=null&&d("MAWReceiveToUploadUtils").checkUploadEligbility(a)&&void w.load().then(function(c){return c.log(function(){return{message_id:a,trace_id:b}})})}function K(a,e,f){var g=new Map();a.forEach(function(a){return g.set(a.dbMsg.externalId,a)});return Q(a).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=[],h=[],j=[],k=[];a.forEach(function(a){var l,m=g.get(a.externalId)||{dbMsg:null,traceId:null},n=m.dbMsg;m=m.traceId;l=n!=null?(l=e==null?void 0:e.find(function(a){var b=d("MAWDbMsgUtil").getProtocolMsgIdFromDbMsg(n);return b==null?!1:d("WAProtocolMsgId").equals(a.msgId,b)}))!=null?l:void 0:void 0;var p=a.echoMessage,q=[];if(a.maybeErrorDetail!=null){a=a.maybeErrorDetail;var r=!1;if(n!=null&&m!=null){if(a.uploadErrorType===x.WARN)d("WALogger").WARN(o(),a.errorMsg);else if(a.errorCode===c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID)c("FBLogger")("labyrinth_web").warn("media info invalid thrown from constructEchoMessage, error msg: %s",a.errorMsg);else{var s;h.push(d("MAWBridgeUpload").createBridgeUploadMessage((s=p==null?void 0:p.xOfflineThreadingId)!=null?s:"0",(s=p==null?void 0:p.threadId)!=null?s:"0",d("MAWEBUploadMessageUtils").echoOverrideMessageSortOrder(n),n.serverTs,null,null,1,a.errorCode,a.errorMsg,m,L(f,n.externalId),l));M(f,n.externalId,"construct_echo_success");r=!0}r||N(f,n.externalId,"construct_echo_failed",{string:{errorMsg:a.errorMsg}});I(n.externalId,m)}b.push(m);return}if((p==null?void 0:p.xOfflineThreadingId)==null){if(n!=null&&m!=null){h.push(d("MAWBridgeUpload").createBridgeUploadMessage("0",(s=p==null?void 0:p.threadId)!=null?s:"0",d("MAWEBUploadMessageUtils").echoOverrideMessageSortOrder(n),n.serverTs,null,null,1,c("LSEBPayloadSerializerError").OTID_NOT_FOUND_IN_ACT_MESSAGES,null,m,L(f,n.externalId),l));N(f,n.externalId,"construct_echo_failed",{string:{errorMsg:"oitd not found"}});J(n.externalId,m)}b.push(m)}else{r=H(h,p,n,m,l,f);if(!r){n!=null&&N(f,n.externalId,"construct_echo_failed",{string:{errorMsg:"not unique"}});return}}q.push({checkPoint:c("LSDataTraceCheckPoint").LABYRINTH_WEB_UPLOAD_ISSUE_MESSAGE_UPLOAD_UI_EVENT,pointName:"issue_message_upload_ui_event"});a=G(m,q);s=a.checkPointArray;p=a.qplArray;j.push.apply(j,p);k.push.apply(k,s);d("MAWTraceUtils").startNewTrace((i||(i=d("LSIntEnum"))).ofNumber(c("LSDataTraceType").ENCRYPTED_BACKUPS_UPLOAD),d("MAWTraceUtils").CONTEXT_BACKUP_UPLOAD,m);(h.length>=d("MAWConstants").BRIDGE_UPLOAD_BATCH_SIZE||k.length>=d("MAWConstants").BRIDGE_UPLOAD_BATCH_SIZE)&&(E(k.slice(),h.slice(),j.slice()),k.length=0,h.length=0,j.length=0)});(h.length>0||k.length>0)&&E(k,h,j);c("gkx")("8100")&&(yield d("MAWUploadRetryStatusUtil").bulkRemove(b.filter(Boolean)));return a});return function(b){return a.apply(this,arguments)}}())}function L(a,b){return a==null?void 0:a.get(b)}function M(a,b,c,e){a=L(a,b);a!=null&&d("MAWEBUploadTrackingUtils").addPoint(a,c,e)}function N(a,b,c,e){a=L(a,b);a!=null&&d("MAWEBUploadTrackingUtils").endFail(a,c,e)}function O(a){var b=new Set(),c=[];a.forEach(function(a){var e=a.externalId+"|"+a.thread.toString()+"|"+a.author;d("MAWEncryptedBackupCacheManager").getRestoredCacheStatus(a.externalId)!=="restoring"&&!b.has(e)&&(b.add(e),c.push(a))});return c}function P(a,e,f,g,i,j){if(!c("MAWEBSwitch").isEnabled()){d("WALogger").LOG(n());return(h||(h=b("Promise"))).resolve()}var k=O(a).filter(function(a){return d("MAWMsgType").isEBSupportedMsgType(a.type)&&a.serverTs!=null&&!(a.ephemeralSetting!=null&&a.ephemeralSetting.ephemeralExpirationInSec>0)}).map(function(a){M(i,a.externalId,"construct_echo_start",f!=null?{bool:{isRetroactiveBackupsUpload:f}}:void 0);var b=d("MAWTraceUtils").createTraceId();d("MAWEBBackendQPLUtils").startEBBackupUploadQplUserFlow(f,b);f!=null&&f&&d("MAWEBBackendQPLUtils").addPointEBBackupUpload(b,"retroactive_backup_upload_started");return{lastRetryTs:d("WATimeUtils").millisTime(),msg:a,retriedTimes:0,traceId:b}});return(c("gkx")("8100")?d("MAWUploadRetryStatusUtil").bulkInsert(k):(h||(h=b("Promise"))).resolve()).then(function(a){return S(k.map(function(a){var b=a.msg.quoteExternalId;if(b!=null)return{dbMsg:a.msg,quotedMsg:e==null?void 0:e.get(b),traceId:a.traceId};else return{dbMsg:a.msg,traceId:a.traceId}}),g,j,i)}).then(function(){return(h||(h=b("Promise"))).resolve()})}var Q=d("MAWIndexedDb").makeMsgrAndSignalTransactor({contacts:j.READONLY,editMsgHistory:j.READONLY,media:j.READONLY,mediaBackup:j.READONLY,messages:j.READONLY,reactions:j.READONLY,threads:j.READONLY,xma:j.READONLY},"constructEchoMessage",function(a){return function(){for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b("cr:5916").constructEchoMessage.apply(b("cr:5916"),[a].concat(d))}});function R(a,b,e,f,g){b=z(a,b);c("gkx")("7572")?A(a,e):d("MAWDexieTable").dexieResolve();e=B(a,f);f=C(a,g);return d("MAWDexieTable").dexieAll([b,e,f]).then(function(a){return a.flat()})}function S(a,e,f,g){var j=new Map();a.forEach(function(a){var b=a.dbMsg;a=a.traceId;d("MAWEBBackendQPLUtils").addPointEBBackupUpload(a,"echo_message_upload_begin",{string:{message_type:b.type}});var f=d("MAWQplProxy").startQplUserFlow(c("qpl")._(521475102,"868"),{bool:{eb_switch:c("MAWEBSwitch").isEnabled()},"int":{sort_order:b.sortOrderMs,timestamp:Date.now()},string:{hashed_msgid:T(b.externalId),message_id:b.externalId,message_type:b.type.toString(),org_trace_id:e==null?void 0:e.get(b.externalId),trace_id:a}});j.set(b.externalId,{constructEchoFlow:f,traceId:a})});a=K(a,f,g)["catch"](function(a){a="[labyrinth_web] Error while encode and upload message to backup: "+String(a);d("WALogger").ERROR(m(),a);for(var e of j.values())d("MAWEBBackendQPLUtils").endFailEBBackupUpload(e.traceId,"echo_message_upload_failure",{string:{error_message:a}}),d("MAWTraceUtils").recordFailureAndFlushForTraceId(e.traceId,(i||(i=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_WEB_ECHO_MESSAGE_UPLOAD_FAILURE),[],a),e.constructEchoFlow.endFail("serialisation_failure");return(h||(h=b("Promise"))).resolve()});return a.then(function(a){a==null?void 0:a.forEach(function(a){var b;b=(b=a.echoMessage)==null?void 0:b.messageId;if(b!=null&&j.has(d("WAStanzaUtils").toStanzaId(b))){var e;b=j.get(d("WAStanzaUtils").toStanzaId(b))||{constructEchoFlow:null,traceId:null};var f=b.constructEchoFlow;b=b.traceId;e=a==null?void 0:(e=a.maybeErrorDetail)==null?void 0:e.uploadErrorType;a=a==null?void 0:(a=a.maybeErrorDetail)==null?void 0:a.errorMsg;if(e!=null)switch(e){case x.WARN:a!=null&&d("WALogger").WARN(l(),a);f==null?void 0:f.endSuccess({bool:{is_skipped:!0}});b!=null&&(d("MAWEBBackendQPLUtils").addPointEBBackupUpload(b,"echo_message_upload_invalid_request"),d("MAWTraceUtils").recordInvalidUploadRequestAndFlushTrace(b,(i||(i=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_WEB_ECHO_MESSAGE_UPLOAD_INVALID_REQUEST),[]));break;case x.FATAL:a=(e=a)!=null?e:"[labyrinth_web] unknown error in the upload message flow";d("WALogger").ERROR(k(),a);b!=null&&(d("MAWEBBackendQPLUtils").endFailEBBackupUpload(b,"echo_message_upload_failure",{string:{error_message:a}}),d("MAWTraceUtils").recordFailureAndFlushForTraceId(b,(i||(i=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_WEB_ECHO_MESSAGE_UPLOAD_FAILURE),[],a));f==null?void 0:f.endFail("serialisation_failure");break}else f==null?void 0:f.endSuccess()}});return(h||(h=b("Promise"))).resolve()})}function T(a){if(a==null)return"";var b=d("MAWGlobals").getHMACKey();return d("MAWHMACKey").hmacTweetNaCl(a,b)}function e(a,b){var e=d("MAWTraceUtils").startNewTrace((i||(i=d("LSIntEnum"))).ofNumber(c("LSDataTraceType").ENCRYPTED_BACKUPS_UPLOAD),d("MAWTraceUtils").CONTEXT_BACKUP_UPLOAD);d("MAWTraceUtils").recordCheckpointForTrace(e,i.ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_WEB_ECHO_MESSAGE_UPLOAD_BEGIN),[d("MAWTraceUtils").getTagForMsgType(a.type)],!1);b=b==null?a.thread.toString():d("WAJids").threadIdForChatJid(b);d("MAWIndexedDb").afterTransaction({tag:"UploadMessage",value:d("MAWBridgeUpload").createBridgeUploadMessage(a.externalId,b,d("MAWEBUploadMessageUtils").echoOverrideMessageSortOrder(a),a.serverTs,null,null,2,null,null,e,null)})}g.uploadMessagesBackup=f;g.convertStringMsgIdtoMsgId=a;g.UploadErrorType=x;g.deduplicateMessageArray=O;g.uploadUniqueMessage=P;g.getMessagesBackupForUpload=R;g.sendDeleteEchoMessage=e}),98);
__d("MAWHandlePendingStanzasInRestoreV2",["I64","LSMEBTaskCreationSource","MAWBridgeEventTransmitter","MAWDbPendingStanza","MAWDbPendingStanzaTxns","MAWDbThreadTxns","MAWDexieTable","MAWEncryptedBackupCacheManager","MAWIndexedDb","MAWReStoreTiming","MAWRestoreDbState","MAWTransactionMode","MAWUploadMessagesBackup","MAWWriteRevokeMessageTxns","Promise","ReQL","WAJids","WALogger","cr:553","nullthrows","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] pendingStanza type "," is not supported"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] revokedExternalId is null for pendingStanza"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] revokedExternalId is null for pendingStanza"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] threadJid is null for pendingStanza"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] pendingStanzaTs is null for pendingStanza"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] revokedExternalId is null for pendingStanza"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] externalId is null for pendingStanza"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Could not find thread for chatId "," for pendingStanza"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Delete For Me pending stanza does not need to be applied."]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] thread is null"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] pendingStanza type "," is not supported"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Pending Stanza not found in the cache. This shouldn't happen."]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] externalId is null for pendingStanza"]);v=function(){return a};return a}var w=(a=b("cr:553"))==null?void 0:a.structuredClone;e=function(a,c,d){a=a.restoredMsgsData;if(a){var e=a.newlyAddedMsgs;e=e.concat(a.existingMsgs);return x(e,c,d)}return(i||(i=b("Promise"))).resolve()};var x=function(a,e,f){f==null?void 0:f.addPoint("apply_pending_stanza_start");var g=0,h=0,j=0,k=0,l=new Map();return F().then(function(a){a==null?void 0:a.map(function(a){var b=a.pendingContent.content.externalId;if(b==null){d("WALogger").WARN(v());return}l.set(a.externalIdWithType,a)}),k=l.size}).then(function(){var b=new Set();return B(a).then(function(f){return d("MAWDexieTable").dexieAll(a.map(function(a){var c=a.externalId;if(e)if(d("MAWEncryptedBackupCacheManager").peekPendingStanzaCache(c)){var i=d("MAWEncryptedBackupCacheManager").getPendingStanzaCacheValue(c);if(i==null){d("WALogger").ERROR(u());return}return A(i,a,f,e).then(function(a){a!=null&&b.add(i);d("MAWEncryptedBackupCacheManager").removePendingStanzaCacheValue(c);l["delete"](i.externalIdWithType);a=i.pendingContent.type;a===d("MAWDbPendingStanza").PENDING_TYPE.REVOKED&&g++;h++})}else l.clear();else{var k=c+"_"+d("MAWDbPendingStanza").PENDING_REVOKED,m=l.get(k);if(m!=null)return A(m,a,f,e).then(function(a){a!=null&&(b.add(m),g++,j++),l["delete"](m.externalIdWithType)})}})).then(function(){if(!e){var a=y(l);g+=a[1];h+=a[0]+a[1];c("promiseDone")(z(Array.from(b)))}})})}).then(function(a){f==null?void 0:f.addPoint("apply_pending_stanza_end",{"int":{initialRestorePendingStanzaCount:j,pendingStanzasToBeUploadedCount:k,pointRestorePendingStanzaCount:h,revokedCount:g}});return(i||(i=b("Promise"))).resolve()})},y=function(a){var b=0,c=0;a.forEach(function(a){var e=a.pendingContent.type;e===d("MAWDbPendingStanza").PENDING_TYPE.REVOKED?c++:e===d("MAWDbPendingStanza").PENDING_TYPE.DELETE_FOR_ME&&b++;E(a)});a.clear();return[b,c]},z=d("MAWIndexedDb").makeMsgrTransactor({pendingStanzas:d("MAWTransactionMode").READWRITE},"deletePendingStanzasFromIndexedDB",function(a){return function(b){return d("MAWDbPendingStanzaTxns").deletePendingStanzas(a,b)}}),A=function(a,e,f,g){var h=a.pendingContent.type;if(h===d("MAWDbPendingStanza").PENDING_TYPE.REVOKED)return D(a,e,f,g).then(function(a){a!=null&&c("promiseDone")(d("MAWUploadMessagesBackup").uploadUniqueMessage([a],void 0,!1,void 0))});else if(h===d("MAWDbPendingStanza").PENDING_TYPE.DELETE_FOR_ME)return C(a);else{d("WALogger").WARN(t(),h);return(i||(i=b("Promise"))).resolve()}},B=d("MAWIndexedDb").makeMsgrTransactor({threads:d("MAWTransactionMode").READONLY},"getThreadsForMessages",function(a){return function(b){var c=[];b.forEach(function(a){c.push(a.thread)});return d("MAWDbThreadTxns").getThreads(a,c).then(function(a){var b=new Map();a.forEach(function(a){if(a==null){d("WALogger").WARN(s());return d("MAWDexieTable").dexieResolve()}b.set(a.chatId,a)});return b})}}),C=d("MAWIndexedDb").makeMsgrTransactor({pendingStanzas:d("MAWTransactionMode").READWRITE},"deleteForMeMsg",function(a){return function(b){d("WALogger").LOG(r());return d("MAWDexieTable").dexieAll([a.pendingStanzas["delete"](b.rowId)]).then(function(){return d("MAWDexieTable").dexieResolve(b)})}}),D=d("MAWIndexedDb").makeMsgrAndSignalTransactor({chunk:d("MAWTransactionMode").READONLY,contacts:d("MAWTransactionMode").READONLY,deletedMessages:d("MAWTransactionMode").READWRITE,groupInfo:d("MAWTransactionMode").READWRITE,media:d("MAWTransactionMode").READONLY,messages:d("MAWTransactionMode").READWRITE,pendingStanzas:d("MAWTransactionMode").READWRITE,reactions:d("MAWTransactionMode").READWRITE,threads:d("MAWTransactionMode").READWRITE,xma:d("MAWTransactionMode").READONLY},"revokeMessage",function(a){return function(b,c,e,f){var g=c.thread;e=e.get(c.thread);if(e==null){d("WALogger").ERROR(q(),g);return d("MAWDexieTable").dexieResolve()}g=b.pendingContent.content.externalId;if(g==null){d("WALogger").ERROR(p());return d("MAWDexieTable").dexieResolve()}var h=b.pendingContent.content.revokedExternalId;if(h==null){d("WALogger").ERROR(o());return d("MAWDexieTable").dexieResolve()}var i=b.pendingContent.content.ts;if(i==null){d("WALogger").ERROR(n());return d("MAWDexieTable").dexieResolve()}return d("MAWWriteRevokeMessageTxns").revokeUnstoredMsg(a,c,e,g,h,c.serverTs,c.ts,f).then(function(c){a.pendingStanzas["delete"](b.rowId);return d("MAWDexieTable").dexieResolve(c)})}});function E(a){var b=a.pendingContent.content.threadJid;if(b==null){d("WALogger").WARN(m());return}b=d("WAJids").threadIdForChatJid(b);var e=a.pendingContent.type;if(e===d("MAWDbPendingStanza").PENDING_TYPE.REVOKED){var f=a.pendingContent.content.revokedExternalId;if(f==null){d("WALogger").WARN(l());return}f=f}else if(e===d("MAWDbPendingStanza").PENDING_TYPE.DELETE_FOR_ME){var g=a.pendingContent.content.externalId;if(g==null){d("WALogger").WARN(k());return}f=g}else{d("WALogger").WARN(j(),e);return}d("MAWEncryptedBackupCacheManager").addPendingStanzaToPendingStanzaCache(f,a);d("MAWBridgeEventTransmitter").issuePointQueryOutsideTxn(f,b,void 0,c("LSMEBTaskCreationSource").EB_POINT_QUERY_IN_ACT)}var F=d("MAWRestoreDbState").isUsingShim()?d("MAWReStoreTiming").measureDuration("getAllPendingStanzas",function(a){return d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.table("e2ee_pendingStanzas")).map(function(a){a=c("nullthrows")(w)(a);return babelHelpers["extends"]({},a,{rowId:(h||(h=d("I64"))).to_float(a.rowId)})}))}):d("MAWIndexedDb").makeMsgrTransactor({pendingStanzas:d("MAWTransactionMode").READONLY},"getAllPendingStanzas",function(a){return function(){return d("MAWDbPendingStanzaTxns").getAllPendingStanzas(a)}});g.applyPendingStanzas=e;g.issuePointQueryForPendingStanza=E}),98);
__d("MAWUploadMessageTxns",["EchoCommonUtils","EchoEncodingUtils","EchoMessage","LSEBPayloadSerializerError","LSMEBTaskCreationSource","MAWBridgeEventTransmitter","MAWConvertExtendedContentOverlayIconGlyphToXMAGatingType","MAWConvertExtendedContentTargetTypeToXMATargetType","MAWConvertExtendedContentXMLLayoutTypeToXMALayoutType","MAWDbContactsTxns","MAWDbEditMsgHistoryTxns","MAWDbMediaTxns","MAWDbMsg","MAWDbMsgTxns","MAWDbReactionsTxns","MAWDbXMATxns","MAWDexieTable","MAWEBUploadMessageUtils","MAWEncryptedBackupCacheManager","MAWGetAttachmentTypeForServerMediaType","MAWGetMediaAttachmentTypeForServerMediaType","MAWGetPreviewContentTypeForMediaType","MAWGlobals","MAWJidUtils","MAWJids","MAWMsgType","MAWUploadMessagesBackup","MAWVault","WAArmadilloXMA.pb","WABase64","WAJids","WALogger","WAMediaUtils","WATimeUtils","err","gkx"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] edit history has length ",", but edit count on message is ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] No XMA object found for msg with external id ",". Cannot upload XMA"]);k=function(){return a};return a}function l(a,b){return a.threads.get(b).then(function(a){if(a==null)throw c("err")("constructEchoMessage: thread not present");return a.jid})}var m="You unsent a message";function n(a){switch(a.specialTextSize){case 1:return d("EchoMessage").MessageTextSize.SMALL;case 2:return d("EchoMessage").MessageTextSize.MEDIUM;case 3:return d("EchoMessage").MessageTextSize.LARGE;default:return d("EchoMessage").MessageTextSize.NONE}}function o(a,b){return d("MAWDbXMATxns").maybeGetXMAFromProtocolMsgId(a,d("MAWJidUtils").maybeToProtocolMsgId(b.author,b.threadJid,b.externalId)).then(function(e){if(e!=null)return e.previewMediaIds!=null?d("MAWDexieTable").dexieAll(e.previewMediaIds.map(function(b){return d("MAWDbMediaTxns").maybeGetMediaFromMediaId(a,b)})).then(function(a){for(var a=a,b=Array.isArray(a),f=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(b){if(f>=a.length)break;g=a[f++]}else{f=a.next();if(f.done)break;g=f.value}g=g;if(g==null)return d("MAWDexieTable").dexieResolve({maybeErrorDetail:{errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"constructEchoMessage: DbMedia is null for the XMA message",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.WARN},xmaData:void 0});if(g.fbid==null)return d("MAWDexieTable").dexieResolve({maybeErrorDetail:{errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"constructEchoMessage: fbid is null for the XMA message",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.WARN},xmaData:void 0})}return v(e)}):v(e);else{d("WALogger").ERROR(k(),b.externalId);return d("MAWDexieTable").dexieResolve({maybeErrorDetail:{errorCode:c("LSEBPayloadSerializerError").UNKNOWN_ERROR,errorMsg:"constructEchoMessage: no xma object found for msg with external id "+b.externalId,uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL},xmaData:void 0})}})}function p(a,b){try{return d("MAWDbMsg").isMediaMsg(a)||a.type===d("MAWMsgType").MSG_TYPE.XMA}catch(e){a="[labyrinth_web] Invalid msg type for isMediaMsg check: "+e;d("WALogger").ERROR(j(),a);b.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:a,uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return!1}}function q(a,b){return{echoMessage:null,externalId:a,maybeErrorDetail:{errorCode:c("LSEBPayloadSerializerError").NOT_IMPLEMENTED,errorMsg:b,uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.WARN}}}function r(a,b,e,f){var g=f.threadJid!=null?d("MAWDexieTable").dexieResolve(f.threadJid):l(a,f.thread);b=d("MAWDbContactsTxns").maybeGetContactName(a,b);var h={mediaMetadata:null},i=p(f,h);i=i?t(a,f):d("MAWDexieTable").dexieResolve(h);h=u(a,f);e=f.quote!=null?B(a,f.quote,f.thread,g,e):d("MAWDexieTable").dexieResolve();var j=f.quote!=null?A(a,e):d("MAWDexieTable").dexieResolve(),k=d("MAWDbMsg").isXMAMsg(f)?o(a,f):d("MAWDexieTable").dexieResolve(null),m=[];a=c("gkx")("10617")?d("MAWDbEditMsgHistoryTxns").getEditHistoryAsEchoWithJidPromise(a,f.externalId,f.author,g):d("MAWDexieTable").dexieResolve(m);return{editHistoryPromise:a,mediaMetadataUploadPromise:i,quotedMsgPromise:e,quotedMsgSenderDisplayNamePromise:j,reactionsPromise:h,senderDisplayNamePromise:b,threadJidPromise:g,xmaDataUploadRequestPromise:k}}function s(a,b,c,e,f,g,h,j,k,l){var o;a=d("WAJids").threadIdForChatJid(a);var p=k.serverTs;o=(o=k.editCount)!=null?o:0;j.length>0&&j.length-1!==k.editCount&&(d("WALogger").WARN(i(),j.length,k.editCount),o=j.length-1);p={authoritativeTimestampMs:p!=null?p*1e3:void 0,contentSubtype:d("EchoMessage").EchoMessageContentSubtype.NONE,contentType:d("EchoMessage").EchoMessageContentType.TEXT,displayTimestampMs:k.ts*1e3,editCount:o,editHistory:j,from:d("EchoCommonUtils").craftEchoAddress(b,l,"AdvancedCrypto"),isForwarded:k.isForwarded,messageId:k.externalId,serializationOrigin:d("EchoMessage").EchoSerializationOriginType.WEB,sortOrderMs:d("MAWEBUploadMessageUtils").echoOverrideMessageSortOrder(k),textSize:n(k),threadId:a,version:d("EchoMessage").ECHO_MESSAGE_MIGRATION_DOCUMENT_VERSION,xContentType:d("EchoEncodingUtils").convertDbMsgTypeToXMessageContentType(k.type),xMessagePlaceholderType:d("EchoMessage").EchoMessagePlaceholderType.NO_PLACEHOLDER,xOfflineThreadingId:k.externalId,xThreadId:a};((o=k.msgContent)==null?void 0:o.content)!=null&&(p=babelHelpers["extends"]({},p,{text:d("MAWVault").unvault(k.msgContent.content)}));k.type===d("MAWMsgType").MSG_TYPE.REVOKED&&(p.contentType=d("EchoMessage").EchoMessageContentType.PLACEHOLDER,p.contentSubtype=d("EchoMessage").EchoMessageContentSubtype.UNSEND,p.revokeSentTimestampMs=k.originalTs,p.revokeUnsentTimestampMS=k.unsendMsgContentDeleteTs,p.text=m);if(f!=null){j=z(f);b=j.senderId;l=d("EchoCommonUtils").craftEchoAddress(g,b,"AdvancedCrypto");f.sortOrderMs!=null&&(p.quoteData={quoteMessageId:f.externalId,quoteMessageSender:l,quoteSortOrderInMs:f.sortOrderMs})}if(d("MAWMsgType").isMAWSupportedMediaType(k.type)){a=c.mediaMetadata;if(a!=null)p=babelHelpers["extends"]({},p,{contentType:d("EchoMessage").EchoMessageContentType.MEDIA,mediaData:a});else if(k.type!==d("MAWMsgType").MSG_TYPE.XMA)return{echoMessage:p,externalId:k.externalId,maybeErrorDetail:c.maybeErrorDetail}}if(h!=null&&h.xmaData!=null&&k.type===d("MAWMsgType").MSG_TYPE.XMA){p.xmaData=h.xmaData;p.contentType=d("EchoMessage").EchoMessageContentType.XMA;if(p.mediaData==null&&((o=h.xmaData)==null?void 0:o.xmaDefaultCTA)!=null&&p.text==null){p.text=(j=h.xmaData)==null?void 0:j.xmaDefaultCTA}}else if(h!=null&&h.xmaData==null&&k.type===d("MAWMsgType").MSG_TYPE.XMA)return{echoMessage:p,externalId:k.externalId,maybeErrorDetail:h.maybeErrorDetail};return{echoMessage:babelHelpers["extends"]({},p,e),externalId:k.externalId}}function a(a,b){return d("MAWDexieTable").dexieAll(b.map(function(b){var c=b.dbMsg;b=b.quotedMsg;if(!d("MAWMsgType").isEBSupportedMsgType(c.type))return d("MAWDexieTable").dexieResolve(q(c.externalId,'constructEchoMessage: "'+String(c.type)+'" NYI'));if(c.serverTs==null)return d("MAWDexieTable").dexieResolve(q(c.externalId,'constructEchoMessage: "'+String(c.type)+'" Not authoritative msg. '));var e=d("WATimeUtils").castToUnixTime(0);if(c.serverTs===e||c.serverTs===null&&c.ts===e){e="constructEchoMessage: Invalid timestamp - timestamp for message corresponds to 1/1/1970";d("WALogger").ERROR(h(),e);return d("MAWDexieTable").dexieResolve(q(c.externalId,e))}e=z(c);var f=e.senderId;e=e.senderJid;e=r(a,e,b,c);b=e.editHistoryPromise;var g=e.mediaMetadataUploadPromise,i=e.quotedMsgPromise,j=e.quotedMsgSenderDisplayNamePromise,k=e.reactionsPromise,l=e.senderDisplayNamePromise,m=e.threadJidPromise;e=e.xmaDataUploadRequestPromise;return d("MAWDexieTable").dexieAll([m,l,g,k,i,j,e,b]).then(function(a){var b=a[0],d=a[1],e=a[2],g=a[3],h=a[4],i=a[5],j=a[6];a=a[7];return s(b,d,e,g,h,i,j,a,c,f)})}))}function t(a,b){var e={mediaMetadata:null};if(b.type===d("MAWMsgType").MSG_TYPE.XMA)return d("MAWDbXMATxns").maybeGetXMAFromProtocolMsgId(a,d("MAWJidUtils").maybeToProtocolMsgId(b.author,b.threadJid,b.externalId)).then(function(b){if(b!=null)return w(a,b);else{e.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] Media meta data couldn't be created for XMA because DbXMA is not in IndexedDB. This probably means the XMA message was not sent properly by ChatX.",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return d("MAWDexieTable").dexieResolve(e)}});if(!d("MAWMsgType").isMAWSupportedMediaType(b.type)){e.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").NOT_SUPPORTED_ON_WEB,errorMsg:"[labyrinth_web] Media type is not supported for msg, type: "+b.type,uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.WARN};return d("MAWDexieTable").dexieResolve(e)}if(b.mediaId==null){e.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] No media id found in a media msg",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return d("MAWDexieTable").dexieResolve(e)}var f=d("WATimeUtils").DAY_SECONDS*28,g=b.serverTs;if(g!=null&&d("WATimeUtils").unixTime()-g>f){e.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] Media is older than 28 days and is not being uploaded.",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.WARN};return d("MAWDexieTable").dexieResolve(e)}return d("MAWDbMediaTxns").maybeGetMediaFromMediaId(a,b.mediaId).then(function(f){if(!f){e.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] No media db entry for media id",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return d("MAWDexieTable").dexieResolve(e)}var g=c("gkx")("8098")?d("MAWDbMediaTxns").maybeGetMediaBackupRowFromMsgId(a,b.msgId):d("MAWDexieTable").dexieResolve();return g.then(function(a){return d("MAWDexieTable").dexieResolve(x(b.msgId,f,!1,a))})})}function u(a,b){return d("MAWDbReactionsTxns").getReactionsFromMessage(a,b).then(function(a){if(a!=null&&a.length>0){var b=d("WAJids").extractUserId(d("MAWGlobals").getMyUserJid()),c=a.map(function(a){var c=d("WAJids").authorToUserId(a.author,b);return d("EchoCommonUtils").craftEchoAddress(a.reaction,c,"AdvancedCrypto")}),e=a.map(function(a){var c=d("WAJids").authorToUserId(a.author,b);return d("EchoCommonUtils").craftEchoAddress((a.ts*1e3).toString(),c,"AdvancedCrypto")});a=a.map(function(a){var c=d("WAJids").authorToUserId(a.author,b);return d("EchoCommonUtils").craftEchoAddress(a.externalId.toString(),c,"AdvancedCrypto")});return{reactionAuthoritativeTimestampMs:e,reactions:c,reactionXOfflineThreadingIds:a}}})}function v(a){var b={xmaData:null};if(a.isTombstoned==null){b.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no isTombstoned to construct XMAData",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return b}var e={xmaHeaderSubtitle:a.overlayTitle,xmaHeaderTitle:a.headerTitle,xmaIsTombstoned:a.isTombstoned,xmaMaxSubtitleNumLines:a.maxSubtitleNumOfLines,xmaMaxTitleNumLines:a.maxTitleNumOfLines,xmaSubtitleText:a.subtitleText,xmaTargetExpiry:a.targetExpiringAtSec,xmaTargetId:a.targetId,xmaTargetUsername:a.targetUsername,xmaTitleText:a.titleText},f=a.xmaLayoutType||d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_XMA_LAYOUT_TYPE.SINGLE;e=babelHelpers["extends"]({},e,{xmaLayoutType:d("MAWConvertExtendedContentXMLLayoutTypeToXMALayoutType").convertExtendedContentXMLLayoutTypeToXMALayoutType(f)});a.targetType!=null&&(e=babelHelpers["extends"]({},e,{xmaTargetType:d("MAWConvertExtendedContentTargetTypeToXMATargetType").convertExtendedContentTargetTypeToXMATargetType(a.targetType)}));a.overlayIconGlyph!=null&&(e=babelHelpers["extends"]({},e,{xmaGatingType:d("MAWConvertExtendedContentOverlayIconGlyphToXMAGatingType").convertExtendedContentOverlayIconGlyphToXMAGatingType(a.overlayIconGlyph)}));a.defaultCTA!=null&&a.defaultCTA.nativeUrl!=null&&(e=babelHelpers["extends"]({},e,{xmaDefaultCTA:a.defaultCTA.nativeUrl}));b.xmaData=e;return b}function w(a,b){var e={mediaMetadata:null};if(b.previewMediaIds!=null){var f=b.previewMediaIds[0];return d("MAWDbMediaTxns").maybeGetMediaFromMediaId(a,f).then(function(f){if(!f){e.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] No media db entry for media id to be used for xma",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.WARN};return d("MAWDexieTable").dexieResolve(e)}var g=b.msgId;if(g==null){e.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] No message id found in a xma msg",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return d("MAWDexieTable").dexieResolve(e)}var h=c("gkx")("8098")?d("MAWDbMediaTxns").maybeGetMediaBackupRowFromMsgId(a,g):d("MAWDexieTable").dexieResolve();return h.then(function(a){return d("MAWDexieTable").dexieResolve(x(g,f,!0,a))})})}else return d("MAWDexieTable").dexieResolve(e)}function x(a,b,e,f){var g={mediaMetadata:null},h=null;f!=null&&f.length>0&&(h=f.find(function(a){return a.mediaId===b.mediaId}));f=h!=null?h.fbid:b.fbid;a=b.mediaEntries.get(a);if(a==null){g.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no media entry to construct mediaMetadata",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return g}a=d("WAMediaUtils").decodeMediaEntryData(a);h=h!=null?h.objectId:b.objectId;if(h==null)return g;var i=d("MAWGetAttachmentTypeForServerMediaType").getAttachmentTypeForServerMediaType(a.serverMediaType);if(i==null){g.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no attachment type to construct mediaMetadata",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return g}var j=a.mediaKey;if(j==null){g.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no mediaKey to construct mediaMetadata",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return g}var k=a.mediaKeyTimestamp;if(k==null){g.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no mediaKeyTimestamp to construct mediaMetadata",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return g}var l=a.directPath;if(l==null){g.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no directPath to construct mediaMetadata",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return g}if(a.serverMediaType==null){g.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no mediaContentType to construct mediaMetadata",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return g}e=e?"image/jpeg":d("WAMediaUtils").getMimeTypeFromServerMediaType(a.serverMediaType);var m=d("MAWGetMediaAttachmentTypeForServerMediaType").getMediaAttachmentTypeForServerMediaType(a.serverMediaType);if(m==null){g.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no xAttachmentType to construct mediaMetadata",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return g}if(a.serverMediaType!=null&&a.serverMediaType in{gif:1,image:1,sticker:1}&&b.validatedImageInfo==null){g.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no imageinfo to construct mediaMetadata",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return g}if(a.serverMediaType==="video"&&b.validatedVideoInfo==null){g.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no videoinfo to construct mediaMetadata",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return g}if(a.serverMediaType==="ptt"&&b.validatedAudioInfo==null){g.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no audioinfo to construct mediaMetadata",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return g}if(a.fileSha256==null){g.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no WA fileSha256 found",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return g}var n=d("WABase64").encodeB64UrlSafe(a.fileSha256);if(a.fileEncSha256==null){g.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no WA fileEncSha256 found",uploadErrorType:d("MAWUploadMessagesBackup").UploadErrorType.FATAL};return g}g=d("WABase64").encodeB64UrlSafe(a.fileEncSha256);var o=null,p=null,q=null,r=null,s=null,t=void 0;a=d("MAWGetPreviewContentTypeForMediaType").getPreviewContentTypeForMediaType(a.serverMediaType);if(b.validatedImageInfo!=null){var u;o=(u=b.validatedImageInfo.width)!=null?u:0;p=(u=b.validatedImageInfo.height)!=null?u:0;r=(u=b.validatedImageInfo.jpegThumbnailWidth)!=null?u:0;s=(u=b.validatedImageInfo.jpegThumbnailHeight)!=null?u:0}if(b.validatedVideoInfo!=null){o=(u=b.validatedVideoInfo.width)!=null?u:0;p=(u=b.validatedVideoInfo.height)!=null?u:0;r=(u=b.validatedVideoInfo.jpegThumbnailWidth)!=null?u:0;s=(u=b.validatedVideoInfo.jpegThumbnailHeight)!=null?u:0;q=(u=b.validatedVideoInfo.duration)!=null?u:0}if(b.validatedAudioInfo!=null){q=(u=b.validatedAudioInfo.duration)!=null?u:0}b.validatedDocumentFileInfo!=null&&(t=b.validatedDocumentFileInfo.filename);u={attachmentObjectId:h,attachmentType:i,directPath:l,hashedPlaintextHash:g,mediaBackupStatus:"success",mediaContentType:e,mediaKey:d("EchoEncodingUtils").convertMediaKeyToString(j),mediaKeyTimestamp:k,plaintextHash:n,size:b.size,xAttachmentType:m,xContentType:"full"};u=y(u,f,a,o,p,q,r,s,t);return{mediaMetadata:u}}function y(a,b,c,d,e,f,g,h,i){a=a;b!=null&&(a=babelHelpers["extends"]({},a,{backupEntFbid:b}));c!=null&&(a=babelHelpers["extends"]({},a,{previewContentType:c}));d!=null&&(a=babelHelpers["extends"]({},a,{width:d}));e!=null&&(a=babelHelpers["extends"]({},a,{height:e}));f!=null&&(a=babelHelpers["extends"]({},a,{mediaPlayableDuration:f}));g!=null&&(a=babelHelpers["extends"]({},a,{previewContentWidth:g}));h!=null&&(a=babelHelpers["extends"]({},a,{previewContentHeight:h}));i!=null&&(a=babelHelpers["extends"]({},a,{filename:i}));return a}function z(a){a=d("WAJids").authorToUserId(a.author,d("MAWJids").userIdFromJid(d("MAWGlobals").getMyUserJid()));var b=d("MAWJids").toUserJid(a);return{senderId:a,senderJid:b}}function A(a,b){return b.then(function(b){if(b!=null){b=z(b);b=b.senderJid;b=d("MAWDbContactsTxns").maybeGetContactName(a,b);return b}return null})}function B(a,b,e,f,g){var h=b.content.msgId,i=b.content.externalId;return g!=null?d("MAWDexieTable").dexieResolve(g):d("MAWDbMsgTxns").maybeGetMsg(a,h).then(function(a){if(a==null)return f.then(function(a){a=d("WAJids").threadIdForChatJid(a);if(!d("MAWEncryptedBackupCacheManager").peekRestoreCache(i)){d("MAWEncryptedBackupCacheManager").addMsgEntryToReuploadCache(e,i);d("MAWBridgeEventTransmitter").issuePointQueryOutsideTxn(i,a,void 0,c("LSMEBTaskCreationSource").EB_POINT_QUERY_IN_ACT);return null}else{a=(a=d("MAWEncryptedBackupCacheManager").getRestoredCache(i))==null?void 0:a.dbMsg;return d("MAWDexieTable").dexieResolve(a)}});else return d("MAWDexieTable").dexieResolve(a)})}g.constructEchoMessage=a;g.constructXMAData=v;g.constructMediaMetadata=x;g.setConditionalFields=y}),98);
__d("MAWDbMetaTxns",["MAWTransactionMode","MAWTransactor","SignalDbTypes"],(function(a,b,c,d,e,f,g){"use strict";var h=d("MAWTransactor").makeSignalTransactor({meta:d("MAWTransactionMode").READWRITE},"saveCAT",function(a){return function(b){return a.meta.put({key:d("SignalDbTypes").MetaKeysEnum.cat,value:{cat:b}}).then(function(){return b})}});function a(a){return a.meta.get(d("SignalDbTypes").MetaKeysEnum.deviceUUID).then(function(a){return{deviceUUID:a==null?void 0:a.value.deviceUUID}})}function b(a){return a.meta.bulkGet([d("SignalDbTypes").MetaKeysEnum.lastSignedPrekeyId,d("SignalDbTypes").MetaKeysEnum.identityKeyPair]).then(function(a){var b=a[0];a=a[1];b=b==null?void 0:b.value.lastSignedPrekeyId;a=a==null?void 0:a.value.identityKeyPair;return{identityPair:a,keyId:b}})}function c(a){return a.meta.get(d("SignalDbTypes").MetaKeysEnum.lastPrekeyId).then(function(a){return a==null?void 0:a.value.lastPrekeyId})}function e(a){return a.meta.get(d("SignalDbTypes").MetaKeysEnum.lastPrekeyGenerationId).then(function(a){return a==null?void 0:a.value.lastPrekeyGenerationId})}function f(a){return a.meta.toArray()}g.saveCAT=h;g.getPushMetaData=a;g.maybeGetLastSignedPrekeyIdAndIdentity=b;g.maybeGetLastPrekeyId=c;g.maybeGetLastPrekeyGenerationId=e;g.getAllMeta=f}),98);
__d("MAWDbRavenActionTxns",["MAWBridgeTypesCreators","MAWDbMsg","MAWIndexedDb","MAWMsg","MAWRavenUtils","err"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e){return a.messages.where("externalId").equals(b.ravenActionToMsgExternalId).filter(function(a){return a.threadJid===e.jid}).first().then(function(f){var g=f==null?void 0:f.msgId;if(g==null)throw c("err")("Cannot Write Raven Action without ID of Raven Message");return h(a,f).then(function(c){var d=babelHelpers["extends"]({msgId:g,thread:e.chatId,threadJid:e.jid},b);return a.unrenderedMessages.add(d).then(function(a){return babelHelpers["extends"]({rowId:a},d)})}).then(function(a){d("MAWIndexedDb").afterTransaction({tag:"RavenActionUpdate",value:d("MAWBridgeTypesCreators").createBridgeRavenAction(a)});return})})}function h(a,b){if((b==null?void 0:b.type)!=="Raven")throw c("err")("Cannot Modify Message because Message is not Raven Message");var e=[d("MAWMsg").MAWRavenMsgEphemeralMediaState.cast(Number(b.ravenEphemeralMediaState)),d("MAWMsg").MAWRavenMsgEphemeralType.cast(Number(b.ravenEphemeralType))],f=e[0];e=e[1];if(f==null||e==null)throw c("err")("ravenEphemeralMediaStateEnum or ravenEphemeralTypeEnum is null");f=d("MAWRavenUtils").getNextRavenMessageEphemeralState(f,e);return a.messages.put(babelHelpers["extends"]({},b,{ravenEphemeralMediaState:f}))}function b(a,b,c){c=d("MAWDbMsg").isRavenActionMsgType(c)&&(b==null?void 0:b.externalId)!=null?[b.externalId]:[];return a.messages.where("externalId").anyOf(c).filter(function(a){return a.author===(b==null?void 0:b.author)&&a.threadJid===(b==null?void 0:b.chat)}).first()}g.writeRavenActionMsg=a;g.modifyRavenMsgWithActionMsg=h;g.maybeGetRavenMsgQueryByProtocolMsgId=b}),98);
__d("MAWMediaBackupTxns",["MAWDbMediaTxns","MAWDexieTable","Promise","WALogger","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] fbid already exists for objectId"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] mediaId or msgId cannot differ for an objectId in mediaBackup"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] ObjectId already shared by different msgId"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] fbid already exists for objectId"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] mediaId or msgId cannot differ for an objectId in mediaBackup"]);m=function(){return a};return a}function a(a,b,e,f,g){return f==null||!c("gkx")("8098")?d("MAWDexieTable").dexieResolve():d("MAWDbMediaTxns").maybeGetMediaBackupRowFromObjectId(a,f).then(function(c){if(c==null){var h={mediaId:b,msgId:e,objectId:f};g!=null&&(h=babelHelpers["extends"]({},h,{fbid:g}));return a.mediaBackup.add(h).then(function(a){return babelHelpers["extends"]({},h,{mediaBackupId:a})})}else if(c.mediaId!==b||c.msgId!==e){d("WALogger").ERROR(m());return c}else{if(c.fbid==null&&g!=null){var i=babelHelpers["extends"]({},c,{fbid:g});return a.mediaBackup.put(i).then(function(a){return i})}else d("WALogger").WARN(l());return c}})}function e(a,e){if(e==null||!c("gkx")("8098"))return d("MAWDexieTable").dexieResolve();var f=[];e.forEach(function(a){a=a.objectId;a!=null&&f.push(a)});return d("MAWDbMediaTxns").maybeGetMediaBackupRowsFromObjectIds(a,f).then(function(c){var f=new Map(),g=[];e.forEach(function(a){var b=a.objectId;if(b!=null){var e=c.get(b);if(e==null){var h={mediaId:a.mediaId,msgId:a.msgId,objectId:b},l=a.fbid;if(l!=null){h=babelHelpers["extends"]({},h,{fbid:l});f.get(b)!=null&&((l=f.get(b))==null?void 0:l.msgId)!==a.msgId&&d("WALogger").ERROR(k());f.set(b,h)}}else{e.mediaId!==a.mediaId&&d("WALogger").ERROR(j());l=a.fbid;if(e.fbid==null&&l!=null){b=babelHelpers["extends"]({},e,{fbid:l});g.push(b)}else d("WALogger").WARN(i())}}});return(h||(h=b("Promise"))).all([a.mediaBackup.bulkAdd([].concat(Array.from(f.values()))),a.mediaBackup.bulkPut(g)]).then(function(){})}).then(function(){})}g.linkMediaBackup=a;g.bulkLinkMediaBackup=e}),98);
__d("MAWCryptoAuthTokenWrapper",["MessengerWebInitData"],(function(a,b,c,d,e,f,g){"use strict";function a(){return d("MessengerWebInitData").cryptoAuthToken}g.getCryptoAuthToken=a}),98);
__d("MAWDeviceRegistrationActions",["MAWCompareIdentity","MAWCurrentUser","MAWDexieTable","MAWLoggerUtils","MessengerWebInitData","SignalDbTypes","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": signedPrekey}"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Device Registration Meta Check] Device Id should be a number"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["MAWDeviceRegistrationActions: sessionId is null"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": ",""]);o=function(){return a};return a}var p="Device registration meta is incomplete: ",q=d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.DeviceRegistration]);function r(a,b,c,e,f){(a!=null||b!=null||c!=null||e!=null||f!=null)&&(a==null&&q.TAGS([d("MAWLoggerUtils").Tag.SignedPrekey]).ERROR(o(),p,d("SignalDbTypes").MetaKeysEnum.lastSignedPrekeyId),b==null&&q.ERROR(n(),p,d("SignalDbTypes").MetaKeysEnum.deviceUUID),c==null&&q.ERROR(m(),p,d("SignalDbTypes").MetaKeysEnum.regId),e==null&&q.ERROR(l(),p,d("SignalDbTypes").MetaKeysEnum.identityKeyPair),f==null&&q.ERROR(k(),p,d("SignalDbTypes").MetaKeysEnum.fbid))}function a(a){var b;return d("MAWDexieTable").dexieAll([a.meta.bulkGet([(b=d("SignalDbTypes")).MetaKeysEnum.lastSignedPrekeyId,b.MetaKeysEnum.deviceUUID,b.MetaKeysEnum.lastSessionDeviceWasLinkedTo,b.MetaKeysEnum.regId,b.MetaKeysEnum.identityKeyPair,b.MetaKeysEnum.fbid,b.MetaKeysEnum.deviceId,b.MetaKeysEnum.registrationVersion]),d("MAWCompareIdentity").compareIdentityDexie(a)]).then(function(b){var e=b[0],f=e[0],g=e[1],k=e[2],l=e[3],m=e[4],n=e[5],o=e[6];e=e[7];var s=b[1],t=f==null?void 0:(b=f.value)==null?void 0:b.lastSignedPrekeyId,u=g==null?void 0:(f=g.value)==null?void 0:f.deviceUUID,v=k==null?void 0:(b=k.value)==null?void 0:b.lastSessionDeviceWasLinkedTo,w=l==null?void 0:(g=l.value)==null?void 0:g.regId,x=m==null?void 0:(f=m.value)==null?void 0:f.identityKeyPair;b=n==null?void 0:(k=n.value)==null?void 0:k.fbid;var y=o==null?void 0:(l=o.value)==null?void 0:l.deviceId,z=e==null?void 0:e.value.registrationVersion;if(t==null||u==null||w==null||x==null||b==null){r(t,u,w,x,b);return null}c("MessengerWebInitData").sessionId==null&&q.ERROR(j());if(y!=null&&typeof y!=="number"){q.ERROR(i());return null}return a.signedPrekey.get(t).then(function(a){if(a==null){q.TAGS([d("MAWLoggerUtils").Tag.SignedPrekey]).ERROR(h(),p);return null}return{deviceId:y,deviceUUID:u,identityCompareResult:s,lastSessionDeviceWasLinkedTo:v,lastSignedPrekeyId:t,registrationVersion:z,signalRegInfo:{identityKeyPair:x,regId:w,signedPreKey:a}}})})}function b(a,b){var c;return d("MAWDexieTable").dexieAll([a.meta.bulkPut([{key:(c=d("SignalDbTypes")).MetaKeysEnum.deviceUUID,value:{deviceUUID:b.deviceUUID}},{key:c.MetaKeysEnum.fbid,value:{fbid:d("MAWCurrentUser").getID()}},{key:c.MetaKeysEnum.regId,value:{regId:b.signalRegInfo.regId}},{key:c.MetaKeysEnum.identityKeyPair,value:{identityKeyPair:b.signalRegInfo.identityKeyPair}},{key:c.MetaKeysEnum.lastSignedPrekeyId,value:{lastSignedPrekeyId:b.signalRegInfo.signedPreKey.keyId}},{key:c.MetaKeysEnum.registrationVersion,value:{registrationVersion:b.registrationVersion}},{key:c.MetaKeysEnum.authKeyPair,value:{authKeyPair:b.signalRegInfo.authKeyPair}}]),a.signedPrekey.put(b.signalRegInfo.signedPreKey)])}function e(a,b){return a.meta.put({key:d("SignalDbTypes").MetaKeysEnum.deviceId,value:{deviceId:b}})}function f(a,b){return a.meta.put({key:d("SignalDbTypes").MetaKeysEnum.lastSessionDeviceWasLinkedTo,value:{lastSessionDeviceWasLinkedTo:b}})}function s(a,b,c){return a.contacts.get(b).then(function(d){if(d!=null)return a.contacts.put(babelHelpers["extends"]({},d,{icdcInfo:c}));else return a.contacts.put({contactJid:b,dhash:null,icdcInfo:c})}).then(function(){})}g.getRegistrationMetaDexie=a;g.saveUnsentRegistrationMeta=b;g.saveDeviceId=e;g.saveLastSessionDeviceWasLinkedTo=f;g.saveICDC=s}),98);
__d("MAWDeviceRegistrationTypes",[],(function(a,b,c,d,e,f){"use strict";a=25;b=7;c=100;d="https://reg-e2ee.facebook.com";e=d;var g="https://v.whatsapp.net",h="https://reg-e2ee.instagram.com",i="/v2/fb_icdc_fetch",j="/v2/fb_register_v2",k="Device has already been registered to WA servers",l="Device registration finished successfully",m="Device registration retries failed "+b+" times. No longer attempting registration.",n="Device registration response was null",o="Current user id is zero",p="CryptoAuthToken is empty",q="CryptoAuthToken is expired",r={failed:"failed",finished:"finished"};f.MAX_USERS_FOR_NOTIFY_DEVICE_CHANGE=a;f.MAX_DEVICE_REGISTRATION_RETRIES=b;f.MAX_ROTATE_CRYPTO_AUTH_TOKEN_RETRIES=c;f.REG_FB_DOMAIN=d;f.REG_MSGR_DOMAIN=e;f.REG_WA_DOMAIN=g;f.REG_IGD_DOMAIN=h;f.ICDC_ENDPOINT=i;f.REGISTRATION_ENDPOINT=j;f.DEVICE_ALREADY_REGISTERED=k;f.DEVICE_SUCCESSFULLY_REGISTERED=l;f.FAILED_REGISTRATION_RETRIES=m;f.NULL_RESPONSE_FROM_SERVER=n;f.DEVICE_REGISTER_ERROR_ZERO_AS_USER_ID=o;f.DEVICE_REGISTER_ERROR_EMPTY_CAT_TOKEN=p;f.DEVICE_REGISTER_ERROR_EXPIRED_CAT_TOKEN=q;f.RegistrationStatesEnum=r}),66);
__d("MAWSignalIndexedDb",["MAWCurrentUser","MAWErrorObject","MAWExceededStorageQuota","MAWIndexedDbMetadata","MAWQplProxy","MAWTransactionMode","Promise","WALogger","WAWorkerGlobalScope","err","gkx","promiseDone","qex","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[SignalDb initialization] upgradeneeded is triggered in another worker. This should not happen."]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[JOB] Setting up the jobs database"]);j=function(){return a};return a}var k=null,l=null,m="jobs",n="observations";function o(){return c("qex")._("940")}function p(){if(k==null)throw c("err")("SignalDB IndexDB should've been initialized");return k}function q(){if(l==null)throw c("err")("SignalDB IndexDB should've been initialized");return l.then(function(){return p()})}function a(){return k!=null}var r=[function(a){a=a.target.result;a=a.createObjectStore(m,{autoIncrement:!0,keyPath:"jobId"});a.createIndex("uniqKey","uniqKey")},function(a){a=a.target.result;a.createObjectStore(n,{autoIncrement:!1,keyPath:"id"})},function(a){a=a.target.transaction;d("MAWExceededStorageQuota").listenToQuotaExceededError(a);a=a.objectStore(n);a.createIndex("lastUpdate","lastUpdate",{unique:!1})}];function s(){return c("gkx")("2033")}function e(a,b){b===void 0&&(b=!1);l=null;k=null;return t(a,b).then(function(){return k.version})}function t(a,c){c===void 0&&(c=!1);if(!c&&s())return(h||(h=b("Promise"))).resolve();if(l!=null)return l;if(k!=null)return(h||(h=b("Promise"))).resolve();c=d("MAWCurrentUser").getID();var e=d("MAWIndexedDbMetadata").signalDbName(c),f=(a=(c=a)!=null?c:o())!=null?a:r.length;l=new(h||(h=b("Promise")))(function(a,b){d("WALogger").LOG(j());var c=indexedDB.open(e,f);c.onupgradeneeded=function(a){for(var b=0;b<r.length;b++){var c=r[b],d=b+1;u(a,d)&&c(a)}};c.onsuccess=function(b){var c=b.target.result;c.onversionchange=function(){d("WALogger").ERROR(i()),c.close(),d("WAWorkerGlobalScope").workerGlobalScope.location.reload==null?void 0:d("WAWorkerGlobalScope").workerGlobalScope.location.reload()};k=c;a()};c.onerror=function(){b(c.error)}});return l}function u(a,b){var c=a.newVersion;a=a.oldVersion;return a<b&&c>=b}function v(a){return a===d("MAWTransactionMode").READWRITE?"readwrite":"readonly"}function f(a,b,e,f){var g=v(b);return function(b){return function(){for(var h=arguments.length,i=new Array(h),j=0;j<h;j++)i[j]=arguments[j];var m=f!=null?d("MAWQplProxy").startQplUserFlow(f):null,n=function f(h){return q().then(function(c){var e=function(b){b=c.transaction(a,b!=null?v(b):g,{durability:"relaxed"});d("MAWExceededStorageQuota").listenToQuotaExceededError(b);return b.objectStore(a)};return b.apply(void 0,[e].concat(i))}).then(function(a){m==null?void 0:m.endSuccess();return a})["catch"](function(b){m==null?void 0:m.endFail("job_transaction_fail");b=d("MAWErrorObject").getErrorObject(b);if((b==null?void 0:b.name)==="InvalidStateError"&&h===1){l=null;k=null;c("promiseDone")(t());return f(h-1)}throw c("unrecoverableViolation")(e+":"+a+" - Error performing transaction in signalDB transactor v2","messenger_e2ee_web",b?{error:b}:{})})};return n(1)}}}g.getSignalDbVersion=o;g.getSignalDB=p;g.isSignalDBInitted=a;g.dbMigrations=r;g.makeSignalDbIgnoringPreviousCreations=e;g.makeSignalDB=t;g.makeSignalMsgrTransactor=f}),98);
__d("MAWObservationApi",["MAWSignalIndexedDb","MAWTransactionMode","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return{addObservation:d("MAWSignalIndexedDb").makeSignalMsgrTransactor("observations",d("MAWTransactionMode").READWRITE,"addObservation")(function(a,c,d){return new(h||(h=b("Promise")))(function(b,e){var f=a(),g=f.get(c);g.onsuccess=function(a){var g=a.target.result;g!=null?(g.observations.push(d),g.lastUpdate=d,a=f.put(g)):(g={id:c,lastUpdate:d,observations:[d]},a=f.add(g));a.onsuccess=function(){return b(g)};a.onerror=e};g.onerror=e})}),getAndRemoveObservation:d("MAWSignalIndexedDb").makeSignalMsgrTransactor("observations",d("MAWTransactionMode").READWRITE,"getAndRemoveObservation")(function(a,c){return new(h||(h=b("Promise")))(function(b,d){var e=a(),f=e.get(c);f.onsuccess=function(a){var f=a.target.result;a=e["delete"](c);a.onsuccess=function(){return b(f)};a.onerror=d};f.onerror=d})}),getAndRemoveStaleObservations:d("MAWSignalIndexedDb").makeSignalMsgrTransactor("observations",d("MAWTransactionMode").READWRITE,"getAndRemoveStaleObservations")(function(a,c){return new(h||(h=b("Promise")))(function(b,d){var e=[],f=a(),g=IDBKeyRange.upperBound(c),h=f.index("lastUpdate").openCursor(g);h.onsuccess=function(a){a=a.target.result;if(a==null){b(e);return}var c=a.value;e.push(c);var f=a["delete"]();f.onerror=function(){return d("An error with deleting observation: "+f.error.toString())};a["continue"]()};h.onerror=function(){return d("An error with retrieving observations: "+h.error.toString())}})})}}c=d("MAWSignalIndexedDb").makeSignalMsgrTransactor("observations",d("MAWTransactionMode").READWRITE,"clearSignalObservationStore")(function(a){return new(h||(h=b("Promise")))(function(b,c){var d=a().clear();d.onsuccess=b;d.onerror=function(){return c("An error with clearing observations: "+d.error.toString())}})});g.getObservationApi=a;g.clearSignalObservationStore=c}),98);
__d("MAWClearSignalAndTempStores",["MAWDeleteOldLogsFromDisk","MAWDexieTable","MAWIndexedDb","MAWJobActionsV2","MAWLoggingSwitches","MAWObservationApi","MAWSignalIndexedDb","MAWTransactionMode","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("MAWIndexedDb").makeSignalTransactor({meta:(a=d("MAWTransactionMode")).READWRITE,personalSenderKeyStatuses:a.READWRITE,prekey:a.READWRITE,prekeyGeneration:a.READWRITE,senderKeySessions:a.READWRITE,session:a.READWRITE,signedPrekey:a.READWRITE,tasks:a.READWRITE},"clearSignalAndTempStores",function(a){return function(){return d("MAWDexieTable").dexieAll([a.meta.clear(),a.prekey.clear(),a.prekeyGeneration.clear(),a.session.clear(),a.signedPrekey.clear(),a.tasks.clear(),a.senderKeySessions.clear(),a.personalSenderKeyStatuses.clear()]).then(function(){})}}),j=d("MAWSignalIndexedDb").makeSignalMsgrTransactor("jobs",a.READWRITE,"clearJob")(d("MAWJobActionsV2").clearJobs);c=function(){return(h||(h=b("Promise"))).all([d("MAWLoggingSwitches").removeLoggingFromBridge&&d("MAWDeleteOldLogsFromDisk").clearLogs(),i(),j(),d("MAWObservationApi").clearSignalObservationStore()["catch"](function(){})]).then(function(){})};g.clearSignalAndTempStores=c}),98);
__d("XArmadilloWebLinkDeviceToSessionControllerRouteBuilder",["jsRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsRouteBuilder")("/messenger/armadillo/link_device/",Object.freeze({}),void 0);b=a;g["default"]=b}),98);
__d("MAWDeviceRegistrationSessionUtil",["CSRFGuard","DTSG","DTSGUtils","MAWDeviceRegistrationActions","MAWIndexedDb","MAWLoggerUtils","MAWTransactionMode","PHPQuerySerializer","SprinkleConfig","WATagsLogger","WAWorkerGlobalScope","XArmadilloWebLinkDeviceToSessionControllerRouteBuilder","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[LinkDeviceToTheSession] fetch result is not succesful"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[LinkDeviceToTheSession] success"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[LinkDeviceToTheSession] parse response error ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[LinkDeviceToTheSession] fetch is not 200: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[LinkDeviceToTheSession] fetch error ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[LinkDeviceToTheSession] deviceUUID is null"]);n=function(){return a};return a}var o=d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.DeviceRegistration]),p=d("MAWIndexedDb").makeSignalTransactor({meta:d("MAWTransactionMode").READWRITE},"saveLastSessionDeviceWasLinkedTo",function(a){return function(b){return d("MAWDeviceRegistrationActions").saveLastSessionDeviceWasLinkedTo(a,b)}});function a(a,b){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=d("WAWorkerGlobalScope").workerGlobalScope.location.origin;if(e==null||e==="")return;if(a==null){o.ERROR(n());return}e=new URL(e).hostname;e=(e=c("XArmadilloWebLinkDeviceToSessionControllerRouteBuilder").buildUri({}).setDomain(e))==null?void 0:(e=e.setProtocol("https"))==null?void 0:e.toString();if(e==null)return;var f=d("DTSG").getToken();if(f==null)return;a={device_id:a,fb_dtsg:f};c("SprinkleConfig").param_name&&(a[c("SprinkleConfig").param_name]=c("DTSGUtils").getNumericValue(f));f=d("WAWorkerGlobalScope").workerGlobalScope.fetch;var g;try{g=(yield f(e,{body:(h||(h=c("PHPQuerySerializer"))).serialize(a),headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",redirect:"error"}))}catch(a){o.ERROR(m(),a);return}if(!g.ok){o.ERROR(l(),g.status);return}f=(yield g.text());d("CSRFGuard").exists(f)&&(f=d("CSRFGuard").clean(f));var q;try{q=JSON.parse(f)}catch(a){o.ERROR(k(),a);return}((e=q)==null?void 0:e.success)===!0?(o.LOG(j()),yield p(b)):o.WARN(i())});return q.apply(this,arguments)}g.linkDeviceToTheSession=a}),98);
__d("WALock",["Promise","WAResolvable","WATagsLogger"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Lock failed for ",""]);i=function(){return a};return a}function a(a){return{lock:function(c,e){var f=new(d("WAResolvable").Resolvable)(),g=c.map(function(a){return[a,new(d("WAResolvable").Resolvable)()]});(h||(h=b("Promise"))).all(g.map(function(b){var c=b[0],d=b[1];return a.enqueue(c,function(){d.resolve();return f.promise})}))["catch"](function(a){d("WATagsLogger").TAGS(["WALock"]).ERROR(i(),c)});return h.all(g.map(function(a){a[0];a=a[1];return a.promise})).then(function(){return e()})["finally"](function(){f.resolve()})},wait:function(b){return a.wait(b)}}}g.makeLock=a}),98);
__d("WALockMap",["WALock","WAPromiseQueue"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a===void 0&&(a=-1);a=new(d("WAPromiseQueue").PromiseQueueMap)(a);return d("WALock").makeLock(a)}g.makeLockMap=a}),98);
__d("WASignalSessions",["WABinary","WAErr","WASignalKeys","WASignalOther"],(function(a,b,c,d,e,f,g){var h=3;function a(a,b){return i(a,0,b,[])}function i(a,b,c,d){return{ratchetPubKey:a,nextMsgIndex:b,chainKey:c,unusedMsgKeys:d}}function b(a,b){return j(a,0,b)}function j(a,b,c){return{ratchetKey:a,nextMsgIndex:b,chainKey:c}}function k(a,b,c){return{remoteOneTimeId:a,remoteSignedId:b,localOneTimePubKey:c}}function e(a,b){return n(a.local,a.remote,a.rootKey,a.recvChains,a.sendChain,a.initialExchangeInfo,a.prevSendChainHighestIndex,b,a.aliceBaseKey)}function f(a,b,c){return n(a.local,a.remote,a.rootKey,b,c,a.initialExchangeInfo,a.prevSendChainHighestIndex,a.prevSessions,a.aliceBaseKey)}function l(a,b,c,d){c===void 0&&(c=a.sendChain);return n(a.local,a.remote,d,b,c,null,Math.max(a.sendChain.nextMsgIndex-1,0),a.prevSessions,a.aliceBaseKey)}function m(a,b,c,d,e,f,g){return n(a,b,c,d,e,f,0,[],g)}function n(a,b,c,d,e,f,g,h,i){return{local:a,remote:b,rootKey:c,sendChain:e,recvChains:d,initialExchangeInfo:f,prevSendChainHighestIndex:g,prevSessions:h,aliceBaseKey:i}}function o(a,b){b=new(d("WABinary").Binary)(b);var c=d("WASignalOther").readBytes(b,32),e=d("WASignalOther").readBytes(b,32);b=d("WASignalOther").readBytes(b,16);return p(a,c,e,b)}function p(a,b,c,d){return{index:a,cipherKey:b,macKey:c,iv:d}}function q(a){return{senderRatchetKey:a.ratchetPubKey,chainKey:{index:a.nextMsgIndex,key:a.chainKey},messageKeys:a.unusedMsgKeys}}function r(a){var b=a.ratchetKey;return{senderRatchetKey:b.serializedPubKey,senderRatchetKeyPrivate:b.privateKey,chainKey:{index:a.nextMsgIndex,key:a.chainKey}}}function s(a){var b=a.local,c=a.remote,d=a.initialExchangeInfo,e=void 0;if(d){var f=d.remoteOneTimeId;e={preKeyId:f!=null?f:void 0,signedPreKeyId:d.remoteSignedId,baseKey:d.localOneTimePubKey}}return{currentSession:{sessionVersion:h,localIdentityPublic:b.pubKey,remoteIdentityPublic:c.pubKey,rootKey:a.rootKey,previousCounter:a.prevSendChainHighestIndex,senderChain:r(a.sendChain),receiverChains:a.recvChains.map(q),pendingPreKey:e,remoteRegistrationId:c.regId,localRegistrationId:b.regId,aliceBaseKey:a.aliceBaseKey},previousSessions:a.prevSessions}}function t(a){var b=a.local,c=a.remote,e=a.sendChain,f=a.initialExchangeInfo,g=void 0;if(f){var i=f.remoteOneTimeId;g={preKeyId:i!=null?i:void 0,signedPreKeyId:f.remoteSignedId,baseKey:d("WASignalOther").toBuffer(f.localOneTimePubKey)}}return{sessionVersion:h,localIdentityPublic:d("WASignalOther").toBuffer(b.pubKey),remoteIdentityPublic:d("WASignalOther").toBuffer(c.pubKey),rootKey:d("WASignalOther").toBuffer(a.rootKey),previousCounter:a.prevSendChainHighestIndex,senderChain:{senderRatchetKey:d("WASignalOther").toBuffer(e.ratchetKey.serializedPubKey),senderRatchetKeyPrivate:d("WASignalOther").toBuffer(e.ratchetKey.privateKey),chainKey:{index:e.nextMsgIndex,key:d("WASignalOther").toBuffer(e.chainKey)},messageKeys:[]},receiverChains:a.recvChains.map(function(a){return{senderRatchetKey:d("WASignalOther").toBuffer(a.ratchetPubKey),chainKey:{index:a.nextMsgIndex,key:d("WASignalOther").toBuffer(a.chainKey)},messageKeys:a.unusedMsgKeys.map(function(a){return{index:a.index,cipherKey:d("WASignalOther").toBuffer(a.cipherKey),macKey:d("WASignalOther").toBuffer(a.macKey),iv:d("WASignalOther").toBuffer(a.iv)}})}}),pendingPreKey:g,remoteRegistrationId:c.regId,localRegistrationId:b.regId,aliceBaseKey:a.aliceBaseKey==null?void 0:d("WASignalOther").toBuffer(a.aliceBaseKey)}}function u(a){var b=A(a.currentSession,"currentSession");return w(b,a.previousSessions)}function v(a){return w(a,[])}function w(a,b){var e=A(a.sessionVersion,"sessionVersion");if(e!==h)throw c("WAErr")("Signal: bad session version "+e);e=A(a.senderChain,"senderChain");var f=A(e.chainKey,"senderChain.chainKey");e=j(d("WASignalKeys").makeSerializedKeyPairFrom(z(e.senderRatchetKeyPrivate,32,"senderRatchetKeyPrivate"),y(e.senderRatchetKey,"senderRatchetKey")),A(f.index,"senderChain.chainKey.index"),z(f.key,32,"senderChain.chainKey.key"));f=A(a.receiverChains,"receiverChains").map(function(a){var b=A(a.chainKey,"receiverChains[].chainKey");return i(y(a.senderRatchetKey,"receiverChains[].senderRatchetKey"),A(b.index,"receiverChains[].chainKey.index"),z(b.key,32,"receiverChains[].chainKey.key"),x(a.messageKeys))});var g={regId:d("WASignalOther").castRegistrationId(A(a.localRegistrationId,"localRegistrationId")),pubKey:y(a.localIdentityPublic,"localIdentityPublic")},l={regId:d("WASignalOther").castRegistrationId(A(a.remoteRegistrationId,"remoteRegistrationId")),pubKey:y(a.remoteIdentityPublic,"remoteIdentityPublic")},m=a.pendingPreKey,o=null;if(m){var p=m.preKeyId;o=k(p!=null?d("WASignalKeys").castToPreKeyId(p):null,d("WASignalKeys").castToSignedPreKeyId(A(m.signedPreKeyId,"pendingPreKey.signedPreKeyId")),y(m.baseKey,"pendingPreKey.baseKey"))}p=a.aliceBaseKey==null?null:y(a.aliceBaseKey,"aliceBaseKey");return n(g,l,z(a.rootKey,32,"rootKey"),f,e,o,a.previousCounter||0,b,p)}function x(a){return a.map(function(a){return{index:A(a.index,"messageKeys[].index"),cipherKey:z(a.cipherKey,32,"messageKeys[].cipherKey"),macKey:z(a.macKey,32,"messageKeys[].macKey"),iv:z(a.iv,16,"messageKeys[].iv")}})}function y(a,b){return d("WASignalKeys").castToSerializedPubKey(new Uint8Array(A(a,b)))}function z(a,b,c){return d("WASignalOther").toBytes(A(a,c),b)}function A(a,b){if(a==null)throw c("WAErr")("Signal: protobuf is missing "+b);return a}g.FORMAT_VERSION=h;g.makeFreshRecvChain=a;g.makeRecvChain=i;g.makeFreshSendChain=b;g.makeSendChain=j;g.makeInitialExchangeInfo=k;g.setPrevSessions=e;g.updateChains=f;g.ratchetSession=l;g.makeFreshSession=m;g.makeSession=n;g.splitMsgKey=o;g.serializeSession=s;g.detachSession=t;g.parseSessionFromRecord=u;g.parseSession=v;g._parseSession=w;g.bytesOrThrow=z;g.definedOrThrow=A}),98);
__d("WASignalWhisperTextProtocol.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};c={};e={};f={};var h={};a.internalSpec={ratchetKey:[1,(d=d("WAProtoConst")).TYPES.BYTES],counter:[2,d.TYPES.UINT32],previousCounter:[3,d.TYPES.UINT32],ciphertext:[4,d.TYPES.BYTES]};b.internalSpec={registrationId:[5,d.TYPES.UINT32],preKeyId:[1,d.TYPES.UINT32],signedPreKeyId:[6,d.TYPES.UINT32],baseKey:[2,d.TYPES.BYTES],identityKey:[3,d.TYPES.BYTES],message:[4,d.TYPES.BYTES]};c.internalSpec={id:[1,d.TYPES.UINT32],baseKey:[2,d.TYPES.BYTES],ratchetKey:[3,d.TYPES.BYTES],identityKey:[4,d.TYPES.BYTES],baseKeySignature:[5,d.TYPES.BYTES]};e.internalSpec={id:[1,d.TYPES.UINT32],iteration:[2,d.TYPES.UINT32],ciphertext:[3,d.TYPES.BYTES]};f.internalSpec={id:[1,d.TYPES.UINT32],iteration:[2,d.TYPES.UINT32],chainKey:[3,d.TYPES.BYTES],signingKey:[4,d.TYPES.BYTES]};h.internalSpec={generation:[1,d.TYPES.UINT32],signature:[2,d.TYPES.BYTES]};g.SignalMessageSpec=a;g.PreKeySignalMessageSpec=b;g.KeyExchangeMessageSpec=c;g.SenderKeyMessageSpec=e;g.SenderKeyDistributionMessageSpec=f;g.DeviceConsistencyCodeMessageSpec=h}),98);
__d("WASignalGroupSession",["WASignalKeys","WASignalSessions"],(function(a,b,c,d,e,f,g){var h=5,i=3;function j(a){var b=d("WASignalSessions").definedOrThrow(a.senderSigningKey,"senderSigningKey"),c=d("WASignalSessions").definedOrThrow(a.senderMessageKeys,"senderMessageKeys"),e=d("WASignalSessions").definedOrThrow(a.senderChainKey,"senderChainKey");return{senderSigningKeyPublic:r(b["public"],"public"),senderSigningKeyPrivate:b["private"]?d("WASignalSessions").bytesOrThrow(b["private"],32,"private"):void 0,senderKeyId:d("WASignalSessions").definedOrThrow(a.senderKeyId,"senderKeyId"),unusedMsgKeys:c.map(function(a){return k(d("WASignalSessions").definedOrThrow(a.iteration,"iteration"),d("WASignalSessions").bytesOrThrow(a.seed,50,"seed"))}),senderKeyChainKey:l(d("WASignalSessions").definedOrThrow(e.iteration,"iteration"),d("WASignalSessions").bytesOrThrow(e.seed,32,"seed"))}}function a(a,b,c,d,e){return{senderSigningKeyPublic:a,senderSigningKeyPrivate:b,senderKeyChainKey:c,senderKeyId:d,unusedMsgKeys:e==null?[]:e}}function b(a,b){var c=a.senderKeyStates.findIndex(function(a){return a.senderKeyId===b.senderKeyId});return{senderKeyStates:a.senderKeyStates.map(function(a,d){return d===c?b:a})}}function c(a,b){a=a.senderKeyStates.slice(a.senderKeyStates.length>h-1?1:0);a.push(b);return{senderKeyStates:a}}function e(a){return{senderKeyStates:[a]}}function k(a,b){return{iteration:a,seed:b}}function l(a,b){return{nextMsgIndex:a,chainKey:b}}function f(a){a=d("WASignalSessions").definedOrThrow(a.senderKeyStates,"senderKeyStates");return m(a)}function m(a){return n(a)}function n(a){a=a.map(function(a){return j(a)});return{senderKeyStates:a}}function o(a,b){var c=a.senderKeyStates.findIndex(function(a){return a.senderKeyId===b});return c===-1?void 0:a.senderKeyStates[c]}function p(a){return{senderKeyStates:a.senderKeyStates.map(function(a){return q(a)})}}function q(a){return{senderKeyId:a.senderKeyId,senderChainKey:{iteration:a.senderKeyChainKey.nextMsgIndex,seed:a.senderKeyChainKey.chainKey},senderSigningKey:{"public":a.senderSigningKeyPublic,"private":a.senderSigningKeyPrivate},senderMessageKeys:a.unusedMsgKeys.map(function(a){var b=a.iteration;a=a.seed;return{iteration:b,seed:a}})}}function r(a,b){return d("WASignalKeys").castToSerializedPubKey(new Uint8Array(d("WASignalSessions").definedOrThrow(a,b)))}function s(a){return a}g.FORMAT_VERSION=i;g.makeSenderKeyState=a;g.updateSessionWithUpdatedSenderKeyState=b;g.updateSessionWithNewSenderKeyState=c;g.makeNewSenderKeySession=e;g.makeSenderKeyMsgKey=k;g.makeSenderKeyChainKey=l;g.parseSessionFromRecord=f;g._parseSession=m;g.makeSenderKeySessionFromRecord=n;g.findSenderKeyState=o;g.serializeSession=p;g.serializeSenderKeyState=q;g.convertFromRawToSenderKeyState=s}),98);
__d("WASignalWhitepaper",["Promise","WABinary","WACryptoDependencies","WASignalGroupSession","WASignalKeys","WASignalOther","WASignalSessions","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=new Uint8Array(32);i.fill(255);var j=new Uint8Array([1]),k=new Uint8Array([2]);function a(a,c,e){var f,g,h,j,k,l,m,q,r,s,t,u,v,w,x,y,z;return b("regeneratorRuntime").async(function(A){while(1)switch(A.prev=A.next){case 0:g=a.regId,h=a.staticKeyPair;j=c.identity;k=c.signedKey.publicKey;l=e.privateKey;m=h.privateKey;q=(f=c.oneTimeKey)==null?void 0:f.publicKey;r=d("WABinary").Binary.build(i,p(m,k),p(l,j),p(l,k),q&&p(l,q)).readByteArray();A.next=9;return b("regeneratorRuntime").awrap(o(r,"WhisperText"));case 9:s=A.sent;t=s[0];u=s[1];v=c.ratchetKey;w=d("WASignalSessions").makeFreshRecvChain(v,u);x=d("WASignalKeys").makeSerializedKeyPair();A.next=17;return b("regeneratorRuntime").awrap(n(t,x,v));case 17:y=A.sent;z=d("WASignalSessions").makeInitialExchangeInfo(c.oneTimeKey==null?null:c.oneTimeKey.id,c.signedKey.id,d("WASignalKeys").serializePubKey(e));return A.abrupt("return",d("WASignalSessions").makeFreshSession({regId:g,pubKey:d("WASignalKeys").serializePubKey(h)},{regId:c.regId,pubKey:j},y.rootKey,[w],d("WASignalSessions").makeFreshSendChain(x,y.chainKey),z,d("WASignalKeys").serializePubKey(e)));case 20:case"end":return A.stop()}},null,this)}function c(a,c,e,f){var g,h,j,k,l,m,n,p,r,s,t,u,v,w;return b("regeneratorRuntime").async(function(x){while(1)switch(x.prev=x.next){case 0:h=a.regId,j=a.staticKeyPair;k=j.privateKey;l=f.signed.privateKey;m=e;n=c.pubKey;p=(g=f.oneTime)==null?void 0:g.privateKey;r=d("WABinary").Binary.build(i,q(n,l),q(m,k),q(m,l),p&&q(m,p)).readByteArray();x.next=9;return b("regeneratorRuntime").awrap(o(r,"WhisperText"));case 9:s=x.sent;t=s[0];u=s[1];v=f.ratchet;w=d("WASignalSessions").makeFreshSendChain(v,u);return x.abrupt("return",d("WASignalSessions").makeSession({regId:h,pubKey:d("WASignalKeys").serializePubKey(j)},c,t,[],w,null,0,[],e));case 15:case"end":return x.stop()}},null,this)}function e(a){a=d("WASignalGroupSession").makeSenderKeyState(d("WASignalKeys").serializePubKey(a),a.privateKey,d("WASignalGroupSession").makeSenderKeyChainKey(0,d("WASignalKeys").makeRawSenderKey()),d("WASignalOther").makeSenderKeyId(),[]);return(h||(h=b("Promise"))).resolve(d("WASignalGroupSession").makeNewSenderKeySession(a))}function f(a,c,e,f,g){e=d("WASignalGroupSession").makeSenderKeyState(e,void 0,d("WASignalGroupSession").makeSenderKeyChainKey(c,f),a,[]);c=null;g?c=d("WASignalGroupSession").updateSessionWithNewSenderKeyState(g,e):c=d("WASignalGroupSession").makeNewSenderKeySession(e);return(h||(h=b("Promise"))).resolve(c)}function l(a,c){var e,f,g,i;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:l.next=2;return b("regeneratorRuntime").awrap(d("WASignalOther").makeCryptoKey(c,"hmac-sha256"));case 2:e=l.sent;f=function(a){return d("WACryptoDependencies").getCrypto().subtle.sign({name:"HMAC",hash:"SHA-256"},e,a)};g=f(j).then(function(a){return d("WASignalOther").hkdf(new Uint8Array(a),null,"WhisperMessageKeys",80)}).then(function(b){return d("WASignalSessions").splitMsgKey(a,b)});i=f(k).then(function(a){return d("WASignalOther").toBytes(a,32)});return l.abrupt("return",(h||(h=b("Promise"))).all([i,g]));case 7:case"end":return l.stop()}},null,this)}function m(a,c){var e,f,g,i;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:l.next=2;return b("regeneratorRuntime").awrap(d("WASignalOther").makeCryptoKey(c,"hmac-sha256"));case 2:e=l.sent;f=function(a){return d("WACryptoDependencies").getCrypto().subtle.sign({name:"HMAC",hash:"SHA-256"},e,a)};g=f(j).then(function(a){return d("WASignalOther").hkdf(new Uint8Array(a),null,"WhisperGroup",50)}).then(function(b){return d("WASignalGroupSession").makeSenderKeyMsgKey(a,b)});i=f(k).then(function(a){return d("WASignalOther").toBytes(a,32)});return l.abrupt("return",(h||(h=b("Promise"))).all([i,g]));case 7:case"end":return l.stop()}},null,this)}function n(a,c,e){var f,g,h,i,j,k;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:f=c.privateKey;g=e;h=d("WASignalKeys").ecdh(f,g);l.next=5;return b("regeneratorRuntime").awrap(o(new Uint8Array(h),"WhisperRatchet",a));case 5:i=l.sent;j=i[0];k=i[1];return l.abrupt("return",{rootKey:j,chainKey:k});case 9:case"end":return l.stop()}},null,this)}function o(a,c,e){var f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:e===void 0&&(e=null);g.next=3;return b("regeneratorRuntime").awrap(d("WASignalOther").hkdf(a,e,c,64));case 3:f=g.sent;return g.abrupt("return",[d("WASignalOther").sliceBytes(f,0,32),d("WASignalOther").sliceBytes(f,32,32)]);case 5:case"end":return g.stop()}},null,this)}function p(a,b){return new Uint8Array(d("WASignalKeys").ecdh(a,b))}function q(a,b){return p(b,a)}g.initiateSessionOutgoing=a;g.initiateSessionIncoming=c;g.initiateSenderKeySessionOutgoing=e;g.initiateSenderKeySessionIncoming=f;g.deriveMsgKey=l;g.deriveSenderKeyMsgKey=m;g.calculateRatchet=n}),98);
__d("WASignalCipher",["Promise","WABinary","WACryptoDependencies","WACryptoUtils","WALogger","WAResultOrError","WASignalKeys","WASignalOther","WASignalSessions","WASignalSignatures","WASignalWhisperTextProtocol.pb","WASignalWhitepaper","decodeProtobuf","encodeProtobuf","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["decryptMsgFromSession error ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["deserializePkMsg error ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["deserializeMsg error ",""]);k=function(){return a};return a}var l=40,m=8,n=2e3;function a(a,c){var e,f,g,h,i,j,k,l,n,o,p,q,r,s,u,x,y,z,A,B,C;return b("regeneratorRuntime").async(function(D){while(1)switch(D.prev=D.next){case 0:e=a.sendChain;D.next=3;return b("regeneratorRuntime").awrap(d("WASignalWhitepaper").deriveMsgKey(e.nextMsgIndex,e.chainKey));case 3:f=D.sent;g=f[0];h=f[1];D.next=8;return b("regeneratorRuntime").awrap(w(h));case 8:i=D.sent;j=i.cipherKey;k=i.macKey;D.next=13;return b("regeneratorRuntime").awrap(d("WACryptoDependencies").getCrypto().subtle.encrypt({name:"AES-CBC",iv:h.iv},j,c));case 13:l=D.sent;n=new(d("WABinary").Binary)();n.writeByteArray(a.local.pubKey);n.writeByteArray(a.remote.pubKey);o=n.size();n.writeUint8(t(d("WASignalSessions").FORMAT_VERSION,d("WASignalSessions").FORMAT_VERSION));d("encodeProtobuf").encodeProtobuf(d("WASignalWhisperTextProtocol.pb").SignalMessageSpec,{ratchetKey:e.ratchetKey.serializedPubKey,counter:h.index,previousCounter:a.prevSendChainHighestIndex,ciphertext:l},n);p=n.readByteArray();D.next=23;return b("regeneratorRuntime").awrap(v(k,p));case 23:q=D.sent;r=p.subarray(o);s=d("WABinary").Binary.build(r,new Uint8Array(q,0,m)).readByteArray();y=a.initialExchangeInfo;y!=null?(A=new(d("WABinary").Binary)(),A.writeUint8(t(d("WASignalSessions").FORMAT_VERSION,d("WASignalSessions").FORMAT_VERSION)),d("encodeProtobuf").encodeProtobuf(d("WASignalWhisperTextProtocol.pb").PreKeySignalMessageSpec,{registrationId:a.local.regId,preKeyId:(z=y.remoteOneTimeId)!=null?z:void 0,signedPreKeyId:y.remoteSignedId,baseKey:y.localOneTimePubKey,identityKey:a.local.pubKey,message:s},A),u="pkmsg",x=A.readByteArray()):(u="msg",x=s);B=d("WASignalSessions").makeSendChain(e.ratchetKey,h.index+1,g);C=d("WASignalSessions").updateChains(a,a.recvChains,B);return D.abrupt("return",[C,{type:u,ciphertext:x}]);case 31:case"end":return D.stop()}},null,this)}function c(a,c){var e,f,g,h,i,j,k,l,m,n,o,p,r,s;return b("regeneratorRuntime").async(function(t){while(1)switch(t.prev=t.next){case 0:if(!(a==null)){t.next=2;break}return t.abrupt("return",d("WAResultOrError").makeError("errSignalNoSession"));case 2:t.next=4;return b("regeneratorRuntime").awrap(q(a,c));case 4:e=t.sent;if(!e.success){t.next=10;break}f=e.value,g=f[0],h=f[1];return t.abrupt("return",d("WAResultOrError").makeResult({newSessionInfo:null,updatedSession:g,plaintext:h}));case 10:i=a.prevSessions,j=e,k=0;case 13:if(!(!j.success&&k<i.length)){t.next=22;break}l=d("WASignalSessions").parseSession(i[k]);t.next=17;return b("regeneratorRuntime").awrap(q(l,c));case 17:m=t.sent,m.success&&((n=m.value,o=n[0],p=n[1]),r=d("WASignalSessions").setPrevSessions(o,[d("WASignalSessions").detachSession(a)].concat(i.slice(0,k),i.slice(k+1))),s=!a||!d("WACryptoUtils").serializedPubKeysEqual(r.remote.pubKey,a.remote.pubKey)?r.remote.pubKey:null,j=d("WAResultOrError").makeResult({newSessionInfo:{newIdentity:s,baseSession:l,usedPreKey:null},updatedSession:r,plaintext:p}));case 19:k++;t.next=13;break;case 22:return t.abrupt("return",j);case 23:case"end":return t.stop()}},null,this)}function e(a,b){if(x(a,b))return a;var c=a.prevSessions;for(var e=0;e<c.length;e++){var f=d("WASignalSessions").parseSession(c[e]);if(x(f,b))return d("WASignalSessions").setPrevSessions(f,[d("WASignalSessions").detachSession(a)].concat(c.slice(0,e),c.slice(e+1)))}return null}function f(a,c,e,f){var g,h,i,j,k,m,n,o,p,r,s,t;return b("regeneratorRuntime").async(function(u){while(1)switch(u.prev=u.next){case 0:h=f.localSignedPreKey;if(!(h==null)){u.next=3;break}return u.abrupt("return",d("WAResultOrError").makeError("errSignalInvalidSignedPreKey"));case 3:i=d("WASignalSignatures").deserializeSignedPreKey(h);if(!(i==null)){u.next=6;break}return u.abrupt("return",d("WAResultOrError").makeError("errSignalSignedPreKeyDeserialization"));case 6:if(!(i.id!==e.localSignedPreKeyId)){u.next=8;break}return u.abrupt("return",d("WAResultOrError").makeError("errSignalSignedPreKeyIdMismatch"));case 8:j=null;if(!(e.localOneTimeKeyId!=null)){u.next=18;break}k=f.localOneTimeKey;if(!(k==null)){u.next=13;break}return u.abrupt("return",d("WAResultOrError").makeError("errSignalInvalidOneTimeKey"));case 13:j=d("WASignalKeys").deserializePreKey(k);if(!(j==null)){u.next=16;break}return u.abrupt("return",d("WAResultOrError").makeError("errSignalOneTimeKeyDeserialization"));case 16:if(!(j.id!==e.localOneTimeKeyId)){u.next=18;break}return u.abrupt("return",d("WAResultOrError").makeError("errSignalOneTimeKeyMismatch"));case 18:u.next=20;return b("regeneratorRuntime").awrap(d("WASignalWhitepaper").initiateSessionIncoming(a,e.remote,e.sessionBaseKey,{signed:i.keyPair,oneTime:(g=j)==null?void 0:g.keyPair,ratchet:d("WASignalKeys").toSerializedKeyPair(i.keyPair)}));case 20:m=u.sent;n=m.remote.pubKey;o=!c||!d("WACryptoUtils").serializedPubKeysEqual(n,c.remote.pubKey)?n:null;c&&!o&&(m=d("WASignalSessions").setPrevSessions(m,[d("WASignalSessions").detachSession(c)].concat(c.prevSessions.slice(0,l-1))));u.next=26;return b("regeneratorRuntime").awrap(q(m,e));case 26:p=u.sent;if(p.success){u.next=29;break}return u.abrupt("return",p);case 29:r=p.value,s=r[0],t=r[1];return u.abrupt("return",d("WAResultOrError").makeResult({newIdentity:o,baseSession:m,updatedSession:s,plaintext:t}));case 31:case"end":return u.stop()}},null,this)}function o(a){var b,c,e=null;try{var f=s(a,d("WASignalSessions").FORMAT_VERSION,m);if(!f.success)return f;f=d("decodeProtobuf").decodeProtobuf(d("WASignalWhisperTextProtocol.pb").SignalMessageSpec,f.value);var g=f.ratchetKey;e=f.counter;c=f.ciphertext;if(g==null||e==null||c==null)return d("WAResultOrError").makeError("errSignalDeserializeInvalidProtoFormat");b=d("WASignalKeys").castToSerializedPubKey(new Uint8Array(g))}catch(a){d("WALogger").DEV(k(),a);return d("WAResultOrError").makeError("errSignalDeserializeRatchetKeyBadFormat")}f={ratchetPubKey:b,counter:e,ciphertext:new Uint8Array(c),versionContentMac:a};return d("WAResultOrError").makeResult(f)}function p(a){a=s(a,d("WASignalSessions").FORMAT_VERSION,0);if(!a.success)return a;var b,c,e,f,g;try{a=d("decodeProtobuf").decodeProtobuf(d("WASignalWhisperTextProtocol.pb").PreKeySignalMessageSpec,a.value);var h=a.registrationId,i=a.preKeyId,k=a.signedPreKeyId,l=a.baseKey,m=a.identityKey;a=a.message;if(h==null||k==null||l==null||m==null||a==null)return d("WAResultOrError").makeError("errSignalDeserializePkInvalidProtoFormat");f=d("WASignalKeys").castToSerializedPubKey(new Uint8Array(l));b={regId:d("WASignalOther").castRegistrationId(h),pubKey:d("WASignalKeys").castToSerializedPubKey(new Uint8Array(m))};e=i!=null?d("WASignalKeys").castToPreKeyId(i):null;c=d("WASignalKeys").castToSignedPreKeyId(k);g=new Uint8Array(a)}catch(a){d("WALogger").DEV(j(),a);return d("WAResultOrError").makeError("errSignalDeserializePkKeyBadFormat")}l=o(g);return!l.success?l:d("WAResultOrError").makeResult(babelHelpers["extends"]({},l.value,{remote:b,sessionBaseKey:f,localSignedPreKeyId:c,localOneTimeKeyId:e}))}function q(a,c){var e,f,g,h,j,k,l,n,o,p,q,s,t,u,x,y,z,A,B,C,D,E,F,G,H,I;return b("regeneratorRuntime").async(function(J){while(1)switch(J.prev=J.next){case 0:e=c.ratchetPubKey,f=c.counter,g=c.ciphertext,h=c.versionContentMac;j=a.recvChains;k=a.recvChains.findIndex(function(a){return d("WACryptoUtils").serializedPubKeysEqual(a.ratchetPubKey,e)});if(!(k===-1)){J.next=24;break}J.next=6;return b("regeneratorRuntime").awrap(d("WASignalWhitepaper").calculateRatchet(a.rootKey,a.sendChain.ratchetKey,e));case 6:o=J.sent;p=d("WASignalSessions").makeFreshRecvChain(e,o.chainKey);J.next=10;return b("regeneratorRuntime").awrap(r(p,f));case 10:q=J.sent;if(q.success){J.next=13;break}return J.abrupt("return",q);case 13:s=q.value;t=d("WASignalKeys").makeSerializedKeyPair();J.next=17;return b("regeneratorRuntime").awrap(d("WASignalWhitepaper").calculateRatchet(o.rootKey,t,e));case 17:u=J.sent;x=j.slice(-4);x.push(s.updatedChain);n=s.msgKey;l=d("WASignalSessions").ratchetSession(a,x,d("WASignalSessions").makeFreshSendChain(t,u.chainKey),u.rootKey);J.next=34;break;case 24:J.next=26;return b("regeneratorRuntime").awrap(r(j[k],f));case 26:y=J.sent;if(y.success){J.next=29;break}return J.abrupt("return",y);case 29:z=y.value,A=j.slice(),A[k]=z.updatedChain,n=z.msgKey,l=d("WASignalSessions").updateChains(a,A,a.sendChain);case 34:J.next=36;return b("regeneratorRuntime").awrap(w(n));case 36:B=J.sent;C=B.cipherKey;D=B.macKey;E=d("WABinary").Binary.build(a.remote.pubKey,a.local.pubKey,h.subarray(0,-m)).readByteArray();J.next=42;return b("regeneratorRuntime").awrap(v(D,E));case 42:F=J.sent;G=h.subarray(-m);H=!d("WACryptoUtils").uint8ArraysEqual(new Uint8Array(F,0,m),G);I=null;J.prev=46;J.next=49;return b("regeneratorRuntime").awrap(d("WACryptoDependencies").getCrypto().subtle.decrypt({name:"AES-CBC",iv:n.iv},C,g));case 49:I=J.sent;J.next=55;break;case 52:J.prev=52,J.t0=J["catch"](46),d("WALogger").DEV(i(),J.t0);case 55:if(!(H&&I==null)){J.next=59;break}if(!(k===-1)){J.next=58;break}return J.abrupt("return",d("WAResultOrError").makeError("errInvalidMacInvalidCipherKeyNewChain"));case 58:return J.abrupt("return",d("WAResultOrError").makeError("errInvalidMacInvalidCipherKey"));case 59:if(!H){J.next=61;break}return J.abrupt("return",d("WAResultOrError").makeError("errInvalidMacWithDecryptedPlaintext"));case 61:if(!(I==null)){J.next=63;break}return J.abrupt("return",d("WAResultOrError").makeError("errUnknownInvalidCipherKey"));case 63:return J.abrupt("return",d("WAResultOrError").makeResult([l,I]));case 64:case"end":return J.stop()}},null,this,[[46,52]])}function r(a,c){var e,f,g,h,i,j,k,l,m,o,p;return b("regeneratorRuntime").async(function(q){while(1)switch(q.prev=q.next){case 0:e=c-a.nextMsgIndex;if(!(e>2e3)){q.next=3;break}return q.abrupt("return",d("WAResultOrError").makeError("errSignalTooManyMessagesInFuture"));case 3:f=a.unusedMsgKeys;if(!(e<0)){q.next=9;break}g=f.findIndex(function(a){return a.index===c});if(!(g===-1)){q.next=8;break}return q.abrupt("return",d("WAResultOrError").makeError("errDuplicateMsg"));case 8:return q.abrupt("return",d("WAResultOrError").makeResult({msgKey:f[g],updatedChain:d("WASignalSessions").makeRecvChain(a.ratchetPubKey,a.nextMsgIndex,a.chainKey,u(f,g))}));case 9:h=a.nextMsgIndex;q.next=12;return b("regeneratorRuntime").awrap(d("WASignalWhitepaper").deriveMsgKey(h,a.chainKey));case 12:i=q.sent;j=i[0];k=i[1];l=null;if(!(e>0)){q.next=30;break}m=e+f.length-n;m>0?(l=f.slice(m),m-=f.length):l=f.slice();o=h+1;case 20:if(!(o<=c)){q.next=30;break}m>0?m--:l.push(k);q.next=24;return b("regeneratorRuntime").awrap(d("WASignalWhitepaper").deriveMsgKey(o,j));case 24:p=q.sent,j=p[0],k=p[1];case 27:o++;q.next=20;break;case 30:return q.abrupt("return",d("WAResultOrError").makeResult({msgKey:k,updatedChain:d("WASignalSessions").makeRecvChain(a.ratchetPubKey,c+1,j,l||f)}));case 31:case"end":return q.stop()}},null,this)}function s(a,b,c){if(a.length<1)return d("WAResultOrError").makeError("errSignalEmptyVersionContentSuffix");var e=a[0]>>>4;if(e!==b)return e<b?d("WAResultOrError").makeError("errSignalLegacyMsg"):d("WAResultOrError").makeError("errSignalInvalidVersion");e=a.length-c;return e<1?d("WAResultOrError").makeError("errSignalContentExceededExpectedLength"):d("WAResultOrError").makeResult(a.subarray(1,e))}function t(a,b){return(a<<4|b)&255}function u(a,b){var c=[];for(var d=0;d<a.length;d++)d!==b&&c.push(a[d]);return c}function v(a,b){return d("WACryptoDependencies").getCrypto().subtle.sign(d("WASignalOther").HMAC_SHA256,a,b)}function w(a){return(h||(h=b("Promise"))).all([d("WASignalOther").makeCryptoKey(a.cipherKey,"aes-cbc"),d("WASignalOther").makeCryptoKey(a.macKey,"hmac-sha256")]).then(function(a){var b=a[0];a=a[1];return{cipherKey:b,macKey:a}})}function x(a,b){a=a.aliceBaseKey;return!a?!1:d("WACryptoUtils").serializedPubKeysEqual(a,b)}g.MAX_UNUSED_KEYS=n;g.encryptMsg=a;g.decryptMsg=c;g.findMatchingSession=e;g.decryptPkMsgWithNewSession=f;g.deserializeMsg=o;g.deserializePkMsg=p;g.decryptMsgFromSession=q;g.readContent=s;g.versionByte=t}),98);
__d("WASignalGroupCipher",["WABinary","WACryptoDependencies","WALogger","WAResultOrError","WASignalCipher","WASignalGroupSession","WASignalKeys","WASignalOther","WASignalSessions","WASignalSignatures","WASignalWhisperTextProtocol.pb","WASignalWhitepaper","decodeProtobuf","encodeProtobuf","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Exception caught during SenderKeyMessageSpec Proto: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["deserializeSenderKeyDistributionMsg error ",""]);i=function(){return a};return a}var j=64;function a(a,c){var e,f,g,h,i,j,l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:e=k(a);if(e.success){m.next=3;break}return m.abrupt("return",e);case 3:f=e.value,g=f.senderKeyId,h=f.iteration,i=f.signingKeyPublic,j=f.chainKey;m.next=6;return b("regeneratorRuntime").awrap(d("WASignalWhitepaper").initiateSenderKeySessionIncoming(g,h,i,j,c));case 6:l=m.sent;return m.abrupt("return",d("WAResultOrError").makeResult(l));case 8:case"end":return m.stop()}},null,this)}function c(a){a=d("WASignalGroupSession").serializeSenderKeyState(a);var b=new(d("WABinary").Binary)();b.writeUint8(d("WASignalCipher").versionByte(d("WASignalGroupSession").FORMAT_VERSION,d("WASignalGroupSession").FORMAT_VERSION));d("encodeProtobuf").encodeProtobuf(d("WASignalWhisperTextProtocol.pb").SenderKeyDistributionMessageSpec,{id:a.senderKeyId,iteration:d("WASignalSessions").definedOrThrow(a.senderChainKey,"senderChainKey").iteration,chainKey:d("WASignalSessions").definedOrThrow(a.senderChainKey,"senderChainKey").seed,signingKey:d("WASignalSessions").definedOrThrow(a.senderSigningKey,"senderSigningKey")["public"]},b);return b.readByteArray()}function e(a,c){var e,f,g,h,i,j,k,l,n,o,p,q,r,s,t;return b("regeneratorRuntime").async(function(u){while(1)switch(u.prev=u.next){case 0:if(!(!a.senderKeyStates||a.senderKeyStates.length===0)){u.next=2;break}return u.abrupt("return",d("WAResultOrError").makeError("errSignalNoSession"));case 2:e=a.senderKeyStates[a.senderKeyStates.length-1];u.next=5;return b("regeneratorRuntime").awrap(d("WASignalWhitepaper").deriveSenderKeyMsgKey(e.senderKeyChainKey.nextMsgIndex,e.senderKeyChainKey.chainKey));case 5:f=u.sent;g=f[0];h=f[1];u.next=10;return b("regeneratorRuntime").awrap(m(h.seed));case 10:i=u.sent;j=i[0];k=i[1];u.next=15;return b("regeneratorRuntime").awrap(d("WACryptoDependencies").getCrypto().subtle.encrypt({name:"AES-CBC",iv:k},j,c));case 15:l=u.sent;n=new(d("WABinary").Binary)();d("encodeProtobuf").encodeProtobuf(d("WASignalWhisperTextProtocol.pb").SenderKeyMessageSpec,{id:e.senderKeyId,iteration:h.iteration,ciphertext:l},n);o=new(d("WABinary").Binary)();o.writeUint8(d("WASignalCipher").versionByte(d("WASignalGroupSession").FORMAT_VERSION,d("WASignalGroupSession").FORMAT_VERSION));o.writeBinary(n);p=d("WASignalKeys").makeKeyPairFromSerialized(d("WASignalSessions").definedOrThrow(e.senderSigningKeyPrivate,"senderSigningKeyPrivate"),e.senderSigningKeyPublic);q=d("WASignalSignatures").signSenderKeyMessage(p,o.readByteArray());r=new(d("WABinary").Binary)();r.writeUint8(d("WASignalCipher").versionByte(d("WASignalGroupSession").FORMAT_VERSION,d("WASignalGroupSession").FORMAT_VERSION));r.writeBinary(n);r.writeByteArray(q);s=d("WASignalGroupSession").makeSenderKeyChainKey(h.iteration+1,g);t=d("WASignalGroupSession").updateSessionWithUpdatedSenderKeyState(a,d("WASignalGroupSession").makeSenderKeyState(e.senderSigningKeyPublic,e.senderSigningKeyPrivate,s,e.senderKeyId,e.unusedMsgKeys));return u.abrupt("return",d("WAResultOrError").makeResult([t,r.readByteArray()]));case 30:case"end":return u.stop()}},null,this)}function f(a,c){var e,f,g,h,i,j,k,l,p,q,r,s,t,u,v;return b("regeneratorRuntime").async(function(w){while(1)switch(w.prev=w.next){case 0:e=c.senderKeyMessageId,f=c.iteration,g=c.ciphertext,h=c.versionContentMac;i=d("WASignalGroupSession").findSenderKeyState(a,e);if(!(i==null)){w.next=4;break}return w.abrupt("return",d("WAResultOrError").makeError("errSignalNoSession"));case 4:j=i.senderSigningKeyPublic;k=n(h,j);if(k){w.next=8;break}return w.abrupt("return",d("WAResultOrError").makeError("errSignalInvalidKey"));case 8:w.next=10;return b("regeneratorRuntime").awrap(o(i,f));case 10:l=w.sent;if(l.success){w.next=13;break}return w.abrupt("return",l);case 13:p=l.value;q=p.msgKey;r=d("WASignalGroupSession").updateSessionWithUpdatedSenderKeyState(a,p.updatedSenderKeyState);w.next=18;return b("regeneratorRuntime").awrap(m(q.seed));case 18:s=w.sent;t=s[0];u=s[1];w.next=23;return b("regeneratorRuntime").awrap(d("WACryptoDependencies").getCrypto().subtle.decrypt({name:"AES-CBC",iv:u},t,g));case 23:v=w.sent;return w.abrupt("return",d("WAResultOrError").makeResult([r,v]));case 25:case"end":return w.stop()}},null,this)}function k(a){var b,c,e,f;try{a=d("WASignalCipher").readContent(a,d("WASignalGroupSession").FORMAT_VERSION,0);if(!a.success)return a;a=d("decodeProtobuf").decodeProtobuf(d("WASignalWhisperTextProtocol.pb").SenderKeyDistributionMessageSpec,a.value);b=a.id;c=a.iteration;var g=d("WASignalSessions").bytesOrThrow(a.signingKey,33,"signingKey");e=d("WASignalKeys").castToSerializedPubKey(g);f=d("WASignalSessions").bytesOrThrow(a.chainKey,32,"chainKey");if(b==null||c==null)return d("WAResultOrError").makeError("errSignalGrpInvalidProtoFormat")}catch(a){d("WALogger").DEV(i(),a);return d("WAResultOrError").makeError("errSignalGrpInvalidKeyFormat")}return d("WAResultOrError").makeResult({senderKeyId:b,iteration:c,signingKeyPublic:e,chainKey:f})}function l(a){if(a.length<1)return d("WAResultOrError").makeError("errSignalGrpVersionContentEmpty");var b=a[0]>>>4;if(b!==d("WASignalGroupSession").FORMAT_VERSION)return b<d("WASignalGroupSession").FORMAT_VERSION?d("WAResultOrError").makeError("errSignalLegacyMsg"):d("WAResultOrError").makeError("errSignalInvalidVersion");if(a.length<1+j)return d("WAResultOrError").makeError("errSignalGrpInvalidVersionContentLength");var c,e,f;try{b=a.subarray(1,-j);b=d("decodeProtobuf").decodeProtobuf(d("WASignalWhisperTextProtocol.pb").SenderKeyMessageSpec,b);c=b.id;e=b.iteration;f=b.ciphertext;if(c==null||e==null||f==null)return d("WAResultOrError").makeError("errSignalGrpSenderKeyInvalidProtoFormat")}catch(a){d("WALogger").ERROR(h(),a);return d("WAResultOrError").makeError("errSignalGrpSenderKeyProtoError")}return d("WAResultOrError").makeResult({senderKeyMessageId:c,iteration:e,ciphertext:new Uint8Array(f),versionContentMac:a})}function m(a){var c,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:c=new(d("WABinary").Binary)(a);e=d("WASignalOther").readBytes(c,16);f=d("WASignalOther").readBytes(c,32);g.next=5;return b("regeneratorRuntime").awrap(d("WASignalOther").makeCryptoKey(f,"aes-cbc"));case 5:g.t0=g.sent;g.t1=e;return g.abrupt("return",[g.t0,g.t1]);case 8:case"end":return g.stop()}},null,this)}function n(a,b){var c=a.subarray(a.length-j);a=a.subarray(0,a.length-j);return d("WASignalSignatures").verifyMsgSignalVariant(b,a,d("WASignalOther").toBytes(d("WASignalOther").toBuffer(c),64))}function o(a,c){var e,f,g,h,i,j,k,l,m,n,o,q;return b("regeneratorRuntime").async(function(r){while(1)switch(r.prev=r.next){case 0:e=a;f=c-e.senderKeyChainKey.nextMsgIndex;if(!(f>2e3)){r.next=4;break}return r.abrupt("return",d("WAResultOrError").makeError("errSignalGrpTooManyMessagesInFuture"));case 4:g=a.unusedMsgKeys||[];if(!(f<0)){r.next=10;break}h=g.findIndex(function(a){return a.iteration===c});if(!(h===-1)){r.next=9;break}return r.abrupt("return",d("WAResultOrError").makeError("errDuplicateMsg"));case 9:return r.abrupt("return",d("WAResultOrError").makeResult({msgKey:g[h],updatedSenderKeyState:d("WASignalGroupSession").makeSenderKeyState(e.senderSigningKeyPublic,e.senderSigningKeyPrivate,e.senderKeyChainKey,e.senderKeyId,p(g,h))}));case 10:i=e.senderKeyChainKey.nextMsgIndex;r.next=13;return b("regeneratorRuntime").awrap(d("WASignalWhitepaper").deriveSenderKeyMsgKey(i,e.senderKeyChainKey.chainKey));case 13:j=r.sent;k=j[0];l=j[1];m=null;if(!(f>0)){r.next=31;break}n=f+g.length-d("WASignalCipher").MAX_UNUSED_KEYS;n>0?(m=g.slice(n),n-=g.length):m=g.slice();o=i+1;case 21:if(!(o<=c)){r.next=31;break}n>0?n--:m.push(l);r.next=25;return b("regeneratorRuntime").awrap(d("WASignalWhitepaper").deriveSenderKeyMsgKey(o,k));case 25:q=r.sent,k=q[0],l=q[1];case 28:o++;r.next=21;break;case 31:return r.abrupt("return",d("WAResultOrError").makeResult({msgKey:l,updatedSenderKeyState:d("WASignalGroupSession").makeSenderKeyState(e.senderSigningKeyPublic,e.senderSigningKeyPrivate,d("WASignalGroupSession").makeSenderKeyChainKey(c+1,k),a.senderKeyId,m||g)}));case 32:case"end":return r.stop()}},null,this)}function p(a,b){var c=[];for(var d=0;d<a.length;d++)d!==b&&c.push(a[d]);return c}g.processSenderKeyDistributionMsg=a;g.createSenderKeyDistributionProto=c;g.encryptSenderKeyMsgWithSession=e;g.decryptSenderKeyMsgFromSession=f;g.deserializeSenderKeyMsg=l}),98);
__d("WACryptoLibrary",["WACryptoUtils","WAJids","WALockMap","WALogger","WAResultOrError","WASignalCipher","WASignalGroupCipher","WASignalGroupSession","WASignalKeys","WASignalOther","WASignalSignatures","WASignalWhitepaper","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["getSessionForRecipient pkmsg signature verification result: ",""]);h=function(){return a};return a}var i=d("WALockMap").makeLockMap(60*1e3);function a(){return i}var j=[],k=300;function l(a){j.push(a),j.length>=k&&j.shift()}function c(a){a(j),j=[]}function m(a,c){var e,f,g,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:l("createOutgoingSession");e=u(c);f=e.signedKey;j.next=5;return b("regeneratorRuntime").awrap(d("WASignalSignatures").verifyMsgSignalVariant(e.identity,f.publicKey,f.signature));case 5:g=j.sent;d("WALogger").DEV(h(),g);if(g){j.next=10;break}l("createOutgoingSession: errSignalInvalidKey");return j.abrupt("return",d("WAResultOrError").makeError("errSignalInvalidKey"));case 10:j.next=12;return b("regeneratorRuntime").awrap(d("WASignalWhitepaper").initiateSessionOutgoing(a,e,d("WASignalKeys").makeKeyPair()));case 12:i=j.sent;return j.abrupt("return",d("WAResultOrError").makeResult(i));case 14:case"end":return j.stop()}},null,this)}function e(a,c,d,e,f){var g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:g=a.handleNewSession;l("establishOutgoingSession");j.next=4;return b("regeneratorRuntime").awrap(m(c,e));case 4:h=j.sent;if(h.success){j.next=7;break}return j.abrupt("return",h);case 7:i=h.value;return j.abrupt("return",g(d,i,i.remote.pubKey,null,f));case 9:case"end":return j.stop()}},null,this)}function f(a,c,e,f){var g=a.loadSession,h=a.handleNewSession;l("encryptContent");return i.lock([d("WAJids").extractUserJid(c)],function(){var a,i,j,k,m,n;return b("regeneratorRuntime").async(function(o){while(1)switch(o.prev=o.next){case 0:a=null;case 1:o.next=3;return b("regeneratorRuntime").awrap(g(c,"cryptoLibraryEncryptContent"));case 3:i=o.sent;if(!(i==null)){o.next=7;break}l("encryptContent: errSignalInvalidKey");return o.abrupt("return",d("WAResultOrError").makeError("errSignalInvalidKey"));case 7:if(!(f!=null&&!d("WACryptoUtils").uint8ArraysEqual(f,i.remote.pubKey))){o.next=10;break}l("encryptContent: identity-mismatch");return o.abrupt("return",d("WAResultOrError").makeError("identity-mismatch"));case 10:o.next=12;return b("regeneratorRuntime").awrap(d("WASignalCipher").encryptMsg(i,e));case 12:j=o.sent;k=j[0];m=j[1];o.next=17;return b("regeneratorRuntime").awrap(h(c,k,k.remote.pubKey));case 17:n=o.sent,n.success?a=d("WAResultOrError").makeResult(babelHelpers["extends"]({},m,{baseKey:k.aliceBaseKey})):n.error;case 19:if(a==null){o.next=1;break}case 20:return o.abrupt("return",a);case 21:case"end":return o.stop()}},null,this)})}function n(a,c,e,f,g){var h=a.loadSession,j=a.handleNewSession,k=a.loadSignedPreKey,m=a.loadOneTimePreKey;l("decryptContent");return i.lock([d("WAJids").extractUserJid(e)],function(){var a,i,n,p,q,r,s,t,u,v,w,x;return b("regeneratorRuntime").async(function(y){while(1)switch(y.prev=y.next){case 0:a=!1;y.next=3;return b("regeneratorRuntime").awrap(h(e,"decryptContent"));case 3:i=y.sent;if(!(f.type==="pkmsg")){y.next=18;break}p=d("WASignalCipher").deserializePkMsg(f.ciphertext);if(p.success){y.next=9;break}l("decryptContent: errCryptoDeserialization");return y.abrupt("return",d("WAResultOrError").makeError("errCryptoDeserialization"));case 9:q=p.value;y.next=12;return b("regeneratorRuntime").awrap(o({loadSignedPreKey:k,loadOneTimePreKey:m},c,q,i));case 12:r=y.sent;if(r.success){y.next=15;break}return y.abrupt("return",r);case 15:n=r.value;y.next=30;break;case 18:f.type;s=d("WASignalCipher").deserializeMsg(f.ciphertext);if(s.success){y.next=23;break}l("decryptContent: errCryptoDeserialization");return y.abrupt("return",d("WAResultOrError").makeError("errCryptoDeserialization"));case 23:t=s.value;y.next=26;return b("regeneratorRuntime").awrap(d("WASignalCipher").decryptMsg(i,t));case 26:u=y.sent;if(u.success){y.next=29;break}return y.abrupt("return",u);case 29:n=u.value;case 30:v=n,w=v.newSessionInfo;if(!(w&&(w.newIdentity!=null||w.usedPreKey!=null))){y.next=34;break}y.next=34;return b("regeneratorRuntime").awrap(j(e,w.baseSession,w.newIdentity,w.usedPreKey));case 34:if(a){y.next=39;break}x=w==null?void 0:w.baseSession.remote.pubKey;y.next=38;return b("regeneratorRuntime").awrap(g(new Uint8Array(n.plaintext),x));case 38:a=!0;case 39:y.next=41;return b("regeneratorRuntime").awrap(j(e,n.updatedSession,n.updatedSession.remote.pubKey));case 41:return y.abrupt("return",d("WAResultOrError").makeResult());case 42:case"end":return y.stop()}},null,this)})}function o(a,c,e,f){var g,h,i,j,k,m,n,o,p,q,r,s,t,u,v,w;return b("regeneratorRuntime").async(function(x){while(1)switch(x.prev=x.next){case 0:g=a.loadSignedPreKey,h=a.loadOneTimePreKey;l("decryptPkMsg");i=f&&d("WASignalCipher").findMatchingSession(f,e.sessionBaseKey);if(!i){x.next=13;break}x.next=6;return b("regeneratorRuntime").awrap(d("WASignalCipher").decryptMsgFromSession(i,e));case 6:j=x.sent;if(j.success){x.next=9;break}return x.abrupt("return",j);case 9:k=j.value,m=k[0],n=k[1];return x.abrupt("return",d("WAResultOrError").makeResult({newSessionInfo:null,updatedSession:m,plaintext:n}));case 13:o=e.localOneTimeKeyId;x.next=16;return b("regeneratorRuntime").awrap(g(e.localSignedPreKeyId));case 16:p=x.sent;if(!(o==null)){x.next=21;break}x.t0=null;x.next=24;break;case 21:x.next=23;return b("regeneratorRuntime").awrap(h(o));case 23:x.t0=x.sent;case 24:q=x.t0;x.next=27;return b("regeneratorRuntime").awrap(d("WASignalCipher").decryptPkMsgWithNewSession(c,f,e,{localSignedPreKey:p,localOneTimeKey:q}));case 27:r=x.sent;if(r.success){x.next=30;break}return x.abrupt("return",r);case 30:s=r.value,t=s.newIdentity,u=s.baseSession,v=s.updatedSession,w=s.plaintext;return x.abrupt("return",d("WAResultOrError").makeResult({newSessionInfo:{newIdentity:t,baseSession:u,usedPreKey:o},updatedSession:v,plaintext:w}));case 32:case"end":return x.stop()}},null,this)}function p(c,e,f,g){var h=c.loadSenderKeySession,a=c.saveSenderKeySession;l("encryptGroupContent");return i.lock([e,d("WAJids").extractUserJid(f)],function(){var c,i,j,k,m,n,o,p;return b("regeneratorRuntime").async(function(q){while(1)switch(q.prev=q.next){case 0:c=null;case 1:q.next=3;return b("regeneratorRuntime").awrap(h(e,f));case 3:i=q.sent;if(i.success){q.next=6;break}return q.abrupt("return",d("WAResultOrError").makeError(i.error));case 6:j=i.value;q.next=9;return b("regeneratorRuntime").awrap(d("WASignalGroupCipher").encryptSenderKeyMsgWithSession(j,g));case 9:k=q.sent;if(!k.success){q.next=18;break}m=k.value,n=m[0],o=m[1];q.next=14;return b("regeneratorRuntime").awrap(a(e,f,n));case 14:p=j.senderKeyStates[j.senderKeyStates.length-1];c=d("WAResultOrError").makeResult({ciphertext:{ciphertext:o,type:"skmsg"},senderKeyId:p.senderKeyId,senderKeyDistributionProto:d("WASignalGroupCipher").createSenderKeyDistributionProto(d("WASignalGroupSession").convertFromRawToSenderKeyState(p))});q.next=20;break;case 18:l("encryptGroupContent: sender-key-no-session");return q.abrupt("return",d("WAResultOrError").makeError("sender-key-no-session"));case 20:if(c==null){q.next=1;break}case 21:return q.abrupt("return",c);case 22:case"end":return q.stop()}},null,this)})}function q(c,e,f,g,h){var j=c.loadSenderKeySession,a=c.saveSenderKeySession;l("decryptGroupContent");return i.lock([e,d("WAJids").extractUserJid(f)],function(){var c,i,k,m,n,o,p,q;return b("regeneratorRuntime").async(function(r){while(1)switch(r.prev=r.next){case 0:c=!1;r.next=3;return b("regeneratorRuntime").awrap(j(e,f));case 3:i=r.sent;if(i.success){r.next=6;break}return r.abrupt("return",d("WAResultOrError").makeError(i.error));case 6:k=d("WASignalGroupCipher").deserializeSenderKeyMsg(g);if(k.success){r.next=10;break}l("decryptGroupContent: errCryptoDeserialization");return r.abrupt("return",d("WAResultOrError").makeError("errCryptoDeserialization"));case 10:m=i.value;r.next=13;return b("regeneratorRuntime").awrap(d("WASignalGroupCipher").decryptSenderKeyMsgFromSession(m,k.value));case 13:n=r.sent;if(n.success){r.next=16;break}return r.abrupt("return",n);case 16:o=n.value,p=o[0],q=o[1];if(c){r.next=21;break}r.next=20;return b("regeneratorRuntime").awrap(h(new Uint8Array(q)));case 20:c=!0;case 21:r.next=23;return b("regeneratorRuntime").awrap(a(e,f,p));case 23:return r.abrupt("return",d("WAResultOrError").makeResult());case 24:case"end":return r.stop()}},null,this)})}function r(c,e,f,g){var h=c.loadSenderKeySession,a=c.saveSenderKeySession;l("saveSenderKeySession");return i.lock([e,d("WAJids").extractUserJid(f)],function(){var c,i,j,k;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:c=null;if(!h){l.next=6;break}l.next=4;return b("regeneratorRuntime").awrap(h(e,f));case 4:i=l.sent,c=i.success?i.value:null;case 6:l.next=8;return b("regeneratorRuntime").awrap(d("WASignalGroupCipher").processSenderKeyDistributionMsg(g,c));case 8:j=l.sent;if(j.success){l.next=11;break}return l.abrupt("return",j);case 11:k=j.value;l.next=14;return b("regeneratorRuntime").awrap(a(e,f,k));case 14:return l.abrupt("return",d("WAResultOrError").makeResult());case 15:case"end":return l.stop()}},null,this)})}function s(c,e,f,g){var a=c.saveSenderKeySession;l("rotateGroupSenderKey");return i.lock([e,d("WAJids").extractUserJid(f)],function(){var c,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:i.next=2;return b("regeneratorRuntime").awrap(d("WASignalWhitepaper").initiateSenderKeySessionOutgoing(g));case 2:c=i.sent;h=c.senderKeyStates[0].senderKeyId;i.next=6;return b("regeneratorRuntime").awrap(a(e,f,c));case 6:return i.abrupt("return",{senderKeyId:h});case 7:case"end":return i.stop()}},null,this)})}function t(c,e,f){var g,a,h,i,j,k;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:g=c.loadSenderKeySession,a=c.saveSenderKeySession;l("createSenderKeyDistributionMsg");m.next=4;return b("regeneratorRuntime").awrap(g(e,f));case 4:h=m.sent;i=h.error;if(!(!h.success&&i==="errLoadSenderKeySession")){m.next=15;break}m.next=9;return b("regeneratorRuntime").awrap(d("WASignalKeys").makeKeyPair());case 9:j=m.sent;m.next=12;return b("regeneratorRuntime").awrap(s({saveSenderKeySession:a},e,f,j));case 12:m.next=14;return b("regeneratorRuntime").awrap(g(e,f));case 14:h=m.sent;case 15:if(!h.success){m.next=19;break}k=h.value.senderKeyStates.slice(-1);if(!(k.length>0)){m.next=19;break}return m.abrupt("return",d("WAResultOrError").makeResult(d("WASignalGroupCipher").createSenderKeyDistributionProto(d("WASignalGroupSession").convertFromRawToSenderKeyState(k[0]))));case 19:l("createSenderKeyDistributionMsg: errGetSenderKeyProto");return m.abrupt("return",d("WAResultOrError").makeError("errGetSenderKeyProto"));case 21:case"end":return m.stop()}},null,this)}function u(a){var b=a.regId,c=a.identity,e=a.signedKey;a=a.oneTimeKey;l("sanitizeInitialSessionInfo");var f=d("WASignalKeys").castToSerializedPubKey(e.publicKey);return{regId:d("WASignalOther").castRegistrationId(b),identity:d("WASignalKeys").castToSerializedPubKey(c),signedKey:{id:d("WASignalKeys").castToSignedPreKeyId(e.id),publicKey:f,signature:d("WASignalOther").ensureSize(e.signature,64)},oneTimeKey:a&&{id:d("WASignalKeys").castToPreKeyId(a.id),publicKey:d("WASignalKeys").castToSerializedPubKey(a.publicKey)},ratchetKey:f}}g.getSessionLocks=a;g.publishLogs=c;g.createOutgoingSession=m;g.establishOutgoingSession=e;g.encryptContent=f;g.decryptContent=n;g.encryptGroupContent=p;g.decryptGroupContent=q;g.saveSenderKeySession=r;g.rotateGroupSenderKey=s;g.createSenderKeyDistributionMsg=t}),98);
__d("WACryptoManager",["MAWLoggerUtils","Promise","WABaseGlobals","WACryptoLibrary","WACryptoUtils","WAErr","WAJids","WALogger","WANullthrows","WAPromiseQueue","WAResultOrError","WASignalCipher","WASignalGroupSession","WASignalKeys","WASignalLocalStorageProtocol.pb","WASignalOther","WASignalSessions","WASignalSignatures","WATagsLogger","WATimeUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to generate signed prekey with id: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to deserialize signed prekey: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to generate signed prekey ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to generate one time prekey: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[SendMessage] end encryption"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[SendMessage] start encryption"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[SendMessage] sendWrittenMsg bulkEncryptContent"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["[sessions] Failed to create a session"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["[sessions] Received keys ",""]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["[sessions] fail during key requesting"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["[sessions] Missing sessions: ",". Requesting keys"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["[sessions] No need to establish outgoing sessions"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["[sessions] Establish outgoing sessions"]);u=function(){return a};return a}var v=d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.CryptoManager]),w={type:"default"};function a(a){return{regInfo:a.regInfo,network:a.network,storage:a.storage}}function x(a,c,e,f,g){var h,i,j,k,l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:m.next=2;return b("regeneratorRuntime").awrap(f(c,g));case 2:h=m.sent;if(!(h!=null&&e.type!=="requestNewSession")){m.next=13;break}i=h;if(!(e.type==="default")){m.next=9;break}return m.abrupt("return",d("WAResultOrError").makeResult(i));case 9:if(!(i.aliceBaseKey!=null&&e.session.baseKey!=null)){m.next=13;break}e.type;if(d("WACryptoUtils").uint8ArraysEqual(e.session.baseKey,i.aliceBaseKey)){m.next=13;break}return m.abrupt("return",d("WAResultOrError").makeResult(i));case 13:if(!(e.type==="useSession")){m.next=17;break}j=e.session.keys;m.next=25;break;case 17:e.type;m.next=20;return b("regeneratorRuntime").awrap(a.network.requestKeys(c));case 20:k=m.sent;if(k.success){m.next=23;break}return m.abrupt("return",k);case 23:j=k.value.keys,e.type==="compareTSAndUseSession"&&e.session.timestamp>=k.value.timestamp&&(j=e.session.keys);case 25:m.next=27;return b("regeneratorRuntime").awrap(d("WACryptoLibrary").createOutgoingSession(a.regInfo,j));case 27:l=m.sent;if(l.success){m.next=30;break}return m.abrupt("return",l);case 30:return m.abrupt("return",d("WAResultOrError").makeResult(l.value));case 31:case"end":return m.stop()}},null,this)}function e(a,b,c,e){return a.storage.runInTransaction(function(f){f=f.handleNewSession;return d("WACryptoLibrary").establishOutgoingSession({handleNewSession:f},a.regInfo,b,c,e)})}function y(a,c){var e,f,g,h,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:d("WALogger").DEV(u());k.next=3;return b("regeneratorRuntime").awrap(a.storage.runInTransaction(function(a){a=a.loadSessions;return a(c).then(function(a){return d("WAResultOrError").makeResult(a)})}));case 3:e=k.sent;f=e.success===!0?e.value:new Map();g=c.filter(function(a){return!f.has(a)});if(!(g.length===0)){k.next=9;break}d("WALogger").DEV(t());return k.abrupt("return",f);case 9:d("WALogger").DEV(s(),g.length);k.next=12;return b("regeneratorRuntime").awrap(a.network.bulkRequestKeys(g));case 12:h=k.sent;if(h.success){k.next=16;break}d("WALogger").ERROR(r());return k.abrupt("return",f);case 16:i=h.value;d("WALogger").DEV(q(),i.size);j=new(d("WAPromiseQueue").PromiseQueue)();i.forEach(function(b,c){j.enqueue(function(){return d("WACryptoLibrary").createOutgoingSession(a.regInfo,b.keys).then(function(a){a.success===!1?d("WALogger").ERROR(p()):f.set(c,a.value)})})});k.next=22;return b("regeneratorRuntime").awrap(j.wait());case 22:return k.abrupt("return",f);case 23:case"end":return k.stop()}},null,this)}function z(a,b){return d("WACryptoLibrary").getSessionLocks().lock(a.map(function(a){return a}),b)}function f(a,e){var f=Array.from(e.keys());return z(f,function(){var g,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:d("WALogger").LOG(o());k.next=3;return b("regeneratorRuntime").awrap(y(a,f));case 3:g=k.sent;i=new Map();d("WALogger").DEV(n());k.next=8;return b("regeneratorRuntime").awrap(a.storage.runInTransaction(function(a){var f=a.handleNewSession;return(h||(h=b("Promise"))).all(Array.from(g.entries()).map(function(a){var g,h,j,k,l,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:h=a[0],j=a[1];n.next=3;return b("regeneratorRuntime").awrap(d("WASignalCipher").encryptMsg(j,c("WANullthrows")((g=e.get(h))==null?void 0:g.plaintext)));case 3:k=n.sent;l=k[0];m=k[1];i.set(h,babelHelpers["extends"]({},m,{baseKey:null}));return n.abrupt("return",f(h,l,l.remote.pubKey));case 8:case"end":return n.stop()}},null,this)})).then(function(){return d("WAResultOrError").makeResult()})}));case 8:j=k.sent;if(!(j.success===!0)){k.next=14;break}d("WALogger").DEV(m());return k.abrupt("return",d("WAResultOrError").makeResult(i));case 14:return k.abrupt("return",j);case 15:case"end":return k.stop()}},null,this)})}function A(a,b,c,e,f){return a.storage.runInTransaction(function(g){var h=g.handleNewSession,i=g.loadSession;return d("WACryptoLibrary").encryptContent({loadSession:function(b){return x(a,b,e,i,"cryptoManagerEncryptContent").then(function(a){if(a.success===!0)return a.value;else return null})},handleNewSession:h},b,c,f)})}function B(a,b,c,e){return a.storage.runInTransaction(function(f){var g=f.loadSession,h=f.handleNewSession,i=f.loadSignedPreKey;f=f.loadOneTimePreKey;return d("WACryptoLibrary").decryptContent({loadSession:g,handleNewSession:h,loadSignedPreKey:i,loadOneTimePreKey:f},a.regInfo,b,c,e)},{fetchUnknownDevices:!0})}function C(a,c){return d("WACryptoLibrary").getSessionLocks().lock([c],function(){var e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:g.next=2;return b("regeneratorRuntime").awrap(a.storage.runInTransaction(function(a){a=a.loadSession;return a(c,"getParticipantInfo").then(function(a){return d("WAResultOrError").makeResult(a)})}));case 2:e=g.sent;if(!(e.success===!0)){g.next=5;break}return g.abrupt("return",(f=e.value)==null?void 0:f.remote);case 5:case"end":return g.stop()}},null,this)})}function D(a){return a.storage.runInTransaction(function(a){var e,f,g,h,i,j,k,l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:g=a.getLastPreKeyGenerationId,h=a.saveOneTimePreKey;m.next=3;return b("regeneratorRuntime").awrap(g());case 3:i=m.sent;j=((e=i==null?void 0:i.lastPreKeyId)!=null?e:0)+1;k=d("WASignalKeys").makePreKeys(j,1)[0];m.next=8;return b("regeneratorRuntime").awrap(h({keyId:k.plainObject.id,encoded:k.record}));case 8:l=m.sent;if(!l.success){m.next=11;break}return m.abrupt("return",d("WAResultOrError").makeResult(k.plainObject));case 11:throw c("WAErr")("Cannot save one time prekey: "+l.error+", LastPreKeyId: "+((f=i==null?void 0:i.lastPreKeyId)!=null?f:0));case 12:case"end":return m.stop()}},null,this)}).then(function(a){if(a.success)return a.value;else{v.TAGS([d("MAWLoggerUtils").Tag.OneTimePrekey]).ERROR(l(),a);throw c("WAErr")("[CryptoManager] failed to generate one time prekey")}})}function E(a){return a.storage.runInTransaction(function(a){var c,e,f,g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:e=a.getLastPreKeyGenerationId,f=a.savePreKeysGeneration;i.next=3;return b("regeneratorRuntime").awrap(e());case 3:g=i.sent;h=d("WASignalKeys").makePreKeys(((c=g==null?void 0:g.lastPreKeyId)!=null?c:0)+1,d("WABaseGlobals").getConfig().maxPrekeysToUpload());return i.abrupt("return",f(h.map(function(a){var b=a.plainObject;a=a.record;return{keyId:b.id,encoded:a}})));case 6:case"end":return i.stop()}},null,this)})}function F(a){return a.storage.runInTransaction(function(a){a=a.loadLatestSignedPreKey;return a().then(function(a){return d("WAResultOrError").makeResult(a)})}).then(function(b){if(b.success===!1){var e;v.TAGS([d("MAWLoggerUtils").Tag.SignedPrekey]).ERROR(k(),b==null?void 0:b.payload);throw c("WAErr")("Failed to generate signed prekey: "+((e=b==null?void 0:(e=b.payload)==null?void 0:e.message)!=null?e:""))}e=b.value;e=d("WASignalSignatures").deserializeSignedPreKey(e);if(e==null){v.TAGS([d("MAWLoggerUtils").Tag.SignedPrekey]).ERROR(j(),b);throw c("WAErr")("failed to deserialize signed prekey")}return G(a,e.id+1)})}function G(a,b){var e=d("WASignalSignatures").makeSignedPreKey(b,d("WATimeUtils").unixTimeMs(),a.regInfo.staticKeyPair),f=d("WASignalSignatures").serializeSignedPreKeyForPrivateStorage(e);return a.storage.runInTransaction(function(a){a=a.saveSignedPreKeyIfNew;return a(e.id,f).then(function(a){if(a.type==="success")return d("WAResultOrError").makeResult(e);else{a.type;return d("WAResultOrError").makeResult(a.key)}})}).then(function(a){if(a.success===!1){var b;v.TAGS([d("MAWLoggerUtils").Tag.SignedPrekey]).ERROR(i(),a);throw c("WAErr")("Unexpected error when generateSignedPreKeyWithId: "+((b=a==null?void 0:(b=a.payload)==null?void 0:b.message)!=null?b:a.error))}return a.value})}function H(a,b,c,e){return a.storage.runInTransaction(function(a){var f=a.loadSenderKeySession;a=a.saveSenderKeySession;return d("WACryptoLibrary").encryptGroupContent({loadSenderKeySession:f,saveSenderKeySession:a},b,c,e)})}function I(a,b,c,e,f){return a.storage.runInTransaction(function(a){var g=a.loadSenderKeySession;a=a.saveSenderKeySession;return d("WACryptoLibrary").decryptGroupContent({loadSenderKeySession:g,saveSenderKeySession:a},b,c,e,f)})}function J(a,b,c,e){return a.storage.runInTransaction(function(f){var a=f.saveSenderKeySession;f=f.loadSenderKeySession;return d("WACryptoLibrary").saveSenderKeySession({loadSenderKeySession:d("WABaseGlobals").getConfig().useUpdatedSenderKeySession()?f:void 0,saveSenderKeySession:a},b,c,e)})}function K(a,c,e){var f,g;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:i.next=2;return b("regeneratorRuntime").awrap(D(a));case 2:f=i.sent;i.next=5;return b("regeneratorRuntime").awrap(a.storage.runInTransaction(function(a){a=a.saveSenderKeySession;return d("WACryptoLibrary").rotateGroupSenderKey({saveSenderKeySession:a},c,e,f.keyPair).then(d("WAResultOrError").makeResult)}));case 5:g=i.sent;if(!g.success){i.next=10;break}return i.abrupt("return",(h||(h=b("Promise"))).resolve(g.value));case 10:return i.abrupt("return",(h||(h=b("Promise"))).reject(g.error));case 11:case"end":return i.stop()}},null,this)}function L(a){return(h||(h=b("Promise"))).resolve().then(function(){return{regId:d("WASignalOther").makeRegistrationId(a),staticKeyPair:d("WASignalKeys").makeKeyPair(),authKeyPair:d("WASignalKeys").makeKeyPair()}})}function M(a){return d("WASignalOther").encodeSignalProto(d("WASignalLocalStorageProtocol.pb").RecordStructureSpec,d("WASignalSessions").serializeSession(a))}function N(a){return d("WASignalOther").decodeSignalProto(d("WASignalLocalStorageProtocol.pb").RecordStructureSpec,a,d("WASignalSessions").parseSessionFromRecord)}function O(a){return d("WASignalOther").encodeSignalProto(d("WASignalLocalStorageProtocol.pb").SenderKeyRecordStructureSpec,d("WASignalGroupSession").serializeSession(a))}function P(a){return d("WASignalOther").decodeSignalProto(d("WASignalLocalStorageProtocol.pb").SenderKeyRecordStructureSpec,a,d("WASignalGroupSession").parseSessionFromRecord)}function Q(a){return a}function R(a,b){return a+"|"+b}function S(a){a=a.split("|");if(a.length!==2)throw c("WAErr")("Incorrect ComplexSenderKey");return{groupId:d("WAJids").unsafeCoerceToGroupJid(a[0]),deviceId:d("WAJids").unsafeCoerceToDeviceJid(a[1])}}g.DEFAULT_SESSION_REQUEST=w;g.initCryptoManager=a;g.getSessionForRecipient=x;g.establishOutgoingSession=e;g.ensureSessionsExists=y;g.acquireSessionLocks=z;g.bulkEncryptContent=f;g.encryptContent=A;g.decryptContent=B;g.getParticipantInfo=C;g.generateOneTimePreKey=D;g.generatePreKeys=E;g.generateSignedPreKey=F;g.generateSignedPreKeyWithId=G;g.encryptGroupContent=H;g.decryptGroupContent=I;g.saveSenderKeySession=J;g.rotateGroupSenderKey=K;g.generateRegistrationInfo=L;g.encodeSession=M;g.decodeSession=N;g.encodeSenderKeySession=O;g.decodeSenderKeySession=P;g.castToPreKeyGenerationId=Q;g.encodeSenderKey=R;g.decodeSenderKey=S}),98);
__d("WAPreRegistrationCrypto",["WACryptoManager","WAErr","WASignalSignatures","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(){var a,c,e,f,g,h,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:k.next=2;return b("regeneratorRuntime").awrap(d("WACryptoManager").generateRegistrationInfo());case 2:a=k.sent;c=a.regId;e=a.staticKeyPair;f=a.authKeyPair;g=Date.now();k.next=9;return b("regeneratorRuntime").awrap(d("WASignalSignatures").generateSignedPreKey(1,g,e));case 9:h=k.sent;i=h.plainObject;j=h.record;return k.abrupt("return",{regId:c,identityKeyPair:e,authKeyPair:f,signedPreKey:{keyId:i.id,encoded:j}});case 13:case"end":return k.stop()}},null,this)}function e(a){var b=d("WASignalSignatures").deserializeSignedPreKey(a.signedPreKey.encoded);if(b==null||b.id!==a.signedPreKey.keyId)throw c("WAErr")("Badly formatted signed prekey");return{regId:a.regId,identityPubKeyType:5,identityPubKey:a.identityKeyPair.publicKey,signedPreKey:b}}g.makeRegistrationData=a;g.serializeRegistrationData=e}),98);
__d("MAWDeviceRegistrationUtilWorker",["MAWConstants","MAWCurrentUser","MAWDeviceRegistrationTypes","MAWLoggerUtils","URI","WABase64","WAPreRegistrationCrypto","WATagsLogger","WAWorkerGlobalScope","asyncToGeneratorRuntime","err","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["ICDC failed to fetch url:",". error: ",""]);i=function(){return a};return a}function j(a,b){var c=new Uint8Array(b);a=a;for(b=b-1|0;b>=0;--b)c[b]=a&255,a=a>>>8;return c}function k(a,b,c,e,f,g,h,i,k){var l;f=(l=d("WABase64")).encodeB64(j(f,4));g=l.encodeB64(j(g,1));h=l.encodeB64(h);var m=l.encodeB64(j(i.id,3)),n=l.encodeB64(i.keyPair.publicKey);l=l.encodeB64(i.signature);i=new Map().set("fbid",a).set("fb_cat",b).set("app_id",c).set("device_id",e).set("e_regid",f).set("e_keytype",g).set("e_ident",h).set("e_skey_id",m).set("e_skey_val",n).set("e_skey_sig",l);if(k){a=d("WABase64").encodeB64(k.signedICDCIdentityList);b=d("WABase64").encodeB64(k.ihash);i.set("icdc_list",a).set("icdc_ts",k.ts).set("icdc_seq",k.seq).set("ihash",b)}return i}function l(a){var b=[];a.forEach(function(a,c,d){b.push(encodeURIComponent(c)+("="+encodeURIComponent(a.toString())))});return b.join("&")}function m(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{a=(yield d("WAWorkerGlobalScope").workerGlobalScope.fetch(b,{body:a,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},method:"POST"}));return yield a.json()}catch(a){d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.DeviceRegistration]).ERROR(i(),b,a);throw a}});return n.apply(this,arguments)}function o(a,b){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield d("WAWorkerGlobalScope").workerGlobalScope.fetch(b,{body:a,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},method:"POST"}));return b.json()});return p.apply(this,arguments)}function q(){var a=new(h||(h=c("URI")))(t()+d("MAWDeviceRegistrationTypes").ICDC_ENDPOINT);return a.toString()}function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=q();a=(yield m(a,b));if(a==null)throw c("err")(d("MAWDeviceRegistrationTypes").NULL_RESPONSE_FROM_SERVER);if(a.status!==200)throw c("err")("WA Server returned status code "+a.status+" while attempting device registration");return a});return s.apply(this,arguments)}function t(){var a=Number(d("MAWCurrentUser").getAppID()),b=d("MAWDeviceRegistrationTypes").REG_FB_DOMAIN;switch(a){case 1217981644879628:case 936619743392459:case 487152425211411:case 1035956773910536:b=d("MAWDeviceRegistrationTypes").REG_IGD_DOMAIN;break;case 772021112871879:b=d("MAWDeviceRegistrationTypes").REG_MSGR_DOMAIN;break;default:b=d("MAWDeviceRegistrationTypes").REG_FB_DOMAIN}return b}function u(){var a=new(h||(h=c("URI")))(t()+d("MAWDeviceRegistrationTypes").REGISTRATION_ENDPOINT);return a.toString()}function v(a){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=u(),e;try{e=(yield o(a,b))}catch(a){throw c("err")("Post request failed: "+(a==null?void 0:a.message)+" url:"+b)}if(e==null)throw c("err")(d("MAWDeviceRegistrationTypes").NULL_RESPONSE_FROM_SERVER);if(e.wa_device_id==null||e.status!==200){a=e.message!=null?': "'+e.message+'"':"";b="WA Server returned status code "+e.status+a+" while attempting device registration";throw c("err")(b)}if(typeof e.wa_device_id!=="number")throw c("err")("Device ID from WA Server was not a number");return{deviceId:e.wa_device_id,icdcSuccess:(a=e.icdc_success)!=null?a:!1,type:e.type}});return w.apply(this,arguments)}function a(a,b,c,d){a=new Map().set("fbid",a).set("fb_cat",b).set("app_id",c).set("device_id",d);b=l(a);return r(b)}function e(a,b,c,d,e,f,g,h,i){a=k(a,b,c,d,e,f,g,h,i);b=l(a);return v(b)}function f(){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAPreRegistrationCrypto").makeRegistrationData());return{deviceUUID:c("uuidv4")(),lastSignedPrekeyId:a.signedPreKey.keyId,registrationVersion:d("MAWConstants").CURRENT_REGISTRATION_VERSION,signalRegInfo:a}});return x.apply(this,arguments)}g.getRegistrationEndpoint=u;g.fetchICDC=a;g.register=e;g.createNewRegistrationMeta=f}),98);
__d("WAArmadilloICDC.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};a.internalSpec={seq:[1,(c=d("WAProtoConst")).TYPES.INT32],timestamp:[2,c.TYPES.INT64],devices:[3,c.FLAGS.REPEATED|c.TYPES.BYTES],signingDeviceIndex:[4,c.TYPES.INT32]};b.internalSpec={details:[1,c.TYPES.BYTES],signature:[2,c.TYPES.BYTES]};g.ICDCIdentityListSpec=a;g.SignedICDCIdentityListSpec=b}),98);
__d("WAICDCUtils",["WAArmadilloICDC.pb","WABase64","WABinary","WABridge","WACryptoDependencies","WACryptoEd25519","WACryptoUtils","WAErr","WAIdentityUtils","WAJids","WALogger","WAOdsEnums","WASignalKeys","WASignalOther","WASignalSignatures","WATimeUtils","decodeProtobuf","encodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["ICDC timestamp is negative. time: ",", closkSkew: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["signingDeviceIndex not found. This should never happen. ",". caller: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Received ICDC has mismatched missed signingDeviceIndex"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Received ICDC has mismatched timestamp between XML node and byte structure"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Received ICDC has mismatched sequence between XML node and byte structure"]);l=function(){return a};return a}function a(a,b,c,e){if(a!==e.details.seq){d("WALogger").ERROR(l());return null}if(c!==e.details.timestamp){d("WALogger").ERROR(k());return null}if(e.details.signingDeviceIndex==null){d("WALogger").ERROR(j());return null}var f=e.details.signingDeviceIndex;return{dirty:b,sequence:a,timestamp:c,signingDeviceIndex:f,devices:e.details.devices.map(function(a){return new Uint8Array(a)})}}function m(a){return a.signingDeviceIndex<0||a.signingDeviceIndex>=a.devices.length}function n(a,b){if(m(b))return null;var c=new Set(),e=new Set();b.devices.forEach(function(a){c.add(a.id),e.add(a.identity.toString())});var f=new Set(),g=new Set();a.devicesInfo.forEach(function(a){var b=d("WAJids").extractDeviceId(a.jid);a=d("WAIdentityUtils").removeKeyTypeIfNeeded(a.identity);(!c.has(b)||!e.has(a.toString()))&&(f.add(b),g.add(a.buffer))});return{seq:b.sequence,signingDevice:d("WAIdentityUtils").removeKeyTypeIfNeeded(b.devices[b.signingDeviceIndex].identity).buffer,unknownDevices:Array.from(g),unknownDeviceIds:Array.from(f)}}function b(a,b,c){var d=new Map();c.forEach(function(a){d.set(a.user,a)});c=d.get(a.user);var e=void 0;c!=null&&(e=n(a,c));var f=[],g=[];b.forEach(function(a){var b=d.get(a.user);if(b!=null){b=n(a,b);b!=null&&f.push(b)}g.push(a.user)});return{senderIdentity:(a=e)!=null?a:void 0,recipientIdentities:f,recipientUserJids:g}}function e(a,b,c){if(a==null){d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.ICDC,key:"missing_icdc_payload"});return{action:"none"}}else if(b==null||a.seq==null||a.signingDevice==null){b==null&&d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.ICDC,key:"error.missing_stored_icdc"});(a.seq==null||a.signingDevice==null)&&d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.ICDC,key:"error.invalid_icdc_payload"});return{action:"error",failureTs:d("WATimeUtils").unixTime(),sync:!0}}var e=a.seq,f=a.signingDevice;if(e===b.sequence){var g=new Set();c.forEach(function(a){return g.add(d("WAIdentityUtils").removeKeyTypeIfNeeded(a).toString())});e=!g.has(new Uint8Array(f).toString());b=a.unknownDevices.some(function(a){return!g.has(new Uint8Array(a).toString())});if(e||b){d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.ICDC,key:"error.unknow_device"});return{action:"error",failureTs:d("WATimeUtils").unixTime(),sync:!0}}}else{d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.ICDC,key:"error.incorrect_seq"});return{action:"error",failureTs:d("WATimeUtils").unixTime(),sync:!0}}return{action:"none"}}function f(a){a=d("decodeProtobuf").decodeProtobuf(d("WAArmadilloICDC.pb").SignedICDCIdentityListSpec,a);var b=a.signature;a=d("decodeProtobuf").decodeProtobuf(d("WAArmadilloICDC.pb").ICDCIdentityListSpec,a.details);return{signature:b,details:a}}function o(a){return a.map(function(a){return d("WASignalKeys").serializeIdentity(new Uint8Array(d("WABase64").decodeB64UrlSafe(a)))})}function p(a,b,e,f,g){var j=d("WAIdentityUtils").removeKeyTypeIfNeeded(a.publicKey);e=e.map(function(a){return d("WAIdentityUtils").removeKeyTypeIfNeeded(a)});var k=e.findIndex(function(a){return d("WACryptoUtils").uint8ArraysEqual(a,j)});if(k===-1){d("WALogger").ERROR(i(),f,g);throw c("WAErr")("signingDeviceIndex not found")}f=b==null?1:b+1;g=d("WATimeUtils").unixTime();g<0&&d("WALogger").ERROR(h(),Date.now(),d("WATimeUtils").getClockSkew());b={seq:f,timestamp:g,devices:e,signingDeviceIndex:k};f=d("encodeProtobuf").encodeProtobuf(d("WAArmadilloICDC.pb").ICDCIdentityListSpec,b).readBuffer();g=q(a,d("WABinary").Binary.build(f).readByteArray());e={details:f,signature:g};k=d("encodeProtobuf").encodeProtobuf(d("WAArmadilloICDC.pb").SignedICDCIdentityListSpec,e).readBuffer();return{icdcInfo:b,encodedSignedICDC:k}}function q(a,b){var c=d("WASignalOther").makeBytes(64);d("WACryptoDependencies").getCrypto().getRandomValues(c);var e=new Uint8Array(64);d("WACryptoEd25519").hashSha512(e,b,b.length);e=d("WASignalSignatures").makeSignature(a,b,c);return d("WABinary").Binary.build(e).readBuffer()}var r=4*d("WATimeUtils").HOUR_SECONDS;function s(a){return a==null?!0:!d("WATimeUtils").happenedWithin(a,r)}g.validateAndPrepareICDCFromNotification=a;g.isICDCIndexInvalid=m;g.computeICDCParticipantDevices=b;g.validateICDCInfo=e;g.decodeICDCInfo=f;g.base64DeviceIdentitiesToSerializedPubKeys=o;g.computeICDCInfoForUpload=p;g.isLastSyncTsExpired=s}),98);
__d("MAWDeviceRegistrationWorker",["IGDWebUtils","MAWClearSignalAndTempStores","MAWCryptoAuthTokenWrapper","MAWCurrentUser","MAWDbMetaTxns","MAWDeviceRegistrationActions","MAWDeviceRegistrationSessionUtil","MAWDeviceRegistrationTypes","MAWDeviceRegistrationUtilWorker","MAWIndexedDb","MAWJids","MAWLoggerUtils","MAWODSProxy","MAWQplProxy","MAWTransactionMode","MessengerWebInitData","WAICDCUtils","WAIdentityUtils","WAOdsEnums","WAPreRegistrationCrypto","WASignalKeys","WATagsLogger","WATimeUtils","asyncToGeneratorRuntime","cr:2025","gkx","promiseDone","qpl"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Skipping device registration"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Crypto Auth Token was null or incomplete"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Cannot process ICDC payload during registration: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Beginning device registration"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Device registration failure - ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);m=function(){return a};return a}var n=typeof window!=="undefined"?window:self,o=d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.DeviceRegistration]),p=!1,q,r=function(){return d("IGDWebUtils").isInstagramWebSupportedApp(Number(d("MAWCurrentUser").getAppID()))};function s(a){var b;b=(b=n.location.origin)!=null?b:"unknown";p||(q=d("MAWQplProxy").startQplUserFlow(c("qpl")._(25302457,"311"),{bool:{identityCompareResult:a.identityCompareResult,isDeviceRegistrationDomainUniquenessEnabled:c("gkx")("6393")},"int":{registrationVersion:a.registrationVersion},string:{hostname:b}}),p=!0)}function t(){if(p){var a;(a=q)==null?void 0:a.endFail("failure_during_device_registration");q=null}}function a(){if(p){var a;(a=q)==null?void 0:a.endSuccess();q=null}}function u(a){var b;(b=q)==null?void 0:b.addPoint("wa_registration_response",{string:{registrationType:a}})}function v(a){return{message:a,registrationState:d("MAWDeviceRegistrationTypes").RegistrationStatesEnum.failed}}var w=function(a){return d("MAWIndexedDb").makeSignalTransactor({meta:d("MAWTransactionMode").READWRITE,signedPrekey:d("MAWTransactionMode").READWRITE},"inMetaStoreAndSignedPreKey",function(b){return function(c){return a(b,c)}})},x=function(a){return d("MAWIndexedDb").makeSignalTransactor({meta:d("MAWTransactionMode").READWRITE},"saveDeviceId",function(b){return function(c){return a(b,c)}})};function y(a){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){o.LOG(k());var b=(yield d("MAWDeviceRegistrationUtilWorker").createNewRegistrationMeta());yield w(d("MAWDeviceRegistrationActions").saveUnsentRegistrationMeta)(b);var e=d("MAWCurrentUser").getID(),f=b.deviceUUID,g=d("WAPreRegistrationCrypto").serializeRegistrationData(b.signalRegInfo),h=null,i=!1;i=(i=i?1019394685547802:d("MAWCurrentUser").getAppID())==null?void 0:i.toString();if(i==null)return v("appId is null, cannot register to WhatsApp");if(e==="0")return v(d("MAWDeviceRegistrationTypes").DEVICE_REGISTER_ERROR_ZERO_AS_USER_ID);var l=null,m=null;try{var n=(yield d("MAWDeviceRegistrationUtilWorker").fetchICDC(e,a.encrypted_serialized_cat,i,f)),p=[].concat(d("WAICDCUtils").base64DeviceIdentitiesToSerializedPubKeys(n.device_identities));if(n.curr_identity_idx!=null){var q=n.curr_identity_idx;p[q]=d("WASignalKeys").serializeIdentity(g.identityPubKey)}else p.push(d("WASignalKeys").serializeIdentity(g.identityPubKey));l=d("WAICDCUtils").computeICDCInfoForUpload(b.signalRegInfo.identityKeyPair,n.icdc_seq,p,"registration","registration");m=(yield d("WAIdentityUtils").computeIdentitiesHash(p))}catch(a){o.ERROR(j(),a)}q=!1;try{b=(yield d("MAWDeviceRegistrationUtilWorker").register(e,a.encrypted_serialized_cat,i,f,g.regId,g.identityPubKeyType,g.identityPubKey,g.signedPreKey,l&&m?{ihash:m,seq:l.icdcInfo.seq,signedICDCIdentityList:l.encodedSignedICDC,ts:l.icdcInfo.timestamp}:null));n=b==null?void 0:b.type;n!=null&&d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.REGISTRATION_TYPE,key:n});h=b==null?void 0:b.deviceId;q=(p=b==null?void 0:b.icdcSuccess)!=null?p:!1;u(b==null?void 0:b.type)}catch(a){return v(a)}if(h==null)return v(d("MAWDeviceRegistrationTypes").NULL_RESPONSE_FROM_SERVER);a=d("MAWJids").toUserJid(e);if(!r()){i=c("MessengerWebInitData").sessionId;i!=null&&c("promiseDone")(d("MAWDeviceRegistrationSessionUtil").linkDeviceToTheSession(f,i))}if(l!=null&&q){g=l.icdcInfo;m=function(a){return d("MAWIndexedDb").makeSignalTransactor({contacts:d("MAWTransactionMode").READWRITE},"saveICDC",function(b){return function(c,d){return a(b,c,d)}})};yield m(d("MAWDeviceRegistrationActions").saveICDC)(a,{devices:g.devices,dirty:!0,sequence:g.seq,signingDeviceIndex:g.signingDeviceIndex,timestamp:g.timestamp})}yield x(d("MAWDeviceRegistrationActions").saveDeviceId)(h);return{message:d("MAWDeviceRegistrationTypes").DEVICE_SUCCESSFULLY_REGISTERED,registrationState:d("MAWDeviceRegistrationTypes").RegistrationStatesEnum.finished}});return z.apply(this,arguments)}var A=function(a){return d("MAWIndexedDb").makeSignalTransactor({identity:d("MAWTransactionMode").READONLY,meta:d("MAWTransactionMode").READONLY,signedPrekey:d("MAWTransactionMode").READONLY},"checkExistingRegistration",function(b){return function(){return a(b)}})()};function e(a){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=d("MAWCryptoAuthTokenWrapper").getCryptoAuthToken();if(e==null||e.encrypted_serialized_cat===""){o.WARN(i());return v(d("MAWDeviceRegistrationTypes").DEVICE_REGISTER_ERROR_EMPTY_CAT_TOKEN)}if(!d("WATimeUtils").isInFuture(d("WATimeUtils").castToUnixTime(e.expiration_time_in_seconds)))return v(d("MAWDeviceRegistrationTypes").DEVICE_REGISTER_ERROR_EXPIRED_CAT_TOKEN);var f=b("cr:2025")?yield b("cr:2025").getRegistrationMetaRestore():yield A(d("MAWDeviceRegistrationActions").getRegistrationMetaDexie);a!=null&&d("MAWQplProxy").sendQplPointThroughBridge(a,"device_registration_check",{annotations:{bool:{identityCompareResult:f==null?void 0:f.identityCompareResult,isDeviceRegistrationDomainUniquenessEnabled:c("gkx")("6393")},"int":{registrationVersion:f==null?void 0:f.registrationVersion}}});a=(f==null?void 0:f.identityCompareResult)===!1;if(f==null||f.deviceId==null||a){try{yield d("MAWClearSignalAndTempStores").clearSignalAndTempStores(),yield d("MAWDbMetaTxns").saveCAT(e)}catch(a){return v(a)}s({identityCompareResult:f==null?void 0:f.identityCompareResult,registrationVersion:f==null?void 0:f.registrationVersion});return y(e)}else{yield d("MAWDbMetaTxns").saveCAT(e);a=c("MessengerWebInitData").sessionId;e=f.lastSessionDeviceWasLinkedTo==null||f.lastSessionDeviceWasLinkedTo!==a;a!=null&&!(f.deviceUUID===a||f.deviceUUID.startsWith(a+"-"))&&e&&!r()&&c("promiseDone")(d("MAWDeviceRegistrationSessionUtil").linkDeviceToTheSession(f.deviceUUID,a))}o.LOG(h());return{message:d("MAWDeviceRegistrationTypes").DEVICE_ALREADY_REGISTERED,registrationState:d("MAWDeviceRegistrationTypes").RegistrationStatesEnum.finished}});return B.apply(this,arguments)}function f(a){d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.DEVICE_REGISTRATION,key:"fail"});d("MAWCurrentUser").isEmployee()||d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.DEVICE_REGISTRATION_NON_EMPLOYEE,key:"fail"});o.ERROR(m(),d("MAWDeviceRegistrationTypes").FAILED_REGISTRATION_RETRIES);for(a of a)o.ERROR(l(),a);t()}g.endRegistrationTimerSuccess=a;g.handleRegistrationError=v;g.setupDeviceRegistration=e;g.logDeviceRegistrationRetryFailure=f}),98);
__d("WAPromiseBackoffs",["Promise","WAErr"],(function(a,b,c,d,e,f,g){var h;function a(a,b){if(a===0)return 0;var c=o(b.algo);for(var d=1;d<a;d++)c();return j(b,c())}function i(a){var b=a.relativeDelay,c=b===void 0?!1:b,d=null,e=o(a.algo);return function(){var b=d;if(b==null){d=c?Date.now():0;return 0}var f=j(a,e());if(c){var g=Date.now();b=g-b;b>0&&(f=Math.max(0,f-b));d=g}return f}}function d(a){var c=i(a);return function(a){return new(h||(h=b("Promise")))(function(b){var d=c();d>0?setTimeout(b,d,a):b(a)})}}function j(a,b){var c=a.max,d=a.min;a=a.jitter;a=a===void 0?.1:a;b=b;c!=null&&b>c&&(b=c);d!=null&&b<d&&(b=d);a!==0&&(b=Math.ceil(b*(1+a*Math.random())));return b}function k(a){var b=a.second-a.first,c=a.first-b;return function(){var a=b+c;c=b;b=a;return a}}function l(a){var b=a.base,c=b===void 0?2:b,d=a.first;return function(){var a=d;d*=c;return a}}function m(a){var b=a.delay;return function(){return b}}function n(a){var b=a.toMs;a=a.backoff;var c=o(a);return function(){return b(c())}}function o(a){switch(a.type){case"fibonacci":return k(a);case"exponential":return l(a);case"constant":return m(a);case"adjust":return n(a);default:a;throw c("WAErr")("makeTimeFunc unrecognized backoff "+a.type)}}g.getDelay=a;g.createTimer=i;g.createPromiseTimer=d}),98);
__d("WAPromiseRetryLoop",["Promise","WAErr","WALogger","WAPromiseBackoffs","WAPromiseDelays","WAResolvable"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop: retrying "," in ","ms"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop: resetting ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop was called several times. You may have race conditions"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop: starting ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop: resetting ",""]);m=function(){return a};return a}a=function(){function a(a){var b=this;this.$2=new(d("WAResolvable").Resolvable)();this.$3=null;this.$4=null;this.$5=0;this.endWithValue=function(a){b.$5++,b.$2.resolve(a)};this.$1=a}var e=a.prototype;e.resetTimeoutAfter=function(a){this.$4=Date.now()+a};e.cancelReset=function(){this.$4=null};e.reset=function(){if(this.$2.resolveWasCalled())return;d("WALogger").LOG(m(),this.$1.name);this.$5++;this.$6()};e.start=function(){if(this.$2.resolveWasCalled())return;d("WALogger").LOG(l(),this.$1.name);this.$5!==0&&d("WALogger").ERROR(k());this.$5++;this.$6()};e.$6=function(){var a=this,c=this.$1,e=this.$5,f=d("WAPromiseBackoffs").createTimer(this.$1.timer);f();var g=function b(){if(a.$2.resolveWasCalled())return;if(e!==a.$5)return;var g=Date.now();a.$3=c.code(a.endWithValue).then(function(){if(a.$2.resolveWasCalled())return;var e=c.resetDelay;(e!==void 0&&Date.now()>=g+e||a.$4!=null&&a.$4<=Date.now())&&(d("WALogger").LOG(j(),c.name),f=d("WAPromiseBackoffs").createTimer(a.$1.timer));a.$4=null;e=f();d("WALogger").LOG(i(),c.name,e);return d("WAPromiseDelays").delayMs(e).then(b)});return a.$3};this.$3=(h||(h=b("Promise"))).resolve().then(g)};e.promise=function(){var a=this;if(this.$2.resolveWasCalled())return this.$2.promise;return!this.$3?(h||(h=b("Promise"))).reject(c("WAErr")("PromiseRetryLoop "+this.$1.name+" had promise() called before start()")):(h||(h=b("Promise"))).race([this.$2.promise,this.$3.then(function(){return a.$2.promise})])};return a}();g.PromiseRetryLoop=a}),98);
__d("WARetryUtils",[],(function(a,b,c,d,e,f){a={algo:{type:"adjust",backoff:{type:"fibonacci",first:1,second:1},toMs:function(a){return 1e3*(a+9)}},max:62e4};f.FIBONACCI_BACKOFF=a}),66);
__d("MAWDeviceRegistrationInitWorker",["MAWCurrentUser","MAWDeviceRegistrationTypes","MAWDeviceRegistrationWorker","MAWLoggerUtils","MAWODSProxy","MAWQplProxy","WALogger","WAOdsEnums","WAPromiseRetryLoop","WARetryUtils","WATagsLogger","asyncToGeneratorRuntime","qpl"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Registration finished, ending device registration promise retry loop"]);i=function(){return a};return a}function a(){var a=1,e=new Set(),f=new(d("WAPromiseRetryLoop").PromiseRetryLoop)({code:function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){if(a===d("MAWDeviceRegistrationTypes").MAX_DEVICE_REGISTRATION_RETRIES){d("MAWDeviceRegistrationWorker").logDeviceRegistrationRetryFailure(e);var f=d("MAWDeviceRegistrationWorker").handleRegistrationError(d("MAWDeviceRegistrationTypes").FAILED_REGISTRATION_RETRIES);b(f);return}try{f=a===1?c("qpl")._(25310776,"6155"):null;f=(yield d("MAWDeviceRegistrationWorker").setupDeviceRegistration(f));f.registrationState===d("MAWDeviceRegistrationTypes").RegistrationStatesEnum.finished&&(f.message===d("MAWDeviceRegistrationTypes").DEVICE_SUCCESSFULLY_REGISTERED&&(d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.DEVICE_REGISTRATION,key:"success"}),d("MAWCurrentUser").isEmployee()||d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.DEVICE_REGISTRATION_NON_EMPLOYEE,key:"success"}),d("MAWDeviceRegistrationWorker").endRegistrationTimerSuccess()),d("WALogger").LOG(i()),b(f));e.add(f.message)}catch(a){b="Uncaught device registration error - "+a;d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.DeviceRegistration]).WARN(h(),b);e.add(""+b)}a++});function g(a){return f.apply(this,arguments)}return g}(),name:"deviceRegistration",timer:d("WARetryUtils").FIBONACCI_BACKOFF});d("MAWQplProxy").sendQplPointThroughBridge(c("qpl")._(25310776,"6155"),"device_registration_start");f.start();return f.promise()}g.initDeviceRegistration=a}),98);
__d("MAWWriteOutgoingMsgApi",["MAWAckLevel","MAWAuthor","MAWDbContactsTxns","MAWDbMsg","MAWDbMsgTxns","MAWDbRavenActionTxns","MAWDexieTable","MAWEBSwitch","MAWEBUploadTrackingUtils","MAWIndexedDb","MAWLoadReplyMediaTxns","MAWMsgReceiptPreparationTxns","MAWMsgType","MAWTransactionMode","MAWVault","MAWWriteMsgTxns","WAArmadilloXMA.pb","WAAssertUnreachable","WAJids","WAStanzaUtils","WATimeUtils","err"],(function(a,b,c,d,e,f,g){"use strict";b=d("MAWIndexedDb").makeMsgrAndSignalTransactor({chunk:(a=d("MAWTransactionMode")).READONLY,contacts:a.READWRITE,groupInfo:a.READONLY,identity:a.READONLY,media:a.READONLY,messages:a.READWRITE,participants:a.READONLY,receipts:a.READWRITE,threads:a.READWRITE,unrenderedMessages:a.READWRITE,xma:a.READONLY},"writeOutgoingMsg",function(a){return function(b,e,f,g,k){g.content!=null&&(g.content=d("MAWVault").vault(g.content));return d("MAWDexieTable").dexieAll([a.threads.get({jid:e}),a.messages.where("externalId").equals(b).toArray(),h(a,g.quote,e),d("MAWDbRavenActionTxns").maybeGetRavenMsgQueryByProtocolMsgId(a,g.ravenProtocolMsgId,k)]).then(function(e){var h=e[0],m=e[1],n=e[2];e=e[3];if(h==null)return{type:"missing_thread"};m=m.find(function(a){return a.thread===h.chatId&&a.author===d("WAJids").AUTHOR_ME});if(m!=null)return m.ack>=d("MAWAckLevel").ACK.sent?{msgId:m.msgId,protocolMsgId:{author:d("WAJids").AUTHOR_ME,chat:h.jid,externalId:m.externalId},type:"already_sent"}:{msgId:m.msgId,protocolMsgId:{author:d("WAJids").AUTHOR_ME,chat:h.jid,externalId:m.externalId},type:"not_sent"};else{if(!d("MAWDbMsg").isUnrenderedMsgType(k)){m={ack:d("MAWAckLevel").ACK.clock,altIndex:void 0,author:d("WAJids").AUTHOR_ME,ephemeralSetting:g.ephemeralSetting,externalId:b,isForwarded:g.isForwarded,specialTextSize:g.specialTextSize,thread:h.chatId,threadJid:h.jid,ts:f};var o=i(k,m,g,n),p=g.isFirstMsg,q=g.openMessageOtid,r=g.openMessageParticipantCount,s=g.optimisticMsg,t=g.participantCount;m=d("MAWLoadReplyMediaTxns").getReplyMediaForMsgQuote(a,o).then(function(b){return d("MAWWriteMsgTxns").writeMsg(a,o,h,{isCurrentDeviceSendingMsg:!0,isFirstMsg:p,isOutgoing:!0,openMessageOtid:q,openMessageParticipantCount:r,optimisticMsg:s,participantCount:t,quotedReplyAttachmentMeta:b})})}else{n={ack:d("MAWAckLevel").ACK.clock,author:d("WAJids").AUTHOR_ME,externalId:b,thread:h.chatId,threadJid:h.jid,ts:f};n=j(k,n,g,e==null?void 0:e.externalId);m=d("MAWWriteMsgTxns").writeUnrenderedMsg(a,n,h)}return m.then(function(e){if(d("MAWMsgType").isEBSupportedMsgType(e.type)&&e.serverTs!=null&&!(e.ephemeralSetting!=null&&e.ephemeralSetting.ephemeralExpirationInSec>0)&&c("MAWEBSwitch").isEnabled()){var g=d("MAWEBUploadTrackingUtils").genInstanceKey(e.externalId);g!=null&&d("MAWEBUploadTrackingUtils").startUploadTracking(e.externalId,e.type,"send",g)}return d("MAWDexieTable").dexieAll([d("MAWMsgReceiptPreparationTxns").prepareReceiptForMsg(a,e.msgId,h.jid),l(a,k,h.jid,f)]).then(function(){return{msgId:e.msgId,protocolMsgId:{author:d("WAJids").AUTHOR_ME,chat:h.jid,externalId:b},type:"not_sent"}})})}})}});function h(a,b,c){return b==null?d("MAWDexieTable").dexieResolve(null):d("MAWDbMsgTxns").maybeGetMsgByProtocolMsgId(a,b).then(function(b){return b==null?null:a.threads.get(b.thread).then(function(a){var e=b?k(b):null;b.messageExpirationTs!=null&&b.messageExpirationTs<d("WATimeUtils").unixTime()&&e!=null&&(e=babelHelpers["extends"]({},e,{mediaId:void 0,msgContent:void 0,type:d("MAWMsgType").MSG_TYPE.EXPIRED_EPHEMERAL,xmaMessageType:void 0}));if(a==null||a.jid===c)return{content:e,remoteJid:null};a=d("WAJids").interpretAndValidateJid(a.jid);a=a.jidType==="group"?a.groupJid:null;return{content:e,remoteJid:a}})})}function i(a,b,e,f){if(d("MAWDbMsg").isUnrenderedMsgType(a))throw c("err")("getNewMsg called for wrong message type "+a);var g,h;if(e.quote!=null&&(f==null?void 0:f.content)!=null){var i;h=f==null?void 0:(i=f.content)==null?void 0:i.externalId;g={content:f==null?void 0:f.content,remoteJid:(i=f==null?void 0:f.remoteJid)!=null?i:void 0}}f=babelHelpers["extends"]({},b,{quote:g,quoteExternalId:h});switch(a){case"Text":return babelHelpers["extends"]({},f,{msgContent:{content:e.content!=null?e.content:"",mentionedJids:e.mentionedJids},type:d("MAWMsgType").MSG_TYPE.TEXT});case"Image":return babelHelpers["extends"]({},f,{type:d("MAWMsgType").MSG_TYPE.IMAGE});case"Video":return babelHelpers["extends"]({},f,{type:d("MAWMsgType").MSG_TYPE.VIDEO});case"Ptt":return babelHelpers["extends"]({},f,{type:d("MAWMsgType").MSG_TYPE.PTT});case"Gif":return babelHelpers["extends"]({},f,{type:d("MAWMsgType").MSG_TYPE.GIF});case"Sticker":return babelHelpers["extends"]({},f,{type:d("MAWMsgType").MSG_TYPE.STICKER});case"DocumentFile":return babelHelpers["extends"]({},f,{type:d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE});case"XMA":if(e.xmaMessageType==null)throw c("err")("XMA Message Missing xmaMessageType");i=e.content!=null&&e.xmaMessageType===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_EXTERNAL_LINK_SHARE?e.content:"";return babelHelpers["extends"]({},f,{msgContent:{content:i},type:d("MAWMsgType").MSG_TYPE.XMA,xmaMessageType:e.xmaMessageType});case"EditAction":throw c("err")("EditAction is not supported yet");case"Revoked":case"DeleteForMe":case"Ciphertext":case"Futureproof":case"Unavailable":case"Admin":case"ExpiredEphemeral":case"EphemeralSettingAdmin":case"EphemeralScreenshotAction":case"AlertICDC":case"GroupInvite":case"Reaction":case"Raven":case"RavenAction":throw c("err")("Should not be writing ciphertext, futureproof, unsent, admin,\n        ephemeral setting messages, ephemeral screenshot action, group invite messages");default:throw c("WAAssertUnreachable")(a)}}function j(a,b,e,f){if(!d("MAWDbMsg").isUnrenderedMsgType(a))throw c("err")("getNewUnrenderedMsg called for wrong message type "+a);switch(a){case"EphemeralSyncResponse":if(e.ephemeralSetting==null)throw c("err")("Ephemeral Sync Response without ephemeral settings");return babelHelpers["extends"]({},b,{ephemeralSetting:e.ephemeralSetting,type:d("MAWMsgType").MSG_TYPE.EPHEMERAL_SYNC_RESPONSE});case"EphemeralSettingChangeFromCurrentDevice":var g;if(e.ephemeralSetting==null)throw c("err")("Ephemeral Setting Change without ephemeral settings");return babelHelpers["extends"]({},b,{ephemeralSetting:e.ephemeralSetting,isEphemeralSettingReset:(g=e.isEphemeralSettingReset)!=null?g:!1,type:d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE});case"GroupInvite":g=d("WAJids").interpretAsGroupJid(b.threadJid);if(g==null)throw c("err")("Group Invite without valid group jid");if(e.invitedParticipantUserJid==null)throw c("err")("Group Invite without invited user jid");return babelHelpers["extends"]({},b,{groupName:e.groupName==null?void 0:e.groupName,invitedParticipantUserJid:e.invitedParticipantUserJid,type:d("MAWMsgType").MSG_TYPE.GROUP_INVITE});case"SenderKeyDistribution":return babelHelpers["extends"]({},b,{type:d("MAWMsgType").MSG_TYPE.SK_DISTRIBUTION});case"RavenAction":if(f==null)throw c("err")("Raven Action without Raven Message External Id");if(e.actionType==null)throw c("err")("Raven Action without Action Type");return babelHelpers["extends"]({},b,{actionType:e.actionType,ravenActionToMsgExternalId:d("WAStanzaUtils").toStanzaId(f),type:d("MAWMsgType").MSG_TYPE.RAVEN_ACTION});case"EditAction":throw c("err")("Edit action not implemented yet");default:throw c("WAAssertUnreachable")(a)}}function k(a){var b={author:d("MAWAuthor").getAuthorUserJid(a.author)||d("WAJids").AUTHOR_ME,externalId:a.externalId,mediaId:a.mediaId,msgId:a.msgId,specialTextSize:a.specialTextSize,ts:a.ts,xmaMessageType:a.xmaMessageType};switch(a.type){case d("MAWMsgType").MSG_TYPE.IMAGE:return babelHelpers["extends"]({},b,{msgContent:a.msgContent,type:d("MAWMsgType").MSG_TYPE.IMAGE});case d("MAWMsgType").MSG_TYPE.VIDEO:return babelHelpers["extends"]({},b,{msgContent:a.msgContent,type:d("MAWMsgType").MSG_TYPE.VIDEO});case d("MAWMsgType").MSG_TYPE.PTT:return babelHelpers["extends"]({},b,{msgContent:a.msgContent,type:d("MAWMsgType").MSG_TYPE.PTT});case d("MAWMsgType").MSG_TYPE.TEXT:return babelHelpers["extends"]({},b,{msgContent:a.msgContent,type:d("MAWMsgType").MSG_TYPE.TEXT});case d("MAWMsgType").MSG_TYPE.STICKER:return babelHelpers["extends"]({},b,{msgContent:a.msgContent,type:d("MAWMsgType").MSG_TYPE.STICKER});case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:return babelHelpers["extends"]({},b,{msgContent:a.msgContent,type:d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE});case d("MAWMsgType").MSG_TYPE.GIF:return babelHelpers["extends"]({},b,{msgContent:a.msgContent,type:d("MAWMsgType").MSG_TYPE.GIF});case d("MAWMsgType").MSG_TYPE.XMA:return babelHelpers["extends"]({},b,{msgContent:a.msgContent,type:d("MAWMsgType").MSG_TYPE.XMA,xmaMessageType:a.xmaMessageType});case d("MAWMsgType").MSG_TYPE.REVOKED:return babelHelpers["extends"]({},b,{msgContent:a.msgContent,type:d("MAWMsgType").MSG_TYPE.UNAVAILABLE});default:throw c("err")("Trying to reply to a message type that does not support replies")}}function l(a,b,c,e){if(b===d("MAWMsgType").MSG_TYPE.EPHEMERAL_SYNC_RESPONSE)return d("WAJids").switchOnMsgrChatJidType(c,{group:function(){return d("MAWDexieTable").dexieResolve()},user:function(b){return d("MAWDbContactsTxns").getContact(a,b).then(function(b){var c;if(b==null)return d("MAWDexieTable").dexieResolve();b.ephemeralSyncResponseBackoffInfo={syncResponseRetries:((c=(c=b.ephemeralSyncResponseBackoffInfo)==null?void 0:c.syncResponseRetries)!=null?c:0)+1,syncResponseSentTs:e};return a.contacts.put(b)}).then(function(){})}});return b===d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE?d("WAJids").switchOnMsgrChatJidType(c,{group:function(){return d("MAWDexieTable").dexieResolve()},user:function(b){return d("MAWDbContactsTxns").getContact(a,b).then(function(b){if(b==null||b.ephemeralSyncResponseBackoffInfo==null)return d("MAWDexieTable").dexieResolve();b.ephemeralSyncResponseBackoffInfo=void 0;return a.contacts.put(b).then(function(){})})}}):d("MAWDexieTable").dexieResolve()}g.writeOutgoingMsg=b}),98);
__d("WAStateMachines",["WAErr"],(function(a,b,c,d,e,f,g){"use strict";var h=null;function a(a){h=a}function b(a){if(h==null)throw c("WAErr")("GlobalStateMachines api called before set");return h[a]}g.setStateMachines=a;g.getStateMachine=b}),98);
__d("MAWSendMsg",["MAWGlobals","MAWJobDefinitions","MAWMsgType","MAWODSProxy","MAWQplProxy","MAWWriteOutgoingMsgApi","Promise","WAGlobals","WAJids","WAJobOrchestratorTypes","WALogger","WAOdsEnums","WAStateMachines","asyncToGeneratorRuntime","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendMsg cannot send to a non-existent thread"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendMsg already sent message"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendMsg: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error during get devices before sending: ",""]);l=function(){return a};return a}function m(a){return(h||(h=b("Promise"))).resolve()}function n(a){return d("WAStateMachines").getStateMachine("devicesStateMachine").waitForUserDevices(Array.from(new Set([a,d("WAGlobals").getMyUserJid()])))}function o(a){return d("WAJids").switchOnChatJidType(a,{group:function(a){return m(a)},interopUser:function(a){return n(a)},lidUser:function(a){return n(a)},msgrUser:function(a){return n(a)},phoneUser:function(a){return n(a)}})["catch"](function(a){d("WALogger").ERROR(l(),a);return(h||(h=b("Promise"))).resolve()})}function p(a){if(d("WAGlobals").getConfig().getDevicesBeforeSend())return o(a);else return(h||(h=b("Promise"))).resolve()}a=d("MAWGlobals").getPersistedJobsApi().definePersistedJob().finalStep("writeToDb",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){e=a.args;var g=a.chatJid;a=a.externalId;d("MAWQplProxy").sendQplPointThroughBridge(c("qpl")._(25313175,"1551"),"received_message_in_wajob",{instanceKey:e.s2sInstanceKey});d("WAGlobals").getConfig().offlineProcessingState()!=="idle"&&d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.MSG_SEND,key:"offline"});yield p(g);a=(yield d("MAWWriteOutgoingMsgApi").writeOutgoingMsg(a,g,f.jobStartTime,e,d("MAWMsgType").MSG_TYPE.TEXT));d("WALogger").DEV(k(),g);if(a.type==="already_sent")d("WALogger").LOG(j()),d("MAWQplProxy").sendQplPointThroughBridge(c("qpl")._(25313175,"1551"),"message_already_sent_to_backend",{instanceKey:e.s2sInstanceKey});else if(a.type==="missing_thread"){d("WALogger").LOG(i());d("MAWQplProxy").sendQplPointThroughBridge(c("qpl")._(25313175,"1551"),"failed_message_missing_thread",{instanceKey:e.s2sInstanceKey});return(h||(h=b("Promise"))).reject("sendMsg sends a message to a non-existent thread")}else yield d("MAWGlobals").getJobManager().waitUntilPersisted(d("MAWJobDefinitions").createStartJobInfo("sendWrittenMsg",{gotDevicesBeforeSending:d("WAGlobals").getConfig().getDevicesBeforeSend(),protocolMsgId:a.protocolMsgId,s2sInstanceKey:e.s2sInstanceKey,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},type:"message"})),d("MAWQplProxy").sendQplPointThroughBridge(c("qpl")._(25313175,"1551"),"successful_message_sent_to_backend",{instanceKey:e.s2sInstanceKey})});return function(b,c,d){return a.apply(this,arguments)}}()).end();g.getDevicesBeforeSend=o;g.maybeGetDevicesBeforeSend=p;g.sendMsg=a}),98);
__d("MAWGetContactApi",["MAWDbContact","MAWDbContactsTxns","MAWIndexedDb","MAWJids","MAWTransactionMode"],(function(a,b,c,d,e,f,g){"use strict";a=d("MAWIndexedDb").makeSignalTransactor({contacts:d("MAWTransactionMode").READONLY},"getContact",function(a){return function(b){b=b.fbid;b=d("MAWJids").toUserJid(b);return d("MAWDbContactsTxns").getContact(a,b).then(function(a){var b;return{isBlocked:(b=a==null?void 0:a.isBlocked)!=null?b:!1,isRestricted:(b=a==null?void 0:a.isRestricted)!=null?b:!1,relationship:(b=a==null?void 0:a.relationship)!=null?b:d("MAWDbContact").NON_CONTACT}})}});g.getContact=a}),98);
__d("MAWOptimisticUploadManager",[],(function(a,b,c,d,e,f){"use strict";var g=new Map();function a(){return g}function b(){g.clear()}f.getOptimisticUploadManager=a;f.clearOptimisticUploadManager=b}),66);
__d("MAWGetMediaPlaintextApi",["MAWIndexedDb","MAWMediaUtils","MAWOptimisticUploadManager","MAWTransactionMode","Promise","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Media blob does not exist for the given hashedPlaintextHash"]);i=function(){return a};return a}a=function(a){var c=d("MAWOptimisticUploadManager").getOptimisticUploadManager();c=c.get(a);if(c==null)return j(a);else return(h||(h=b("Promise"))).resolve(c.file)};function j(a){return d("MAWIndexedDb").makeMsgrTransactor({chunk:d("MAWTransactionMode").READONLY},"getMediaPlaintextFromDb",function(a){return function(b){b=d("MAWMediaUtils").genHMACPlaintextHash(b);return a.chunk.where("hashedPlaintextHash").equals(b).first().then(function(a){if(!a){d("WALogger").WARN(i());return null}return new Blob([a.blobData],{type:a.mimetype})})}})(a)}g.getMediaPlaintext=a}),98);
__d("MAWMediaPreviewDownloadManager",["WAResolvable"],(function(a,b,c,d,e,f,g){"use strict";var h=1e4,i=[],j=new Map();function a(a){if(j.has(a))return;k();var b=new(d("WAResolvable").Resolvable)();j.set(a,b);i.push(a)}function b(a){return j.get(a)}function c(a){j["delete"](a)}function k(){if(i.length>=h){var a=i.shift();j["delete"](a)}}function e(){i=[],j.clear()}g.markMediaPreviewAsDownloading=a;g.getMediaPreviewDownloadingResolvable=b;g.removeMediaPreviewDownloadingResolvable=c;g.clear=e}),98);
__d("MAWHandleMediaPreviewBeforeDownloadApi",["MAWMediaPreviewDownloadManager","MAWMediaUtils","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(a){a=d("MAWMediaUtils").genHMACPlaintextHash(a);d("MAWMediaPreviewDownloadManager").markMediaPreviewAsDownloading(a);return(h||(h=b("Promise"))).resolve()};g.handleMediaPreviewBeforeDownload=a}),98);
__d("MAWCastToMsgrServerMediaType",["MAWDbMedia","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["invalid client mediaType: "," for castClientMediaTypeToServerMediaType method"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["invalid mediaType: "," for castToMsgrServerMediaType method"]);i=function(){return a};return a}function a(a,b){b===void 0&&(b=!1);if(b&&a==="image")return"xma";switch(a){case"image":case"video":case"gif":case"sticker":case"document":return a;case"ptt":return"audio";case"xma-image":return"xma";default:d("WALogger").ERROR(i(),a);return null}}function b(a,b){b===void 0&&(b=!1);if(b&&a===d("MAWDbMedia").MEDIA_TYPE.IMAGE)return"xma";switch(a){case"Image":return"image";case"Video":return"video";case"Gif":return"gif";case"Sticker":return"sticker";case"DocumentFile":return"document";case"Ptt":return"audio";default:d("WALogger").ERROR(h(),a);return null}}g.castToMsgrServerMediaType=a;g.castClientMediaTypeToServerMediaType=b}),98);
__d("MAWCastToServerMediaType",[],(function(a,b,c,d,e,f){"use strict";function a(a){switch(a){case"document":case"image":case"xma-image":case"video":case"ptt":case"gif":case"sticker":return a;default:return null}}f.castToServerMediaType=a}),66);
__d("MAWUpdateMediaEntryForMsgApi",["FBLogger","MAWBridgeUpload","MAWCastToMsgrServerMediaType","MAWCastToServerMediaType","MAWDbMediaTxns","MAWDbMsgTxns","MAWDexieTable","MAWGlobals","MAWIndexedDb","MAWMediaBackupTxns","MAWMediaUtils","MAWOptimisticUploadManager","MAWTransactionMode","WAJids","WALogger","WAMediaUtils","err","isInstamadilloEB"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Missing required arguments for media backup"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Nothing to update if updatedMediaEntry is null"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([""," msgId does not exist within media entries"]);j=function(){return a};return a}var k=d("MAWIndexedDb").makeMsgrTransactor({media:(a=d("MAWTransactionMode")).READWRITE,mediaBackup:a.READWRITE,messages:a.READONLY,threads:a.READONLY},"updateMediaEntryForMsg",function(a){return function(b,e,f,g,k){var l=d("MAWCastToServerMediaType").castToServerMediaType(k);if(!l){c("FBLogger")("labyrinth_web","unsupported_media").mustfix("unsupported media type");throw c("err")("Media type unsupported: "+((l=k)!=null?l:""))}l=d("MAWMediaUtils").genHMACPlaintextHash(b);return d("MAWDexieTable").dexieAll([d("MAWDbMediaTxns").maybeGetMediaFromHash(a,l),d("MAWDbMsgTxns").maybeGetMsgByProtocolMsgId(a,e)]).then(function(b){var l=b[0],m=b[1];if(!m)throw c("err")("Message does not exist for the given protocolMsgId");if(!l)throw c("err")("Media does not exist for the given hashedPlaintextHash");if(!l.msgIds.includes(m.msgId)){d("WALogger").LOG(j(),m.msgId);return}b=l.mediaEntries;var n=b.get(m.msgId);n=f(n);if(n==null){d("WALogger").LOG(i());return}b=babelHelpers["extends"]({},l,{mediaEntries:b.set(m.msgId,n)});g!=null&&(b=babelHelpers["extends"]({},b,{objectId:d("WAMediaUtils").stringToDeliveryObjectId(g)}));var o=d("WAMediaUtils").decodeMediaEntryData(n);return a.media.put(b).then(function(b){return g!=null?d("MAWMediaBackupTxns").linkMediaBackup(a,l.mediaId,m.msgId,d("WAMediaUtils").stringToDeliveryObjectId(g)):d("MAWDexieTable").dexieResolve()}).then(function(){var a=d("MAWCastToMsgrServerMediaType").castToMsgrServerMediaType(k),b=o.mediaKeyTimestamp;g!=null&&a!=null&&b!=null&&a!=="document"&&!c("isInstamadilloEB")()?d("MAWIndexedDb").afterTransaction({tag:"UploadAttachment",value:d("MAWBridgeUpload").createBridgeUploadAttachment(m.thread,g,a,e.externalId,d("MAWGlobals").getConfig().productTypeForEBAttachments,d("WAJids").threadIdForChatJid(e.chat),b)}):d("WALogger").WARN(h())})})}});b=function(a,b,c,d,e){l(a,c);return k(a,b,c,d,e)};function l(a,b){var c=d("MAWOptimisticUploadManager").getOptimisticUploadManager(),e=c.get(a);if(e==null)return;b=b();if(b==null)return;c.set(a,babelHelpers["extends"]({},e,{mediaEntry:b}))}g.updateMediaEntryForMsg=b}),98);
__d("MAWPersistedQueueApi",["MAWDexieTable","MAWTransactionMode","MAWTransactor","WAArrayZip","WATagsLogger","err"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["{"," not indexed in ",""]);h=function(){return a};return a}var i=d("WATagsLogger").TAGS(["MAWWorker"]);function a(){return{ack:o,clear:r,count:j,"delete":q,failAck:p,where:m,write:n}}function j(a,b){return d("MAWTransactor").persistedQueueTransactor(a,d("MAWTransactionMode").READONLY,function(a){return b==null?a.count():a.where(Object.keys(b)).anyOf(Object.values(b)).count()},"count")}function k(a,b){b=b.length===1?b[0]:"["+b.join("+")+"]";var c=a.schema.indexes.map(function(a){a=a.name;return a});if(c.includes(b))return!0;i.WARN(h(),b,a.name);return!1}function l(a,b){if(!k(a,b))throw c("err")(b.join(",")+" is not an index for "+a.name+".")}function m(a,b,c,e){return d("MAWTransactor").persistedQueueTransactor(a,d("MAWTransactionMode").READONLY,function(a){var d;if(b!=null&&Object.keys(b).length>0){var f=Object.keys(b),g=Object.values(b);k(a,f)||(f.reverse(),g.reverse());l(a,f);f.length>1?d=a.where(f).anyOf([g]):d=a.where(f[0]).equals(g[0])}else d=a.toCollection();e==="desc"&&(d=d.desc());c!=null&&(d=d.limit(c));return d.toArray()},"where")}function n(a,b){return d("MAWTransactor").persistedQueueTransactor(a,d("MAWTransactionMode").READWRITE,function(a){return a.bulkAdd(b).then(function(){})},"write")}function o(a,b,c){return d("MAWTransactor").persistedQueueTransactor(a,d("MAWTransactionMode").READWRITE,function(a){if(c==null)return a.bulkDelete(b);else return a.bulkGet(b).then(function(e){e=d("WAArrayZip").zip(b,e).map(function(a){var b=a[0];a=a[1];return{after:c(a),id:b}});var f=e.filter(function(a){return a.after==null}).map(function(a){return a.id});e=e.filter(function(a){return a.after!=null});return d("MAWDexieTable").dexieAll([a.bulkDelete(f),a.bulkUpdate(e.map(function(a){return{changes:a.after,key:a.id}}))]).then(function(){})})},"ack")}function p(a,b,c){return d("MAWTransactor").persistedQueueTransactor(a,d("MAWTransactionMode").READWRITE,function(a){return a.bulkGet(b).then(function(e){e=d("WAArrayZip").zip(b,e).map(function(a){var b=a[0];a=a[1];if(a==null)return;return{after:c(a),id:b}}).filter(Boolean);var f=e.filter(function(a){return a.after==null}).map(function(a){return a.id});e=e.filter(function(a){return a.after!=null});return d("MAWDexieTable").dexieAll([a.bulkDelete(f),a.bulkUpdate(e.map(function(a){return{changes:a.after,key:a.id}}))]).then(function(){})})},"failAck")}function q(a,b){return d("MAWTransactor").persistedQueueTransactor(a,d("MAWTransactionMode").READWRITE,function(a){return d("MAWDexieTable").dexieAll([a.bulkDelete(b)]).then(function(){})},"delete")}function r(a){return d("MAWTransactor").persistedQueueTransactor(a,d("MAWTransactionMode").READWRITE,function(a){return a.clear().then(function(){})},"clear")}g.dexieApiForPersistedQueue=a;g.persistedQueueWhere=m}),98);
__d("MAWMediaQplHelper",[],(function(a,b,c,d,e,f){"use strict";function a(a){if(a==null||a<0||a>100*1024*1024)return"invalid_size";else if(a<=1*1024)return"size lower than 1 KB";else if(a<=100*1024)return"size between 1 KB and 100 KB";else if(a<=1*1024*1024)return"size between 100 KB and 1 MB";else if(a<=10*1024*1024)return"size between 1 and 10 MB";else if(a<=50*1024*1024)return"size between 10 and 50 MB";else return"size above 50 MB"}f.convertIntegerSizeToStringBucket=a}),66);
__d("WATypedArraysConcat",[],(function(a,b,c,d,e,f){function a(a,b,c){c===void 0&&(c=0);c=b.reduce(function(a,b){return a+b.length},c);var d=new a(c),e=0;b.forEach(function(a){d.set(a,e),e+=a.length});return d}f.concatTypedArrays=a}),66);
__d("WACryptoAesCbc",["Promise","WABinary","WACryptoDependencies","WAErr","WATypedArraysCast","WATypedArraysConcat","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=16,j=1024,k=16,l=1024*1024,m=i*l;l=function(){function a(a,b,c,e){this.$4=null;this.$6=!1;this.$1=a;this.$2=b;this.$3=c;var f={name:"AES-CBC",iv:e};this.$5=d("WACryptoDependencies").getCrypto().subtle.importKey("raw",c,"AES-CBC",!1,[b]).then(function(a){return{algo:f,key:a}})}var b=a.prototype;b.append=function(a){var b=this;this.$7("append");var c=this.$4;if(c){c.writeByteArray(a);if(c.size()>j){var e=c.size()%i;e=c.readByteArray(c.size()-e);c.size()||(this.$4=null)}else e=null}else if(a.length>j){c=a.length%i;!c?e=a:(this.$4=new(d("WABinary").Binary)(a),e=this.$4.readByteArray(a.length-c))}else this.$4=new(d("WABinary").Binary)(a),e=null;var f=e;f&&(this.$5=this.$5.then(function(a){var c=a.key;a=a.algo;if(b.$2==="encrypt")return d("WACryptoDependencies").getCrypto().subtle.encrypt(a,c,f).then(function(a){b.$1.writeByteArray(new Uint8Array(a,0,a.byteLength-i));return new Uint8Array(a,a.byteLength-2*i,i)});else{var e=f.slice(-i);return d("WACryptoDependencies").getCrypto().subtle.decrypt(a,c,f).then(function(a){b.$1.writeBuffer(a);return e})}}).then(function(a){var c={name:"AES-CBC",iv:a};return d("WACryptoDependencies").getCrypto().subtle.importKey("raw",b.$3,"AES-CBC",!1,[b.$2]).then(function(a){return{algo:c,key:a}})}));return this.$5.then(function(){})};b.finalize=function(a){var b=this;this.$7("finalize");var c;if(this.$4){var e=this.$4;a&&e.writeByteArray(a);c=e.readByteArray();this.$4=null}else a&&(c=a);if(c){var f=c;return this.$5.then(function(a){var c=a.algo;a=a.key;if(b.$2==="encrypt")return d("WACryptoDependencies").getCrypto().subtle.encrypt(c,a,f);else return d("WACryptoDependencies").getCrypto().subtle.decrypt(c,a,f)}).then(function(a){b.$1.writeBuffer(a)})}else return this.$5.then(function(){})};b.$7=function(a){if(this.$6)throw c("WAErr")("AesCbcStream."+a+" called after finalize")};return a}();function n(a){return{name:"AES-CBC",iv:d("WATypedArraysCast").castTypedArrays(Uint8Array,a)}}function o(a){return d("WACryptoDependencies").getCrypto().subtle.importKey("raw",d("WATypedArraysCast").castTypedArrays(Uint8Array,a),"AES-CBC",!1,["encrypt"])}function p(a){if(a)return d("WATypedArraysCast").castTypedArrays(Uint8Array,a);a=new Uint8Array(k);d("WACryptoDependencies").getCrypto().getRandomValues(a);return a}function q(a){a=a.byteLength;var b=i-a%i;return Number.isNaN(b)?a:a+b}function r(a,c,e){var f=n(c);return(h||(h=b("Promise"))).resolve(d("WACryptoDependencies").getCrypto().subtle.importKey("raw",d("WATypedArraysCast").castTypedArrays(Uint8Array,a),"AES-CBC",!1,["decrypt"])).then(function(a){return d("WACryptoDependencies").getCrypto().subtle.decrypt(f,a,e)})}function a(a,c){return(h||(h=b("Promise"))).resolve().then(function(){var b=c.slice(0,k),d=c.slice(k);return r(a,b,d)})}function e(a,c,e){return(h||(h=b("Promise"))).resolve().then(function(){var f=p(e),g=n(f);return(h||(h=b("Promise"))).resolve(o(a)).then(function(a){return d("WACryptoDependencies").getCrypto().subtle.encrypt(g,a,c)}).then(function(a){return d("WATypedArraysConcat").concatTypedArrays(Uint8Array,[f,new Uint8Array(a)]).buffer})})}function f(a,d,e,f){var g,h,j,k,l,n,r,t,u,v,w,x,y;return b("regeneratorRuntime").async(function(z){while(1)switch(z.prev=z.next){case 0:f===void 0&&(f=m);if(!(f%i!==0)){z.next=3;break}throw c("WAErr")("chunkSize must be a multiple of "+i+", "+f+" received");case 3:z.next=5;return b("regeneratorRuntime").awrap(o(a));case 5:g=z.sent,h=new Uint8Array(d),j=Math.ceil(h.byteLength/f),k=p(e),l=new Uint8Array(q(h)+k.byteLength),l.set(k),(n=0,r=k);case 12:if(!(n<j)){z.next=26;break}u=n===j-1;v=n*f;t=h.subarray(v,v+f);z.next=18;return b("regeneratorRuntime").awrap(s(u,t,r,g));case 18:w=z.sent,x=w.encryptedChunk,y=w.nextIv,l.set(x,k.byteLength+n*f),r=y;case 23:n++;z.next=12;break;case 26:return z.abrupt("return",l.buffer);case 27:case"end":return z.stop()}},null,this)}function s(a,c,e,f){var g,h;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:j.next=2;return b("regeneratorRuntime").awrap(d("WACryptoDependencies").getCrypto().subtle.encrypt(n(e),f,c).then(function(b){return a?new Uint8Array(b):new Uint8Array(b).subarray(0,-i)}));case 2:g=j.sent;h=g.slice(-i);return j.abrupt("return",{encryptedChunk:g,nextIv:h});case 5:case"end":return j.stop()}},null,this)}g.AES_CBC_BLOCK_SIZE=i;g.AesCbcStream=l;g.importRawKey=o;g.getIv=p;g.aesCbcDecrypt=r;g.aesCbcDecryptSplit=a;g.aesCbcEncrypt=e;g.aesCbcEncryptWithChunking=f;g.aesCbcEncryptChunk=s}),98);
__d("WACryptoSha256",["Promise","WABase64","WACryptoDependencies"],(function(a,b,c,d,e,f,g){var h;function i(a){return(h||(h=b("Promise"))).resolve(d("WACryptoDependencies").getCrypto().subtle.digest({name:"SHA-256"},a))}function j(a){return(h||(h=b("Promise"))).resolve(i(a).then(d("WABase64").encodeB64))}function a(a){return j(k(a))}function k(a){var b=new ArrayBuffer(a.length),c=new Uint8Array(b);for(var d=0,e=a.length;d<e;d++)c[d]=a.charCodeAt(d);return b}g.sha256=i;g.sha256Base64=j;g.sha256Str=a}),98);
__d("WAMediaHkdfInfo",["WAErr"],(function(a,b,c,d,e,f,g){function a(a){switch(a){case"document":return"WhatsApp Document Keys";case"image":case"sticker":case"xma-image":return"WhatsApp Image Keys";case"video":case"gif":return"WhatsApp Video Keys";case"audio":case"ptt":return"WhatsApp Audio Keys";case"md-app-state":return"WhatsApp App State Keys";case"md-msg-hist":return"WhatsApp History Keys";default:throw c("WAErr")("getMediaHkdfInfo: unexpected media type "+a)}}function b(){return"Messenger Preview Keys"}g.getMediaHkdfInfo=a;g.getPreviewMediaHkdfInfo=b}),98);
__d("WAPREList",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({DECRYPT_MESSAGE_FINAL:"decrypt_message_final",FRANKING_VALIDATION:"franking_validation",GET_DEVICES:"get_devices",MEDIA_DOWNLOAD:"media_download",MEDIA_UPLOAD:"media_upload",DELETE_THREAD:"delete_thread",DOWNLOAD_AND_DECRYPT:"download_and_decrypt",MESSAGE_DECRYPTION:"message_decryption",MESSAGE_ENCRYPTION:"message_encryption",OFFLINE_QUEUE:"offline_queue",OFFLINE_RETRY:"offline_retry",ICDC_ERROR:"icdc_error",QUERY_GROUP:"query_group",QUERY_GROUPS:"query_groups",RETRY_RECEIPTS_SENT:"retry_receipts_sent",SYNCD_FATAL_ERROR:"syncd_fatal_error",SYNCD_CRITICAL_EVENT:"syncd_critical_event",SYNCD_CRITICAL_BOOTSTRAP_STAGE:"syncd_critical_bootstrap_stage",SYNCD_BOOTSTRAP_APP_STATE_DOWNLOAD:"syncd_bootstrap_app_state_download",SYNCD_DECRYPT_MUTATIONS:"syncd_decrypt_mutations",SYNCD_BOOTSTRAP_DATA_APPLIED:"syncd_bootstrap_data_applied",APP_STATE_SYNC_DAILY:"app_state_sync_daily",SYNCD:"syncd",SEND_MESSAGE:"send_message",RECEIVE_MESSAGE:"receive_message",SYNCD_KEY_ROTATION:"syncd_key_rotation",REMOVE_PARTICIPANTS:"remove_participants",CREATE_GROUP:"create_group",WA_JOBS_ORCHESTRATOR:"wa_jobs_orchestrator",WA_DISCONNECT:"wa_disconnect",WA_JOB_MANAGER:"wa_job_manager",STANZA_QUEUE_MESSAGE_CONSUMER:"stanza_queue_message_consumer",WA_FAIL_STANZA_QUEUE_ITEM:"stanza_queue_item_failure",ONE_QUEUE:"one_queue",PROTOCOL_QUEUE_CONSUMER:"protocol_queue_consumer"});f.PRE_METRIC=a}),66);
__d("WAPREMetrics",["WALogger"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[PRE] "," ends with an error ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[PRE] "," ends successfully"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[PRE] add point "," to ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[PRE] resume ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[PRE] start ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[PRE] There are no subscribers to PRE events"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Removing all listeners from PRE_METRICS"]);n=function(){return a};return a}var o=0;function a(){var b=[];function c(a){b.push(a)}function e(){d("WALogger").WARN(n()),b.length=0}function a(a){b.length===0&&d("WALogger").WARN(m()),b.forEach(function(b){b(a)})}return{subscribe:c,notify:a,clear:e}}c=a();var p=c.notify;e=c.clear;f=c.subscribe;function b(a,b,c){var e;c==null&&o++;var f=(e=c)!=null?e:o,g="open";c==null?(p({name:a,stage:"START",instanceKey:f,annotations:b}),d("WALogger").DEV(l(),a)):(p({name:a,stage:"RESUME",instanceKey:f,annotations:b}),d("WALogger").DEV(k(),a));return{addPoint:function(c,b){p({name:a,stage:"POINT",reason:c,instanceKey:f,annotations:b}),d("WALogger").DEV(j(),c,a)},addAnnotations:function(b){p({name:a,stage:"ANNOTATE",instanceKey:f,annotations:b})},endSuccess:function(b){p({name:a,stage:"SUCCESS",instanceKey:f,annotations:b}),g="closed",d("WALogger").DEV(i(),a)},endFail:function(c,b){p({name:a,stage:"FAIL",reason:c,instanceKey:f,annotations:b}),g="closed",d("WALogger").DEV(h(),a,c)},getFlowDetails:function(){return{name:a,instanceKey:f}},isActive:function(){return g==="open"}}}g.clear=e;g.subscribe=f;g.startMetric=b}),98);
__d("WAMediaCrypto",["Promise","WABase64","WABinary","WACryptoAesCbc","WACryptoDependencies","WACryptoHkdf","WACryptoHmac","WACryptoSha256","WACryptoUtils","WACustomError","WAErr","WALogger","WAMediaCryptoSidecar","WAMediaHkdfInfo","WAMediaUtils","WAPREList","WAPREMetrics","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["WAMediaCrypto::downloadAndDecrypt"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Processing scan ",""]);j=function(){return a};return a}var k=d("WACustomError").customError("HmacValidationError",!1);function l(a,b){return d("WACryptoHkdf").extractAndExpand(new Uint8Array(a),b,112).then(function(a){return{iv:new Uint8Array(a,0,16),cipherKey:new Uint8Array(a,16,32),hmacKey:new Uint8Array(a,48,32),refKey:new Uint8Array(a,80,32)}})}function m(a,b){b=d("WAMediaHkdfInfo").getMediaHkdfInfo(b);return l(a,b)}function n(a){var b=d("WAMediaHkdfInfo").getPreviewMediaHkdfInfo();return l(a,b)}function a(a){var c,d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:c=new Map();f.next=3;return b("regeneratorRuntime").awrap(n(a));case 3:d=f.sent;c.set("preview",d);e=["document","image","video","audio","md-app-state","md-msg-hist"];f.next=8;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(e.map(function(b){return m(a,b).then(function(a){c.set(b,a)})})));case 8:return f.abrupt("return",c);case 9:case"end":return f.stop()}},null,this)}function e(a){switch(a){case"image":case"video":return a;default:throw c("WAErr")("Unsupported PreviewMediaType: "+a)}}var o=16,p=16,q=10,r=64*1024;function s(a,c,e,f,g){var i,j,k,l,m,n,s,t,u,v,w,x,y,z,A;return b("regeneratorRuntime").async(function(B){while(1)switch(B.prev=B.next){case 0:i=new(d("WABinary").Binary)(),i.ensureCapacity(p+f.size+o+q),i.writeByteArray(c),j=new(d("WACryptoAesCbc").AesCbcStream)(i,"encrypt",a,c),k=0,l=k+r;case 6:if(!(l<f.size)){B.next=17;break}m=f.slice(k,l);B.next=10;return b("regeneratorRuntime").awrap(d("WAMediaUtils").blobToArrayBuffer(m));case 10:n=B.sent;B.next=13;return b("regeneratorRuntime").awrap(j.append(new Uint8Array(n)));case 13:k=l;l+=r;B.next=6;break;case 17:B.next=19;return b("regeneratorRuntime").awrap(d("WAMediaUtils").blobToArrayBuffer(f.slice(k)));case 19:s=B.sent;B.next=22;return b("regeneratorRuntime").awrap(j.finalize(new Uint8Array(s)));case 22:t=i.peek(function(a){return a.readByteArray()});B.next=25;return b("regeneratorRuntime").awrap(d("WACryptoHmac").encodeKeySha256(e));case 25:u=B.sent;B.next=28;return b("regeneratorRuntime").awrap(d("WACryptoHmac").sign(u,t));case 28:v=B.sent;i.writeByteArray(new Uint8Array(v,0,q));w=i.readByteArray();x=w.subarray(p);B.next=34;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all([d("WACryptoDependencies").getCrypto().subtle.digest("SHA-256",x),d("WAMediaCryptoSidecar").shouldHaveStreamingSidecar(g)?d("WAMediaCryptoSidecar").calculateStreamingSidecar(u,w):void 0]));case 34:y=B.sent;z=y[0];A=y[1];return B.abrupt("return",{ciphertext:x,ciphertextHash:z,sidecar:A,ivCiphertext:t});case 38:case"end":return B.stop()}},null,this)}function f(a,c,e){var f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:h.next=2;return b("regeneratorRuntime").awrap(d("WACryptoHmac").encodeKeySha256(a));case 2:f=h.sent;g=d("WABinary").Binary.build(c,e).readByteArray();return h.abrupt("return",d("WACryptoHmac").sign(f,g));case 5:case"end":return h.stop()}},null,this)}function t(a,c,e,f,g){var h,i,j,l,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:if(10<=g.length&&g.length<=32){n.next=2;break}throw new k("Bad hmac size "+g.length);case 2:h=d("WABinary").Binary.build(c,e).readByteArray();n.next=5;return b("regeneratorRuntime").awrap(d("WACryptoHmac").hmacSha256(f,h).then(function(a){return new Uint8Array(a)}));case 5:i=n.sent;j=i.slice(0,g.length);if(w(j,g)){n.next=9;break}throw new k("hmacAndDecrypt hmac mismatch");case 9:n.next=11;return b("regeneratorRuntime").awrap(d("WACryptoAesCbc").aesCbcDecrypt(a,c,e));case 11:l=n.sent;n.next=14;return b("regeneratorRuntime").awrap(d("WACryptoDependencies").getCrypto().subtle.digest("SHA-256",l));case 14:m=n.sent;return n.abrupt("return",{plaintextHash:d("WABase64").encodeB64UrlSafe(new Uint8Array(m)),plaintext:l});case 16:case"end":return n.stop()}},null,this)}function u(a,b,c,e,f){if(!(10<=f.length&&f.length<=32))throw new k("Bad hmac size "+f.length);var g=c.subarray(0,c.byteLength-o);g=d("WABinary").Binary.build(b,g).readByteArray();e=d("WACryptoHmac").hmacSha256(e,g).then(function(a){return new Uint8Array(a)});return e.then(function(a){a=a.slice(0,f.length);if(!d("WACryptoUtils").uint8ArraysEqual(a,f))throw new k("hmacAndDecrypt hmac mismatch")}).then(function(){return d("WACryptoAesCbc").aesCbcDecrypt(a,b,c)}).then(function(a){return new Uint8Array(a)}).then(function(a){var b=a.subarray(0,a.byteLength-2);return d("WACryptoSha256").sha256(b).then(function(a){return{plaintext:b,plaintextHash:d("WABase64").encodeB64UrlSafe(new Uint8Array(a))}})})}function v(a,c,e,f,g,h){var i,k,l,m,n,p,q,r,t,v,w,x,y,z,A,B,C,D;return b("regeneratorRuntime").async(function(E){while(1)switch(E.prev=E.next){case 0:i=new(d("WABinary").Binary)();k=[];for(l=0;l<g;l++)k.push(new Uint8Array(h.sidecar.slice(l*10,(l+1)*10)));m=0;n=c;p=0;q=0;case 7:if(!(q<g)){E.next=30;break}d("WALogger").DEV(j(),q);r=h.alignedScanLengths[q];t=m+r;v=e.slice(m,t);w=new Uint8Array(v.slice(r-o,r));E.next=15;return b("regeneratorRuntime").awrap(s(a,w,f,new Blob([2,2]),"image"));case 15:x=E.sent;y=new(d("WABinary").Binary)(v);y.writeByteArray(x.ciphertext.slice(0,o));z=y.readByteArray();E.next=21;return b("regeneratorRuntime").awrap(u(a,n,z,f,k[q]));case 21:A=E.sent,B=A.plaintext,i.write(B),m+=r,n=w,p+=h.scanLengths[q];case 27:q++;E.next=7;break;case 30:C=i.readBuffer(p);E.next=33;return b("regeneratorRuntime").awrap(d("WACryptoSha256").sha256(C));case 33:D=E.sent;return E.abrupt("return",{plaintextHash:d("WABase64").encodeB64UrlSafe(new Uint8Array(D)),plaintext:C});case 35:case"end":return E.stop()}},null,this)}function w(a,b){if(a.length!==b.length)return!1;var c=1,d=a.length;for(var e=0;e<d;e++)c&=a[e]===b[e]?1:0;return c!==0}function x(a,e,f,g,j,k,l){var m,n,o,p,q,r,s,u,v,w,x;return b("regeneratorRuntime").async(function(y){while(1)switch(y.prev=y.next){case 0:d("WALogger").DEV(i());m=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.DOWNLOAD_AND_DECRYPT);y.prev=2;m.addPoint("download_start");y.next=6;return b("regeneratorRuntime").awrap(fetch(a));case 6:n=y.sent;m.addPoint("download_end");y.next=15;break;case 10:y.prev=10;y.t0=y["catch"](2);m.addPoint("download_end");m.endFail("download_error");throw c("WAErr")("download_error");case 15:if(!(n.status!==200)){y.next=18;break}m.endFail("http_status_"+n.status);throw c("WAErr")("http_status="+n.status);case 18:m.endSuccess();y.next=21;return b("regeneratorRuntime").awrap(n.arrayBuffer());case 21:o=y.sent;if(!(o.byteLength<j+k)){y.next=25;break}m.endFail("bad_ciphertext_size");throw c("WAErr")("bad_ciphertext_size");case 25:p=o.byteLength-k;q=new Uint8Array(o,p);r=q.slice(0,k);s=new Uint8Array(o,0,p);y.next=31;return b("regeneratorRuntime").awrap(t(f,e,s,g,q));case 31:u=y.sent;v=u.plaintext;w=u.plaintextHash;l(new Uint8Array(v));x=new Uint8Array(d("WABase64").decodeB64UrlSafe(w));return y.abrupt("return",(h||(h=b("Promise"))).resolve({tail:r,plaintextHash:x,hmac:q}));case 37:case"end":return y.stop()}},null,this,[[2,10]])}g.HmacValidationError=k;g.computeMediaKeys=m;g.computeMediaKeysForPreview=n;g.deprecated_getAllCommonComputedMediaKeys=a;g.convertServerMediaTypeToPreviewMediaType=e;g.IV_LENGTH=p;g.HMAC_LENGTH=q;g.encryptAndHmac=s;g.hmacCiphertext=f;g.hmacAndDecrypt=t;g.decryptPartialChunks=v;g.downloadAndDecrypt=x}),98);
__d("WADecryptMedia",["WAGlobals","WAMediaCrypto","WAResultOrError","WATagsLogger","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Download Plaintext Success"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Download Plaintext Error ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Using default plaintext verifier"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([""," is not a working hmac salt."]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Found a working hmac salt using ","."]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Trying "," as an alternative hmac salt."]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Encountered enc-hash-mismatch - looking for a potential working hmac salt"]);n=function(){return a};return a}var o=d("WATagsLogger").TAGS(["WADecryptMedia"]);function p(a,c,e,f){var g,h,i,j,p,q,r,s,t,u,v;return b("regeneratorRuntime").async(function(w){while(1)switch(w.prev=w.next){case 0:o.WARN(n());g=e.type==="preview"?"preview":e.mediaType;w.next=4;return b("regeneratorRuntime").awrap(d("WAMediaCrypto").deprecated_getAllCommonComputedMediaKeys(f));case 4:h=w.sent,(j=h,p=Array.isArray(j),q=0,j=p?j:j[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 6:if(!p){w.next=12;break}if(!(q>=j.length)){w.next=9;break}return w.abrupt("break",39);case 9:r=j[q++];w.next=16;break;case 12:q=j.next();if(!q.done){w.next=15;break}return w.abrupt("break",39);case 15:r=q.value;case 16:s=r;t=s[0];u=s[1];w.prev=19;if(!(t===g)){w.next=22;break}return w.abrupt("continue",37);case 22:o.LOG(m(),t);w.t0=d("WAResultOrError").makeResult;w.next=26;return b("regeneratorRuntime").awrap(d("WAMediaCrypto").hmacAndDecrypt(u.cipherKey,u.iv,a,u.hmacKey,c));case 26:w.t1=w.sent;v=w.t0(w.t1);i={hmacAndDecryptResult:v,alternativeHmacSaltUsed:t};o.LOG(l(),t);return w.abrupt("return",i);case 33:w.prev=33;w.t2=w["catch"](19);o.LOG(k(),t);return w.abrupt("continue",37);case 37:w.next=6;break;case 39:return w.abrupt("return",{hmacAndDecryptResult:d("WAResultOrError").makeError("enc-hash-mismatch")});case 40:case"end":return w.stop()}},null,this,[[19,33]])}function a(a){var c,e,f,g,k,l,m,n,q,r,s,t,u,v;return b("regeneratorRuntime").async(function(w){while(1)switch(w.prev=w.next){case 0:c=a.ciphertextHmac,e=a.mediaKey,f=a.mediaTypeDetails,g=a.plaintextHash;o.LOG(j());k=c.byteLength-d("WAMediaCrypto").HMAC_LENGTH;l=new Uint8Array(c,k);m=new Uint8Array(c,0,k);f.type==="preview"?n=d("WAMediaCrypto").computeMediaKeysForPreview(e):n=d("WAMediaCrypto").computeMediaKeys(e,f.mediaType);r=null;w.next=9;return b("regeneratorRuntime").awrap(n.then(function(a){var b=a.iv,c=a.cipherKey;a=a.hmacKey;return d("WAMediaCrypto").hmacAndDecrypt(c,b,m,a,l)}).then(d("WAResultOrError").makeResult)["catch"](function(a){o.ERROR(i(),a);if(a instanceof d("WAMediaCrypto").HmacValidationError)return d("WAResultOrError").makeError("enc-hash-mismatch");else return d("WAResultOrError").makeError("decryption-error")}));case 9:q=w.sent;if(!(d("WAGlobals").getConfig().isMediaFallbackToAlternativeHmacSaltsEnabled()===!0&&q.success===!1&&q.error==="enc-hash-mismatch")){w.next=16;break}w.next=13;return b("regeneratorRuntime").awrap(p(m,l,f,e));case 13:s=w.sent,q=s.hmacAndDecryptResult,r=s.alternativeHmacSaltUsed;case 16:if(q.success){w.next=18;break}return w.abrupt("return",q);case 18:t=q.value,u=t.plaintext,v=t.plaintextHash;if(!(g!==v)){w.next=21;break}return w.abrupt("return",d("WAResultOrError").makeError("hash-mismatch"));case 21:o.LOG(h());return w.abrupt("return",d("WAResultOrError").makeResult({plaintext:u,alternativeHmacSaltUsed:r}));case 23:case"end":return w.stop()}},null,this)}g.decryptMedia=a}),98);
__d("WADecimalStringMod",["WAErr","WALogger"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(['"','" is over 64 bits']);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(['"','" is not a valid decimal string']);i=function(){return a};return a}function a(a,b){if(!/^\d+$/.test(a)){d("WALogger").ERROR(i(),a);throw c("WAErr")("decimalStringMod is given an invalid decimal string")}var e=a.length;if(e<16||e===16&&a<="9007199254740991")return Number(a)%b;if(e>20||e===20&&a>"18446744073709551615"){d("WALogger").ERROR(h(),a);throw c("WAErr")("decimalStringMod is given value over 64 bits")}e=0;for(var f=0;f<a.length;f++){var g=Number(a[f]);e=(e*10+g)%b}return e}g.decimalStringMod=a}),98);
__d("WACreateGetVcaEnabledBucket",["WAArrayBufferUtils","WADecimalStringMod","WALogger"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["mediaRouteSelection: can't get fbId from mediaDirectPath"]);h=function(){return a};return a}function a(a,b){return function(){return b==null?null:d("WAArrayBufferUtils").arrayBufferMod(a,b)+100}}function b(a,b){return function(){if(b==null)return null;var c=a.split("/");c=c[c.length-1];c=c.split("_")[1];if(!/^\d+$/.test(c))return null;if(c==null){d("WALogger").ERROR(h());return null}else return d("WADecimalStringMod").decimalStringMod(c,b)+100}}g.createGetVcaEnabledBucket=a;g.msgrCreateGetVcaEnabledBucket=b}),98);
__d("WAExtractNcHotTimestamp",["WATimeUtils"],(function(a,b,c,d,e,f,g){function a(a){if(a==null)return null;a=h(a);if(a.has("_nc_hot")){a=parseInt(a.get("_nc_hot"),10);return Number.isInteger(a)?d("WATimeUtils").castToUnixTime(a):null}else return null}function h(a){a=a.split("?");return new URLSearchParams(a.length===2?a[1]:"")}g.extractNcHotTimestamp=a}),98);
__d("WAWapDict",[],(function(a,b,c,d,e,f){a=3;b=["xmlstreamstart","xmlstreamend","s.whatsapp.net","type","participant","from","receipt","id","notification","disappearing_mode","status","jid","broadcast","user","devices","device_hash","to","offline","message","result","class","xmlns","duration","notify","iq","t","ack","g.us","enc","urn:xmpp:whatsapp:push","presence","config_value","picture","verified_name","config_code","key-index-list","contact","mediatype","routing_info","edge_routing","get","read","urn:xmpp:ping","fallback_hostname","0","chatstate","business_hours_config","unavailable","download_buckets","skmsg","verified_level","composing","handshake","device-list","media","text","fallback_ip4","media_conn","device","creation","location","config","item","fallback_ip6","count","w:profile:picture","image","business","2","hostname","call-creator","display_name","relaylatency","platform","abprops","success","msg","offline_preview","prop","key-index","v","day_of_week","pkmsg","version","1","ping","w:p","download","video","set","specific_hours","props","primary","unknown","hash","commerce_experience","last","subscribe","max_buckets","call","profile","member_since_text","close_time","call-id","sticker","mode","participants","value","query","profile_options","open_time","code","list","host","ts","contacts","upload","lid","preview","update","usync","w:stats","delivery","auth_ttl","context","fail","cart_enabled","appdata","category","atn","direct_connection","decrypt-fail","relay_id","mmg-fallback.whatsapp.net","target","available","name","last_id","mmg.whatsapp.net","categories","401","is_new","index","tctoken","ip4","token_id","latency","recipient","edit","ip6","add","thumbnail-document","26","paused","true","identity","stream:error","key","sidelist","background","audio","3","thumbnail-image","biz-cover-photo","cat","gcm","thumbnail-video","error","auth","deny","serial","in","registration","thumbnail-link","remove","00","gif","thumbnail-gif","tag","capability","multicast","item-not-found","description","business_hours","config_expo_key","md-app-state","expiration","fallback","ttl","300","md-msg-hist","device_orientation","out","w:m","open_24h","side_list","token","inactive","01","document","te2","played","encrypt","msgr","hide","direct_path","12","state","not-authorized","url","terminate","signature","status-revoke-delay","02","te","linked_accounts","trusted_contact","timezone","ptt","kyc-id","privacy_token","readreceipts","appointment_only","address","expected_ts","privacy","7","android","interactive","device-identity","enabled","attribute_padding","1080","03","screen_height"];c=["read-self","active","fbns","protocol","reaction","screen_width","heartbeat","deviceid","2:47DEQpj8","uploadfieldstat","voip_settings","retry","priority","longitude","conflict","false","ig_professional","replaced","preaccept","cover_photo","uncompressed","encopt","ppic","04","passive","status-revoke-drop","keygen","540","offer","rate","opus","latitude","w:gp2","ver","4","business_profile","medium","sender","prev_v_id","email","website","invited","sign_credential","05","transport","skey","reason","peer_abtest_bucket","America/Sao_Paulo","appid","refresh","100","06","404","101","104","107","102","109","103","member_add_mode","105","transaction-id","110","106","outgoing","108","111","tokens","followers","ig_handle","self_pid","tue","dec","thu","joinable","peer_pid","mon","features","wed","peer_device_presence","pn","delete","07","fri","audio_duration","admin","connected","delta","rcat","disable","collection","08","480","sat","phash","all","invite","accept","critical_unblock_low","group_update","signed_credential","blinded_credential","eph_setting","net","09","background_location","refresh_id","Asia/Kolkata","privacy_mode_ts","account_sync","voip_payload_type","service_areas","acs_public_key","v_id","0a","fallback_class","relay","actual_actors","metadata","w:biz","5","connected-limit","notice","0b","host_storage","fb_page","subject","privatestats","invis","groupadd","010","note.m4r","uuid","0c","8000","sun","372","1020","stage","1200","720","canonical","fb","011","video_duration","0d","1140","superadmin","012","Opening.m4r","keystore_attestation","dleq_proof","013","timestamp","ab_key","w:sync:app:state","0e","vertical","600","p_v_id","6","likes","014","500","1260","creator","0f","rte","destination","group","group_info","syncd_anti_tampering_fatal_exception_enabled","015","dl_bw","Asia/Jakarta","vp8/h.264","online","1320","fb:multiway","10","timeout","016","nse_retry","urn:xmpp:whatsapp:dirty","017","a_v_id","web_shops_chat_header_button_enabled","nse_call","inactive-upgrade","none","web","groups","2250","mms_hot_content_timespan_in_seconds","contact_blacklist","nse_read","suspended_group_deletion_notification","binary_version","018","https://www.whatsapp.com/otp/copy/","reg_push","shops_hide_catalog_attachment_entrypoint","server_sync",".","ephemeral_messages_allowed_values","019","mms_vcache_aggregation_enabled","iphone","America/Argentina/Buenos_Aires","01a","mms_vcard_autodownload_size_kb","nse_ver","shops_header_dropdown_menu_item","dhash","catalog_status","communities_mvp_new_iqs_serverprop","blocklist","default","11","ephemeral_messages_enabled","01b","original_dimensions","8","mms4_media_retry_notification_encryption_enabled","mms4_server_error_receipt_encryption_enabled","original_image_url","sync","multiway","420","companion_enc_static","shops_profile_drawer_entrypoint","01c","vcard_as_document_size_kb","status_video_max_duration","request_image_url","01d","regular_high","s_t","abt","share_ext_min_preliminary_image_quality","01e","32","syncd_key_rotation_enabled","data_namespace","md_downgrade_read_receipts2","patch","polltype","ephemeral_messages_setting","userrate","15","partial_pjpeg_bw_threshold","played-self","catalog_exists","01f","mute_v2"];d=["reject","dirty","announcement","020","13","9","status_video_max_bitrate","fb:thrift_iq","offline_batch","022","full","ctwa_first_business_reply_logging","h.264","smax_id","group_description_length","https://www.whatsapp.com/otp/code","status_image_max_edge","smb_upsell_business_profile_enabled","021","web_upgrade_to_md_modal","14","023","s_o","smaller_video_thumbs_status_enabled","media_max_autodownload","960","blocking_status","peer_msg","joinable_group_call_client_version","group_call_video_maximization_enabled","return_snapshot","high","America/Mexico_City","entry_point_block_logging_enabled","pop","024","1050","16","1380","one_tap_calling_in_group_chat_size","regular_low","inline_joinable_education_enabled","hq_image_max_edge","locked","America/Bogota","smb_biztools_deeplink_enabled","status_image_quality","1088","025","payments_upi_intent_transaction_limit","voip","w:g2","027","md_pin_chat_enabled","026","multi_scan_pjpeg_download_enabled","shops_product_grid","transaction_id","ctwa_context_enabled","20","fna","hq_image_quality","alt_jpeg_doc_detection_quality","group_call_max_participants","pkey","America/Belem","image_max_kbytes","web_cart_v1_1_order_message_changes_enabled","ctwa_context_enterprise_enabled","urn:xmpp:whatsapp:account","840","Asia/Kuala_Lumpur","max_participants","video_remux_after_repair_enabled","stella_addressbook_restriction_type","660","900","780","context_menu_ios13_enabled","mute-state","ref","payments_request_messages","029","frskmsg","vcard_max_size_kb","sample_buffer_gif_player_enabled","match_last_seen","510","4983","video_max_bitrate","028","w:comms:chat","17","frequently_forwarded_max","groups_privacy_blacklist","Asia/Karachi","02a","web_download_document_thumb_mms_enabled","02b","hist_sync","biz_block_reasons_version","1024","18","web_is_direct_connection_for_plm_transparent","view_once_write","file_max_size","paid_convo_id","online_privacy_setting","video_max_edge","view_once_read","enhanced_storage_management","multi_scan_pjpeg_encoding_enabled","ctwa_context_forward_enabled","video_transcode_downgrade_enable","template_doc_mime_types","hq_image_bw_threshold","30","body","u_aud_limit_sil_restarts_ctrl","other","participating","w:biz:directory","1110","vp8","4018","meta","doc_detection_image_max_edge","image_quality","1170","02c","smb_upsell_chat_banner_enabled","key_expiry_time_second","pid","stella_interop_enabled","19","linked_device_max_count","md_device_sync_enabled","02d","02e","360","enhanced_block_enabled","ephemeral_icon_in_forwarding","paid_convo_status","gif_provider","project_name","server-error","canonical_url_validation_enabled","wallpapers_v2","syncd_clear_chat_delete_chat_enabled","medianotify","02f","shops_required_tos_version","vote","reset_skey_on_id_change","030","image_max_edge","multicast_limit_global","ul_bw","21","25","5000","poll","570","22","031","1280","WhatsApp","032","bloks_shops_enabled","50","upload_host_switching_enabled","web_ctwa_context_compose_enabled","ptt_forwarded_features_enabled","unblocked","partial_pjpeg_enabled","fbid:devices","height","ephemeral_group_query_ts","group_join_permissions","order","033","alt_jpeg_status_quality","migrate","popular-bank","win_uwp_deprecation_killswitch_enabled","web_download_status_thumb_mms_enabled","blocking","url_text","035","web_forwarding_limit_to_groups","1600","val","1000","syncd_msg_date_enabled","bank-ref-id","max_subject","payments_web_enabled","web_upload_document_thumb_mms_enabled","size","request","ephemeral","24","receipt_agg","ptt_remember_play_position","sampling_weight","enc_rekey","mute_always","037","034","23","036","action","click_to_chat_qr_enabled","width","disabled","038","md_blocklist_v2","played_self_enabled","web_buttons_message_enabled","flow_id","clear","450","fbid:thread","bloks_session_state","America/Lima","attachment_picker_refresh","download_host_switching_enabled","1792","u_aud_limit_sil_restarts_test2","custom_urls","device_fanout","optimistic_upload","2000","key_cipher_suite","web_smb_upsell_in_biz_profile_enabled","e","039","siri_post_status_shortcut","pair-device","lg","lc","stream_attribution_url","model","mspjpeg_phash_gen","catalog_send_all","new_multi_vcards_ui","share_biz_vcard_enabled","-","clean","200","md_blocklist_v2_server","03b","03a","web_md_migration_experience","ptt_conversation_waveform","u_aud_limit_sil_restarts_test1"];e=["64","ptt_playback_speed_enabled","web_product_list_message_enabled","paid_convo_ts","27","manufacturer","psp-routing","grp_uii_cleanup","ptt_draft_enabled","03c","business_initiated","web_catalog_products_onoff","web_upload_link_thumb_mms_enabled","03e","mediaretry","35","hfm_string_changes","28","America/Fortaleza","max_keys","md_mhfs_days","streaming_upload_chunk_size","5541","040","03d","2675","03f","...","512","mute","48","041","alt_jpeg_quality","60","042","md_smb_quick_reply","5183","c","1343","40","1230","043","044","mms_cat_v1_forward_hot_override_enabled","user_notice","ptt_waveform_send","047","Asia/Calcutta","250","md_privacy_v2","31","29","128","md_messaging_enabled","046","crypto","690","045","enc_iv","75","failure","ptt_oot_playback","AIzaSyDR5yfaG7OG8sMTUj8kfQEb8T9pN8BM6Lk","w","048","2201","web_large_files_ui","Asia/Makassar","812","status_collapse_muted","1334","257","2HP4dm","049","patches","1290","43cY6T","America/Caracas","web_sticker_maker","campaign","ptt_pausable_enabled","33","42","attestation","biz","04b","query_linked","s","125","04a","810","availability","1411","responsiveness_v2_m1","catalog_not_created","34","America/Santiago","1465","enc_p","04d","status_info","04f","key_version","..","04c","04e","md_group_notification","1598","1215","web_cart_enabled","37","630","1920","2394","-1","vcard","38","elapsed","36","828","peer","pricing_category","1245","invalid","stella_ios_enabled","2687","45","1528","39","u_is_redial_audio_1104_ctrl","1025","1455","58","2524","2603","054","bsp_system_message_enabled","web_pip_redesign","051","verify_apps","1974","1272","1322","1755","052","70","050","1063","1135","1361","80","1096","1828","1851","1251","1921","key_config_id","1254","1566","1252","2525","critical_block","1669","max_available","w:auth:backup:token","product","2530","870","1022","participant_uuid","web_cart_on_off","1255","1432","1867","41","1415","1440","240","1204","1608","1690","1846","1483","1687","1749","69","url_number","053","1325","1040","365","59","Asia/Riyadh","1177","test_recommended","057","1612","43","1061","1518","1635","055","1034","1375","750","1430","event_code","1682","503","55","865","78","1309","1365","44","America/Guayaquil","535","LIMITED","1377","1613","1420","1599","1822","05a","1681","password","1111","1214","1376","1478","47","1082","4282","Europe/Istanbul","1307","46","058","1124","256","rate-overlimit","retail","u_a_socket_err_fix_succ_test","1292","1370","1388","520","861","psa","regular","1181","1766","05b","1183","1213","1304","1537"];var g=["1724","profile_picture","1071","1314","1605","407","990","1710","746","pricing_model","056","059","061","1119","6027","65","877","1607","05d","917","seen","1516","49","470","973","1037","1350","1394","1480","1796","keys","794","1536","1594","2378","1333","1524","1825","116","309","52","808","827","909","495","1660","361","957","google","1357","1565","1967","996","1775","586","736","1052","1670","bank","177","1416","2194","2222","1454","1839","1275","53","997","1629","6028","smba","1378","1410","05c","1849","727","create","1559","536","1106","1310","1944","670","1297","1316","1762","en","1148","1295","1551","1853","1890","1208","1784","7200","05f","178","1283","1332","381","643","1056","1238","2024","2387","179","981","1547","1705","05e","290","903","1069","1285","2436","062","251","560","582","719","56","1700","2321","325","448","613","777","791","51","488","902","Asia/Almaty","is_hidden","1398","1527","1893","1999","2367","2642","237","busy","065","067","233","590","993","1511","54","723","860","363","487","522","605","995","1321","1691","1865","2447","2462","NON_TRANSACTIONAL","433","871","432","1004","1207","2032","2050","2379","2446","279","636","703","904","248","370","691","700","1068","1655","2334","060","063","364","533","534","567","1191","1210","1473","1827","069","701","2531","514","prev_dhash","064","496","790","1046","1139","1505","1521","1108","207","544","637","final","1173","1293","1694","1939","1951","1993","2353","2515","504","601","857","modify","spam_request","p_121_aa_1101_test4","866","1427","1502","1638","1744","2153","068","382","725","1704","1864","1990","2003","Asia/Dubai","508","531","1387","1474","1632","2307","2386","819","2014","066","387","1468","1706","2186","2261","471","728","1147","1372","1961"],h=[c,d,e,g];f.DICT_VERSION=a;f.SINGLE_BYTE_TOKEN=b;f.DICTIONARY_0_TOKEN=c;f.DICTIONARY_1_TOKEN=d;f.DICTIONARY_2_TOKEN=e;f.DICTIONARY_3_TOKEN=g;f.DICTIONARIES=h}),66);
__d("WAWapJid",["$InternalEnum","WAJids"],(function(a,b,c,d,e,f,g){var h={JID:0,JID_U:1,JID_AD:1,JID_FB:3,JID_INTEROP:4},i=b("$InternalEnum")({WHATSAPP:0,LID:1,HOSTED:128,HOSTED_LID:129});a=function(){function a(a){this.$1=a}a.createAD=function(b,c,d){return new a({type:h.JID_AD,user:b,device:d==null?0:d,agent:c==null?0:c,domainType:i.WHATSAPP})};a.createJidU=function(b,c,d){return new a({type:h.JID_U,user:b,device:d==null?0:d,domainType:c==null?i.WHATSAPP:c})};a.createFbJid=function(b,c){c=c==null?0:c;return new a({type:h.JID_FB,user:b,device:c})};a.createInteropJid=function(b,c,d){c=c==null?0:c;return new a({type:h.JID_INTEROP,user:b,device:c,integrator:d})};a.create=function(b,c){return new a({type:h.JID,user:b,server:c})};var b=a.prototype;b.toString=function(){if(this.$1.type===h.JID_AD||this.$1.type===h.JID_U){var a=this.$1,b=a.user,c=a.device;a=a.domainType;var e;a===i.WHATSAPP?e=d("WAJids").WA_USER_JID_SUFFIX:a===i.HOSTED?e=d("WAJids").HOSTED_SUFFIX:a===i.HOSTED_LID?e=d("WAJids").HOSTED_LID_SUFFIX:e=d("WAJids").LID_SUFFIX;return c===0?b+"@"+e:b+":"+c+"@"+e}else if(this.$1.type===h.JID_FB){a=this.$1;b=a.user;c=a.device;e=d("WAJids").MSGR_USER_JID_SUFFIX;return b+":"+c+"@"+e}else if(this.$1.type===h.JID_INTEROP){a=this.$1;b=a.user;c=a.device;e=a.integrator;a=d("WAJids").INTEROP_USER_JID_SUFFIX;return e+"-"+b+":"+c+"@"+a}else{this.$1.type;e=this.$1;b=e.user;c=e.server;return b!=null?b+"@"+c:c}};b.getInnerJid=function(){return this.$1};return a}();g.WAP_JID_SUBTYPE=h;g.DomainType=i;g.WapJid=a}),98);
__d("WAXmlFormatter",[],(function(a,b,c,d,e,f){function a(a){a=a.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns:/g,"~::~xmlns:").replace(/\s*xmlns=/g,"~::~xmlns=").split("~::~");var b=a.length,c=!1,d=0,e="",f=0,g=["\n"];for(f=0;f<100;f++)g.push(g[f]+"    ");var h=function(b,a){var c=/^<[\w:\-.,]+/.exec(b[a-1]);b=/^<\/[\w:\-.,]+/.exec(b[a]);return c!=null&&b!=null&&c[0]===b[0]};for(f=0;f<b;f++)a[f].search(/<!/)>-1?(e+=g[d]+a[f],c=!0,(a[f].search(/-->/)>-1||a[f].search(/\]>/)>-1||a[f].search(/!DOCTYPE/)>-1)&&(c=!1)):a[f].search(/-->/)>-1||a[f].search(/\]>/)>-1?(e+=a[f],c=!1):h(a,f)?(e+=a[f],c||d--):a[f].search(/<\w/)>-1&&a[f].search(/<\//)===-1&&a[f].search(/\/>/)===-1?e=c?e+=a[f]:e+=g[d++]+a[f]:a[f].search(/<\w/)>-1&&a[f].search(/<\//)>-1?e=c?e+=a[f]:e+=g[d]+a[f]:a[f].search(/<\//)>-1?e=c?e+=a[f]:e+=g[d===0?d:--d]+a[f]:a[f].search(/\/>/)>-1?e=c?e+=a[f]:e+=g[d]+a[f]:a[f].search(/<\?/)>-1?e+=g[d]+a[f]:a[f].search(/xmlns:/)>-1||a[f].search(/xmlns=/)>-1?e+=g[d]+a[f]:e+=a[f];return e[0]==="\n"?e.slice(1):e}f["default"]=a}),66);
__d("WAXmlNode",["WAHex"],(function(a,b,c,d,e,f,g){var h={};a=function(){function a(a,b,c){b===void 0&&(b=h),c===void 0&&(c=null),this.tag=a,this.attrs=b,this.content=c}var b=a.prototype;b.toString=function(){var a="<"+this.tag;a+=i(this.attrs);var b=this.content;Array.isArray(b)?a+=">"+b.map(String).join("")+"</"+this.tag+">":b instanceof Uint8Array?a+=">"+j(b)+"</"+this.tag+">":b!=null?a+=">"+String(b)+"</"+this.tag+">":a+=" />";return a};return a}();function i(a){var b=Object.keys(a),c="";for(var d=0;d<b.length;d++){var e=b[d];c+=" "+e+'="'+a[e].toString()+'"'}return c}function j(a){var b;a.length===0?b="<!-- empty binary -->":a.length<50?b=d("WAHex").bytesToDebugString(a):b="<!-- "+a.length+" bytes -->";return b}g.XmlNode=a;g.attrsToString=i;g.uint8ArrayToDebugString=j}),98);
__d("WAWap",["WAAssertUnreachable","WABinary","WACryptoDependencies","WAErr","WAJids","WALogger","WALongInt","WAWapDict","WAWapJid","WAXmlFormatter","WAXmlNode"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["decodeNullableString got invalid value: ",", string expected"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["decodeString got invalid value: ",", string expected"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Decoding compressed stanza"]);k=function(){return a};return a}var l=(h=d("WAJids")).MSGR_USER_DOMAIN.replace("@",""),aa=h.WA_USER_DOMAIN.replace("@",""),m=h.LID_DOMAIN.replace("@",""),n=h.INTEROP_DOMAIN.replace("@",""),o=h.HOSTED_DOMAIN.replace("@",""),p=2,ba=128,q=0,r=236,s=237,t=238,u=239,ca=[r,s,t,u],v=245,w=246,x=247,y=248,z=249,A=250,B=251,C=252,D=253,E=254,F=255,da=["0","1","2","3","4","5","6","7","8","9","-",".","\ufffd","\ufffd","\ufffd","\ufffd"],ea=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],G="",fa=1,H={sentinel:"DROP_ATTR"},I=(s=d("WAWapJid")).WapJid.create(null,"g.us"),J=s.WapJid.create(null,h.WA_SERVER_JID_SUFFIX);t=s.WapJid.create("status","broadcast");var K=s.WapJid.create(null,"newsletter");h=s.WapJid.create(null,"hosted");s=s.WapJid.create(null,"hosted.lid");var L={},M=!1;function a(){M=!0}var ga=new TextEncoder(),N=function(){function a(a,b,c){b===void 0&&(b=L),c===void 0&&(c=null),this.tag=a,this.attrs=b,this.content=c}var b=a.prototype;b.toString=function(){var a="<"+this.tag;a+=d("WAXmlNode").attrsToString(this.attrs);var b=this.content;Array.isArray(b)?a+=">"+b.map(String).join("")+"</"+this.tag+">":b?a+=">"+d("WAXmlNode").uint8ArrayToDebugString(b)+"</"+this.tag+">":a+=" />";M&&(a=c("WAXmlFormatter")(a));return a};return a}();function b(a,b,e){var f=null;if(b&&b.children!=null)throw c("WAErr")('Children should not be passed via props (see eslint check "react/no-children-props")');if(Array.isArray(e))f=e.filter(Boolean);else if(typeof e==="string")f=d("WABinary").Binary.build(e).readByteArray();else if(e instanceof ArrayBuffer)f=new Uint8Array(e);else if(e instanceof Uint8Array)f=e;else{var g=[];for(var h=2;h<arguments.length;h++){var i=arguments[h];i&&g.push(i)}f=g}Array.isArray(f)&&f.length===0&&(f=null);var j={};if(b){var k=b;Object.keys(k).forEach(function(b){if(["__self","__source"].includes(b))return;var d=k[b];if(d==null)throw c("WAErr")("Attr "+b+" in <"+a+"> is null");if(d===H)return;j[b]=d})}return new N(a,j,f)}var ha=b;function e(a){return a instanceof d("WAWapJid").WapJid?a.toString():a}function O(a){var b=a.content;Array.isArray(b)?b=b.map(O):typeof b==="string"&&(b=d("WABinary").Binary.build(b).readByteArray());return new N(a.tag,a.attrs||L,b)}function f(a){a=a instanceof N?a:O(a);var b=new(d("WABinary").Binary)();P(a,b);a=0;b=b.readByteArray();var c=new Uint8Array(1+b.length);c[0]=a;c.set(b,1);return c}function P(a,b){if(a==null)b.writeUint8(q);else if(a instanceof N)Q(a,b);else if(a instanceof d("WAWapJid").WapJid)ia(a,b);else if(typeof a==="string")U(a,b);else if(a instanceof Uint8Array)ja(a,b);else{a;b=typeof a;throw c("WAErr")("Invalid payload type "+b)}}function ia(a,b){a=a.getInnerJid();if(a.type===d("WAWapJid").WAP_JID_SUBTYPE.JID_U){var c=a.user,e=a.device,f=a.domainType;b.writeUint8(x);b.writeUint8(f);b.writeUint8(e);P(c,b)}else if(a.type===d("WAWapJid").WAP_JID_SUBTYPE.JID_FB){f=a.user;e=a.device;b.writeUint8(w);P(f,b);b.writeUint16(e);P(l,b)}else if(a.type===d("WAWapJid").WAP_JID_SUBTYPE.JID_INTEROP){c=a.user;f=a.device;e=a.integrator;b.writeUint8(v);P(c,b);b.writeUint16(f);b.writeUint16(e)}else{c=a.user;f=a.server;b.writeUint8(A);c!=null?P(c,b):b.writeUint8(q);P(f,b)}}function Q(a,b){if(a.tag===void 0){b.writeUint8(y);b.writeUint8(q);return}var c=1;a.attrs&&(c+=Object.keys(a.attrs).length*2);a.content&&c++;c<256?(b.writeUint8(y),b.writeUint8(c)):c<65536&&(b.writeUint8(z),b.writeUint16(c));P(a.tag,b);a.attrs&&Object.keys(a.attrs).forEach(function(c){U(c,b),P(a.attrs[c],b)});c=a.content;if(Array.isArray(c)){c.length<256?(b.writeUint8(y),b.writeUint8(c.length)):c.length<65536&&(b.writeUint8(z),b.writeUint16(c.length));for(var d=0;d<c.length;d++)Q(c[d],b)}else c&&P(c,b)}var R,S;function T(a){var b=new Map();for(var c=0;c<a.length;c++)b.set(a[c],c);return b}function U(a,b){if(a===""){b.writeUint8(C);b.writeUint8(0);return}R==null&&(R=T(d("WAWapDict").SINGLE_BYTE_TOKEN));var c=R.get(a);if(c!=null){b.writeUint8(c+1);return}if(S==null){S=[];for(c=0;c<d("WAWapDict").DICTIONARIES.length;++c)S.push(T(d("WAWapDict").DICTIONARIES[c]))}for(c=0;c<S.length;++c){var e=S[c].get(a);if(e!=null){b.writeUint8(ca[c]);b.writeUint8(e);return}}e=d("WABinary").numUtf8Bytes(a);if(e<128){c=/[^0-9.-]+?/;var f=/[^0-9A-F]+?/;if(!c.exec(a)){V(a,F,b);return}else if(!f.exec(a)){V(a,B,b);return}}ka(e,b);b.writeString(a)}function V(a,b,d){var e=a.length%2===1;d.writeUint8(b);var f=Math.ceil(a.length/2);e&&(f|=ba);d.writeUint8(f);e=0;for(f=0;f<a.length;f++){var g=a.charCodeAt(f),h=null;48<=g&&g<=57?h=g-48:b===F?g===45?h=10:g===46&&(h=11):b===B&&(65<=g&&g<=70&&(h=g-55));if(h==null)throw c("WAErr")("Cannot nibble encode "+g);else f%2===0?(e=h<<4,f===a.length-1&&(e|=15,d.writeUint8(e))):(e|=h,d.writeUint8(e))}}function ja(a,b){ka(a.length,b),b.writeByteArray(a)}function ka(a,b){if(a<256)b.writeUint8(C),b.writeUint8(a);else if(a<1048576)b.writeUint8(D),b.writeUint8(a>>>16&255),b.writeUint8(a>>>8&255),b.writeUint8(a&255);else if(a<4294967296)b.writeUint8(E),b.writeUint32(a);else throw c("WAErr")("Binary with length "+a+" is too big for WAP protocol")}function la(a,b){a=new(d("WABinary").Binary)(a);var c=a.readUint8();c=c&p;if(c){d("WALogger").LOG(k());return b(a.readByteArray()).then(function(a){return X(new(d("WABinary").Binary)(a))})}return Promise.resolve(X(a))}function ma(a){a=new(d("WABinary").Binary)(a);var b=a.readUint8();b=b&p;if(b)throw c("WAErr")("Cannot pass compressed stanza to decodeStanzaDebug");return X(a)}function W(a,b){var e=a.readUint8();if(e===q)return null;if(e===y)return na(a,a.readUint8());if(e===z)return na(a,a.readUint16());if(e===C){var f=a.readUint8();return Z(a,f,b)}if(e===D){f=a.readUint8();var g=a.readUint8(),h=a.readUint8();f=((f&15)<<16)+(g<<8)+h;return Z(a,f,b)}if(e===E){g=a.readUint32();return Z(a,g,b)}if(e===A)return pa(a);if(e===w)return qa(a);if(e===v)return ra(a);if(e===x)return sa(a);if(e===F){h=a.readUint8();f=h>>>7;g=h&127;return ta(a,da,f,g)}if(e===B){b=a.readUint8();h=b>>>7;f=b&127;return ta(a,ea,h,f)}if(e<=0||e>=240)throw c("WAErr")("Unable to decode WAP buffer");if(e>=r&&e<=u){g=e-r;b=d("WAWapDict").DICTIONARIES[g];if(b===void 0)throw c("WAErr")("Missing WAP dictionary "+g);h=a.readUint8();f=b[h];if(f===void 0)throw c("WAErr")("Invalid value index "+h+" in dict "+g);return f}a=d("WAWapDict").SINGLE_BYTE_TOKEN[e-1];if(a===void 0)throw c("WAErr")("Undefined token with index "+e);return a}function na(a,b){var c=[];for(var d=0;d<b;d++)c.push(X(a));return c}function X(a){var b=a.readUint8(),e;if(b===y)e=a.readUint8();else if(b===z)e=a.readUint16();else throw c("WAErr")("Failed to decode node since type byte "+String(b)+" is invalid");b=void 0;var f=null;if(e===0)throw c("WAErr")("Failed to decode node, list cannot be empty");var g=Y(a);e-=1;while(e>1){b||(b={});var h=Y(a),i=W(a,!0);b[h]=i;e-=2}e===1&&(f=W(a,!1),f instanceof d("WAWapJid").WapJid&&(f=String(f)),typeof f==="string"&&(f=ga.encode(f)));return new N(g,b,f)}function Y(a){a=W(a,!0);if(typeof a!=="string"){d("WALogger").DEV(j(),String(a));throw c("WAErr")("WAWap:decodeString got invalid value, string expected")}return a}function oa(a){a=W(a,!0);if(a!=null&&typeof a!=="string"){d("WALogger").DEV(i(),String(a));throw c("WAErr")("WAWap:decodeNullableString got invalid value, string expected")}return a}function pa(a){var b=oa(a);a=Y(a);return d("WAWapJid").WapJid.create(b,a)}function qa(a){var b=Y(a),c=a.readUint16();Y(a);return d("WAWapJid").WapJid.createFbJid(b,c)}function ra(a){var b=Y(a),c=a.readUint16(),e=a.readUint16();Y(a);return d("WAWapJid").WapJid.createInteropJid(b,c,e)}function sa(a){var b=null,e=a.readUint8();if(e===0)b=d("WAWapJid").DomainType.WHATSAPP;else if(e===1)b=d("WAWapJid").DomainType.LID;else throw c("WAErr")("decodeJidU - Invalid domain type encoding "+e);e=a.readUint8();a=Y(a);return d("WAWapJid").WapJid.createJidU(a,b,e)}function Z(a,b,c){c===void 0&&(c=!1);if(c)return a.readString(b);else return a.readByteArray(b)}function ta(a,b,c,d){d=new Array(d*2-c);for(var e=0;e<d.length-1;e+=2){var f=a.readUint8();d[e]=b[f>>>4];d[e+1]=b[f&15]}if(c){f=a.readUint8();d[d.length-1]=b[f>>>4]}return d.join("")}function ua(){if(!G){var a=new Uint16Array(2);d("WACryptoDependencies").getCrypto().getRandomValues(a);G=String(a[0])+"."+String(a[1])+"-"}return""+G+fa++}function va(a){switch(a.type){case"group":return a.groupJid;case"status":return d("WAJids").STATUS_JID;case"device":return a.deviceJid;case"newsletter":return a.newsletterJid;case"hosted":return a.hostedDeviceJid;case"hostedLid":return a.hostedLidDeviceJid;default:a.type;return a.broadcastJid}}function wa(a){switch(a.type){case"group":return a.author;case"status":return a.author;case"broadcast":return a.author;default:a.type;return null}}function xa(a){return a.type==="status"||a.type==="group"||a.type==="broadcast"?$(a.author):H}function ya(a){return $(va(a))}function $(a){var b=d("WAJids").validateDomainJid(a);if(b!=null)return za(b);b=a.split("@");a=b[0];b=b[1];var e=null;if((b===aa||b===l||b===n||b===m||b===o||b===d("WAJids").HOSTED_LID_SUFFIX)&&a.indexOf(":")!==-1){var f=a.split(":");a=f[0];f=f[1];e=parseInt(f,10)}if(b===n){f=a.split("-");var g=f[0];f=f[1];return d("WAWapJid").WapJid.createInteropJid(f,e,parseInt(g,10))}else if(b===l)return d("WAWapJid").WapJid.createFbJid(a,e);f=null;if(b===m)f=d("WAWapJid").DomainType.LID;else if(b===o){throw c("WAErr")("wid invalid env");if(e!==99)throw c("WAErr")("wid unexpected deviceId");domainType=d("WAWapJid").DomainType.HOSTED}else if(b===d("WAJids").HOSTED_LID_SUFFIX){throw c("WAErr")("lid invalid env");if(e!==99)throw c("WAErr")("lid invalid deviceId");domainType=d("WAWapJid").DomainType.HOSTED_LID}else f=d("WAWapJid").DomainType.WHATSAPP;return e!=null&&e!==0?d("WAWapJid").WapJid.createJidU(a,f,e):d("WAWapJid").WapJid.create(a,b)}function za(a){if(a==="s.whatsapp.net")return J;else if(a==="g.us")return I;else if(a==="newsletter")return K;else return c("WAAssertUnreachable")(a)}function Aa(a){return $(a)}function Ba(a){return $(a)}function Ca(a){return $(a)}function Da(a){return $(a)}function Ea(a){return $(a)}function Fa(a){return $(a)}function Ga(a){if(a.jidType==="phoneDevice")return $(a.deviceJid);else if(a.jidType==="msgrDevice")return $(a.deviceJid);else if(a.jidType==="lidDevice")return $(a.deviceJid);else if(a.jidType==="phoneUser")return $(a.userJid);else if(a.jidType==="msgrUser")return $(a.userJid);else if(a.jidType==="lidUser")return $(a.userJid);else if(a.jidType==="group")return $(a.groupJid);else if(a.jidType==="status")return $(a.statusJid);else if(a.jidType==="call")return $(a.callJid);else if(a.jidType==="interopDevice")return $(a.deviceJid);else if(a.jidType==="interopUser")return $(a.userJid);else if(a.jidType==="newsletter")return $(a.newsletterJid);else if(a.jidType==="hosted")return $(a.hostedDeviceJid);else if(a.jidType==="hostedLid")return $(a.hostedLidDeviceJid);else{a.jidType;return $(a.broadcastJid)}}function Ha(a){return a}function Ia(a){return a.toString()}function Ja(a){return a}function Ka(a){return a==null?H:a}function La(a){return a.toString()}function Ma(a){return d("WALongInt").longIntToDecimalString(a)}function Na(a,b){b===void 0&&(b=4);a=a;var c=new Uint8Array(b);for(b=b-1;b>=0;b--)c[b]=a&255,a>>>=8;return c}g.DROP_ATTR=H;g.G_US=I;g.S_WHATSAPP_NET=J;g.STATUS_BROADCAST=t;g.NEWSLETTER=K;g.HOSTED=h;g.HOSTED_LID=s;g.enableXMLFormat=a;g.WapNode=N;g.makeWapNode=b;g.wap=ha;g.decodeAsString=e;g.makeStanza=O;g.encodeStanza=f;g.decodeStanza=la;g.decodeStanzaDebug=ma;g.generateId=ua;g.extractToJid=va;g.extractParticipantJid=wa;g.PARTICIPANT_JID=xa;g.TO_JID=ya;g.JID=$;g.DOMAIN_JID=za;g.USER_JID=Aa;g.DEVICE_JID=Ba;g.GROUP_JID=Ca;g.BROADCAST_JID=Da;g.CALL_JID=Ea;g.NEWSLETTER_JID=Fa;g.TO_WAP_JID=Ga;g.STANZA_ID=Ha;g.SMAX_ID=Ia;g.CUSTOM_STRING=Ja;g.MAYBE_CUSTOM_STRING=Ka;g.INT=La;g.LONG_INT=Ma;g.BIG_ENDIAN_CONTENT=Na}),98);
__d("WAParsableWapNode",["WABinary","WAErr","WAJids","WALogger","WALongInt","WAParsableXmlNode","WASignalKeys","WATimeUtils","WAWap","WAWapJid"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["ParsableWapNode: attrFromJid() is called with ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["ParsableWapNode: attrFromJid() is called with ",""]);i=function(){return a};return a}var j=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c){var d;d=b.call(this,"XmppParsingFailure: "+a+": "+c)||this;d.name="XmppParsingFailure";d.parser=a;d.reason=c;return d}var c=a.prototype;c.toString=function(){return"XmppParsingFailure: "+this.parser+": "+this.reason};return a}(babelHelpers.wrapNativeSuper(Error));a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c){return a.call(this,b,c)||this}var e=b.prototype;e.assertFromServer=function(){var a=this.attrString("from");a!==d("WAJids").WA_SERVER_JID_SUFFIX&&this["throw"]('to have "from"="s.whatsapp.net", but instead has "'+a+'"')};e.attrUserJid=function(a){var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);return c.userJid==null?this["throw"]('to have "'+a+'"={UserJid}, but instead has "'+b+'"'):c.userJid};e.attrPhoneUserJid=function(a){var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);return c.jidType==="phoneUser"?c.userJid:this["throw"]('to have "'+a+'"={PhoneUserJid}, but instead has "'+b+'"')};e.attrLidUserJid=function(a){var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);return c.jidType==="lidUser"?c.userJid:this["throw"]('to have "'+a+'"={LidUserJid}, but instead has "'+b+'"')};e.maybeAttrUserJid=function(a){return this.hasAttr(a)?this.attrUserJid(a):null};e.maybeAttrPhoneUserJid=function(a){return this.hasAttr(a)?this.attrPhoneUserJid(a):null};e.maybeAttrLidUserJid=function(a){return this.hasAttr(a)?this.attrLidUserJid(a):null};e.attrGroupJid=function(a){var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);return c.groupJid==null?this["throw"]('to have "'+a+'"={GroupJid}, but instead has "'+b+'"'):c.groupJid};e.maybeAttrGroupJid=function(a){return this.hasAttr(a)?this.attrGroupJid(a):null};e.attrChatJid=function(a){var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);if(c.userJid!=null)return c.userJid;return c.groupJid!=null?c.groupJid:this["throw"]('to have "'+a+'"={ChatJid}, but instead has "'+b+'"')};e.attrPhoneChatJid=function(a){var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);if(c.jidType==="phoneUser")return c.userJid;else if(c.jidType==="group")return c.groupJid;else return this["throw"]('to have "'+a+'"={ChatJid}, but instead has "'+b+'"')};e.attrDeviceJid=function(a){var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);if(c.deviceJid!=null)return c.deviceJid;return c.userJid!=null?d("WAJids").defaultDeviceJidForUser(c.userJid):this["throw"]('to have "'+a+'"={DeviceJid}, but instead has "'+b+'"')};e.attrPhoneDeviceJid=function(a){var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);if(c.jidType==="phoneDevice")return c.deviceJid;return c.jidType==="phoneUser"?d("WAJids").defaultPhoneDeviceJidForUser(c.userJid):this["throw"]('to have "'+a+'"={PhoneDeviceJid}, but instead has "'+b+'"')};e.attrLidDeviceJid=function(a){var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);if(c.jidType==="lidDevice")return c.deviceJid;return c.jidType==="lidUser"?d("WAJids").defaultLidDeviceJidForLidUserJid(c.userJid):this["throw"]('to have "'+a+'"={LidDeviceJid}, but instead has "'+b+'"')};e.attrDeviceId=function(a){a=this.attrInt(a);return d("WAJids").interpretAsDeviceId(a)};e.attrFromJidChat=function(){var a=this.attrJidWithType();switch(a.jidType){case"msgrUser":var b=a.userJid,e=d("WAJids").defaultDeviceJidForUser(b);return{type:"device",chat:b,deviceJid:e,author:e};case"interopUser":b=a.userJid;e=d("WAJids").defaultDeviceJidForUser(b);return{type:"device",chat:b,deviceJid:e,author:e};case"phoneUser":b=a.userJid;e=d("WAJids").defaultDeviceJidForUser(b);return{type:"device",chat:b,deviceJid:e,author:e};case"lidUser":b=a.userJid;e=d("WAJids").defaultLidDeviceJidForLidUserJid(b);return{type:"device",chat:b,deviceJid:e,author:e};case"phoneDevice":b=a.deviceJid;return{type:"device",chat:d("WAJids").extractUserJid(b),deviceJid:b,author:b};case"msgrDevice":e=a.deviceJid;return{type:"device",chat:d("WAJids").extractUserJid(e),deviceJid:e,author:e};case"interopDevice":b=a.deviceJid;return{type:"device",chat:d("WAJids").extractUserJid(b),deviceJid:b,author:b};case"lidDevice":e=a.deviceJid;return{type:"device",chat:d("WAJids").extractUserJid(e),deviceJid:e,author:e};case"group":b=this.hasAttr("participant")?this.attrDeviceJid("participant"):null;return b==null?this["throw"]("expected to have participant JID for group"):{type:"group",chat:a.groupJid,groupJid:a.groupJid,author:b};case"broadcast":e=this.hasAttr("participant")?this.attrDeviceJid("participant"):null;return e==null?this["throw"]("expected to have participant JID for group"):{type:"broadcast",broadcastJid:a.broadcastJid,chat:d("WAJids").extractUserJid(e),author:e};case"hosted":b=a.hostedDeviceJid;return{type:"device",chat:d("WAJids").extractUserJid(b),deviceJid:b,author:b};case"hostedLid":throw c("WAErr")("ParsableWapNode: unexpected env");case"call":d("WALogger").ERROR(i(),a.callJid);throw c("WAErr")("ParsableWapNode: attrFromJid() does not support CallJid");default:a.jidType;return this["throw"]("attrFromJidChat should not be used with jid of type "+a.jidType)}};e.attrFromJidPhoneChat=function(){var a=this.attrJidWithType();switch(a.jidType){case"phoneUser":var b=a.userJid,e=d("WAJids").defaultPhoneDeviceJidForUser(b);return{type:"device",chat:b,deviceJid:e,author:e};case"phoneDevice":b=a.deviceJid;return{type:"device",chat:d("WAJids").extractPhoneUserJid(b),deviceJid:b,author:b};case"group":e=this.hasAttr("participant")?this.attrPhoneDeviceJid("participant"):null;return e==null?this["throw"]("expected to have participant JID for group"):{type:"group",chat:a.groupJid,groupJid:a.groupJid,author:e};case"broadcast":b=this.hasAttr("participant")?this.attrPhoneDeviceJid("participant"):null;return b==null?this["throw"]("expected to have participant JID for group"):{type:"broadcast",broadcastJid:a.broadcastJid,chat:d("WAJids").extractPhoneUserJid(b),author:b};case"call":d("WALogger").ERROR(h(),a.callJid);throw c("WAErr")("ParsableWapNode: attrFromJid() does not support CallJid");default:a.jidType;return this["throw"]("attrFromJidChat should not be used with jid of type "+a.jidType)}};e.attrFromPhoneJid=function(){var a=this.attrJidWithType();if(a.jidType==="status"){a=this.hasAttr("participant")?this.attrPhoneDeviceJid("participant"):null;return a==null?this["throw"]("to have participant for status msg"):{type:"status",author:a}}else return this.attrFromJidPhoneChat()};e.attrFromJid=function(){var a=this.attrJidWithType();if(a.jidType==="status"){var b=this.hasAttr("participant")?this.attrPhoneDeviceJid("participant"):null;return b==null?this["throw"]("to have participant for status msg"):{type:"status",author:b}}if(a.jidType==="newsletter")return{type:"newsletter",newsletterJid:a.newsletterJid};return a.jidType==="hosted"?{type:"hosted",hostedDeviceJid:a.hostedDeviceJid}:this.attrFromJidChat()};e.attrJidWithType=function(a){a===void 0&&(a="from");var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);return c.jidType==="unknown"?this["throw"]('to have "'+a+'"={Jid}, but instead has "'+b+'"'):c};e.attrWapJid=function(a){a===void 0&&(a="from");a=this.attrString(a);var b=d("WAJids").interpretAndValidateJid(a);return b.jidType==="unknown"?d("WAWapJid").WapJid.create(null,a):d("WAWap").JID(d("WAJids").extractFromJid(b))};e.attrLongInt=function(a){a=this.attrString(a);return d("WALongInt").decimalStringToLongInt(a)};e.attrTime=function(a){return d("WATimeUtils").castToUnixTime(this.attrInt(a))};e.attrFutureTime=function(a){a=this.attrInt(a);return d("WATimeUtils").futureUnixTime(a)};e.contentString=function(){if(this.hasChildren())return this["throw"]("to have string content, but has children instead");else if(this.hasContent()){var a=new(d("WABinary").Binary)(this.contentBytes());return a.readString(a.size())}else return this["throw"]("to have content")};e.decodeAsString=function(a){return d("WAWap").decodeAsString(a)};e.contentSerializedPubKey=function(){if(this.hasContent())return d("WASignalKeys").serializeIdentity(this.contentBytes());else return this["throw"]("to have content")};e.createParseError=function(a){return new j(this.name(),"expected <"+this.tag()+"> "+a)};e["throw"]=function(a){throw this.createParseError(a)};return b}(d("WAParsableXmlNode").ParsableXmlNode);g.XmppParsingFailure=j;g.ParsableWapNode=a}),98);
__d("WADeprecatedWapParser",["WAErr","WAParsableWapNode"],(function(a,b,c,d,e,f,g){a=function(){function a(a,b){this.$1=a,this.$2=b}var b=a.prototype;b.parse=function(a){a=new(d("WAParsableWapNode").ParsableWapNode)(this.$1,a);try{return{success:this.$2(a)}}catch(a){if(a instanceof d("WAParsableWapNode").XmppParsingFailure)return{error:a};else throw a}};b.parseOrThrow=function(a){a=this.parse(a);if(a.error)throw c("WAErr")(String(a.error));return a.success};return a}();g["default"]=a}),98);
__d("WAAckParser",["WADeprecatedWapParser","WAJids"],(function(a,b,c,d,e,f,g){b=new(c("WADeprecatedWapParser"))("ack",function(a){a.assertTag("ack");return{id:a.attrString("id"),ts:a.maybeAttrString("t"),"class":a.attrString("class"),type:a.maybeAttrString("type"),from:a.attrJidWithType(),participant:a.hasAttr("participant")?a.attrDeviceJid("participant"):null,recipient:a.hasAttr("recipient")?a.attrUserJid("recipient"):null}});function a(a,b){return a.id===b.id&&(b["class"]===void 0||a["class"]===b["class"])&&(b.type===void 0||a.type===b.type)&&(b.from===void 0||h(a.from,b.from))&&(b.participant===void 0||a.participant===b.participant)&&(b.recipient===void 0||a.recipient===b.recipient)&&(b.ts===void 0||a.ts===b.ts)}function h(a,b){if(d("WAJids").extractFromJid(a)===b)return!0;if(a.userJid!=null)return d("WAJids").defaultDeviceJidForUser(a.userJid)===b;if(a.deviceJid!=null){a=a.deviceJid;return d("WAJids").extractDeviceId(a)===0&&d("WAJids").extractUserJid(a)===b}return!1}g.AckParser=b;g.ackMatchesTemplate=a;g.fromJidsAreEqual=h}),98);
__d("WAArrayUtils",["regeneratorRuntime"],(function(a,b,c,d,e,f){var g=b("regeneratorRuntime").mark(c);function a(a,b){var c=a.pop();b<a.length&&(a[b]=c)}function c(a,c){var d;return b("regeneratorRuntime").wrap(function(b){while(1)switch(b.prev=b.next){case 0:d=0;case 1:if(!(d<a.length)){b.next=7;break}b.next=4;return a.slice(d,d+c);case 4:d+=c;b.next=1;break;case 7:case"end":return b.stop()}},g,this)}f.removeIndexWithoutPreservingOrder=a;f.peekEvery=c}),66);
__d("WAErrors",["WACustomError"],(function(a,b,c,d,e,f,g){b=(a=d("WACustomError")).customError("BufferTooLarge",!1);c=a.customError("Disconnected",!1);e=a.customError("Offline",!1,c);f=a.customError("MaxRetries",!1);g.BufferTooLargeError=b;g.Disconnected=c;g.Offline=e;g.MaxRetries=f}),98);
__d("WANotifyConnectionChangeFactory",[],(function(a,b,c,d,e,f){var g=15e3;function a(a,b,c){c===void 0&&(c=g);var d={timeoutID:null,connectionStatus:"disconnected",optimismLevel:"optimist"},e=function(){var a=d.optimismLevel,e=d.connectionStatus;a==="optimist"?d.timeoutID=setTimeout(function(){d.optimismLevel="realist",b(e)},c):b(e)};return function(c){d.connectionStatus=c,c==="disconnected"?e():c==="in_handshake"?e():(c,d.timeoutID!=null&&(clearTimeout(d.timeoutID),d.timeoutID=null),b(c)),a(c)}}f.notifyConnectionChangeFactory=a}),66);
__d("WASmaxInPingsEnums",["WAJids"],(function(a,b,c,d,e,f,g){a={validators:[d("WAJids").validateDomainJid,d("WAJids").validateUserJid],typeName:"DomainJid|UserJid"};g.DOMAINJID_USERJID=a}),98);
__d("WADeepEquals",[],(function(a,b,c,d,e,f){function g(a,b){if(a===b)return!0;if(!a||!b||typeof a!=="object"&&typeof b!=="object")return!1;var c=Array.isArray(a),d=Array.isArray(b);if(c!==d)return!1;d=!0;if(c){c=a.length;if(c!==b.length)return!1;for(var e=0;d&&e<c;e++)d=g(a[e],b[e]);return d}c=Object.keys(a);for(e=0;d&&e<c.length;e++){var f=c[e];d=b.propertyIsEnumerable(f)&&g(a[f],b[f])}return d&&Object.keys(b).length===c.length}f.deepEqual=g}),66);
__d("WASmaxParseUtils",["WABase64","WABinary","WACryptoUtils","WADeepEquals","WAHasProperty","WAResultOrError","WAStanzaUtils","WAWapJid"],(function(a,b,c,d,e,f,g){var h=d("WAResultOrError").makeResult();function a(a,b){return a.tag!==b?H(a,"to be <"+b+">"):h}function i(a,b){return!I(a,b)?H(a,'to have attribute "'+b+'"'):J(a,a.attrs[b])}function j(a,b,c,e){var f=i(a,b);if(!f.success)return f;c=c(f.value);return c!=null?d("WAResultOrError").makeResult(c):H(a,'to have "'+b+'"={'+e+'}, but instead has "'+f.value+'"')}function k(a,b,c){var e=B(a);if(!e.success)return e;b=b(e.value);return b!=null?d("WAResultOrError").makeResult(b):H(a,"to have "+c+' content, but instead has "'+e.value+'"')}function b(a,b,c){var d=i(a,b);if(!d.success)return d;else if(d.value!==c)return H(a,'to have "'+b+'"="'+c+'", but instead has "'+d.value+'"');return h}function e(a,b){return j(a,b,d("WAStanzaUtils").toStanzaId,"stanzaID")}function l(a,b){return j(a,b,K,"integer")}function f(a,b,c,e){var f=l(a,b);if(!f.success)return f;f=f.value;if(c!==void 0&&f<c)return H(a,'to have "'+b+'"={at least '+c+"} but has value "+f);else if(e!==void 0&&f>e)return H(a,'to have "'+b+'"={at most '+e+"} but has value "+f);return d("WAResultOrError").makeResult(f)}function m(a){var b=a.content;return b instanceof Uint8Array?H(a,"to have children"):d("WAResultOrError").makeResult(b)}function n(a,b){var c=m(a);if(!c.success)return c;c=c.value;if(c==null)return h;var e=null;for(var f=0;f<c.length;f++){var g=c[f];if(g.tag===b){if(e!=null)return H(a,"to have 1 child <"+b+">, but found more than 1");e=g}}return d("WAResultOrError").makeResult(e)}function o(a,b,c){a=n(a,b);if(!a.success)return a;return a.value==null?h:c(a.value)}function p(a,b,c){c=o(a,b,c);if(!c.success)return c;c=c.value;return c==null?H(a,"to have 1 child <"+b+">, but found 0"):d("WAResultOrError").makeResult(c)}function q(a,b){var c=n(a,b);if(!c.success)return c;return c.value==null?H(a,"to have 1 child <"+b+">, but found 0"):d("WAResultOrError").makeResult(c.value)}function r(a,b,c,e,f){a=L(a,b,c,e);if(!a.success)return a;b=[];for(c=0;c<a.value.length;c++){e=f(a.value[c]);if(!e.success)return e;b.push(e.value)}return d("WAResultOrError").makeResult(b)}function s(a,b,c,e,f){a=L(a,b,c,e);if(!a.success)return a;b=a.value.length;for(c=0;c<b;c++){e=f(a.value[c]);if(!e.success)return e}return d("WAResultOrError").makeResult(b)}function t(a,b,c){b=r(a,b,0,Infinity,c);if(!b.success)return b;for(c=0;c<b.value.length;c++)if(!d("WADeepEquals").deepEqual(b.value[0],b.value[c]))return H(a,"to have homogeneous children, but found two children that are not equal");return b}function u(a,b,c){a=t(a,b,c);return!a.success?a:d("WAResultOrError").makeResult(a.value.length)}function v(a,b,c,d,e){return I(b,c)?a(b,c,d,e):h}function w(a,b,c,e){if(e==null)return h;a=v(a,b,c);if(!a.success)return a;if(a.value===e)return d("WAResultOrError").makeResult(e);return a.value==null?h:H(b,'to have "'+c+'"={'+e+'}, but instead has "'+a.value+'"')}function x(a,b,c,e){a=a(b,c);if(!a.success)return a;return a.value===e?d("WAResultOrError").makeResult(e):H(b,'to have "'+c+'"={'+e+'}, but instead has "'+a.value+'"')}function y(a,b,c){a=a(b);if(!a.success)return a;return a.value===c?d("WAResultOrError").makeResult(c):H(b,'to have content "'+c+'", but instead has "'+a.value+'"')}function z(a,b,c){var e=i(a,b);if(!e.success)return e;var f=c[e.value];if(f!=null)return d("WAResultOrError").makeResult(f);f=Object.values(c).join("|");return H(a,'to have "'+b+'"={'+f+'}, but instead has "'+e.value+'"')}function A(a,b){var c=B(a);if(!c.success)return c;var e=b[c.value];if(e!=null)return d("WAResultOrError").makeResult(e);e=Object.values(b).join("|");return H(a,'to have content "'+e+'", but instead has "'+c.value+'"')}function B(a){var b=C(a);if(!b.success)return b;else try{b=new(d("WABinary").Binary)(b.value);b=b.readString(b.size());return d("WAResultOrError").makeResult(b)}catch(b){return H(a,"to have string content, but run into decoding error: "+b.message)}}function C(a){var b=a.content;if(b==null)return H(a,"to have content");else if(Array.isArray(b))return H(a,"to have content, but has children instead");else return d("WAResultOrError").makeResult(b)}function D(a,b){var c=C(a);if(!c.success)return c;return d("WACryptoUtils").uint8ArraysEqual(c.value,b)?d("WAResultOrError").makeResult(b):H(a,'to have content ":binary:'+d("WABase64").encodeB64(b)+'", but instead has ":binary:'+d("WABase64").encodeB64(c.value)+'"')}function E(a,b,c){var e=C(a);if(!e.success)return e;var f=e.value.length;if(b!==void 0&&f<b)return H(a,"to have binary content at least "+b+" bytes but has "+f+" bytes");else if(c!==void 0&&f>c)return H(a,"to have binary content at most "+c+" bytes but has "+f+" bytes");return d("WAResultOrError").makeResult(e.value)}function F(a){return k(a,K,"integer")}function G(a){return a}function H(a,b){return d("WAResultOrError").makeError("expected <"+a.tag+">: "+b)}function I(a,b){return c("WAHasProperty")(a.attrs,b)}function J(a,b){if(b instanceof d("WAWapJid").WapJid)return d("WAResultOrError").makeResult(b.toString());return typeof b==="string"?d("WAResultOrError").makeResult(b):H(a,"decodeAsString: attribute is "+typeof b+" not a string: "+String(b))}function K(a){a=parseInt(a,10);return Number.isNaN(a)?null:a}function L(a,b,c,e){var f=m(a);if(!f.success)return f;f=f.value;if(f==null)if(c!==0)return H(a,"to have at least "+c+" <"+b+"> children, but found 0");else return d("WAResultOrError").makeResult([]);var g=[];for(var h=0;h<f.length;h++){var i=f[h];i.tag===b&&g.push(i)}i=g.length;if(i<c)return H(a,"to have at least "+c+" <"+b+"> children, but found "+i);else if(i>e)return H(a,"to have at most "+e+" <"+b+"> children, but found "+i);return d("WAResultOrError").makeResult(g)}var M={};function N(a,b,c){var d=b.map(function(a,b){return a+": "+c[b].error});return H(a,["to match any of following mixins: "+b.join(", ")+", but all mixins failed."].concat(d).join(" "))}g.voidSuccess=h;g.assertTag=a;g.attrString=i;g.attrValidate=j;g.contentValidate=k;g.assertAttr=b;g.attrStanzaId=e;g.attrInt=l;g.attrIntRange=f;g.maybeChildren=m;g.optionalChild=n;g.optionalChildWithTag=o;g.childWithTag=p;g.flattenedChildWithTag=q;g.mapChildrenWithTag=r;g.countChildrenWithTag=s;g.mapHomogeneousChildrenWithTag=t;g.countHomogeneousChildrenWithTag=u;g.optional=v;g.optionalLiteral=w;g.literal=x;g.literalContent=y;g.attrStringEnum=z;g.contentStringEnum=A;g.contentString=B;g.contentBytes=C;g.contentLiteralBytes=D;g.contentBytesRange=E;g.contentInt=F;g.identity=G;g.errorMessage=H;g.emptyObject=M;g.errorMixinDisjunction=N}),98);
__d("WASmaxParseJid",["WAJids","WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){return d("WASmaxParseUtils").attrValidate(a,b,d("WAJids").validateUserJid,"UserJid")}function b(a,b){return d("WASmaxParseUtils").attrValidate(a,b,d("WAJids").validateDeviceJid,"DeviceJid")}function c(a,b){return d("WASmaxParseUtils").attrValidate(a,b,d("WAJids").validateGroupJid,"GroupJid")}function e(a,b){return d("WASmaxParseUtils").attrValidate(a,b,d("WAJids").validateCallJid,"CallJid")}function f(a,b){return d("WASmaxParseUtils").attrValidate(a,b,d("WAJids").validateDomainJid,"DomainJid")}function h(a,b){return d("WASmaxParseUtils").attrValidate(a,b,d("WAJids").validateBroadcastJid,"BroadcastJid")}function i(a,b){return d("WASmaxParseUtils").attrValidate(a,b,d("WAJids").validateStatusJid,"StatusJid")}function j(a,b){return d("WASmaxParseUtils").attrValidate(a,b,d("WAJids").validateNewsletterJid,"NewsletterJid")}function k(a,b,c){var e=d("WASmaxParseUtils").attrString(a,b);if(!e.success)return e;var f=c.validators;c=c.typeName;for(var g=0;g<f.length;g++){var h=f[g](e.value);if(h!=null)return d("WAResultOrError").makeResult(h)}return d("WASmaxParseUtils").errorMessage(a,'to have "'+b+'"={'+c+'}, but instead has "'+e.value+'"')}function l(a,b,c,e){a=a(b,c);if(!a.success)return a;return a.value===e?a:d("WASmaxParseUtils").errorMessage(b,'to have "'+c+'"={'+e+'}, but instead has "'+a.value+'"')}function m(a,b,c,e){a=d("WASmaxParseUtils").optional(a,b,c);if(!a.success)return a;return a.value==null||a.value===e?a:d("WASmaxParseUtils").errorMessage(b,'to have "'+c+'"={'+e+'}, but instead has "'+a.value+'"')}g.attrUserJid=a;g.attrDeviceJid=b;g.attrGroupJid=c;g.attrCallJid=e;g.attrDomainJid=f;g.attrBroadcastJid=h;g.attrStatusJid=i;g.attrNewsletterJid=j;g.attrJidEnum=k;g.literalJid=l;g.optionalLiteralJid=m}),98);
__d("WASmaxParseReference",["WAHasProperty","WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a,b,c,d,e){b=j(b,c);if(!b.success)return l(b);a=a(b.value,c[c.length-1],d,e);return!a.success?l(a):a}function a(a,b,c,e,f){return k(b,c)?h(a,b,c,e,f):d("WASmaxParseUtils").voidSuccess}function i(a,b){return h(d("WASmaxParseUtils").attrString,a,b)}function b(a,b){return k(a,b)?i(a,b):d("WASmaxParseUtils").voidSuccess}function e(a,b){a=j(a,b);if(!a.success)return l(a);b=d("WASmaxParseUtils").contentString(a.value);return!b.success?l(b):b}function j(a,b){var c=b.length;a=a;for(var e=0;e<c-1;e++){var f=b[e];f=d("WASmaxParseUtils").flattenedChildWithTag(a,f);if(!f.success)return f;a=f.value}return d("WAResultOrError").makeResult(a)}function k(a,b){a=j(a,b);return a.success&&c("WAHasProperty")(a.value.attrs,b[b.length-1])}function l(a){return d("WAResultOrError").makeError("in the reference, "+a.error)}g.attrFromReference=h;g.optionalAttrFromReference=a;g.attrStringFromReference=i;g.optionalAttrStringFromReference=b;g.contentStringFromReference=e}),98);
__d("WASmaxInPingsClientResponseServerResponse",["WAResultOrError","WASmaxInPingsEnums","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseJid").attrJidEnum(a,"from",d("WASmaxInPingsEnums").DOMAINJID_USERJID);if(!c.success)return c;var e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");if(!e.success)return e;b=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",b.value);if(!b.success)return b;b=d("WASmaxParseUtils").attrInt(a,"t");return!b.success?b:d("WAResultOrError").makeResult({from:c.value,type:e.value,t:b.value})}g.parseClientResponseServerResponse=a}),98);
__d("WASmaxJsx",["WAWap"],(function(a,b,c,d,e,f,g){g.smax=d("WAWap").wap}),98);
__d("WASmaxMixins",["WAArrayBufferUtils","WAWapJid"],(function(a,b,c,d,e,f,g){var h="smax$any";function i(a,b){j(a,b);k(a,b);b.content instanceof Uint8Array?m(a,b.content):b.content!=null&&n(a,b.content);return a}function a(a,b,c,d){return c!=null?a(b,c,d):b}function j(a,b){a=a.tag;b=b.tag;if(b===h)return;if(a!==b)throw new Error("tag mismatch: "+a+" != "+b)}function k(a,b){var c=a.attrs,d=b.attrs;Object.keys(d).forEach(function(a){var b=d[a],e=c[a];if(b!=null&&e!=null){if(l(b,e))return;throw new Error("conflict for key: "+a)}c[a]=b})}function l(a,b){if(typeof a==="string"&&typeof b==="string")return a===b;return a instanceof d("WAWapJid").WapJid&&b instanceof d("WAWapJid").WapJid?a.toString()===b.toString():!1}function m(a,b){var c=a.content;if(c instanceof Uint8Array){if(!d("WAArrayBufferUtils").uint8ArraysEqualUNSAFE(c,b))throw new Error("elementValue mismatch: bytes dose not equal");return}if(c!=null)throw new Error("elementValue mismatch: destination has children");a.content=b}function n(a,b){var c=a.content;if(c instanceof Uint8Array)throw new Error("children mismatch: destination has element value");if(c==null||c.length===0){a.content=b;return}if(!o(c,b))throw new Error("children mismatch: child counts are not compatible");var d=[],e=Array.from(c);b.forEach(function(a){var b=e.findIndex(function(b){return b.tag===a.tag});if(b===-1)d.push(a);else{b=e.splice(b,1);b=i(b[0],a);d.push(b)}});e.forEach(function(a){return d.push(a)});a.content=d}function o(a,b){b=p(b);a=p(a);var c=Object.keys(b);for(var d=0;d<c.length;d++){var e=c[d],f=b[e];e=a[e];if(f!=null&&e!=null&&f!==e)return!1}return!0}function p(a){return a.reduce(function(a,b){b=b.tag;var c=a[b];a[b]=c==null?1:c+1;return a},{})}g.mergeStanzas=i;g.optionalMerge=a}),98);
__d("WASmaxOutPingsClientWellFormedToMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{to:d("WAWap").S_WHATSAPP_NET});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeClientWellFormedToMixin=a}),98);
__d("WASmaxOutPingsClientRequest",["WASmaxJsx","WASmaxOutPingsClientWellFormedToMixin","WAWap"],(function(a,b,c,d,e,f,g){function a(){var a=d("WASmaxOutPingsClientWellFormedToMixin").mergeClientWellFormedToMixin(d("WASmaxJsx").smax("iq",{id:d("WAWap").generateId(),type:"get",xmlns:"w:p"}));return a}g.makeClientRequest=a}),98);
__d("WAComms",["Promise","WAArrayUtils","WAErr","WAErrors","WALogger","WANotifyConnectionChangeFactory","WAPromiseRetryLoop","WAResolvable","WAResultOrError","WAShiftTimer","WASmaxInPingsClientResponseServerResponse","WASmaxOutPingsClientRequest","WASmaxParseUtils","WATimeUtils","WAWap","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms has no open socket"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["closeSocket called"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["socketLoopIteration failed ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["socketLoopIteration socket closed while in noise handshake"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["socketLoopIteration socket disconnected while in noise handshake"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["socketLoopIteration socket closed while in noise handshake using treasureHunt strategy"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms: Socket "," closed"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms: Socket "," opened"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms: Socket "," opening"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["closeSocketAndPreventRetry called"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleAck: unrecognized ",""]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms: job response is NO_ACK"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms: job response is CLOSE_SOCKET"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["--- Receiving ---\n",""],["--- Receiving ---\\n",""]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failure parsing stanza!"]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms.startHandlingRequests"]);x=function(){return a};return a}function y(){var a=babelHelpers.taggedTemplateLiteralLoose(["castStanza error ",""]);y=function(){return a};return a}function z(){var a=babelHelpers.taggedTemplateLiteralLoose(["castStanza async error ",""]);z=function(){return a};return a}function A(){var a=babelHelpers.taggedTemplateLiteralLoose(["--- Sending ---\n",""],["--- Sending ---\\n",""]);A=function(){return a};return a}function B(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error in onBeforeCastStanza, we consumed and continue with normal stanza sending to the server:\n",""],["Error in onBeforeCastStanza, we consumed and continue with normal stanza sending to the server:\\n",""]);B=function(){return a};return a}function C(){var a=babelHelpers.taggedTemplateLiteralLoose(["Dropping stanza since onBeforeCastStanza matched. We return mock response directly."]);C=function(){return a};return a}function D(){var a=babelHelpers.taggedTemplateLiteralLoose(["--- Receive (via SMAX+E2E) ---\n",""],["--- Receive (via SMAX+E2E) ---\\n",""]);D=function(){return a};return a}function E(){var a=babelHelpers.taggedTemplateLiteralLoose(["Dropping stanza since onBeforeCastStanza matched:\n",". We return mock response directly."],["Dropping stanza since onBeforeCastStanza matched:\\n",". We return mock response directly."]);E=function(){return a};return a}function F(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms has no open socket, will resend stanza when socket opens"]);F=function(){return a};return a}function G(){var a=babelHelpers.taggedTemplateLiteralLoose(["No stanzaId in ping request stanza"]);G=function(){return a};return a}function H(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendPing ping still pending"]);H=function(){return a};return a}function I(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendPing when socket dead"]);I=function(){return a};return a}function J(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms: Socket "," expired"]);J=function(){return a};return a}function K(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms: testing socket"]);K=function(){return a};return a}function L(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleIq no handler for iq"]);L=function(){return a};return a}function M(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleIq no handler for iq with id ",""]);M=function(){return a};return a}var N=null,O=null,P=1,Q=0,R=function(){function a(a,c,e){var f=this;this.nextSocketId=1;this.pendingIqs=new Map();this.ackHandlers=[];this.pendingSmaxStanzas=new Map();this.$2=new(d("WAResolvable").Resolvable)();this.socketAbortController=null;this.activePing=null;this.$3=new Set();this.socketId=Q;this.socket=null;this.softCloseSocket=null;this.handleStanza=function(a,b,c){var e=d("WASmaxParseUtils").attrString(a,"id");if(e.success&&a.tag!=="receipt"){e=e.value;var g=f.pendingSmaxStanzas.get(e);if(g){f.pendingSmaxStanzas["delete"](e);g.resolve(a);f.maybeScheduleHealthCheck();return"NO_ACK"}}e=$(a);if(e!=null){g=f.pendingIqs.get(e);g?(f.pendingIqs["delete"](e),g.resolve(a),f.maybeScheduleHealthCheck()):(d("WALogger").WARN(M(),e),d("WALogger").ERROR(L()))}else if(a.tag==="ack")f.handleAck(a);else return a.tag==="failure"&&f.config.shouldBlockReceivingUntilSuccess?f.$1(a,b,c):f.$2.promise.then(function(){return f.$1(a,b,c)});return"NO_ACK"};this.healthCheckTimer=new(d("WAShiftTimer").ShiftTimer)(function(){d("WALogger").DEV(K());if(!f.socketId)return;f.sendPing()});this.deadSocketTimer=new(d("WAShiftTimer").ShiftTimer)(function(a){d("WALogger").LOG(J(),a);if(a!==f.socketId)return;f.softCloseSocket&&f.softCloseSocket()});this.sendPing=function(){var a,c,e,f,g,i,j,k;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:a=Z("sendPing");if(a.socketId){l.next=4;break}d("WALogger").LOG(I());return l.abrupt("return",(h||(h=b("Promise"))).resolve());case 4:if(!(a.activePing&&a.activePing.socketId===a.socketId)){l.next=7;break}d("WALogger").LOG(H());return l.abrupt("return",(h||(h=b("Promise"))).resolve());case 7:a.activePing&&a.activePing.handler.resolve();c=d("WASmaxOutPingsClientRequest").makeClientRequest();e=c.attrs.id;if(!(typeof e!=="string")){l.next=13;break}d("WALogger").ERROR(G());return l.abrupt("return",(h||(h=b("Promise"))).resolve());case 13:f=new(d("WAResolvable").Resolvable)();a.activePing={socketId:a.socketId,stanzaId:e,handler:f};a.callStanza(c);l.next=18;return b("regeneratorRuntime").awrap(f.promise);case 18:g=l.sent,g&&(i=d("WASmaxInPingsClientResponseServerResponse").parseClientResponseServerResponse(g,c),i.success&&(j=d("WATimeUtils").castToUnixTime(i.value.t),k=Math.round(Date.now()/1e3-j),a.config.handlers.onClockSkewUpdate==null?void 0:a.config.handlers.onClockSkewUpdate(k)));case 20:case"end":return l.stop()}},null,this)};this.$1=a;this.onConnectionChange=d("WANotifyConnectionChangeFactory").notifyConnectionChangeFactory((a=c.handlers.onConnectionChange)!=null?a:function(){},(a=c.handlers.onOptimisticConnectionChange)!=null?a:function(){});this.gzipInflate=e;this.config=c;this.socketLoop=new(d("WAPromiseRetryLoop").PromiseRetryLoop)({name:"MainSocketLoop",code:X,timer:{jitter:.1,max:c.maxSocketLoopWaitTime,algo:{type:"fibonacci",first:1e4,second:1e4},relativeDelay:!0},resetDelay:3e4})}var e=a.prototype;e.filterPending=function(a){var b=[];function c(c){a(c)&&b.push(c)}this.pendingIqs.forEach(c);this.ackHandlers.forEach(c);this.pendingSmaxStanzas.forEach(c);return b};e.sendPendingStanza=function(a){a.cleanup==null?void 0:a.cleanup(),a.cleanup=void 0,this.callStanza(a.stanza)};e.maybeSendPendingStanza=function(a){if(a.attempt>=this.config.maxRetries)this.config.handlers.onDropStanza==null?void 0:this.config.handlers.onDropStanza(a),a.cleanup==null?void 0:a.cleanup(),a.cleanup=void 0,this.removeHandler(a,"max-retries");else if(this.socket){a.attempt+=1;this.sendPendingStanza(a);return}else d("WALogger").LOG(F())};e.callStanzaAsync=function(a,c){var d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(this.callStanza(a,c));case 2:d=e.sent;return e.abrupt("return",d);case 4:case"end":return e.stop()}},null,this)};e.callStanza=function(a,b){a=this.castStanza(a,b);this.deadSocketTimer.onOrBefore(this.config.deadSocketTime,this.socketId);this.healthCheckTimer.cancel();return a};e.castStanzaAsync=function(a){var c;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:d.next=2;return b("regeneratorRuntime").awrap(this.castStanza(a));case 2:c=d.sent;return d.abrupt("return",c);case 4:case"end":return d.stop()}},null,this)};e.castStanza=function(a,c){var e=this;try{var f=this.config.handlers.onBeforeCastStanzaForE2E==null?void 0:this.config.handlers.onBeforeCastStanzaForE2E(a,c);if(f!=null){d("WALogger").DEV_XMPP(E(),a);d("WALogger").DEV_XMPP(D(),f);d("WALogger").ERROR(C());if(Array.isArray(f))return(h||(h=b("Promise"))).all(f.map(function(a){return(h||(h=b("Promise"))).resolve(e.handleStanza(a,e.socketId,Q))}));else{this.handleStanza(f,this.socketId,Q);return(h||(h=b("Promise"))).resolve()}}}catch(a){d("WALogger").DEV_XMPP(B(),a)}f=this.socketOrThrow("castStanza");try{d("WALogger").DEV_XMPP(A(),a);return f.sendFrame(d("WAWap").encodeStanza(a)).then(function(){e.config.handlers.onCastStanza==null?void 0:e.config.handlers.onCastStanza(a,c)})["catch"](function(a){d("WALogger").ERROR(z(),a).devConsole(a);if(a instanceof d("WAErrors").BufferTooLargeError)return(h||(h=b("Promise"))).reject(a)})}catch(a){d("WALogger").ERROR(y(),a).devConsole(a)}return(h||(h=b("Promise"))).resolve()};e.socketOrThrow=function(a){var b=this.socket;if(b)return b;throw c("WAErr")("Comms."+a+" called while no socket")};e.startHandlingRequests=function(){d("WALogger").LOG(x());this.$2.resolve();return this.$2.promise.then(function(){})};e.parseAndHandleStanza=function(a,b){var c=this;a===this.socketId&&(this.deadSocketTimer.cancel(),O&&(O.resolve(),O=null));var e=d("WAWap").decodeStanza(b,this.gzipInflate)["catch"](function(a){d("WALogger").ERROR(w()).devConsole(b);throw a}).then(function(e){d("WALogger").DEV_XMPP(v(),e);c.config.handlers.onHandleStanza==null?void 0:c.config.handlers.onHandleStanza(e,a,b.byteLength);var f=c.activePing;if(f&&f.socketId===a&&f.stanzaId===$(e)){c.activePing=null;f.handler.resolve(e);c.maybeScheduleHealthCheck();return"NO_ACK"}return c.handleStanza(e,a,b.byteLength)}).then(function(b){if(a!==c.socketId)return;if(b==="CLOSE_SOCKET"){d("WALogger").LOG(u());var e=c.socket;e&&e.close()}else b==="NO_ACK"?d("WALogger").DEV(t()):c.castStanza(b);return"NO_ACK"});this.$3.add(e);e["finally"](function(){return void c.$3["delete"](e)})};e.handleAck=function(a){var b=this.ackHandlers,c=-1,e=null;while(!e&&++c<b.length)e=b[c].parseAndTest(a);if(e){var f=b[c];d("WAArrayUtils").removeIndexWithoutPreservingOrder(b,c);this.config.handlers.onHandleAck==null?void 0:this.config.handlers.onHandleAck(a);f.resolve(e);this.maybeScheduleHealthCheck()}else d("WALogger").WARN(s(),a)};e.removeHandler=function(a,c){c===void 0&&(c="disconnect");if(a.type==="iq"||a.type==="smax"){var e=a.stanza.attrs.id;if(!e||typeof e!=="string")return;if(a.type==="iq"&&!this.pendingIqs["delete"](e)||a.type==="smax"&&!this.pendingSmaxStanzas["delete"](e))return}else{a.type;e=this.ackHandlers.indexOf(a);if(e===-1)return;d("WAArrayUtils").removeIndexWithoutPreservingOrder(this.ackHandlers,e)}c==="disconnect"?a.resolve((h||(h=b("Promise"))).reject(new(d("WAErrors").Disconnected)())):a.resolve((h||(h=b("Promise"))).reject(new(d("WAErrors").MaxRetries)()))};e.maybeScheduleHealthCheck=function(){if(this.healthCheckTimer.isScheduled())return;if(this.activePing||this.ackHandlers.length||this.pendingIqs.size||this.pendingSmaxStanzas.size)return;var a=this.config.healthCheckInterval;a=Math.ceil(a*1e3*(1+Math.random()));this.healthCheckTimer.onOrBefore(a)};return a}();function a(){return N}function e(a,b,c){if(N)return;N=new R(a,b,c);setTimeout(T,0)}function f(){var a=Z("stopComms");a.socketLoop.endWithValue();a.socket&&a.socket.close();N=null}function S(){var a=Z("closeSocketAndPreventRetry");a.socketLoop.endWithValue();a.socket&&(d("WALogger").LOG(r()),a.socket.close())}function T(){Z("openSocketLoop").socketLoop.start()}function U(){W()||Z("maybeResetSocketLoop").socketLoop.reset()}function V(){Z("forceResetSocketLoop").socketLoop.reset()}function aa(){var a=Z("socketAbortController");(a=a.socketAbortController)==null?void 0:a.abort()}function W(){var a;return!!((a=N)==null?void 0:a.socket)}function X(){var a=Z("socketLoopIteration");typeof AbortController==="function"&&(a.socketAbortController=new AbortController());var b=a.nextSocketId++;d("WALogger").LOG(q(),b);var c=function(){a.onConnectionChange("in_handshake")};a.config.handlers.onSocketLoopIteration==null?void 0:a.config.handlers.onSocketLoopIteration();return a.config.openChatSocket(c,(c=a.socketAbortController)==null?void 0:c.signal).then(d("WAResultOrError").onResult(function(c){a.config.handlers.onSocketOpen==null?void 0:a.config.handlers.onSocketOpen();var e=new(d("WAResolvable").Resolvable)();d("WALogger").LOG(p(),b);a.socketId=b;a.socket=c;a.softCloseSocket=function(){a.softCloseSocket=null,a.socket&&a.config.shouldCloseStaleSocket&&(a.socket.close(),a.socket=null),e.resolve()};a.socketLoop.resetTimeoutAfter(1e4);a.deadSocketTimer.cancel();a.maybeScheduleHealthCheck();c.setOnFrame(function(c){return a.parseAndHandleStanza(b,c)});c.setOnClose(function(){d("WALogger").LOG(o(),b);a.activePing&&b===a.activePing.socketId&&(a.activePing.handler.resolve(),a.activePing=null);a.filterPending(function(a){return a.attachedToSocketId===b}).forEach(function(b){return void a.removeHandler(b)});if(b!==a.socketId)return;a.socketId=Q;a.socket=null;a.onConnectionChange("disconnected");a.config.handlers.onDisconnect==null?void 0:a.config.handlers.onDisconnect();e.resolve()});a.onConnectionChange("connected");a.config.handlers.onConnect==null?void 0:a.config.handlers.onConnect();a.filterPending(function(a){return!a.attachedToSocketId}).sort(function(a,b){return a.orderedId-b.orderedId}).forEach(function(b){switch(b.type){case"smax":case"iq":a.maybeSendPendingStanza(b);break;case"ack":a.callStanza(b.stanza);break;default:b.type;break}});return e.promise})).then(d("WAResultOrError").catchError(function(a){switch(a){case"max-hunters":d("WALogger").WARN(n());break;case"disconnected":d("WALogger").WARN(m());break;default:a;return}}))["catch"](function(a){a instanceof d("WAErrors").Disconnected?d("WALogger").LOG(l()):d("WALogger").ERROR(k(),a).devConsole(a)})}function ba(){var a=Z("closeSocket").socket;a&&(d("WALogger").LOG(j()),a.close())}function ca(){Z("onStreamErrorReceived").socketLoop.cancelReset()}function da(){Z("waitForConnection").sendPing();O||(O=new(d("WAResolvable").Resolvable)());return O.promise}function ea(a,b){var c=Z("castStanza");c.socket?c.castStanza(a,b):d("WALogger").LOG(i())}function fa(a){var b=Z("castStanza");return b.socketId===a}function Y(a,e,f,g,i){f===void 0&&(f=0);i===void 0&&(i="iq");return new(h||(h=b("Promise")))(function(j){var k=Z("sendIq"),l=a.attrs.id;if(!l||typeof l!=="string")throw c("WAErr")("Comms:sendIq given iq without id: "+String(a));var m=k.socketId;if(e&&!m){j((h||(h=b("Promise"))).reject(new(d("WAErrors").Offline)()));return}var n=function(){var a=i==="iq"?k.pendingIqs.get(l):k.pendingSmaxStanzas.get(l);if(!a){j((h||(h=b("Promise"))).reject(c("WAErr")("Comms:_sendIq unexisting stanza to be cancelled: "+l)));return}k.removeHandler(a)},o=null;if(f>0){var p=setTimeout(n,f*1e3);o=function(){clearTimeout(p)}}if(g!=null)if(g.aborted){j((h||(h=b("Promise"))).reject(new(d("WAErrors").Disconnected)()));return}else g.addEventListener("abort",n),o=function(){g.removeEventListener("abort",n)};m={resolve:j,stanza:a,attachedToSocketId:e?m:Q,orderedId:P++,attempt:0,cleanup:o};if(i==="iq"){o=babelHelpers["extends"]({type:i},m);k.pendingIqs.set(l,o);k.config.handlers.onSendIq==null?void 0:k.config.handlers.onSendIq(a);k.maybeSendPendingStanza(o)}else{i;o=babelHelpers["extends"]({type:i},m);k.pendingSmaxStanzas.set(l,o);k.maybeSendPendingStanza(o)}})}function ga(a,b){var c,d;c=(c=b==null?void 0:b.withoutRetry)!=null?c:!1;d=(d=b==null?void 0:b.timeoutSeconds)!=null?d:0;b=(b=b==null?void 0:b.signal)!=null?b:null;return Y(a,c,d,b,"smax")}function ha(){var a=Z("sendPing");return a.sendPing()}function ia(){return Z("startHandlingRequests").startHandlingRequests()}function ja(){N&&N.deadSocketTimer.cancel()}function Z(a){if(N)return N;throw c("WAErr")("Comms::"+a+" called before startComms")}function $(a){if(a.tag==="iq"){var b=a.attrs.type;if(b==="result"||b==="error")return d("WAWap").decodeAsString(a.attrs.id)||null}return null}function ka(){return P++}function la(){N=null,O=new(d("WAResolvable").Resolvable)(),P=1}g.DEFAULT_SOCKET_ID=Q;g.getComms=a;g.startComms=e;g.stopComms=f;g.closeSocketAndPreventRetry=S;g.openSocketLoop=T;g.maybeResetSocketLoop=U;g.forceResetSocketLoop=V;g.forceAbortSocketConnection=aa;g.isSocketConnected=W;g.socketLoopIteration=X;g.closeSocket=ba;g.onStreamErrorReceived=ca;g.waitForConnection=da;g.castSmaxStanza=ea;g.isActiveSocket=fa;g._sendIq=Y;g.sendSmaxStanza=ga;g.sendPing=ha;g.startHandlingRequests=ia;g.cancelDeadSocketTimer=ja;g.singletonOrThrowIfUninitialized=Z;g.getAndIncrementNextOrderedId=ka;g.resetStateForTests=la}),98);
__d("WAParseIqResponse",["WAWap"],(function(a,b,c,d,e,f,g){function a(a,b,c){var e=a.content;if(e&&Array.isArray(e)&&e[0]){e=e[0];if(e.tag==="error"){var f=e.attrs||{},g;c&&(typeof c==="function"?g=c(a):g=c.parseOrThrow(e));c=g;return{success:!1,errorCode:parseInt(f.code,10),errorText:d("WAWap").decodeAsString(f.text)||"",errorType:d("WAWap").decodeAsString(f.type)||"",errorBackoff:parseInt(f.backoff,10),toString:h,customError:c}}}if(typeof b==="function")return{success:!0,result:b(a)};else return{success:!0,result:b.parseOrThrow(a)}}function h(){return"IqError "+this.errorCode+": "+this.errorText}g.parseIqResponse=a}),98);
__d("WADeprecatedSendIq",["Promise","WAAckParser","WAArrayUtils","WAComms","WALogger","WAParseIqResponse"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Comms has no open socket, will send stanza when socket opens"]);i=function(){return a};return a}function a(a,b){return d("WAComms")._sendIq(a,!1).then(function(a){return d("WAParseIqResponse").parseIqResponse(a,b)})}function c(a,b,c){return d("WAComms")._sendIq(a,!1).then(function(a){return d("WAParseIqResponse").parseIqResponse(a,b,c)})}function e(a,b,c){return d("WAComms")._sendIq(a,!1,c).then(function(a){return d("WAParseIqResponse").parseIqResponse(a,b)})}function f(a,b){return d("WAComms")._sendIq(a,!0).then(function(a){return d("WAParseIqResponse").parseIqResponse(a,b)})}function j(a,b){return k(a,b).then(function(){})}function k(a,c){return new(h||(h=b("Promise")))(function(e){var f=d("WAComms").singletonOrThrowIfUninitialized("deprecatedSendStanzaAndReturnAck"),g=function(a){var b=d("WAAckParser").AckParser.parse(a);return!b.error&&d("WAAckParser").ackMatchesTemplate(b.success,c)?a:null},j={type:"ack",parseAndTest:g,resolve:e,stanza:a,attachedToSocketId:d("WAComms").DEFAULT_SOCKET_ID,orderedId:d("WAComms").getAndIncrementNextOrderedId()};f.ackHandlers.push(j);if(!f.socket){d("WALogger").LOG(i());return}f.callStanza(a)["catch"](function(a){var c=f.ackHandlers.indexOf(j);if(c===-1)return;d("WAArrayUtils").removeIndexWithoutPreservingOrder(f.ackHandlers,c);j.resolve((h||(h=b("Promise"))).reject(a))})})}function l(a,b){d("WAComms").castSmaxStanza(a,b)}g.deprecatedSendIq=a;g.deprecatedSendIqErrorParser=c;g.deprecatedSendIqIfConnectedWithin=e;g.deprecatedSendIqWithoutRetry=f;g.deprecatedSendStanzaAndWaitForAck=j;g.deprecatedSendStanzaAndReturnAck=k;g.deprecatedCastStanza=l}),98);
__d("WAMediaConnParser",["WADeprecatedWapParser","WAServerMediaType"],(function(a,b,c,d,e,f,g){a=new(c("WADeprecatedWapParser"))("mediaConnParser",function(a){a=a.child("media_conn");var b=j(a);return{hosts:b,authToken:a.attrString("auth"),authTokenExpiryTs:a.attrFutureTime("auth_ttl"),routesExpiryTs:a.attrFutureTime("ttl"),maxBuckets:a.attrInt("max_buckets"),maxManualRetry:(b=a.maybeAttrInt("max_manual_retry",0,4))!=null?b:3,maxAutoDownloadRetry:(b=a.maybeAttrInt("max_auto_download_retry",0,4))!=null?b:3}});function h(a){var b;return!a.hasAttr("fallback_hostname")?void 0:{domain:a.attrString("fallback_hostname"),"class":a.maybeAttrString("fallback_class"),ip4:(b=a.maybeAttrString("fallback_ip4"))!=null?b:void 0,ip6:(b=a.maybeAttrString("fallback_ip6"))!=null?b:void 0}}function i(a){var b;return{domain:a.attrString("hostname"),fallback:h(a),uploadable:k(a,"upload"),downloadable:k(a,"download"),isFallback:a.maybeAttrString("type")==="fallback",downloadBuckets:(b=(b=a.maybeChild("download_buckets"))==null?void 0:b.mapChildren(function(a){return parseInt(a.tag(),10)}))!=null?b:[],"class":a.maybeAttrString("class"),ip4:(b=a.maybeAttrString("ip4"))!=null?b:void 0,ip6:(b=a.maybeAttrString("ip6"))!=null?b:void 0}}function j(a){return a.mapChildrenWithTag("host",i)}function k(a,b){if(a.hasChild(b))return a.child(b).mapChildren(function(a){a=a.tag();return d("WAServerMediaType").castToServerMediaType(a)}).filter(Boolean);else return d("WAServerMediaType").SERVER_MEDIA}g.mediaConnParser=a}),98);
__d("WAGatherMediaInfo",["WADeprecatedSendIq","WAErrors","WALogger","WAMediaConnParser","WAPromiseManagement","WAPromiseRetryLoop","WAResultOrError","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["gatherMediaInfo error ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["gatherMediaInfo got "," hosts"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["gatherMediaInfo got client error: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["gatherMediaInfo got "," seconds backoff"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["gatherMediaInfo failure ",""]);l=function(){return a};return a}var m=507;b=d("WAPromiseManagement").cacheWhilePending(function(){return"gatherMediaInfo"},a);function a(){var a=new(d("WAPromiseRetryLoop").PromiseRetryLoop)({name:"gatherMediaInfo",timer:{jitter:.25,max:987e3,algo:{type:"fibonacci",first:6e3,second:12e3},relativeDelay:!0},code:o});a.start();return a.promise()}var n=60;function o(a){var b;b=(b=d("WAWap")).wap("iq",{to:b.S_WHATSAPP_NET,xmlns:"w:m",type:"set",id:b.generateId()},b.wap("media_conn",null));return d("WADeprecatedSendIq").deprecatedSendIqIfConnectedWithin(b,d("WAMediaConnParser").mediaConnParser,n).then(function(b){if(!b.success){d("WALogger").LOG(l(),b);if(b.errorCode===m){var c=b.errorBackoff;d("WALogger").LOG(k(),c);a(d("WAResultOrError").makeError({type:"backoff",backoffMs:c*1e3}))}else b.errorCode<500&&(d("WALogger").LOG(j(),b.errorCode),a(d("WAResultOrError").makeError({type:"client-error",code:b.errorCode,text:b.errorText})))}else d("WALogger").LOG(i(),b.result.hosts.length),a(d("WAResultOrError").makeResult(b.result))})["catch"](function(b){b instanceof d("WAErrors").Disconnected?a(d("WAResultOrError").makeError("disconnected")):d("WALogger").ERROR(h(),b)})}g.gatherMediaInfo=b}),98);
__d("WAMediaRouteSelection",["WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=null,c=null,e=null,f=a.hosts,g=a.operation,h=a.mediaType;if(a.operation==="download"){var i=a.catHotTimespan,j=a.ncHot;a=a.getVcaEnabledBucket;var k=new Map();f.forEach(function(a){a.downloadBuckets.forEach(function(b){k.set(b,a)})});var l=k.get(0);i>0&&j!=null&&d("WATimeUtils").happenedWithin(d("WATimeUtils").castToUnixTime(j),i)?b=1:a&&(b=a());j=null;b!=null&&(j=k.get(b));((i=j)==null?void 0:i.downloadable.includes(h))?c=j:(l==null?void 0:l.downloadable.includes(h))&&(c=l)}for(a=0;a<f.length;a++){i=f[a];g==="upload"&&i.uploadable.includes(h)?c==null?c=i:i.isFallback&&e==null&&(e=i):g==="download"&&i.downloadable.includes(h)&&(c==null?c=i:i.isFallback&&e==null&&(e=i));if(c!=null&&e!=null)break}return{selectedHost:c,fallbackHost:e,bucket:b}}g.mediaRouteSelection=a}),98);
__d("WAGetMediaRoute",["$InternalEnum","Promise","WACreateGetVcaEnabledBucket","WAExtractNcHotTimestamp","WAGatherMediaInfo","WAMediaRouteSelection","WAPromiseManagement","WAResultOrError","WATagsLogger","WATimeUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error occurred on gather after backoff expiry: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Can not get mediaAccess: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["mediaAccess has gone, gather a new one"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["mediaAccess has gone, but we are still locked by backoff"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error occurred during authTTL automatic refresh: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["AuthTTL approaching expiry, refreshing MediaAccess routes"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error: no media host"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to get mediaAccess: ",""]);p=function(){return a};return a}var q=d("WATagsLogger").TAGS(["GetMediaRoute"]),r=!0,s=86400,t=b("$InternalEnum")({Fresh:"fresh",Cached:"cached",Stale:"stale"}),u=null,v=!1,w=null;function a(a,c){var e,f,g,h,i,j,k,l,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:n.next=2;return b("regeneratorRuntime").awrap(A());case 2:e=n.sent;if(e.success){n.next=7;break}q.ERROR(p(),e.error);c==null?void 0:c.addPoint("get_media_access_failed",{string:{mediaAccessStatus:e.error}});return n.abrupt("return",e);case 7:c==null?void 0:c.addAnnotations({string:{mediaAccessStatus:e.value.state}});f=e.value.mediaAccess,g=f.authToken,h=f.hosts,i=f.maxBuckets;j=a.operation==="upload"?d("WAMediaRouteSelection").mediaRouteSelection({operation:"upload",mediaType:a.serverMediaType,hosts:h}):d("WAMediaRouteSelection").mediaRouteSelection({operation:"download",mediaType:a.serverMediaType,hosts:h,catHotTimespan:s,ncHot:d("WAExtractNcHotTimestamp").extractNcHotTimestamp(a.directPath),getVcaEnabledBucket:r?d("WACreateGetVcaEnabledBucket").msgrCreateGetVcaEnabledBucket(a.directPath,i):void 0}),k=j.selectedHost,l=j.fallbackHost,m=j.bucket;if(!(k==null)){n.next=13;break}q.ERROR(o());return n.abrupt("return",d("WAResultOrError").makeError("no-host"));case 13:return n.abrupt("return",d("WAResultOrError").makeResult({authToken:g,selectedHost:k,fallbackHost:l,bucket:m}));case 14:case"end":return n.stop()}},null,this)}function x(){var a=w;a!=null&&(self.clearTimeout(a),w=null)}function y(a){x();var b=Math.max(a.authTokenExpiryTs-d("WATimeUtils").unixTime(),0);if(b<=5*60)return;var c=d("WATimeUtils").pastUnixTime(5*60,a.authTokenExpiryTs);b=d("WATimeUtils").pastUnixTime(Math.floor(b*.2),a.authTokenExpiryTs);a=c<b?c:b;c=d("WATimeUtils").cappedMillisecondsUntil(a);b=Math.floor(Math.random()*d("WATimeUtils").MINUTE_MILLISECONDS);a=self.setTimeout(function(){q.LOG(n()),z()["catch"](function(a){q.ERROR(m(),a)})},c+b);w=a}var z=d("WAPromiseManagement").cacheWhilePending(function(){return"all"},function(){var a,c,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:if(!v){f.next=3;break}q.LOG(l());return f.abrupt("return",d("WAResultOrError").makeError("backoff"));case 3:q.LOG(k());x();f.next=7;return b("regeneratorRuntime").awrap(d("WAGatherMediaInfo").gatherMediaInfo());case 7:a=f.sent;if(!a.success){f.next=14;break}u=a.value;y(a.value);return f.abrupt("return",d("WAResultOrError").makeResult({mediaAccess:a.value,state:t.Fresh}));case 14:c=a.error;e=c==="disconnected"?"disconnected":c.type;q.WARN(j(),e);if(!(c==="disconnected"||c.type==="client-error")){f.next=21;break}return f.abrupt("return",d("WAResultOrError").makeError("disconnected"));case 21:c.type;v=!0;self.setTimeout(function(){v=!1,z()["catch"](function(a){q.ERROR(i(),a)})},c.backoffMs);return f.abrupt("return",d("WAResultOrError").makeError("backoff"));case 25:case"end":return f.stop()}},null,this)}),A=function(){var a=u;if(a==null)return z();if(d("WATimeUtils").isInFuture(a.routesExpiryTs))return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult({mediaAccess:a,state:t.Cached}));var c=z();return d("WATimeUtils").isInFuture(a.authTokenExpiryTs)?(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult({mediaAccess:a,state:t.Stale})):c};function c(){u=null,v=!1,x()}g.getMediaRoute=a;g.clearCachedMediaAccessForTest=c}),98);
__d("WASmaxInMmsdIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQErrorResponseMixin=a}),98);
__d("WASmaxInMmsdEnums",[],(function(a,b,c,d,e,f){a={0:"0",1:"1"};b={400:"400",401:"401",404:"404",408:"408",409:"409",415:"415",426:"426",429:"429"};c={500:"500",501:"501",502:"502",503:"503",507:"507"};d={fallback:"fallback",primary:"primary"};e={"false":"false","true":"true"};var g={fna:"fna",pop:"pop"};f.ENUM_0_1=a;f.ENUM_400_401_404_408_409_415_426_429=b;f.ENUM_500_501_502_503_507=c;f.ENUM_FALLBACK_PRIMARY=d;f.ENUM_FALSE_TRUE=e;f.ENUM_FNA_POP=g}),66);
__d("WASmaxInMmsdRequestErrorMixin",["WAResultOrError","WASmaxInMmsdEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"text");if(!b.success)return b;var c=d("WASmaxParseUtils").attrStringEnum(a,"code",d("WASmaxInMmsdEnums").ENUM_400_401_404_408_409_415_426_429);if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"backoff",0,10800);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:c.value,backoff:a.value})}g.parseRequestErrorMixin=a}),98);
__d("WASmaxInMmsdResignCdnUrlResponseClientError",["WAResultOrError","WASmaxInMmsdIQErrorResponseMixin","WASmaxInMmsdRequestErrorMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;c=d("WASmaxInMmsdRequestErrorMixin").parseRequestErrorMixin(c.value);if(!c.success)return c;a=d("WASmaxInMmsdIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({errorRequestErrorMixin:c.value},a.value))}g.parseResignCdnUrlResponseClientError=a}),98);
__d("WASmaxInMmsdServerErrorMixin",["WAResultOrError","WASmaxInMmsdEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"text");if(!b.success)return b;var c=d("WASmaxParseUtils").attrStringEnum(a,"code",d("WASmaxInMmsdEnums").ENUM_500_501_502_503_507);if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"backoff",0,10800);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:c.value,backoff:a.value})}g.parseServerErrorMixin=a}),98);
__d("WASmaxInMmsdResignCdnUrlResponseServerError",["WAResultOrError","WASmaxInMmsdIQErrorResponseMixin","WASmaxInMmsdServerErrorMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;c=d("WASmaxInMmsdServerErrorMixin").parseServerErrorMixin(c.value);if(!c.success)return c;a=d("WASmaxInMmsdIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({errorServerErrorMixin:c.value},a.value))}g.parseResignCdnUrlResponseServerError=a}),98);
__d("WASmaxInMmsdIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQResultResponseMixin=a}),98);
__d("WASmaxInMmsdResignCdnUrlResponseSuccess",["WAResultOrError","WASmaxInMmsdIQResultResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"cdn_url_resign");if(!c.success)return c;c=d("WASmaxParseUtils").attrString(c.value,"direct_path");if(!c.success)return c;a=d("WASmaxInMmsdIQResultResponseMixin").parseIQResultResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({cdnUrlResignDirectPath:c.value},a.value))}g.parseResignCdnUrlResponseSuccess=a}),98);
__d("WASmaxOutMmsdBaseIQGetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{id:d("WAWap").generateId(),type:"get"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseIQGetRequestMixin=a}),98);
__d("WASmaxOutMmsdIQRequestCommonMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{xmlns:"w:m",to:d("WAWap").S_WHATSAPP_NET});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIQRequestCommonMixin=a}),98);
__d("WASmaxMixinGroupExhaustiveError",[],(function(a,b,c,d,e,f){a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.name="SmaxMixinGroupExhaustiveError",b)||babelHelpers.assertThisInitialized(c)}return b}(babelHelpers.wrapNativeSuper(Error));f.SmaxMixinGroupExhaustiveError=a}),66);
__d("WASmaxOutMmsdResignCdnUrlResignWithHandleParamsMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.cdnUrlResignHandle;a=d("WASmaxJsx").smax("cdn_url_resign",{handle:d("WAWap").CUSTOM_STRING(a),use_case_hint:"wa_stickers"});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeResignCdnUrlResignWithHandleParamsMixin=a}),98);
__d("WASmaxOutMmsdResignCdnUrlResignWithObjectIdAndFBIdParamsMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.cdnUrlResignFbid;a=a.cdnUrlResignObjectId;b=d("WASmaxJsx").smax("cdn_url_resign",{fbid:d("WAWap").CUSTOM_STRING(b),object_id:d("WAWap").CUSTOM_STRING(a),use_case_hint:"fb_encrypted_backup"});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeResignCdnUrlResignWithObjectIdAndFBIdParamsMixin=a}),98);
__d("WASmaxOutMmsdResignWithResignCdnUrlObjectIdAndFBIdOrResignCdnUrlHandleParamsMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMmsdResignCdnUrlResignWithHandleParamsMixin","WASmaxOutMmsdResignCdnUrlResignWithObjectIdAndFBIdParamsMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.resignCdnUrlResignWithObjectIdAndFBIdParams)return d("WASmaxOutMmsdResignCdnUrlResignWithObjectIdAndFBIdParamsMixin").mergeResignCdnUrlResignWithObjectIdAndFBIdParamsMixin(a,b.resignCdnUrlResignWithObjectIdAndFBIdParams);if(b.resignCdnUrlResignWithHandleParams)return d("WASmaxOutMmsdResignCdnUrlResignWithHandleParamsMixin").mergeResignCdnUrlResignWithHandleParamsMixin(a,b.resignCdnUrlResignWithHandleParams);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeResignWithResignCdnUrlObjectIdAndFBIdOrResignCdnUrlHandleParamsMixinGroup=a}),98);
__d("WASmaxOutMmsdResignCdnUrlResignParamsMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMmsdResignWithResignCdnUrlObjectIdAndFBIdOrResignCdnUrlHandleParamsMixinGroup"],(function(a,b,c,d,e,f,g){function h(a){a=a.resignWithResignCdnUrlObjectIdAndFBIdOrResignCdnUrlHandleParamsMixinGroupArgs;a=d("WASmaxOutMmsdResignWithResignCdnUrlObjectIdAndFBIdOrResignCdnUrlHandleParamsMixinGroup").mergeResignWithResignCdnUrlObjectIdAndFBIdOrResignCdnUrlHandleParamsMixinGroup(d("WASmaxJsx").smax("cdn_url_resign",null),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeResignCdnUrlResignParamsMixin=a}),98);
__d("WASmaxOutMmsdResignCdnUrlRequest",["WASmaxJsx","WASmaxOutMmsdBaseIQGetRequestMixin","WASmaxOutMmsdIQRequestCommonMixin","WASmaxOutMmsdResignCdnUrlResignParamsMixin","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=a.cdnUrlResignSignDuration;a=a.resignCdnUrlResignParamsMixinArgs;b=d("WASmaxOutMmsdIQRequestCommonMixin").mergeIQRequestCommonMixin(d("WASmaxOutMmsdBaseIQGetRequestMixin").mergeBaseIQGetRequestMixin(d("WASmaxJsx").smax("iq",null,d("WASmaxOutMmsdResignCdnUrlResignParamsMixin").mergeResignCdnUrlResignParamsMixin(d("WASmaxJsx").smax("cdn_url_resign",{sign_duration:d("WAWap").INT(b)}),a))));return b}g.makeResignCdnUrlRequest=a}),98);
__d("WASmaxParsingFailure",[],(function(a,b,c,d,e,f){a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c;c=a.call(this,"SmaxParsingFailure: "+b)||this;c.name="SmaxParsingFailure";c.reason=b;return c}var c=b.prototype;c.toString=function(){return"SmaxParsingFailure: "+this.reason};return b}(babelHelpers.wrapNativeSuper(Error));f.SmaxParsingFailure=a}),66);
__d("WASmaxRpcUtils",[],(function(a,b,c,d,e,f){function a(a,b){var c=Object.keys(b).map(function(a){return'Tried <response name="'+a+'">, but failed with '+b[a].error+"."}).join(" ");return'Failed to parse the response of <rpc name="'+a+'">. '+c}f.errorMessageRpcParsing=a}),66);
__d("WASmaxMmsdResignCdnUrlRPC",["WAComms","WASmaxInMmsdResignCdnUrlResponseClientError","WASmaxInMmsdResignCdnUrlResponseServerError","WASmaxInMmsdResignCdnUrlResponseSuccess","WASmaxOutMmsdResignCdnUrlRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:e=d("WASmaxOutMmsdResignCdnUrlRequest").makeResignCdnUrlRequest(a);j.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(e,c));case 3:f=j.sent;g=d("WASmaxInMmsdResignCdnUrlResponseSuccess").parseResignCdnUrlResponseSuccess(f,e);if(!g.success){j.next=7;break}return j.abrupt("return",{name:"ResignCdnUrlResponseSuccess",value:g.value});case 7:h=d("WASmaxInMmsdResignCdnUrlResponseClientError").parseResignCdnUrlResponseClientError(f,e);if(!h.success){j.next=10;break}return j.abrupt("return",{name:"ResignCdnUrlResponseClientError",value:h.value});case 10:i=d("WASmaxInMmsdResignCdnUrlResponseServerError").parseResignCdnUrlResponseServerError(f,e);if(!i.success){j.next=13;break}return j.abrupt("return",{name:"ResignCdnUrlResponseServerError",value:i.value});case 13:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("ResignCdnUrl",{Success:g,ClientError:h,ServerError:i}));case 14:case"end":return j.stop()}},null,this)}g.sendResignCdnUrlRPC=a}),98);
__d("WAGetResignedCdnUrl",["WAAssertUnreachable","WAErrorMessage","WALogger","WAPromiseRetryLoop","WAResultOrError","WASmaxMmsdResignCdnUrlRPC","WASmaxParsingFailure"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["requestCdnResignedUrl - Unknown Error ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["requestCdnResignedUrl - Error thrown whilst parsing SMAX response - ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Direct path signature expired. objectId: ",", fbid: ","."]);j=function(){return a};return a}var k="507",l=259200;function a(a){var b=a.objectId;a=a.fbid;b=new(d("WAPromiseRetryLoop").PromiseRetryLoop)({name:"requestCdnResignedUrl",timer:{jitter:.25,max:987e3,algo:{type:"fibonacci",first:6e3,second:12e3},relativeDelay:!0},code:m({objectId:b,fbid:a})});b.start();return b.promise()}function m(a){var b=a.objectId,e=a.fbid;return function(a){d("WALogger").LOG(j(),b,e);return d("WASmaxMmsdResignCdnUrlRPC").sendResignCdnUrlRPC({cdnUrlResignSignDuration:l,resignCdnUrlResignParamsMixinArgs:{resignWithResignCdnUrlObjectIdAndFBIdOrResignCdnUrlHandleParamsMixinGroupArgs:{resignCdnUrlResignWithObjectIdAndFBIdParams:{cdnUrlResignFbid:e,cdnUrlResignObjectId:b}}}}).then(function(b){switch(b.name){case"ResignCdnUrlResponseSuccess":return a(d("WAResultOrError").makeResult({directPath:b.value.cdnUrlResignDirectPath}));case"ResignCdnUrlResponseClientError":return a(d("WAResultOrError").makeError({code:b.value.errorRequestErrorMixin.code,text:b.value.errorRequestErrorMixin.text,backoff:null}));case"ResignCdnUrlResponseServerError":if(b.value.errorServerErrorMixin.code!==k)return;return a(d("WAResultOrError").makeError({code:b.value.errorServerErrorMixin.code,text:b.value.errorServerErrorMixin.text,backoff:b.value.errorServerErrorMixin.backoff!=null?b.value.errorServerErrorMixin.backoff:void 0}));default:throw c("WAAssertUnreachable")(b.name)}})["catch"](function(b){var c=d("WAErrorMessage").maybeGetMessageFromError(b);if(b instanceof d("WASmaxParsingFailure").SmaxParsingFailure){d("WALogger").LOG(i(),c);return a(d("WAResultOrError").makeError({code:"0",text:"requestCdnResignedUrl - SMAX Parsing Error"}))}else{d("WALogger").LOG(h(),c);return}})}}g.BACKOFF_ERROR_CODE=k;g.getCdnResignedUrl=a}),98);
__d("WAHttpDownloadMedia",["WAErrorMessage","WALogger","WAResultOrError","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Download Media Error: can not resume from offset"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["HttpDownloadMedia: fail to parse request body: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["HttpDownloadMedia: fail to parse request body ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Fetch Media HTTP status ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["HttpDownloadMedia: fail to initiate fetch: ",", message: ",""]);l=function(){return a};return a}var m="URL signature expired";function a(a,c){var e,f,g,n;return b("regeneratorRuntime").async(function(o){while(1)switch(o.prev=o.next){case 0:o.prev=0;o.next=3;return b("regeneratorRuntime").awrap(fetch(a,{method:"GET",mode:"cors",cache:"no-store"}));case 3:e=o.sent;o.next=12;break;case 6:o.prev=6;o.t0=o["catch"](0);f=d("WAErrorMessage").maybeGetMessageFromError(o.t0);d("WALogger").ERROR(l(),o.t0,f);c==null?void 0:c.addAnnotations({bool:{threwFetchError:!0}});throw o.t0;case 12:g=e,n=g.status;d("WALogger").LOG(k(),n);o.t1=n;o.next=o.t1===200?17:o.t1===206?17:o.t1===401?18:o.t1===403?19:o.t1===404?20:o.t1===410?20:o.t1===408?21:o.t1===416?22:o.t1===429?24:o.t1===507?24:25;break;case 17:return o.abrupt("return",e.arrayBuffer().then(function(a){return d("WAResultOrError").makeResult(a)})["catch"](function(a){d("WALogger").ERROR(j(),a);return d("WAResultOrError").makeError("body-network-error")}));case 18:return o.abrupt("return",d("WAResultOrError").makeError("access-expired"));case 19:return o.abrupt("return",e.text().then(function(a){return a===m?d("WAResultOrError").makeError("signature-expired"):d("WAResultOrError").makeError("access-expired")})["catch"](function(a){d("WALogger").ERROR(i(),a);return d("WAResultOrError").makeError("access-expired")}));case 20:return o.abrupt("return",d("WAResultOrError").makeError("media-not-found"));case 21:return o.abrupt("return",d("WAResultOrError").makeError("server-timeout"));case 22:d("WALogger").ERROR(h());return o.abrupt("return",d("WAResultOrError").makeError("request-error"));case 24:return o.abrupt("return",d("WAResultOrError").makeError("download-throttled"));case 25:if(!(n>=400&&n<500)){o.next=27;break}return o.abrupt("return",d("WAResultOrError").makeError("request-error"));case 27:return o.abrupt("return",d("WAResultOrError").makeError("unspecified-http-error"));case 28:case"end":return o.stop()}},null,this,[[0,6]])}g.httpDownloadMedia=a}),98);
__d("WAMediaOperationsRetrier",["WALogger","WAPromiseBackoffs","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["MediaOperationsRetrier:download wait for internet, attempt = ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Running retrier"]);i=function(){return a};return a}var j=4,k={algo:{type:"constant",delay:1e3},jitter:0};a=function(){function a(a,b,c){this.$1=a,this.routesInfo=b,this.$2=d("WAPromiseBackoffs").createPromiseTimer(k),this.$3=0,this.$4=!1,this.$5=c}var c=a.prototype;c.run=function(a,c){var e,f,g,k;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:if(!(this.$3<j)){l.next=30;break}d("WALogger").DEV(i());l.next=4;return b("regeneratorRuntime").awrap(this.$2());case 4:e=void 0;if(!(this.$3>0)){l.next=13;break}e=this.$3>=j-2&&!this.$4;if(!(this.$1==="download")){l.next=11;break}d("WALogger").LOG(h(),this.$3);l.next=11;return b("regeneratorRuntime").awrap(this.$5==null?void 0:this.$5());case 11:l.next=14;break;case 13:e=!1;case 14:f=this.routesInfo;if(f){l.next=17;break}return l.abrupt("return",null);case 17:g=f.host;e&&f.fallbackHost&&(g=f.fallbackHost);l.next=21;return b("regeneratorRuntime").awrap(a(g,f.authToken,this.$3,c));case 21:k=l.sent;if(!k.success){l.next=26;break}return l.abrupt("return",k.value);case 26:++this.$3,this.$4=k.error.progressMade;case 28:l.next=0;break;case 30:return l.abrupt("return",null);case 31:case"end":return l.stop()}},null,this)};return a}();g.MAX_ATTEMPTS=j;g.BACKOFF_OPTIONS=k;g.MediaOperationsRetrier=a}),98);
__d("WAHttpUtils",["WAErr"],(function(a,b,c,d,e,f,g){function a(a,b,d){if(!/^https:\/\/[-\w.]+\.\w+$/.test(a))throw c("WAErr")('buildUrl given invalid host "'+a+'"');if(!b.startsWith("/"))throw c("WAErr")('buildUrl given invalid path "'+b+'"');var e=d;d=""+a+b;if(!e)return d;a=Object.keys(e).map(function(a){var b=e[a];b instanceof ArrayBuffer&&(b=new Uint8Array(b));b=b instanceof Uint8Array?Array.prototype.slice.call(b).map(function(a){return"%"+a.toString(16)}).join(""):encodeURIComponent(b.toString());return encodeURIComponent(a)+"="+b});if(a.length>0){b=a.join("&");return d.includes("?")?d+"&"+b:d+"?"+b}else return d}g.buildUrl=a}),98);
__d("WAMediaUrl",["WABase64","WAGlobals","WAHttpUtils"],(function(a,b,c,d,e,f,g){var h=1;function a(a,b,c,e,f,g,i){var j=d("WAGlobals").getConfig().mediaUploadRoot();c=d("WABase64").encodeB64UrlSafe(c);b=d("WABase64").encodeB64UrlSafe(b);f={auth:f,token:b};g&&(f.resume=h);i!=null&&i>0&&(f.bytestart=i);return d("WAHttpUtils").buildUrl("https://"+e,j+"/"+a+"/"+c,f)}function b(a,b,c,e,f,g,h){b=d("WABase64").encodeB64UrlSafe(b);b={hash:b,mode:e};f!=null&&(b._nc_cat=f);g!=null&&g>=0&&(b.bytestart=g);h!=null&&h>0&&(b.byteend=h);return d("WAHttpUtils").buildUrl("https://"+c,a,b)}g.RESUME_PARAM=h;g.buildUploadUrl=a;g.buildDownloadUrl=b}),98);
__d("WADownloadCiphertext",["WAAssertUnreachable","WABase64","WACryptoSha256","WACryptoUtils","WAGetMediaRoute","WAGetResignedCdnUrl","WAHttpDownloadMedia","WALogger","WAMediaOperationsRetrier","WAMediaUrl","WAPromiseDelays","WAPromiseManagement","WAResultOrError","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Download Plaintext failed: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["downloadMedia given up"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Download Media Error: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to generate a new cdn url"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["result to generate a new cdn url was throttled (507)"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Cannot generate a new cdn url: missing objectId or fbid"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Download Media Error: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Downloading ciphertext for hash: ",""]);o=function(){return a};return a}function a(a){var e,f,g,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H;return b("regeneratorRuntime").async(function(I){while(1)switch(I.prev=I.next){case 0:e=a.mediaTypeDetails,f=a.fileEncSha256,g=a.directPath,q=a.plaintextHash,r=a.objectId,s=a.fbid,t=a.pathRedirected,u=a.mediaMetrics,v=a.fromBytes,w=a.toBytes;d("WALogger").LOG(o(),q);x=e.type==="regular"?e.mediaType:"preview";u==null?void 0:u.addPoint("get_media_route_start");I.next=6;return b("regeneratorRuntime").awrap(d("WAGetMediaRoute").getMediaRoute({operation:"download",serverMediaType:x,fileEncSha256:f,directPath:g},u));case 6:y=I.sent;u==null?void 0:u.addPoint("get_media_route_finish");if(y.success){I.next=10;break}return I.abrupt("return",y);case 10:z=y.value,A=z.selectedHost,B=z.fallbackHost,C=z.authToken,D=z.bucket;E=new(d("WAMediaOperationsRetrier").MediaOperationsRetrier)("download",{host:{domain:A.domain,"class":A["class"]},fallbackHost:B&&{domain:B.domain,"class":B["class"]},authToken:C,timeElapsed:null});I.next=14;return b("regeneratorRuntime").awrap(E.run(function(a){a=a.domain;a=d("WAMediaUrl").buildDownloadUrl(g,f,a,"manual",D,v,w);return d("WAHttpDownloadMedia").httpDownloadMedia(a,u).then(function(c){var a,e,f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:if(!c.success){h.next=4;break}return h.abrupt("return",d("WAResultOrError").makeResult(c));case 4:a=c.error;d("WALogger").LOG(n(),a);h.t0=a;h.next=h.t0==="signature-expired"?9:h.t0==="server-timeout"?28:h.t0==="unspecified-http-error"?28:29;break;case 9:if(!(r==null||s==null)){h.next=12;break}d("WALogger").LOG(m());return h.abrupt("return",d("WAResultOrError").makeResult(d("WAResultOrError").makeError("signature-expired-and-resign-failed-no-ids")));case 12:h.next=14;return b("regeneratorRuntime").awrap(d("WAGetResignedCdnUrl").getCdnResignedUrl({objectId:r,fbid:s}));case 14:e=h.sent;if(e.success){h.next=23;break}f=e.error;if(!(f.code===d("WAGetResignedCdnUrl").BACKOFF_ERROR_CODE&&f.backoff!=null)){h.next=20;break}d("WALogger").LOG(l());return h.abrupt("return",d("WAPromiseDelays").delayMs(f.backoff).then(function(){return d("WAResultOrError").makeResult(d("WAResultOrError").makeError("signature-expired"))}));case 20:d("WALogger").LOG(k());u==null?void 0:u.addPoint("new_cdn_url_failed",{"int":{resignCDNErrorCode:Number(e.error.code)}});return h.abrupt("return",d("WAResultOrError").makeResult(d("WAResultOrError").makeError("signature-expired-and-resign-failed-cdn-url")));case 23:g=e.value.directPath;if(!(t!=null)){h.next=27;break}h.next=27;return b("regeneratorRuntime").awrap(t(g));case 27:return h.abrupt("return",d("WAResultOrError").makeResult(d("WAResultOrError").makeError("signature-expired")));case 28:return h.abrupt("return",d("WAResultOrError").makeError({progressMade:!0}));case 29:return h.abrupt("return",d("WAResultOrError").makeResult(d("WAResultOrError").makeError(a)));case 30:case"end":return h.stop()}},null,this)})["catch"](function(a){d("WALogger").ERROR(j(),a);return d("WAResultOrError").makeError({progressMade:!1})})}));case 14:F=I.sent;if(!(F==null)){I.next=18;break}d("WALogger").WARN(i());return I.abrupt("return",d("WAResultOrError").makeError("max-attempts-exceeded"));case 18:if(!(F.success===!1)){I.next=31;break}G=F.error;d("WALogger").WARN(h(),G);I.t0=G;I.next=I.t0==="signature-expired"?24:I.t0==="signature-expired-and-resign-failed-cdn-url"?24:I.t0==="signature-expired-and-resign-failed-no-ids"?24:I.t0==="media-not-found"?24:I.t0==="download-throttled"?24:I.t0==="request-error"?24:I.t0==="access-expired"?25:I.t0==="body-network-error"?26:27;break;case 24:return I.abrupt("return",d("WAResultOrError").makeError(G));case 25:return I.abrupt("return",d("WAResultOrError").makeError("disconnected"));case 26:return I.abrupt("return",d("WAResultOrError").makeError("request-error"));case 27:G;throw c("WAAssertUnreachable")(G);case 29:I.next=44;break;case 31:H=F.value;I.t1=!p(v,w);if(!I.t1){I.next=40;break}I.t2=d("WACryptoUtils").arrayBuffersEqual;I.next=37;return b("regeneratorRuntime").awrap(d("WACryptoSha256").sha256(H));case 37:I.t3=I.sent,I.t4=f,I.t1=!I.t2(I.t3,I.t4);case 40:if(!I.t1){I.next=42;break}return I.abrupt("return",d("WAResultOrError").makeError("ciphertext-hash-mismatch"));case 42:u==null?void 0:u.addPoint("download_finish",{"int":{byteLength:H.byteLength},bool:{isPartialDownload:p(v,w)}});return I.abrupt("return",d("WAResultOrError").makeResult(H));case 44:case"end":return I.stop()}},null,this)}e=d("WAPromiseManagement").cacheWhilePending(function(a){var b=a.fileEncSha256,c=a.fromBytes;a=a.toBytes;return d("WABase64").encodeB64UrlSafe(b)+"-"+((b=c)!=null?b:"X")+"-"+((c=a)!=null?c:"X")},a);function p(a,b){return a!=null&&a>0?!0:b!=null}g.cachedDownloadCiphertext=e}),98);
__d("WADownloadAndDecryptMedia",["WADecryptMedia","WADownloadCiphertext","WAResultOrError","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var c,e,f,g,h,i,j,k,l,m,n;return b("regeneratorRuntime").async(function(o){while(1)switch(o.prev=o.next){case 0:c=a.mediaTypeDetails,e=a.fileEncSha256,f=a.directPath,g=a.mediaKey,h=a.plaintextHash,i=a.objectId,j=a.fbid,k=a.pathRedirected,l=a.mediaMetrics;o.next=3;return b("regeneratorRuntime").awrap(d("WADownloadCiphertext").cachedDownloadCiphertext({mediaTypeDetails:c,fileEncSha256:e,directPath:f,objectId:i,fbid:j,pathRedirected:k,mediaMetrics:l,plaintextHash:h}));case 3:m=o.sent;if(!(m.success!==!0)){o.next=6;break}return o.abrupt("return",m);case 6:o.next=8;return b("regeneratorRuntime").awrap(d("WADecryptMedia").decryptMedia({mediaKey:g,mediaTypeDetails:c,plaintextHash:h,ciphertextHmac:m.value}));case 8:n=o.sent;if(!(n.success!==!0)){o.next=11;break}return o.abrupt("return",n);case 11:n.value.alternativeHmacSaltUsed!=null&&(l==null?void 0:l.addAnnotations({string:{alternativeHmacSaltUsed:n.value.alternativeHmacSaltUsed}}));return o.abrupt("return",d("WAResultOrError").makeResult(n.value.plaintext));case 13:case"end":return o.stop()}},null,this)}g.downloadAndDecryptMedia=a}),98);
__d("WAAlignChunkLengthsToMultipleOfAesBlockSize",[],(function(a,b,c,d,e,f){function g(a){return parseInt((a+15)/16,10)*16}function a(a,b){var c=[],d=0,e=0,f=0;for(var h=0;h<a.length;++h){d+=a[h];if(h===a.length-1&&b!=null){d>e?c.push(b-e):(c.pop(),c.push(b-f));break}else if(d>e){var i=g(d-e);f=e;c.push(i);e+=i}}return c}f.alignChunkSizeToMultipleAesBlockSize=g;f.alignChunkLengthsToMultipleOfAesBlockSize=a}),66);
__d("WAProgressiveJpegAlignScanLengths",["WAAlignChunkLengthsToMultipleOfAesBlockSize"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("WAAlignChunkLengthsToMultipleOfAesBlockSize").alignChunkLengthsToMultipleOfAesBlockSize(a.map(function(a){return a}),b).map(function(a){return a})}function b(a){return a}g.progressiveJpegAlignChunkLengthsToMultipleOfAesBlockSize=a;g.toProgressiveJpegAlignedScanLength=b}),98);
__d("WAProgressiveJpegGetPJpegDetails",["WAMediaCrypto","WAProgressiveJpegAlignScanLengths","WAProgressiveJpegGetScanLengths","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,c,e){var f,g,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:f=c.byteLength-d("WAMediaCrypto").IV_LENGTH;g=d("WAProgressiveJpegGetScanLengths").getProgressiveJpegScanLengths(a);i=d("WAProgressiveJpegAlignScanLengths").progressiveJpegAlignChunkLengthsToMultipleOfAesBlockSize(g,f);k.next=5;return b("regeneratorRuntime").awrap(h(i,c,e));case 5:j=k.sent;return k.abrupt("return",{scanLengths:g,sidecar:j});case 7:case"end":return k.stop()}},null,this)}function h(a,c,e){var f,g,h,i,j,k,l,m,n;return b("regeneratorRuntime").async(function(o){while(1)switch(o.prev=o.next){case 0:f=new Uint8Array(a.length*10),g=0,h=0,i=c.slice(0,16),j=c.slice(16),k=0;case 6:if(!(k<a.length)){o.next=19;break}l=a[k];h=g+l;m=j.subarray(g,h);o.next=12;return b("regeneratorRuntime").awrap(d("WAMediaCrypto").hmacCiphertext(e,i,m));case 12:n=o.sent.slice(0,10),f.set(new Uint8Array(n),k*10),i=m.slice(m.length-16,m.length),g=h;case 16:k++;o.next=6;break;case 19:return o.abrupt("return",f.buffer);case 20:case"end":return o.stop()}},null,this)}function c(a){var b=a.scanLengths;a=a.sidecar;if(b==null||b.length===0)return!1;return a==null||a.byteLength===0?!1:!0}function e(a,b){var c=0;if(b===0)return 0;for(var d=0;d<b;d++){var e=a[d];e!=null&&(c+=e)}return c}g.getProgressiveJpegDetails=a;g.isValidProgressiveJpegDetails=c;g.getTotalByteSizeForScan=e}),98);
__d("WADownloadProgressiveJpegPlaintext",["WABinary","WADownloadCiphertext","WAMediaCrypto","WAProgressiveJpegAlignScanLengths","WAProgressiveJpegGetPJpegDetails","WAResultOrError","WATagsLogger","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Partial Download Plaintext Success"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Download Plaintext Error ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Using progressiveJpeg decryptAndVerify"]);j=function(){return a};return a}var k=d("WATagsLogger").TAGS(["DownloadProgressiveJpeg"]);function a(a){var c,e,f,g,h,i,j,k,m,n,o,p,q,r;return b("regeneratorRuntime").async(function(s){while(1)switch(s.prev=s.next){case 0:c=a.mediaTypeDetails,e=a.fileEncSha256,f=a.directPath,g=a.mediaKey,h=a.mediaMetrics,i=a.pathRedirected,j=a.pjpegDetails,k=a.targetScan,m=a.plaintextHash;n=d("WAProgressiveJpegAlignScanLengths").progressiveJpegAlignChunkLengthsToMultipleOfAesBlockSize(j.scanLengths);o=babelHelpers["extends"]({},j,{alignedScanLengths:n});p=l(g,c,k,o);q=d("WAProgressiveJpegGetPJpegDetails").getTotalByteSizeForScan(n,k);s.next=7;return b("regeneratorRuntime").awrap(d("WADownloadCiphertext").cachedDownloadCiphertext({mediaTypeDetails:c,fileEncSha256:e,directPath:f,pathRedirected:i,fromBytes:0,toBytes:q-1,mediaMetrics:h,plaintextHash:m}));case 7:r=s.sent;if(!(r.success!==!0)){s.next=10;break}return s.abrupt("return",r);case 10:return s.abrupt("return",p(r.value));case 11:case"end":return s.stop()}},null,this)}function l(a,c,e,f){return function(g,l){var n,o,p;return b("regeneratorRuntime").async(function(q){while(1)switch(q.prev=q.next){case 0:k.LOG(j());n=new Uint8Array(g);c.type==="preview"?l=d("WAMediaCrypto").computeMediaKeysForPreview(a):l=d("WAMediaCrypto").computeMediaKeys(a,c.mediaType);q.next=5;return b("regeneratorRuntime").awrap(l.then(function(a){var b=a.iv,c=a.cipherKey;a=a.hmacKey;return d("WAMediaCrypto").decryptPartialChunks(c,b,n,a,e,f)}).then(d("WAResultOrError").makeResult)["catch"](function(a){k.ERROR(i(),a);if(a instanceof d("WAMediaCrypto").HmacValidationError)return d("WAResultOrError").makeError("enc-hash-mismatch");else return d("WAResultOrError").makeError("decryption-error")}));case 5:o=q.sent;if(o.success){q.next=8;break}return q.abrupt("return",o);case 8:k.LOG(h());p=m(o.value.plaintext);return q.abrupt("return",d("WAResultOrError").makeResult(p));case 11:case"end":return q.stop()}},null,this)}}function m(a){a=new(d("WABinary").Binary)(a);a.writeBytes(255,217);return a.readBuffer()}g.downloadProgressiveJpegPlaintext=a}),98);
__d("MAWDownloadMedia",["MAWExternalId","MAWGetMediaPlaintextApi","MAWGlobals","MAWHandleMediaPreviewBeforeDownloadApi","MAWJobDefinitions","MAWLoggerUtils","MAWMediaQplHelper","MAWUpdateMediaEntryForMsgApi","Promise","WADownloadAndDecryptMedia","WADownloadProgressiveJpegPlaintext","WAErrorMessage","WAJids","WAMediaCrypto","WAMediaUtils","WAPREList","WAPREMetrics","WAResultOrError","WATagsLogger","WebStorageEstimator","asyncToGeneratorRuntime","qex"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Finished progressiveJpeg preview download"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed progressiveJpeg preview download: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Starting progressiveJpeg preview download"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["downloadMedia: enc-hash-mismatch"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["downloadMedia: enc-hash-mismatch. chatType: ",", mediaTypeDetailsType: ",", mediaTypeDetailsValue: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Skipping media request reupload for preview media"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["media already exists in db, skipping download"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["mediaPreviewPromise state: ",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["Download Media Error: mediaEntryData is incomplete"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose([""," is not downloaded"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media due to runtime-error: ",""]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["progressiveJpeg scanLengths does not match sidecar byteLength"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["finished downloading"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["failed to download media. Reason: ",""]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["media: mediaPreview - unsupported preview media type "," - ",""]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose(["media: mediaPreview - mediaEntryData directPath matches main media directPath - likely to fail"]);x=function(){return a};return a}function y(){var a=babelHelpers.taggedTemplateLiteralLoose(["media: mediaPreview - mediaEntryData "," is incomplete for media preview"]);y=function(){return a};return a}function z(){var a=babelHelpers.taggedTemplateLiteralLoose(["DownloadableThumbnail exists. Attempting to download."]);z=function(){return a};return a}function A(){var a=babelHelpers.taggedTemplateLiteralLoose(["No downloadableThumbnail. Skipping..."]);A=function(){return a};return a}function B(){var a=babelHelpers.taggedTemplateLiteralLoose(["thumbnail_available: ",""]);B=function(){return a};return a}var C=d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.MediaDownload,d("MAWLoggerUtils").Tag.MessageReceive]),D=!1,E=3,F=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){var f=e.downloadableThumbnail,g=f==null?void 0:f.directPath,h=g!=null;C.TAGS([d("MAWLoggerUtils").Tag.MediaPreview]).LOG(B(),h);if(f==null||g==null){C.TAGS([d("MAWLoggerUtils").Tag.MediaPreview]).LOG(A());return}C.TAGS([d("MAWLoggerUtils").Tag.MediaPreview]).LOG(z());h=f.fileEncSha256;var i=f.fileSha256,j=f.mediaKey;f=f.objectId;if(g==null||h==null||i==null||j==null){C.TAGS([d("MAWLoggerUtils").Tag.MediaPreview]).ERROR(y(),e);return}var k=d("WAJids").switchOnMsgrChatJidType(a.chat,{group:function(){return"group"},user:function(){return"user"}}),l=G(e),m=(yield d("WebStorageEstimator").estimateStorage()),n=m.quota;m=m.usage;l={mediaDownload:d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.MEDIA_DOWNLOAD,{bool:{duplicateDirectPath:g===e.directPath,isMediaFallbackToAlternativeHmacSaltsEnabled:d("MAWGlobals").getConfig().isMediaFallbackToAlternativeHmacSaltsEnabled(),isPreview:!0,isProgressiveJpeg:l!=null},"int":{storageQuota:n,storageUsage:m},string:{chat_type:k,downloadEntry:"downloadable-preview",e2eePlatform:d("MAWExternalId").getPlatform(a.externalId),jid:a.chat,mediaType:e.serverMediaType}},void 0)};g===e.directPath&&C.TAGS([d("MAWLoggerUtils").Tag.MediaPreview]).ERROR(x());var o;try{o=d("WAMediaCrypto").convertServerMediaTypeToPreviewMediaType(c)}catch(a){C.TAGS([d("MAWLoggerUtils").Tag.MediaPreview]).ERROR(w(),c,a);l.mediaDownload.endFail("preview-unsupported-type");return}yield d("MAWHandleMediaPreviewBeforeDownloadApi").handleMediaPreviewBeforeDownload(b);n=(yield N(a,b,l,{messageType:o,type:"preview"},g,h,i,j,f,null,e));n.success===!1?(C.TAGS([d("MAWLoggerUtils").Tag.MediaPreview]).ERROR(v(),n.error),l.mediaDownload.endFail(n.error)):(C.TAGS([d("MAWLoggerUtils").Tag.MediaPreview]).LOG(u()),l.mediaDownload.endSuccess())});return function(b,c,d,e){return a.apply(this,arguments)}}();function G(a){if(a.progressiveJpegDetails==null)return null;return!H(a.progressiveJpegDetails)?null:{scanLengths:a.progressiveJpegDetails.scanLengths,sidecar:a.progressiveJpegDetails.sidecar}}function H(a){if(a.scanLengths.length*10!==a.sidecar.byteLength){C.TAGS([d("MAWLoggerUtils").Tag.MediaPreview]).ERROR(t());return!1}return a.scanLengths.length===0?!1:!0}function I(a,b,c,d,e){return J.apply(this,arguments)}function J(){J=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f){var g=e.directPath,h=e.fileEncSha256,l=e.mediaKey;if(g==null||h==null||l==null)return d("WAResultOrError").makeError("pjpeg-failed");yield d("MAWHandleMediaPreviewBeforeDownloadApi").handleMediaPreviewBeforeDownload(b);var m=d("WAJids").switchOnMsgrChatJidType(a.chat,{group:function(){return"group"},user:function(){return"user"}}),n=(yield d("WebStorageEstimator").estimateStorage()),o=n.quota;n=n.usage;o=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.MEDIA_DOWNLOAD,{bool:{isMediaFallbackToAlternativeHmacSaltsEnabled:d("MAWGlobals").getConfig().isMediaFallbackToAlternativeHmacSaltsEnabled(),isPreview:!0,isProgressiveJpeg:!0},"int":{storageQuota:o,storageUsage:n},string:{chat_type:m,downloadEntry:"progressiveJpeg-preview",e2eePlatform:d("MAWExternalId").getPlatform(a.externalId),jid:a.chat,mediaType:e.serverMediaType}},void 0);C.TAGS([d("MAWLoggerUtils").Tag.MediaPreview]).LOG(k());n=(yield d("WADownloadProgressiveJpegPlaintext").downloadProgressiveJpegPlaintext({directPath:g,fileEncSha256:h,mediaKey:l,mediaMetrics:o,mediaTypeDetails:{mediaType:c,type:"regular"},pjpegDetails:f,plaintextHash:b,targetScan:E}));if(!n.success){o.endFail(n.error);return d("WAResultOrError").makeError("pjpeg-failed")}m=n.value;e=(yield d("MAWGlobals").getDbImpls().handleMediaPreviewDownload(b,m,"image",a));if(e.success===!1){C.TAGS([d("MAWLoggerUtils").Tag.MediaPreview]).ERROR(j(),e.error);o.endFail(e.error);return d("WAResultOrError").makeError("pjpeg-failed")}C.TAGS([d("MAWLoggerUtils").Tag.MediaPreview]).LOG(i());o.endSuccess();return d("WAResultOrError").makeResult()});return J.apply(this,arguments)}function K(a){var c={};return(h||(h=b("Promise"))).race([a,c]).then(function(a){return a===c?"pending":"fulfilled"},function(){return"rejected"})}var L=function(a,c,e,f){return M(a,c,e,f)["catch"](function(a){a=d("WAErrorMessage").maybeGetMessageFromError(a);C.ERROR(s(),a);return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeError("runtime-error"))})},M=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f){var g,i=e.directPath,j=e.fbid,k=e.fileEncSha256,l=e.fileSha256,m=e.mediaKey,n=e.objectId,o=e.serverMediaType;f==null?void 0:f.mediaDownload.addAnnotations({string:{mediaType:o}});f==null?void 0:(g=f.receive)==null?void 0:g.addPoint("downloading_media",{string:{mediaType:o}});if(i==null||k==null||l==null||m==null||o==null){C.WARN(r(),e);C.ERROR(q());return d("WAResultOrError").makeError("media-entry-invalid")}if((e==null?void 0:(g=e.downloadableThumbnail)==null?void 0:g.directPath)!=null){f==null?void 0:f.mediaDownload.addAnnotations({bool:{duplicateDirectPath:(e==null?void 0:(g=e.downloadableThumbnail)==null?void 0:g.directPath)===i,hasDownloadableThumbnail:!0}})}g=(h||(h=b("Promise"))).resolve().then(function(){if(!d("MAWGlobals").getConfig().isProgressiveJpegSendReceiveEnabled())return F(a,c,o,e);var b=G(e);f==null?void 0:f.mediaDownload.addAnnotations({bool:{isProgressiveJpeg:b!=null}});return b==null?F(a,c,o,e):I(a,c,o,e,b).then(function(b){if(b.success!==!0)return F(a,c,o,e)})});i=(yield N(a,c,f,{mediaType:o,type:"regular"},i,k,l,m,n,j,e));k=(yield K(g));C.LOG(p(),k);(e==null?void 0:(l=e.downloadableThumbnail)==null?void 0:l.directPath)!=null&&(f==null?void 0:f.mediaDownload.addAnnotations({string:{mediaPreviewPromiseState:k}}));return i});return function(b,c,d,e){return a.apply(this,arguments)}}(),N=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,h,i,j,k,p,q,r){var s=d("WAMediaUtils").toPlaintextHash(j);if(c("qex")._("181")){j=(yield d("MAWGetMediaPlaintextApi").getMediaPlaintext(s));if(j!=null){C.LOG(o());f==null?void 0:f.mediaDownload.addAnnotations({bool:{downloadSkipped:!0}});f==null?void 0:(j=f.receive)==null?void 0:j.addAnnotations({bool:{downloadSkipped:!0}});return d("WAResultOrError").makeResult()}}f==null?void 0:f.mediaDownload.addAnnotations({bool:{downloadSkipped:!1}});f==null?void 0:(j=f.receive)==null?void 0:j.addAnnotations({bool:{downloadSkipped:!1}});j=(yield d("WADownloadAndDecryptMedia").downloadAndDecryptMedia({directPath:h,fbid:q,fileEncSha256:i,mediaKey:k,mediaMetrics:f==null?void 0:f.mediaDownload,mediaTypeDetails:g,objectId:p,pathRedirected:function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=function(){return d("WAMediaUtils").encodeMediaEntryWithUpdatedPath(r,b)};yield d("MAWUpdateMediaEntryForMsgApi").updateMediaEntryForMsg(s,a,c,p,r.serverMediaType)});function e(a){return c.apply(this,arguments)}return e}(),plaintextHash:s}));if(j.success===!1){h=j.error;switch(h){case"signature-expired":return g.type!=="preview"?L(a,e,r,f):d("WAResultOrError").makeError(h);case"signature-expired-and-resign-failed-cdn-url":case"signature-expired-and-resign-failed-no-ids":case"media-not-found":D&&(g.type==="preview"?C.WARN(n()):yield d("MAWGlobals").getJobManager().waitUntilPersisted(d("MAWJobDefinitions").jobSerializers.requestReuploadMedia(a,e)));return d("WAResultOrError").makeError(h);case"enc-hash-mismatch":q=d("WAJids").switchOnMsgrChatJidType(a.chat,{group:function(a){return"group"},user:function(a){return"user"}});C.WARN(m(),q,g.type,g.type==="regular"?g.mediaType:g.messageType);C.ERROR(l());return d("WAResultOrError").makeError(h);default:h;return d("WAResultOrError").makeError(h)}}else{i=j.value;f==null?void 0:f.mediaDownload.addPoint("download_media_success",{string:{media_size:d("MAWMediaQplHelper").convertIntegerSizeToStringBucket(i.byteLength)}});f==null?void 0:(k=f.receive)==null?void 0:k.addPoint("download_media_success");if(g.type==="preview")return d("MAWGlobals").getDbImpls().handleMediaPreviewDownload(e,i,g.messageType,a);else{q=d("WAMediaUtils").getMimeTypeFromServerMediaType(g.mediaType);return d("MAWGlobals").getDbImpls().handleMediaDownload(e,q,i,a)}}});return function(b,c,d,e,f,g,h,i,j,k,l){return a.apply(this,arguments)}}();g.downloadMedia=L}),98);
__d("WAPersistedQueueCache",["WAResolvable","WAShiftTimer","WATagsLogger","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error during flush: ",""]);h=function(){return a};return a}function a(a,c,e){var f=d("WATagsLogger").TAGS(["PersistedQueue",a,"cache"]),g=[],i=new(d("WAResolvable").Resolvable)(),j=(a=e)!=null?a:{},k=new(d("WAShiftTimer").ShiftTimer)(function(){void n()});function l(){j.cacheSize!=null&&g.length>=j.cacheSize&&void n()}function m(){if(j.maxDelay!=null){var a=j.maxDelay;k.cancel();k.onOrAfter(a)}}function n(){var a,e;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:if(!(g.length===0)){j.next=2;break}return j.abrupt("return");case 2:k.cancel();a=g;g=[];e=i;i=new(d("WAResolvable").Resolvable)();j.prev=7;j.next=10;return b("regeneratorRuntime").awrap(c(a));case 10:e.resolve();j.next=17;break;case 13:j.prev=13,j.t0=j["catch"](7),f.ERROR(h(),j.t0),e.reject(j.t0);case 17:case"end":return j.stop()}},null,this,[[7,13]])}return{flush:function(){return n()},write:function(a){g.push(a);a=i;l();m();return a.promise},config:function(a){j=a}}}g.makePersistedQueueCache=a}),98);
__d("WAPubSub",[],(function(a,b,c,d,e,f){"use strict";var g=function(){function a(){this.$1=new Set()}var b=a.prototype;b.publish=function(a){this.$1.forEach(function(b){return b(a)})};b.subscribe=function(a){var b=this;this.$1.add(a);return function(){b.$1["delete"](a)}};return a}();function a(){return new g()}f.WAPubSub=g;f.simplePubSub=a}),66);
__d("WAPersistedQueue",["WALogger","WAPersistedQueueCache","WAPubSub"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[PersistedQueue] new entry"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[PersistedQueue] flush: ","}"]);i=function(){return a};return a}function a(a,b,c){var e=d("WAPubSub").simplePubSub(),f=d("WAPersistedQueueCache").makePersistedQueueCache(a,function(c){return b.write(a,c).then(function(){d("WALogger").DEV(i(),c.length),e.publish({type:"flush"})})},c);return{subscribe:function(a){return e.subscribe(a)},config:function(a){f.config(a)},count:function(c){return b.count(a,c)},where:function(c,d,e){return b.where(a,c,d,e)},write:function(a){d("WALogger").DEV(h());e.publish({type:"new_entity"});return f.write(a)},flush:function(){return f.flush()},ack:function(c,d){return b.ack(a,c,d)},"delete":function(c){return b["delete"](a,c)},failAck:function(c,d){return b.failAck(a,c,d)},clear:function(){return b.clear(a)}}}g.initPersistedQueue=a}),98);
__d("WAMapContentTypeToFbType",["WAAssertUnreachable"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a){case"text":return"text";case"media":return"media";case"reaction":return"reaction";case"live_location":case"pay":case"product_list":case"poll_creation":case"poll_vote":case"scheduled_call":return"text";default:a;throw c("WAAssertUnreachable")(a)}}g.mapContentTypeToFbType=a}),98);
__d("WAProtocolQueue",["WAErr","WAGlobals","WAJids","WALogger","WAMapContentTypeToFbType","WAPersistedQueue"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Protocol Queue is already initialized"]);h=function(){return a};return a}var i=5e3,j=null;function a(a){if(j!=null){d("WALogger").WARN(h());return j}a=d("WAPersistedQueue").initPersistedQueue("stanzaQueue",a,{cacheSize:null,maxDelay:i});j=a;return j}function b(){if(!j)throw c("WAErr")("Protocol queue not initialized");return j}function e(a){return a.map(function(a){return a.type==="message"?k(a):a})}function k(a){switch(a.subtype){case"unavailable":var b=a,c=d("WAJids").extractUserJid(b.from);c={type:"UnavailableMsg",id:{chat:b.jid,author:d("WAGlobals").getMyUserJid()===c?"@me":c,externalId:b.stanzaId},ts:b.serverTs};return{stanzaId:b.stanzaId,jid:b.jid,type:b.type,message:{decrypted:c,details:{count:null,externalId:b.stanzaId,folder:b.fbFolderId,from:d("WAJids").switchOnMsgrChatJidType(b.jid,{group:function(a){return{type:"group",groupJid:a,chat:a,author:b.from}},user:function(a){return{type:"device",deviceJid:b.from,chat:a,author:b.from}}}),hideDecryptionFailure:!1,messageAlreadyPresented:!1,offline:b.offline,recipient:b.recipient,reportingMeta:b.reportingMeta,retryCount:b.retryCount,ts:b.serverTs,isInstamadillo:!1,type:d("WAMapContentTypeToFbType").mapContentTypeToFbType(b.contentType)}},consumerRetries:a.consumerRetries,failAcks:a.failAcks,stanzaQueueId:a.stanzaQueueId};case"armadillo":var e=a;c=d("WAJids").extractUserJid(e.from);c={device:{id:d("WAJids").extractDeviceId(e.from),identity:e.remoteIdentity},folder:e.fbFolderId,id:{chat:e.jid,author:d("WAGlobals").getMyUserJid()===c?"@me":c,externalId:e.stanzaId},msg:e.message,recipientsCount:null,reportingMeta:e.reportingMeta,ts:e.serverTs,type:"IncomingMsg"};return{stanzaId:e.stanzaId,jid:e.jid,type:e.type,message:{decrypted:c,details:{count:null,externalId:e.stanzaId,folder:e.fbFolderId,from:d("WAJids").switchOnMsgrChatJidType(e.jid,{group:function(a){return{type:"group",groupJid:a,chat:a,author:e.from}},user:function(a){return{type:"device",deviceJid:e.from,chat:a,author:e.from}}}),hideDecryptionFailure:!1,messageAlreadyPresented:!1,offline:e.offline,recipient:e.recipient,reportingMeta:e.reportingMeta,retryCount:e.retryCount,ts:e.serverTs,isInstamadillo:!1,type:d("WAMapContentTypeToFbType").mapContentTypeToFbType(e.contentType)}},consumerRetries:a.consumerRetries,failAcks:a.failAcks,stanzaQueueId:a.stanzaQueueId};case"ciphertext":var f=a;c=d("WAJids").extractUserJid(f.from);c={createPlaceholder:f.contentType!=="reaction",id:{chat:f.jid,author:d("WAGlobals").getMyUserJid()===c?"@me":c,externalId:f.stanzaId},ts:f.serverTs,type:"IncomingCiphertextMsg"};return{stanzaId:f.stanzaId,jid:f.jid,type:f.type,message:{decrypted:c,details:{count:null,externalId:f.stanzaId,folder:f.fbFolderId,from:d("WAJids").switchOnMsgrChatJidType(f.jid,{group:function(a){return{type:"group",groupJid:a,chat:a,author:f.from}},user:function(a){return{type:"device",deviceJid:f.from,chat:a,author:f.from}}}),hideDecryptionFailure:!1,messageAlreadyPresented:!1,offline:f.offline,recipient:f.recipient,reportingMeta:f.reportingMeta,retryCount:f.retryCount,ts:f.serverTs,isInstamadillo:!1,type:d("WAMapContentTypeToFbType").mapContentTypeToFbType(f.contentType)}},consumerRetries:a.consumerRetries,failAcks:a.failAcks,stanzaQueueId:a.stanzaQueueId};default:a;return a}}function f(a){return a}function l(a){return a}g.initProtocolQueue=a;g.protocolQueue=b;g.mapProtocolEntriesV2toV1=e;g.mapProcolQueueMessageV2toV1=k;g.appdataApplicationProtocol=f;g.extractSubProtocolFromAppdataProtocol=l}),98);
__d("WAProtocolQueueState",["Promise","WAProtocolQueue","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var c=d("WAProtocolQueue").protocolQueue();void (h||(h=b("Promise"))).all(a.map(function(a){return c.write(a)}));return h.resolve()}function c(a){void d("WAProtocolQueue").protocolQueue().write(a);return(h||(h=b("Promise"))).resolve()}function e(a){return d("WAProtocolQueue").protocolQueue().ack(a)}function f(a){return d("WAProtocolQueue").protocolQueue()["delete"](a)}var i=function(a){var c,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:c=[{}];a.types!=null?c=a.types.map(function(b){b={type:b};a.jid!=null&&(b=babelHelpers["extends"]({jid:a.jid},b));return b}):a.jid!=null&&(c=[{jid:a.jid}]);e=c.map(function(b){return d("WAProtocolQueue").protocolQueue().where(b,a.limit,a.order)});g.next=5;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(e).then(function(a){return a.flatMap(function(a){return a})}));case 5:f=g.sent;return g.abrupt("return",d("WAProtocolQueue").mapProtocolEntriesV2toV1(f));case 7:case"end":return g.stop()}},null,this)},j=function(){return d("WAProtocolQueue").protocolQueue().count()};g.persistStanzas=a;g.persistStanza=c;g.ackProtocols=e;g.deleteQueueIDs=f;g.read=i;g.count=j}),98);
__d("WAGetSyncKey",["WABaseGlobals"],(function(a,b,c,d,e,f,g){function a(a){return d("WABaseGlobals").runInTransaction({SyncKeyStore:!0},function(b){b=b.SyncKeyStore;return b.get(a)})}function b(){return d("WABaseGlobals").runInTransaction({SyncKeyStore:!0},function(a){a=a.SyncKeyStore;return a.getAll()})}function c(a){return d("WABaseGlobals").runInTransaction({SyncKeyStore:!0},function(b){b=b.SyncKeyStore;return b.set(a)})}function e(a){return d("WABaseGlobals").runInTransaction({SyncKeyStore:!0},function(b){b=b.SyncKeyStore;return b.expire(a)})}g.getSyncKeyInTransaction_DO_NOT_USE=a;g.getAllSyncKeysInTransaction=b;g.setSyncKeyInTransaction=c;g.expireSyncKeyInTransaction=e}),98);
__d("WASyncdHandleKeyRequest",["Promise","WAGetSyncKey","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){var c,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:c=[];e=[];f.next=4;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(a.map(function(a){var f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:g.next=2;return b("regeneratorRuntime").awrap(d("WAGetSyncKey").getSyncKeyInTransaction_DO_NOT_USE(a));case 2:f=g.sent,f?c.push(f):e.push(a);case 4:case"end":return g.stop()}},null,this)})));case 4:return f.abrupt("return",{keys:c,orphanKeys:e});case 5:case"end":return f.stop()}},null,this)}g.getKeysForKeyRequest=a}),98);
__d("WACryptoLtHash",["Promise","WACryptoHkdf","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=2,j=128;a=new ArrayBuffer(j);c=function(){function a(a){this.salt=a}var c=a.prototype;c.add=function(a,c){var d=this;return c.reduce(function(a,c){return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.t0=d;e.next=3;return b("regeneratorRuntime").awrap(a);case 3:e.t1=e.sent;e.t2=c;return e.abrupt("return",e.t0.$1.call(e.t0,e.t1,e.t2));case 6:case"end":return e.stop()}},null,this)},(h||(h=b("Promise"))).resolve(a))};c.subtract=function(a,c){var d=this;return c.reduce(function(a,c){return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.t0=d;e.next=3;return b("regeneratorRuntime").awrap(a);case 3:e.t1=e.sent;e.t2=c;return e.abrupt("return",e.t0.$2.call(e.t0,e.t1,e.t2));case 6:case"end":return e.stop()}},null,this)},(h||(h=b("Promise"))).resolve(a))};c.subtractThenAdd=function(a,c,d){var e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:g.next=2;return b("regeneratorRuntime").awrap(this.subtract(a,d));case 2:e=g.sent;g.next=5;return b("regeneratorRuntime").awrap(this.add(e,c));case 5:f=g.sent;return g.abrupt("return",{ltHash:f,subtractResult:e});case 7:case"end":return g.stop()}},null,this)};c.$1=function(a,c){var e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b("regeneratorRuntime").awrap(d("WACryptoHkdf").extractAndExpand(c,this.salt,j));case 2:e=f.sent;return f.abrupt("return",this.performPointwiseWithOverflow(a,e,function(a,b){return a+b}));case 4:case"end":return f.stop()}},null,this)};c.$2=function(a,c){var e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b("regeneratorRuntime").awrap(d("WACryptoHkdf").extractAndExpand(c,this.salt,j));case 2:e=f.sent;return f.abrupt("return",this.performPointwiseWithOverflow(a,e,function(a,b){return a-b}));case 4:case"end":return f.stop()}},null,this)};c.performPointwiseWithOverflow=function(a,b,c){a=new DataView(a);b=new DataView(b);var d=new ArrayBuffer(a.byteLength),e=new DataView(d);for(var f=0;f<a.byteLength;f+=i)e.setUint16(f,c(a.getUint16(f,!0),b.getUint16(f,!0)),!0);return d};return a}();e=new c("WhatsApp Patch Integrity");g.KEY_LENGTH_BYTES=j;g.EMPTY_LT_HASH=a;g.LtHash16=c;g.LT_HASH_ANTI_TAMPERING=e}),98);
__d("WAGetCollectionVersion",["Promise","WABaseGlobals","WACryptoLtHash","WATimeUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return d("WABaseGlobals").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.get(a)})}function i(a,b){a=a.CollectionVersionStore;return a.get(b).then(function(a){return(a=a==null?void 0:a.ltHash)!=null?a:new ArrayBuffer(d("WACryptoLtHash").KEY_LENGTH_BYTES)})}function c(a){return d("WABaseGlobals").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return i({CollectionVersionStore:b},a)})}function e(a){return d("WABaseGlobals").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.bulkGet(a)})}function f(){return d("WABaseGlobals").runInTransaction({CollectionVersionStore:!0},function(a){a=a.CollectionVersionStore;return a.getAll()})}function j(a,b,c){return d("WABaseGlobals").runInTransaction({CollectionVersionStore:!0},function(d){d=d.CollectionVersionStore;return d.update(a,{version:b,ltHash:c})})}function k(a){return d("WABaseGlobals").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.bulkUpdate(a)})}function l(a){return d("WABaseGlobals").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.get(a).then(function(a){return a==null?void 0:a.isCollectionInMacMismatchFatal})})}function m(a){return d("WABaseGlobals").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.update(a,{isCollectionInMacMismatchFatal:!0})})}function n(a){return d("WABaseGlobals").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.get(a).then(function(a){return a==null?void 0:a.isCollectionLthashInconsistent})})}function o(a){return d("WABaseGlobals").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.update(a,{isCollectionLthashInconsistent:!0})})}function p(a){var c=function(b){return a.map(function(a){return b.update(a.collection,{lastSyncAttemptStartTimes:a.lastSyncAttemptStartTimes})})};return d("WABaseGlobals").runInTransaction({CollectionVersionStore:!0},function(a){var d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:d=a.CollectionVersionStore;e.next=3;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(c(d)));case 3:case"end":return e.stop()}},null,this)})}function q(a){return d("WABaseGlobals").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.update(a,{lastSuccessfulSyncEndTime:d("WATimeUtils").unixTimeMs()})})}g.getCollectionVersionInTransaction=a;g.getCollectionVersionLtHash=i;g.getCollectionVersionLtHashInTransaction=c;g.bulkGetCollectionVersionsInTransaction=e;g.getAllCollectionVersionsInTransaction=f;g.updateCollectionVersionAndLtHashInTransaction=j;g.bulkUpdateCollectionVersionInTransaction=k;g.getIsCollectionInMacMismatchFatalInTransaction=l;g.updateIsCollectionInMacMismatchFatalInTransaction=m;g.getIsCollectionLthashInconsistentInTransaction=n;g.updateIsCollectionLthashInconsistentInTransaction=o;g.bulkSetCollectionSyncAttemptStartTimesInTransaction=p;g.updateLastSuccessfulSyncEndTimeInTransaction=q}),98);
__d("WAGetMissingKey",["WABaseGlobals"],(function(a,b,c,d,e,f,g){function a(){return d("WABaseGlobals").runInTransaction({MissingKeyStore:!0},function(a){a=a.MissingKeyStore;return a.getAll()})}function b(a){return d("WABaseGlobals").runInTransaction({MissingKeyStore:!0},function(b){b=b.MissingKeyStore;return b.bulkGet(a)})}function c(){return d("WABaseGlobals").runInTransaction({MissingKeyStore:!0},function(a){a=a.MissingKeyStore;return a.count()})}function e(a){return d("WABaseGlobals").runInTransaction({MissingKeyStore:!0},function(b){b=b.MissingKeyStore;return b.bulkUpdate(a)})}g.getAllMissingKeysInTransaction=a;g.bulkGetMissingKeysInTransaction=b;g.getMissingKeyCountTransaction=c;g.bulkUpdateMissingKeysInTransaction=e}),98);
__d("WAGetPendingMutation",["WABaseGlobals"],(function(a,b,c,d,e,f,g){function a(a){return d("WABaseGlobals").runInTransaction({PendingMutationStore:!0},function(b){b=b.PendingMutationStore;return b.getByCollection(a)})}function b(){return d("WABaseGlobals").runInTransaction({PendingMutationStore:!0},function(a){a=a.PendingMutationStore;return a.getAll()})}function c(a){return d("WABaseGlobals").runInTransaction({PendingMutationStore:!0},function(b){b=b.PendingMutationStore;return b.bulkCreate(a)})}g.getSyncPendingMutationsByCollectionInTransaction=a;g.getAllSyncPendingMutationsInTransaction=b;g.bulkCreateSyncPendingMutationsInTransaction=c}),98);
__d("WAGetSyncAction",["WABaseGlobals"],(function(a,b,c,d,e,f,g){function a(){return d("WABaseGlobals").runInTransaction({SyncActionStore:!0},function(a){a=a.SyncActionStore;return a.count()})}function b(a){return d("WABaseGlobals").runInTransaction({SyncActionStore:!0},function(b){b=b.SyncActionStore;return b.get(a)})}function c(a){return d("WABaseGlobals").runInTransaction({SyncActionStore:!0},function(b){b=b.SyncActionStore;return b.getByCollections(a)})}function e(a){return d("WABaseGlobals").runInTransaction({SyncActionStore:!0},function(b){b=b.SyncActionStore;return b.getByIndexMacs(a)})}function f(a){return d("WABaseGlobals").runInTransaction({SyncActionStore:!0},function(b){b=b.SyncActionStore;return b.getByActionStates(a)})}function h(a){return d("WABaseGlobals").runInTransaction({SyncActionStore:!0},function(b){b=b.SyncActionStore;return b.getByModelInfos(a)})}function i(){return d("WABaseGlobals").runInTransaction({SyncActionStore:!0},function(a){a=a.SyncActionStore;return a.getAll()})}function j(a){return d("WABaseGlobals").runInTransaction({SyncActionStore:!0},function(b){b=b.SyncActionStore;return b.bulkUpdate(a)})}g.countSyncActionsInTransaction=a;g.getSyncActionInTransaction=b;g.getSyncActionsByCollectionsInTransaction=c;g.getSyncActionsByIndexMacsInTransaction=e;g.getSyncActionsByActionStatesInTransaction=f;g.getSyncActionsByModelInfosInTransaction=h;g.getAllSyncActions=i;g.bulkUpdateSyncActionsInTransaction=j}),98);
__d("WASyncdConst",["$InternalEnum","WATimeUtils"],(function(a,b,c,d,e,f,g){a=1e3;c=1e3*60*60;e=2;f=d("WATimeUtils").DAY_MILLISECONDS*2;d=100;var h=2e3,i=10,j=100,k=0,l=3,m=7,n=(b=b("$InternalEnum"))({Star:"star",Contact:"contact",Mute:"mute",PinDEPRECATED:"pin",Pin:"pin_v1",SettingPushName:"setting_pushName",LabelEdit:"label_edit",LabelMessage:"label_message",LabelJid:"label_jid",QuickReply:"quick_reply",LocaleSetting:"setting_locale",Archive:"archive",MarkChatAsRead:"markChatAsRead",ClearChat:"clearChat",DeleteMessageForMe:"deleteMessageForMe",Sentinel:"sentinel",UnarchiveChatsSetting:"setting_unarchiveChats",DeleteChat:"deleteChat",AndroidUnsupportedActions:"android_unsupported_actions",PrimaryFeature:"primary_feature",Subscription:"subscription",Nux:"nux",Agent:"deviceAgent",TimeFormat:"time_format",UserStatusMute:"userStatusMute",PrimaryVersion:"primary_version",RemoveRecentSticker:"removeRecentSticker",ChatAssignment:"agentChatAssignment",ChatAssignmentOpenedStatus:"agentChatAssignmentOpenedStatus",FavoriteSticker:"favoriteSticker",PnForLidChat:"pnForLidChat",ShareOwnPn:"shareOwnPn",ExternalWebBeta:"external_web_beta",MarketingMessage:"marketingMessage",MarketingMessageBroadcast:"marketingMessageBroadcast",StatusPrivacy:"status_privacy",BotWelcomeRequest:"bot_welcome_request",LabelReordering:"label_reordering",PaymentInfo:"payment_info",CustomPaymentMethods:"custom_payment_methods"}),o=b({Regular:"regular",RegularLow:"regular_low",RegularHigh:"regular_high",CriticalBlock:"critical_block",CriticalUnblockLow:"critical_unblock_low"}),p=b.Mirrored(["Success","SuccessHasMore","Conflict","ConflictHasMore","ErrorRetry","ErrorFatal","Blocked"]),q=b.Mirrored(["UpToDate","Dirty","FailingFiniteRetry","Fatal","Blocked"]),r=b.Mirrored(["Success","Malformed","Orphan","Unsupported","Skipped","Failed"]),s=b.Mirrored(["Msg","Chat","Agent","ChatAssignment","UserStatusMute"]),t=b.Mirrored(["ApplyRemoteAndDropLocal","SkipRemote","SkipRemoteAndDropLocal"]);b=b.Mirrored(["Patch","Snapshot","Local"]);g.BACKOFF_MIN_TIMEOUT=a;g.BACKOFF_MAX_TIMEOUT=c;g.BACKOFF_BASE=e;g.FINITE_FAILURE_EXPIRY_DURATION=f;g.MIN_INLINE_MUTATIONS=d;g.MAX_INLINE_MUTATIONS=h;g.MIN_PATCH_SIZE=i;g.MAX_PATCH_SIZE=j;g.DEFAULT_COLLECTION_VERSION=k;g.LABEL_ASSOCIATION_SYNC_VERSION=l;g.CHAT_ASSIGNMENT_SYNC_VERSION=m;g.Actions=n;g.CollectionName=o;g.CollectionState=p;g.CollectionSyncState=q;g.SyncActionState=r;g.SyncModelType=s;g.ConflictResolutionState=t;g.SyncDataType=b}),98);
__d("WASyncdCollectionsStateMachine",["WAGetCollectionVersion","WALogger","WASyncdConst","WATimeUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Collection "," is in finite retry state with no failure start time"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: ",": "," ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: state machine persistToDb. states:"]);j=function(){return a};return a}a=function(){function a(){}a.loadStatesFromDb=function(){var a=this,c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").getAllCollectionVersionsInTransaction());case 2:c=e.sent,c.forEach(function(b){return a.collectionStates.set(b.collection,{collection:b.collection,state:b.state,finiteFailureStartTime:b.finiteFailureStartTime})});case 4:case"end":return e.stop()}},null,this)};a.persistToDb=function(){var a=[];this.collectionStates.forEach(function(b){return a.push(b)});d("WALogger").LOG(j());a.forEach(function(a){var b=a.finiteFailureStartTime==null?"":"(failure start: "+a.finiteFailureStartTime+")";d("WALogger").LOG(i(),a.collection,a.state,b)});return d("WAGetCollectionVersion").bulkUpdateCollectionVersionInTransaction(a)};a.clean=function(){this.collectionStates=new Map()};a.getCollectionState=function(a){var b=this.collectionStates.get(a);if(b)return b.state;this.moveCollectionsToUpToDate([a]);return d("WASyncdConst").CollectionSyncState.UpToDate};a.getCollectionsInStateDirty=function(){var a=[];this.collectionStates.forEach(function(b){b.state===d("WASyncdConst").CollectionSyncState.Dirty&&a.push(b.collection)});return a};a.getCollectionsInStateRetry=function(){var a=[];this.collectionStates.forEach(function(b){b.state===d("WASyncdConst").CollectionSyncState.FailingFiniteRetry&&a.push(b.collection)});return a};a.getCollectionsInStateFatal=function(){var a=[];this.collectionStates.forEach(function(b){b.state===d("WASyncdConst").CollectionSyncState.Fatal&&a.push(b.collection)});return a};a.getCollectionsInStateBlocked=function(){var a=[];this.collectionStates.forEach(function(b){b.state===d("WASyncdConst").CollectionSyncState.Blocked&&a.push(b.collection)});return a};a.moveCollectionsToUpToDate=function(a){var b=this;a.forEach(function(a){return b.collectionStates.set(a,{collection:a,state:d("WASyncdConst").CollectionSyncState.UpToDate,finiteFailureStartTime:void 0})})};a.moveCollectionsToDirty=function(a){var b=this;a.forEach(function(a){return b.collectionStates.set(a,{collection:a,state:d("WASyncdConst").CollectionSyncState.Dirty,finiteFailureStartTime:(a=b.collectionStates.get(a))==null?void 0:a.finiteFailureStartTime})})};a.moveCollectionsToFiniteRetry=function(a){var b=this;a.forEach(function(a){return b.collectionStates.set(a,{collection:a,state:d("WASyncdConst").CollectionSyncState.FailingFiniteRetry,finiteFailureStartTime:(a=(a=b.collectionStates.get(a))==null?void 0:a.finiteFailureStartTime)!=null?a:d("WATimeUtils").unixTimeMs()})})};a.moveCollectionsToFatal=function(a){var b=this;a.forEach(function(a){return b.collectionStates.set(a,{collection:a,state:d("WASyncdConst").CollectionSyncState.Fatal})})};a.moveCollectionsToBlocked=function(a){var b=this;a.forEach(function(a){return b.collectionStates.set(a,{collection:a,state:d("WASyncdConst").CollectionSyncState.Blocked,finiteFailureStartTime:(a=b.collectionStates.get(a))==null?void 0:a.finiteFailureStartTime})})};a.getExpiredCollections=function(){var a=[];this.collectionStates.forEach(function(b){if(b.state===d("WASyncdConst").CollectionSyncState.FailingFiniteRetry){var c;b.finiteFailureStartTime==null?(c=Infinity,d("WALogger").WARN(h(),b.collection)):c=b.finiteFailureStartTime;c=c+d("WASyncdConst").FINITE_FAILURE_EXPIRY_DURATION;c<d("WATimeUtils").unixTimeMs()&&a.push(b.collection)}});return a};a.getCollectionMinFailureTime=function(){var a=Array.from(this.collectionStates.values()).filter(function(a){return a.state===d("WASyncdConst").CollectionSyncState.FailingFiniteRetry}).map(function(a){return a.finiteFailureStartTime}).filter(Boolean);return a.length===0?null:Math.min.apply(Math,a)};return a}();a.collectionStates=new Map();g["default"]=a}),98);
__d("WASyncdCryptoUtils",["WACryptoUtils","WAErr","WASyncdKeyTypes"],(function(a,b,c,d,e,f,g){function a(a){if(a.length===0)throw c("WAErr")("buffers length is zero");if(a.length===1)return a[0];var b=a.map(function(a){return a.byteLength});b=b.reduce(function(a,b){return a+b});b=new Uint8Array(b);var d=0,e;for(e=0;e<a.length;e++)b.set(new Uint8Array(a[e]),d),d+=a[e].byteLength;return b.buffer}function b(a,b,d){if(b<0||d<0)throw c("WAErr")("buffers length is zero");var e=new Array(3);a=new Uint8Array(a);e[0]=a.slice(0,b).buffer;e[1]=a.slice(b,b+d).buffer;e[2]=a.slice(b+d).buffer;return e}function e(a){return Uint8Array.from(a.split(" ").map(function(a){return parseInt(a,16)}))}function f(a){return Array.from(new Uint8Array(d("WASyncdKeyTypes").fromSyncKeyId(a))).map(function(a){return a.toString(16)}).toString().replace(/,/g," ")}function h(a){return Array.from(new Uint8Array(a)).map(function(a){return a.toString(16).padStart(2,"0")}).join("")}function i(a){var b=new ArrayBuffer(8);new DataView(b).setUint32(4,a,!1);return b}var j=new TextEncoder();function k(a){return j.encode(a)}function l(a,b){return d("WACryptoUtils").arrayBuffersEqual(d("WASyncdKeyTypes").fromSyncKeyId(a),d("WASyncdKeyTypes").fromSyncKeyId(b))}g.combine=a;g.split=b;g.hexToUint8Array=e;g.syncKeyIdToHex=f;g.arrayBufferToHexPadded=h;g.to64BitNetworkOrder=i;g.toUtf8=k;g.syncKeyIdsEqual=l}),98);
__d("WASyncdDisabled",["WABaseGlobals"],(function(a,b,c,d,e,f,g){function a(){return d("WABaseGlobals").getConfig().syncdDisabled()}g.isSyncdDisabled=a}),98);
__d("WASyncdKeyCache",["WABase64","WAGetSyncKey","WASyncdKeyTypes","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=new Map();function a(a){var c,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:e=d("WABase64").encodeB64(d("WASyncdKeyTypes").fromSyncKeyId(a));f=h.get(e);if(!f){g.next=4;break}return g.abrupt("return",f.keyData);case 4:g.next=6;return b("regeneratorRuntime").awrap(d("WAGetSyncKey").getSyncKeyInTransaction_DO_NOT_USE(a));case 6:f=g.sent;f&&h.set(e,f);return g.abrupt("return",(c=f)==null?void 0:c.keyData);case 9:case"end":return g.stop()}},null,this)}function c(){h=new Map()}g.getKeyData=a;g.clearSyncKeysCache=c}),98);
__d("WAProtocol.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.internalSpec={remoteJid:[1,(b=d("WAProtoConst")).TYPES.STRING],fromMe:[2,b.TYPES.BOOL],id:[3,b.TYPES.STRING],participant:[4,b.TYPES.STRING]};g.MessageKeySpec=a}),98);
__d("WASyncAction.pb",["$InternalEnum","WAProtoConst","WAProtocol.pb"],(function(a,b,c,aa,d,e,f){var g;c=(a=b("$InternalEnum"))({REGULAR:0,SCHEDULED_CALL:1,VOICE_CHAT:2});d=a({NONE:0,SCHEDULED:1,PRIVACY:2,LIGHTWEIGHT:3});e=a({CONNECTED:0,REJECTED:1,CANCELLED:2,ACCEPTEDELSEWHERE:3,MISSED:4,INVALID:5,UNAVAILABLE:6,UPCOMING:7,FAILED:8,ABANDONED:9,ONGOING:10});b=a({ALLOW_LIST:0,DENY_LIST:1,CONTACTS:2});var ba=a({PERSONALIZED:0});a=a({ANDROID:0,SMBA:1,IPHONE:2,SMBI:3,WEB:4,UWP:5,DARWIN:6});var h={},i={},j={},k={},l={},m={},n={},o={},p={},q={},r={},s={},t={},u={},v={},w={},x={},y={},z={},A={},B={},C={},D={},E={},F={},G={},H={},I={},J={},K={},L={},M={},N={},O={},P={},Q={},R={},S={},T={},U={},V={},W={},X={},Y={},Z={},$={},ca={},da={},ea={},fa={},ga={},ha={};h.internalSpec={emoji:[1,(g=aa("WAProtoConst")).TYPES.STRING],weight:[2,g.TYPES.FLOAT]};i.internalSpec={callResult:[1,g.TYPES.ENUM,e],isDndMode:[2,g.TYPES.BOOL],silenceReason:[3,g.TYPES.ENUM,d],duration:[4,g.TYPES.INT64],startTime:[5,g.TYPES.INT64],isIncoming:[6,g.TYPES.BOOL],isVideo:[7,g.TYPES.BOOL],isCallLink:[8,g.TYPES.BOOL],callLinkToken:[9,g.TYPES.STRING],scheduledCallId:[10,g.TYPES.STRING],callId:[11,g.TYPES.STRING],callCreatorJid:[12,g.TYPES.STRING],groupJid:[13,g.TYPES.STRING],participants:[14,g.FLAGS.REPEATED|g.TYPES.MESSAGE,j],callType:[15,g.TYPES.ENUM,c]};j.internalSpec={userJid:[1,g.TYPES.STRING],callResult:[2,g.TYPES.ENUM,e]};k.internalSpec={timestamp:[1,g.TYPES.INT64],starAction:[2,g.TYPES.MESSAGE,fa],contactAction:[3,g.TYPES.MESSAGE,ea],muteAction:[4,g.TYPES.MESSAGE,da],pinAction:[5,g.TYPES.MESSAGE,ca],securityNotificationSetting:[6,g.TYPES.MESSAGE,$],pushNameSetting:[7,g.TYPES.MESSAGE,Z],quickReplyAction:[8,g.TYPES.MESSAGE,X],recentEmojiWeightsAction:[11,g.TYPES.MESSAGE,U],labelEditAction:[14,g.TYPES.MESSAGE,V],labelAssociationAction:[15,g.TYPES.MESSAGE,W],localeSetting:[16,g.TYPES.MESSAGE,Y],archiveChatAction:[17,g.TYPES.MESSAGE,T],deleteMessageForMeAction:[18,g.TYPES.MESSAGE,S],keyExpiration:[19,g.TYPES.MESSAGE,L],markChatAsReadAction:[20,g.TYPES.MESSAGE,R],clearChatAction:[21,g.TYPES.MESSAGE,Q],deleteChatAction:[22,g.TYPES.MESSAGE,P],unarchiveChatsSetting:[23,g.TYPES.MESSAGE,O],primaryFeature:[24,g.TYPES.MESSAGE,K],androidUnsupportedActions:[26,g.TYPES.MESSAGE,J],agentAction:[27,g.TYPES.MESSAGE,I],subscriptionAction:[28,g.TYPES.MESSAGE,H],userStatusMuteAction:[29,g.TYPES.MESSAGE,G],timeFormatAction:[30,g.TYPES.MESSAGE,F],nuxAction:[31,g.TYPES.MESSAGE,E],primaryVersionAction:[32,g.TYPES.MESSAGE,D],stickerAction:[33,g.TYPES.MESSAGE,B],removeRecentStickerAction:[34,g.TYPES.MESSAGE,C],chatAssignment:[35,g.TYPES.MESSAGE,A],chatAssignmentOpenedStatus:[36,g.TYPES.MESSAGE,z],pnForLidChatAction:[37,g.TYPES.MESSAGE,y],marketingMessageAction:[38,g.TYPES.MESSAGE,x],marketingMessageBroadcastAction:[39,g.TYPES.MESSAGE,w],externalWebBetaAction:[40,g.TYPES.MESSAGE,v],privacySettingRelayAllCalls:[41,g.TYPES.MESSAGE,u],callLogAction:[42,g.TYPES.MESSAGE,t],statusPrivacy:[44,g.TYPES.MESSAGE,s],botWelcomeRequestAction:[45,g.TYPES.MESSAGE,r],deleteIndividualCallLog:[46,g.TYPES.MESSAGE,q],labelReorderingAction:[47,g.TYPES.MESSAGE,p],paymentInfoAction:[48,g.TYPES.MESSAGE,o],customPaymentMethodsAction:[49,g.TYPES.MESSAGE,l]};l.internalSpec={customPaymentMethods:[1,g.FLAGS.REPEATED|g.TYPES.MESSAGE,m]};m.internalSpec={credentialId:[1,g.FLAGS.REQUIRED|g.TYPES.STRING],country:[2,g.FLAGS.REQUIRED|g.TYPES.STRING],type:[3,g.FLAGS.REQUIRED|g.TYPES.STRING],metadata:[4,g.FLAGS.REPEATED|g.TYPES.MESSAGE,n]};n.internalSpec={key:[1,g.FLAGS.REQUIRED|g.TYPES.STRING],value:[2,g.FLAGS.REQUIRED|g.TYPES.STRING]};o.internalSpec={cpi:[1,g.TYPES.STRING]};p.internalSpec={sortedLabelIds:[1,g.FLAGS.REPEATED|g.TYPES.INT32]};q.internalSpec={peerJid:[1,g.TYPES.STRING],isIncoming:[2,g.TYPES.BOOL]};r.internalSpec={isSent:[1,g.TYPES.BOOL]};s.internalSpec={mode:[1,g.TYPES.ENUM,b],userJid:[2,g.FLAGS.REPEATED|g.TYPES.STRING]};t.internalSpec={callLogRecord:[1,g.TYPES.MESSAGE,i]};u.internalSpec={isEnabled:[1,g.TYPES.BOOL]};v.internalSpec={isOptIn:[1,g.TYPES.BOOL]};w.internalSpec={repliedCount:[1,g.TYPES.INT32]};x.internalSpec={name:[1,g.TYPES.STRING],message:[2,g.TYPES.STRING],type:[3,g.TYPES.ENUM,ba],createdAt:[4,g.TYPES.INT64],lastSentAt:[5,g.TYPES.INT64],isDeleted:[6,g.TYPES.BOOL],mediaId:[7,g.TYPES.STRING]};y.internalSpec={pnJid:[1,g.TYPES.STRING]};z.internalSpec={chatOpened:[1,g.TYPES.BOOL]};A.internalSpec={deviceAgentID:[1,g.TYPES.STRING]};B.internalSpec={url:[1,g.TYPES.STRING],fileEncSha256:[2,g.TYPES.BYTES],mediaKey:[3,g.TYPES.BYTES],mimetype:[4,g.TYPES.STRING],height:[5,g.TYPES.UINT32],width:[6,g.TYPES.UINT32],directPath:[7,g.TYPES.STRING],fileLength:[8,g.TYPES.UINT64],isFavorite:[9,g.TYPES.BOOL],deviceIdHint:[10,g.TYPES.UINT32]};C.internalSpec={lastStickerSentTs:[1,g.TYPES.INT64]};D.internalSpec={version:[1,g.TYPES.STRING]};E.internalSpec={acknowledged:[1,g.TYPES.BOOL]};F.internalSpec={isTwentyFourHourFormatEnabled:[1,g.TYPES.BOOL]};G.internalSpec={muted:[1,g.TYPES.BOOL]};H.internalSpec={isDeactivated:[1,g.TYPES.BOOL],isAutoRenewing:[2,g.TYPES.BOOL],expirationDate:[3,g.TYPES.INT64]};I.internalSpec={name:[1,g.TYPES.STRING],deviceID:[2,g.TYPES.INT32],isDeleted:[3,g.TYPES.BOOL]};J.internalSpec={allowed:[1,g.TYPES.BOOL]};K.internalSpec={flags:[1,g.FLAGS.REPEATED|g.TYPES.STRING]};L.internalSpec={expiredKeyEpoch:[1,g.TYPES.INT32]};M.internalSpec={key:[1,g.TYPES.MESSAGE,aa("WAProtocol.pb").MessageKeySpec],timestamp:[2,g.TYPES.INT64]};N.internalSpec={lastMessageTimestamp:[1,g.TYPES.INT64],lastSystemMessageTimestamp:[2,g.TYPES.INT64],messages:[3,g.FLAGS.REPEATED|g.TYPES.MESSAGE,M]};O.internalSpec={unarchiveChats:[1,g.TYPES.BOOL]};P.internalSpec={messageRange:[1,g.TYPES.MESSAGE,N]};Q.internalSpec={messageRange:[1,g.TYPES.MESSAGE,N]};R.internalSpec={read:[1,g.TYPES.BOOL],messageRange:[2,g.TYPES.MESSAGE,N]};S.internalSpec={deleteMedia:[1,g.TYPES.BOOL],messageTimestamp:[2,g.TYPES.INT64]};T.internalSpec={archived:[1,g.TYPES.BOOL],messageRange:[2,g.TYPES.MESSAGE,N]};U.internalSpec={weights:[1,g.FLAGS.REPEATED|g.TYPES.MESSAGE,h]};V.internalSpec={name:[1,g.TYPES.STRING],color:[2,g.TYPES.INT32],predefinedId:[3,g.TYPES.INT32],deleted:[4,g.TYPES.BOOL],orderIndex:[5,g.TYPES.INT32]};W.internalSpec={labeled:[1,g.TYPES.BOOL]};X.internalSpec={shortcut:[1,g.TYPES.STRING],message:[2,g.TYPES.STRING],keywords:[3,g.FLAGS.REPEATED|g.TYPES.STRING],count:[4,g.TYPES.INT32],deleted:[5,g.TYPES.BOOL]};Y.internalSpec={locale:[1,g.TYPES.STRING]};Z.internalSpec={name:[1,g.TYPES.STRING]};$.internalSpec={showNotification:[1,g.TYPES.BOOL]};ca.internalSpec={pinned:[1,g.TYPES.BOOL]};da.internalSpec={muted:[1,g.TYPES.BOOL],muteEndTimestamp:[2,g.TYPES.INT64],autoMuted:[3,g.TYPES.BOOL]};ea.internalSpec={fullName:[1,g.TYPES.STRING],firstName:[2,g.TYPES.STRING],lidJid:[3,g.TYPES.STRING],saveOnPrimaryAddressbook:[4,g.TYPES.BOOL]};fa.internalSpec={starred:[1,g.TYPES.BOOL]};ga.internalSpec={index:[1,g.TYPES.BYTES],value:[2,g.TYPES.MESSAGE,k],padding:[3,g.TYPES.BYTES],version:[4,g.TYPES.INT32]};ha.internalSpec={currentLthash:[1,g.TYPES.BYTES],newLthash:[2,g.TYPES.BYTES],patchVersion:[3,g.TYPES.BYTES],collectionName:[4,g.TYPES.BYTES],firstFourBytesFromAHashOfSnapshotMacKey:[5,g.TYPES.BYTES],newLthashSubtract:[6,g.TYPES.BYTES],numberAdd:[7,g.TYPES.INT32],numberRemove:[8,g.TYPES.INT32],numberOverride:[9,g.TYPES.INT32],senderPlatform:[10,g.TYPES.ENUM,a],isSenderPrimary:[11,g.TYPES.BOOL]};f.CallLogRecord$CallType=c;f.CallLogRecord$SilenceReason=d;f.CallLogRecord$CallResult=e;f.SyncActionValue$StatusPrivacyAction$StatusDistributionMode=b;f.SyncActionValue$MarketingMessageAction$MarketingMessagePrototypeType=ba;f.PatchDebugData$Platform=a;f.RecentEmojiWeightSpec=h;f.CallLogRecordSpec=i;f.CallLogRecord$ParticipantInfoSpec=j;f.SyncActionValueSpec=k;f.SyncActionValue$CustomPaymentMethodsActionSpec=l;f.SyncActionValue$CustomPaymentMethodSpec=m;f.SyncActionValue$CustomPaymentMethodMetadataSpec=n;f.SyncActionValue$PaymentInfoActionSpec=o;f.SyncActionValue$LabelReorderingActionSpec=p;f.SyncActionValue$DeleteIndividualCallLogActionSpec=q;f.SyncActionValue$BotWelcomeRequestActionSpec=r;f.SyncActionValue$StatusPrivacyActionSpec=s;f.SyncActionValue$CallLogActionSpec=t;f.SyncActionValue$PrivacySettingRelayAllCallsSpec=u;f.SyncActionValue$ExternalWebBetaActionSpec=v;f.SyncActionValue$MarketingMessageBroadcastActionSpec=w;f.SyncActionValue$MarketingMessageActionSpec=x;f.SyncActionValue$PnForLidChatActionSpec=y;f.SyncActionValue$ChatAssignmentOpenedStatusActionSpec=z;f.SyncActionValue$ChatAssignmentActionSpec=A;f.SyncActionValue$StickerActionSpec=B;f.SyncActionValue$RemoveRecentStickerActionSpec=C;f.SyncActionValue$PrimaryVersionActionSpec=D;f.SyncActionValue$NuxActionSpec=E;f.SyncActionValue$TimeFormatActionSpec=F;f.SyncActionValue$UserStatusMuteActionSpec=G;f.SyncActionValue$SubscriptionActionSpec=H;f.SyncActionValue$AgentActionSpec=I;f.SyncActionValue$AndroidUnsupportedActionsSpec=J;f.SyncActionValue$PrimaryFeatureSpec=K;f.SyncActionValue$KeyExpirationSpec=L;f.SyncActionValue$SyncActionMessageSpec=M;f.SyncActionValue$SyncActionMessageRangeSpec=N;f.SyncActionValue$UnarchiveChatsSettingSpec=O;f.SyncActionValue$DeleteChatActionSpec=P;f.SyncActionValue$ClearChatActionSpec=Q;f.SyncActionValue$MarkChatAsReadActionSpec=R;f.SyncActionValue$DeleteMessageForMeActionSpec=S;f.SyncActionValue$ArchiveChatActionSpec=T;f.SyncActionValue$RecentEmojiWeightsActionSpec=U;f.SyncActionValue$LabelEditActionSpec=V;f.SyncActionValue$LabelAssociationActionSpec=W;f.SyncActionValue$QuickReplyActionSpec=X;f.SyncActionValue$LocaleSettingSpec=Y;f.SyncActionValue$PushNameSettingSpec=Z;f.SyncActionValue$SecurityNotificationSettingSpec=$;f.SyncActionValue$PinActionSpec=ca;f.SyncActionValue$MuteActionSpec=da;f.SyncActionValue$ContactActionSpec=ea;f.SyncActionValue$StarActionSpec=fa;f.SyncActionDataSpec=ga;f.PatchDebugDataSpec=ha}),98);
__d("WASyncdMetricCriticalBootstrapStage",["$InternalEnum","WALogger","WAPREList","WAPREMetrics","WASyncAction.pb","decodeProtobuf"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: unknown SyncdDecryptMutationsType for DecryptMutations"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing decryptedMutationMessageRangeCountArray for DecryptMutations"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing totalAdditionalMessagesCount for DecryptMutations"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing count for DecryptMutations"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing type for DecryptMutations"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: unknown bootstrap stage: "," for critical bootstrap stage"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing bootstrap stage for critical bootstrap stage"]);n=function(){return a};return a}var o=b("$InternalEnum").Mirrored(["ABOUT_TO_APPLY_MUTATIONS","APPLIED_MUTATIONS","MUTATIONS_DECRYPTED","REQUEST_BUILT","RESPONSE_RECEIVED","RESPONSE_PARSED_VALID","ENTERED_RETRY_MODE","MISSING_KEYS_RECEIVED"]),p=b("$InternalEnum").Mirrored(["PATCH_MUTATIONS","SNAPSHOT_MUTATIONS"]);function q(a){d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.SYNCD_CRITICAL_BOOTSTRAP_STAGE).endSuccess(r({type:a}))}function a(a,b){q(o.MUTATIONS_DECRYPTED),d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.SYNCD_DECRYPT_MUTATIONS).endSuccess(s({type:a,mutations:b}))}function r(a){return{string:{criticalBootstrapStage:a.type}}}function s(a){var b=a.type;a=a.mutations;var c,e=0,f=[];a.forEach(function(a){a=a.binarySyncData;a=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,a);a=a.value;if(a==null)return;a.archiveChatAction?c=a.archiveChatAction.messageRange:a.markChatAsReadAction?c=a.markChatAsReadAction.messageRange:a.clearChatAction?c=a.clearChatAction.messageRange:a.deleteChatAction&&(c=a.deleteChatAction.messageRange);c!=null&&(e+=c.messages.length,f.push(c.messages.length))});return{string:{mutationType:b},"int":{count:a.length,totalAdditionalMessagesCount:e},int_array:{messageRangeLengths:f}}}function c(a){a=a==null?void 0:(a=a.string)==null?void 0:a.criticalBootstrapStage;if(a==null){d("WALogger").ERROR(n());return null}var b=o.cast(a);if(b==null){d("WALogger").ERROR(m(),a);return null}return{type:b}}function e(a){var b,c,e;b=a==null?void 0:(b=a.string)==null?void 0:b.mutationType;c=a==null?void 0:(c=a["int"])==null?void 0:c.count;e=a==null?void 0:(e=a["int"])==null?void 0:e.totalAdditionalMessagesCount;a=a==null?void 0:(a=a.int_array)==null?void 0:a.messageRangeLengths;if(b==null){d("WALogger").ERROR(l());return null}if(c==null){d("WALogger").ERROR(k());return null}if(e==null){d("WALogger").ERROR(j());return null}if(a==null){d("WALogger").ERROR(i());return null}b=p.cast(b);if(b==null){d("WALogger").ERROR(h());return null}return{type:b,count:c,totalAdditionalMessagesCount:e,decryptedMutationMessageRangeCountArray:a}}g.SyncdCriticalBootstrapStageType=o;g.SyncdDecryptMutationsType=p;g.reportSyncdCriticalBootstrapStage=q;g.reportSyncdDecryptedMutations=a;g.convertSyncdCriticalBootstrapStageFromAnnotations=c;g.convertSyncdDecryptMutationsMetricsFromAnnotations=e}),98);
__d("WASyncdMetricFatalError",["$InternalEnum","WALogger","WAPREList","WAPREMetrics","WASyncdConst"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: unknown error code: "," for syncd fatal error"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing error code for syncd fatal error"]);i=function(){return a};return a}var j=b("$InternalEnum").Mirrored(["PATCH_PROTOBUF_SERIALIZATION_FAILED","MUTATIONS_PROTOBUF_SERIALIZATION_FAILED","ACTION_DATA_PROTOBUF_SERIALIZATION_FAILED","ENCRYPTION_FAILED","MISSING_SNAPSHOT_VERSION","MISSING_SNAPSHOT_MAC","MISSING_SNAPSHOT_KEY_ID","MISSING_PATCH_VERSION","PATCH_WITH_BOTH_INLINE_AND_EXTERNAL_MUTATIONS","MISSING_PATCH_SNAPSHOT_MAC","MISSING_PATCH_MAC","MISSING_PATCH_KEY_ID","MISSING_EXTERNAL_BLOB_REFERENCE_MEDIA_KEY","MISSING_EXTERNAL_BLOB_REFERENCE_DIRECT_PATH","MISSING_EXTERNAL_BLOB_REFERENCE_FILE_SHA256","MISSING_EXTERNAL_BLOB_REFERENCE_FILE_ENC_SHA256","MISSING_MUTATION_OPERATION","MISSING_MUTATION_RECORD","MISSING_MUTATION_INDEX","MISSING_MUTATION_VALUE","MISSING_MUTATION_KEY_ID","EXTERNAL_BLOB_REFERENCE_PROTOBUF_DESERIALIZATION_FAILED","SNAPSHOT_PROTOBUF_DESERIALIZATION_FAILED","PATCH_PROTOBUF_DESERIALIZATION_FAILED","MUTATIONS_PROTOBUF_DESERIALIZATION_FAILED","ACTION_DATA_PROTOBUF_DESERIALIZATION_FAILED","MISSING_ACTION_INDEX","MISSING_ACTION_VERSION","SNAPSHOT_MAC_MISMATCH_IN_SNAPSHOT","SNAPSHOT_MAC_MISMATCH_IN_PATCH","MAC_MISMATCH_PATCH","DECRYPTION_FAILED","DUPLICATE_PATCH_VERSION_IN_COLLECTION","SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_PATCH","SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_SNAPSHOT","MISSING_ACTION_VALUE","MISSING_ACTION_TIMESTAMP","XMPP_BAD_REQUEST_FOR_COLLECTION","XMPP_NOT_FOUND_FOR_COLLECTION","CYCLIC_MUTATION_DEPENDENCY_IN_PATCH","SERVER_DID_NOT_SEND_ALL_PATCHES","TERMINAL_PATCH_MISSING_DATA","TERMINAL_PATCH_DESERIALIZATION_ERROR","TERMINAL_PATCH_UNKNOWN","INVALID_ACTION_INDEX","XMPP_BAD_REQUEST_GLOBAL_ERROR","XMPP_NOT_FOUND_GLOBAL_ERROR","XMPP_BAD_METHOD_GLOBAL_ERROR","XMPP_NOT_ACCEPTABLE_GLOBAL_ERROR","TOO_MANY_INTERNAL_SERVER_ERRORS_IN_7D","TIMEOUT_WHILE_WAITING_FOR_MISSING_KEY","MISSING_KEY_ON_ALL_CLIENTS"]);function a(a,b,c,e,f,g,h,i,j,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C){d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.SYNCD_FATAL_ERROR).endFail("syncd fatal error: "+a,k({type:a,collection:b,patchSnapshotMutationCount:c,patchVersion:e,isFatal:f,isLtHashConsistent:g,macFatalCollectionNameMismatch:h,macFatalCurrentLthashMismatch:i,macFatalNewLthashMismatch:j,macFatalPatchVersionMismatch:l,macFatalNewLthashSubtractMismatch:m,macFatalNumberHasOverrideMutation:n,macFatalNumberNumAddMutation:o,macFatalNumberNumRemoveMutation:p,macFatalSenderCurrentLthashToLocalCalculatedCurrentLthashMismatch:q,isPatchSenderPrimary:r,macFatalDidUseMacFetchFallback:s,macFatalHasMissingRemove:t,macFatalNumberAddMismatch:u,macFatalNumberRemoveMismatch:v,macFatalDidPreviousPatchFailPostSaveValidation:w,macFatalPreviousPatchNewLthashToCurrentPatchCurrentLthash:x,isPreviousPatchAnIncomingPatch:y,isLastPatchSenderAPrimaryDevice:z,isSenderIndexSameAsPreviousSenderIndex:A,didBootstrapFromSnapshot:B,isThereAnotherSyncdCompanion:C}))}function k(a){var b=a.type,c=a.collection,d=a.patchSnapshotMutationCount,e=a.patchVersion,f=a.isFatal,g=a.isLtHashConsistent,h=a.macFatalCollectionNameMismatch,i=a.macFatalCurrentLthashMismatch,j=a.macFatalNewLthashMismatch,k=a.macFatalPatchVersionMismatch,l=a.macFatalNewLthashSubtractMismatch,m=a.macFatalNumberHasOverrideMutation,n=a.macFatalNumberNumAddMutation,o=a.macFatalNumberNumRemoveMutation,p=a.macFatalSenderCurrentLthashToLocalCalculatedCurrentLthashMismatch,q=a.isPatchSenderPrimary,r=a.macFatalDidUseMacFetchFallback,s=a.macFatalHasMissingRemove,t=a.macFatalNumberAddMismatch,u=a.macFatalNumberRemoveMismatch,v=a.macFatalDidPreviousPatchFailPostSaveValidation,w=a.macFatalPreviousPatchNewLthashToCurrentPatchCurrentLthash,x=a.isPreviousPatchAnIncomingPatch,y=a.isLastPatchSenderAPrimaryDevice,z=a.isSenderIndexSameAsPreviousSenderIndex,A=a.didBootstrapFromSnapshot;a=a.isThereAnotherSyncdCompanion;return{string:{errorCode:b,collection:c==null?null:c},"int":{patchSnapshotMutationCount:d,patchVersion:e,macFatalNumberNumAddMutation:n,macFatalNumberNumRemoveMutation:o},bool:{isFatal:f,isLtHashConsistent:g,macFatalCollectionNameMismatch:h,macFatalCurrentLthashMismatch:i,macFatalNewLthashMismatch:j,macFatalPatchVersionMismatch:k,macFatalNewLthashSubtractMismatch:l,macFatalNumberHasOverrideMutation:m,macFatalSenderCurrentLthashToLocalCalculatedCurrentLthashMismatch:p,isPatchSenderPrimary:q,macFatalDidUseMacFetchFallback:r,macFatalHasMissingRemove:s,macFatalNumberAddMismatch:t,macFatalNumberRemoveMismatch:u,macFatalDidPreviousPatchFailPostSaveValidation:v,macFatalPreviousPatchNewLthashToCurrentPatchCurrentLthash:w,isPreviousPatchAnIncomingPatch:x,isLastPatchSenderAPrimaryDevice:y,isSenderIndexSameAsPreviousSenderIndex:z,didBootstrapFromSnapshot:A,isThereAnotherSyncdCompanion:a}}}function c(a){var b;b=a==null?void 0:(b=a.string)==null?void 0:b.errorCode;if(b==null){d("WALogger").ERROR(i());return null}var c=j.cast(b);if(c==null){d("WALogger").ERROR(h(),b);return null}return{type:c,collection:d("WASyncdConst").CollectionName.cast(a==null?void 0:(b=a.string)==null?void 0:b.collection),patchSnapshotMutationCount:a==null?void 0:(c=a["int"])==null?void 0:c.patchSnapshotMutationCount,patchVersion:a==null?void 0:(b=a["int"])==null?void 0:b.patchVersion,isFatal:a==null?void 0:(c=a.bool)==null?void 0:c.isFatal,isLtHashConsistent:a==null?void 0:(b=a.bool)==null?void 0:b.isLtHashConsistent,macFatalCollectionNameMismatch:a==null?void 0:(c=a.bool)==null?void 0:c.macFatalCollectionNameMismatch,macFatalCurrentLthashMismatch:a==null?void 0:(b=a.bool)==null?void 0:b.macFatalCurrentLthashMismatch,macFatalNewLthashMismatch:a==null?void 0:(c=a.bool)==null?void 0:c.macFatalNewLthashMismatch,macFatalPatchVersionMismatch:a==null?void 0:(b=a.bool)==null?void 0:b.macFatalPatchVersionMismatch,macFatalNewLthashSubtractMismatch:a==null?void 0:(c=a.bool)==null?void 0:c.macFatalNewLthashSubtractMismatch,macFatalNumberHasOverrideMutation:a==null?void 0:(b=a.bool)==null?void 0:b.macFatalNumberHasOverrideMutation,macFatalNumberNumAddMutation:a==null?void 0:(c=a["int"])==null?void 0:c.macFatalNumberNumAddMutation,macFatalNumberNumRemoveMutation:a==null?void 0:(b=a["int"])==null?void 0:b.macFatalNumberNumRemoveMutation,macFatalSenderCurrentLthashToLocalCalculatedCurrentLthashMismatch:a==null?void 0:(c=a.bool)==null?void 0:c.macFatalSenderCurrentLthashToLocalCalculatedCurrentLthashMismatch,isPatchSenderPrimary:a==null?void 0:(b=a.bool)==null?void 0:b.isPatchSenderPrimary,macFatalDidUseMacFetchFallback:a==null?void 0:(c=a.bool)==null?void 0:c.macFatalDidUseMacFetchFallback,macFatalHasMissingRemove:a==null?void 0:(b=a.bool)==null?void 0:b.macFatalHasMissingRemove,macFatalNumberAddMismatch:a==null?void 0:(c=a.bool)==null?void 0:c.macFatalNumberAddMismatch,macFatalNumberRemoveMismatch:a==null?void 0:(b=a.bool)==null?void 0:b.macFatalNumberRemoveMismatch,macFatalDidPreviousPatchFailPostSaveValidation:a==null?void 0:(c=a.bool)==null?void 0:c.macFatalDidPreviousPatchFailPostSaveValidation,macFatalPreviousPatchNewLthashToCurrentPatchCurrentLthash:a==null?void 0:(b=a.bool)==null?void 0:b.macFatalPreviousPatchNewLthashToCurrentPatchCurrentLthash,isPreviousPatchAnIncomingPatch:a==null?void 0:(c=a.bool)==null?void 0:c.isPreviousPatchAnIncomingPatch,isLastPatchSenderAPrimaryDevice:a==null?void 0:(b=a.bool)==null?void 0:b.isLastPatchSenderAPrimaryDevice,isSenderIndexSameAsPreviousSenderIndex:a==null?void 0:(c=a.bool)==null?void 0:c.isSenderIndexSameAsPreviousSenderIndex,didBootstrapFromSnapshot:a==null?void 0:(b=a.bool)==null?void 0:b.didBootstrapFromSnapshot,isThereAnotherSyncdCompanion:a==null?void 0:(c=a.bool)==null?void 0:c.isThereAnotherSyncdCompanion}}g.SyncdFatalErrorType=j;g.reportSyncdFatalError=a;g.convertSyncdFatalErrorFromAnnotations=c}),98);
__d("WAPromiseEach",["regeneratorRuntime"],(function(a,b,c,d,e,f){a=function(a,c){var d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:d=[],e=0;case 2:if(!(e<a.length)){f.next=11;break}f.t0=d;f.next=6;return b("regeneratorRuntime").awrap(c(a[e]));case 6:f.t1=f.sent,f.t0.push.call(f.t0,f.t1);case 8:e++;f.next=2;break;case 11:return f.abrupt("return",d);case 12:case"end":return f.stop()}},null,this)};f.promiseEach=a}),66);
__d("WAMemoizeCache",[],(function(a,b,c,d,e,f){var g=[];function a(){g.forEach(function(a){return a.clear()})}function h(){var a=new Map();g.push(a);return a}function b(a,b){var c;return function(){c||(c=h());var d=b.apply(void 0,arguments),e=c.get(d);e==null&&(e=a.apply(void 0,arguments),c.set(d,e));return e}}f.clearAllMemoizeCache=a;f.MemoizeCache=h;f.memoizeWithArgs=b}),66);
__d("WASyncdCryptoConst",[],(function(a,b,c,d,e,f){a="WhatsApp Mutation Keys";b=160;c=32;d=32;e=32;var g=32,h=32,i=c,j=i+d,k=j+e,l=k+g,m=l+h,n="0x01",o="0x02",p=0,q=32,r=8,s=16,t=new ArrayBuffer(q);f.HKDF_INFO=a;f.DERIVED_KEY_LENGTH=b;f.INDEX_KEY_LENGTH=c;f.VALUE_ENCRYPTION_KEY_LENGTH=d;f.VALUE_MAC_KEY_LENGTH=e;f.SNAPSHOT_MAC_KEY_LENGTH=g;f.PATCH_MAC_KEY_LENGTH=h;f.INDEX_KEY_END=i;f.VALUE_ENCRYPTION_KEY_END=j;f.VALUE_MAC_KEY_END=k;f.SNAPSHOT_MAC_KEY_END=l;f.PATCH_MAC_KEY_END=m;f.OPERATION_SET_HEX=n;f.OPERATION_REMOVE_HEX=o;f.MAX_OF_MIN_DATA_LENGTH=p;f.MAC_LENGTH=q;f.OCTET_LENGTH=r;f.IV_LENGTH=s;f.EMPTY_MUTATION_MAC=t}),66);
__d("WASyncdCryptoHelper",["WACryptoHkdf","WASyncdCryptoConst","WASyncdKeyTypes","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){var c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(h(a));case 2:c=e.sent;return e.abrupt("return",{indexKey:c.slice(0,d("WASyncdCryptoConst").INDEX_KEY_END),valueEncryptionKey:c.slice(d("WASyncdCryptoConst").INDEX_KEY_END,d("WASyncdCryptoConst").VALUE_ENCRYPTION_KEY_END),valueMacKey:c.slice(d("WASyncdCryptoConst").VALUE_ENCRYPTION_KEY_END,d("WASyncdCryptoConst").VALUE_MAC_KEY_END),snapshotMacKey:c.slice(d("WASyncdCryptoConst").VALUE_MAC_KEY_END,d("WASyncdCryptoConst").SNAPSHOT_MAC_KEY_END),patchMacKey:c.slice(d("WASyncdCryptoConst").SNAPSHOT_MAC_KEY_END,d("WASyncdCryptoConst").PATCH_MAC_KEY_END)});case 4:case"end":return e.stop()}},null,this)}function h(a){return d("WACryptoHkdf").extractAndExpand(d("WASyncdKeyTypes").fromSyncKeyData(a),d("WASyncdCryptoConst").HKDF_INFO,d("WASyncdCryptoConst").DERIVED_KEY_LENGTH)}g.generateEncryptionKeysUnmemoized=a}),98);
__d("WASyncdCrypto",["WABase64","WACryptoAesCbc","WACryptoDependencies","WACryptoHmac","WAErr","WAMemoizeCache","WAServerSync.pb","WASyncdCryptoConst","WASyncdCryptoHelper","WASyncdCryptoUtils","WASyncdKeyTypes"],(function(a,b,c,d,e,f,g){var h=d("WAMemoizeCache").memoizeWithArgs(d("WASyncdCryptoHelper").generateEncryptionKeysUnmemoized,function(a){return d("WABase64").encodeB64(d("WASyncdKeyTypes").fromSyncKeyData(a))});function a(a,b){return d("WACryptoHmac").hmacSha256(new Uint8Array(a),new Uint8Array(b))}function b(a,b){b=d("WASyncdKeyTypes").fromSyncKeyId(b);var e;switch(a){case d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET:e=d("WASyncdCryptoConst").OPERATION_SET_HEX;break;case d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE:e=d("WASyncdCryptoConst").OPERATION_REMOVE_HEX;break}if(e){a=new Uint8Array([parseInt(e,16)]).buffer;var f=new Uint8Array(a.byteLength+b.byteLength);f.set(new Uint8Array(a));f.set(new Uint8Array(b),a.byteLength);return f.buffer}else throw c("WAErr")("invalid mutation operation value")}function e(a,b){a=Math.max(0,d("WASyncdCryptoConst").MAX_OF_MIN_DATA_LENGTH-a-b);b=new Uint8Array(a);d("WACryptoDependencies").getCrypto().getRandomValues(b);return b.buffer}function f(a,b,c){return d("WACryptoAesCbc").aesCbcEncrypt(b,c,a)}function i(a,b,c){var e=new Uint8Array(d("WASyncdCryptoConst").OCTET_LENGTH);e.set([a.byteLength],e.byteLength-1);a=d("WASyncdCryptoUtils").combine([a,b,e.buffer]);return d("WACryptoHmac").hmacSha512(c,a,d("WASyncdCryptoConst").MAC_LENGTH)}function j(a,b,c){return d("WACryptoAesCbc").aesCbcDecrypt(b,a,c)}function k(a,b,c,e){return d("WACryptoHmac").hmacSha256(a,d("WASyncdCryptoUtils").combine([b,c,e]))}function l(a,b,c,e,f){return d("WACryptoHmac").hmacSha256(a,d("WASyncdCryptoUtils").combine([b].concat(c,[e,f])))}function m(a){var b=a.byteLength;return new Uint8Array(a).slice(b-d("WASyncdCryptoConst").MAC_LENGTH).buffer}g.generateEncryptionKeys=h;g.generateIndexMac=a;g.generateAssociatedData=b;g.generatePadding=e;g.generateCipherText=f;g.generateMac=i;g.decryptCipherText=j;g.generateSnapshotMac=k;g.generatePatchMac=l;g.valueMacFromIndexAndValueCipherText=m}),98);
__d("WASyncdError",[],(function(a,b,c,d,e,f){a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.name="SyncdMissingKeyError",b)||babelHelpers.assertThisInitialized(c)}return b}(babelHelpers.wrapNativeSuper(Error));b=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c){var d;d=a.call(this,b)||this;d.name="SyncdRetryableError";d.backoff=c;d.message=b;return d}return b}(babelHelpers.wrapNativeSuper(Error));c=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c;c=a.call(this,b)||this;c.name="SyncdFatalError";c.message=b;return c}return b}(babelHelpers.wrapNativeSuper(Error));f.SyncdMissingKeyError=a;f.SyncdRetryableError=b;f.SyncdFatalError=c}),66);
__d("WASyncdMetrics",["$InternalEnum","WALogger","WAPREList","WAPREMetrics","WASyncdConst"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: unknown error code: "," for key rotation event"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing error code for key rotation event"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: unknown error code: "," for critical event"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing error code for critical event"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: unknown collection "," for bootstrap data applied event"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing durationMs for bootstrap data applied event"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing snapshotUsed for bootstrap data applied event"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing collection for bootstrap data applied event"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: unknown collection "," for bootstrap app state download metric"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing isSuccess for bootstrap app state download metric"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing downloadStartTs for bootstrap app state download metric"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing collection for bootstrap app state download metric"]);s=function(){return a};return a}var t=b("$InternalEnum").Mirrored(["MISSING_MUTATION_TO_REMOVE"]),u=b("$InternalEnum").Mirrored(["SNAPSHOT_USED","SNAPSHOT_NOT_USED"]),v=b("$InternalEnum").Mirrored(["APP_STATE_SYNC_KEY_EXPIRY","DEVICE_DEREGISTERATION","NO_KEYS"]);function a(a){var b=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.SYNCD_BOOTSTRAP_APP_STATE_DOWNLOAD);a.isSuccess!=="success"?b.endFail("syncd error: Error downloading snapshot or patches",w(a)):b.endSuccess(w(a))}function c(a,b,c){d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.SYNCD_BOOTSTRAP_DATA_APPLIED).endSuccess(x({collection:a,snapshotUsed:b,durationMs:c}))}function e(a,b){d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.SYNCD_CRITICAL_EVENT).endFail("syncd critical event: "+a,y({type:a,collection:b}))}function f(a){d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.SYNCD_KEY_ROTATION).endSuccess(z({type:a}))}function w(a){var b=a.collection,c=a.downloadSize,d=a.downloadStartTs;a=a.isSuccess;return{string:{collection:b},"int":{downloadSize:c,downloadStartTs:d},bool:{isSuccess:a==="success"}}}function x(a){return{string:{collection:a.collection},bool:{snapshot:a.snapshotUsed===u.SNAPSHOT_USED},"int":{durationMs:a.durationMs}}}function y(a){return{string:{criticalEventCode:a.type,collection:a.collection==null?null:a.collection}}}function z(a){return{string:{keyRotationEventCode:a.type}}}function A(a){var b,c,e;b=a==null?void 0:(b=a.string)==null?void 0:b.collection;c=a==null?void 0:(c=a["int"])==null?void 0:c.downloadSize;e=a==null?void 0:(e=a["int"])==null?void 0:e.downloadStartTs;a=a==null?void 0:(a=a.bool)==null?void 0:a.isSuccess;if(b==null){d("WALogger").ERROR(s());return null}if(e==null){d("WALogger").ERROR(r());return null}if(a==null){d("WALogger").ERROR(q());return null}var f=d("WASyncdConst").CollectionName.cast(b);if(f==null){d("WALogger").ERROR(p(),b);return null}b=a?"success":"failure";return{collection:f,downloadStartTs:e,downloadSize:c,isSuccess:b}}function B(a){var b,c;b=a==null?void 0:(b=a.string)==null?void 0:b.collection;c=a==null?void 0:(c=a.bool)==null?void 0:c.snapshot;a=a==null?void 0:(a=a["int"])==null?void 0:a.durationMs;if(b==null){d("WALogger").ERROR(o());return null}if(c==null){d("WALogger").ERROR(n());return null}if(a==null){d("WALogger").ERROR(m());return null}var e=d("WASyncdConst").CollectionName.cast(b);if(e==null){d("WALogger").ERROR(l(),b);return null}b=c?u.SNAPSHOT_USED:u.SNAPSHOT_NOT_USED;return{collection:e,snapshotUsed:b,durationMs:a}}function C(a){var b;b=a==null?void 0:(b=a.string)==null?void 0:b.criticalEventCode;if(b==null){d("WALogger").ERROR(k());return null}var c=t.cast(b);if(c==null){d("WALogger").ERROR(j(),b);return null}return{type:c,collection:d("WASyncdConst").CollectionName.cast(a==null?void 0:(b=a.string)==null?void 0:b.collection)}}function D(a){a=a==null?void 0:(a=a.string)==null?void 0:a.keyRotationEventCode;if(a==null){d("WALogger").ERROR(i());return null}var b=v.cast(a);if(b==null){d("WALogger").ERROR(h(),a);return null}return{type:b}}function E(a){var b={};Object.keys(a).forEach(function(c){typeof a[c]==="number"?(b["int"]==null&&(b["int"]={}),b["int"][c]=a[c]):typeof a[c]==="string"&&(b.string==null&&(b.string={}),b.string[c]=a[c])});return Object.keys(b).length>0?b:void 0}b=function(){function a(){this.event=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.SYNCD)}var b=a.prototype;b.end=function(a){a===void 0&&(a=!1),a?this.event.endFail("syncd failed"):this.event.endSuccess()};b.mark=function(a,b){this.event.addPoint(a,E(b))};return a}();g.SyncdCriticalEventType=t;g.SyncdBootstrapDataAppliedSnapshotUsed=u;g.SyncdKeyRotationEventType=v;g.reportSyncdBootstrapAppStateDownloadMetric=a;g.reportSyncdBootstrapDataApplied=c;g.reportSyncdCriticalEvent=e;g.reportSyncdKeyRotationEvent=f;g.convertSyncdBootstrapAppStateDownloadFromAnnotations=A;g.convertSyncdBootstrapDataAppliedFromAnnotations=B;g.convertSyncdCriticalEventFromAnnotations=C;g.convertSyncdKeyRotationEventFromAnnotations=D;g.constructAnnotationsFromContext=E;g.SyncdEventFlow=b}),98);
__d("WASyncdAntiTampering",["$InternalEnum","Promise","WABaseGlobals","WACryptoLtHash","WACryptoUtils","WAGetCollectionVersion","WAGetSyncAction","WALogger","WAPromiseEach","WAServerSync.pb","WASyncdConst","WASyncdCrypto","WASyncdCryptoUtils","WASyncdError","WASyncdKeyCache","WASyncdKeyTypes","WASyncdMetricFatalError","WASyncdMetrics","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: lthash inconsistent for ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["|",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: current snapshot "," v"," with "," mutations:"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: logMacs: ",": prepare"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: failed LtHash check for ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: computing ltHash for ",":\n  currentLtHash: ","\n  macsToAdd:\n      ","\n  macsToRemove:\n      ","\n  macsToOverwrite (also remove):\n      ","\n  newLtHash: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing indexMAC in sync-actions table for REMOVE mutation in collection "," version "," direction "," for platform ",":\n        ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: had to use fallbackQueryForValueMac in collection "," for platform ",": ","\n        }"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: computing snapshot and patch macs for outgoing patch "," v",":\n  encoded version: ","\n  encoded collection: ","\n  snapshotMAC: ","\n  patchMAC: ",""]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd:\n      expected patchMAC: ","$\n      computed patchMAC: ",""]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: unable to validate patch mac."]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: skip fatal after snapshot mac mismatch for collection ",""]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd:\n      expected snapshotMAC: ","\n      computed snapshotMAC: ",""]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: unable to validate snapshot mac."]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: collection "," is already in snapshot mac mismatch so not checking again"]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: empty local lthash found when processing "," patch v",""]);x=function(){return a};return a}function y(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: "," received patch v"," !== latest local version (v",") + 1"]);y=function(){return a};return a}function z(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: error on incoming records:\n    \t",""],["syncd: error on incoming records:\n    \\t",""]);z=function(){return a};return a}function A(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: validating snapshot and patch mac for "," v",":\n  expected snapshotMAC: ","\n  expected patchMAC: ","\n  encoded version: ","\n  encoded collection: ","\n  key ID: ","\n  "]);A=function(){return a};return a}function B(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: shouldRecalculateLtHash: ",""]);B=function(){return a};return a}function C(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: validating snapshot mac for "," snapshot v",":\n  ltHash: ","\n  encoded version: ","\n  encoded collection: ","\n  expected snapshotMAC: ","\n  "]);C=function(){return a};return a}function D(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd:\n  "," snapshot macsToAdd:\n      ",""]);D=function(){return a};return a}var E=b("$InternalEnum").Mirrored(["Incoming","Outgoing"]);function F(a,b,c){c===void 0&&(c=!0);a=typeof a==="string"?a:d("WASyncdCryptoUtils").arrayBufferToHexPadded(a);b=typeof b==="string"?b:d("WASyncdCryptoUtils").arrayBufferToHexPadded(b);c=c?-16:0;return a.slice(c)+":"+b.slice(c)}var G=new TextDecoder();function a(a,c){var e,f,g,h,i,j,k,l,m,n,o;return b("regeneratorRuntime").async(function(p){while(1)switch(p.prev=p.next){case 0:e=c.mac,f=c.version,g=c.keyId,h=c.records;p.next=3;return b("regeneratorRuntime").awrap(d("WASyncdKeyCache").getKeyData(g.id));case 3:i=p.sent;if(i){p.next=6;break}throw new(d("WASyncdError").SyncdMissingKeyError)();case 6:j=new Map(h.map(function(a){return[d("WASyncdCryptoUtils").arrayBufferToHexPadded(a.index.blob),d("WASyncdCrypto").valueMacFromIndexAndValueCipherText(a.value.blob)]}));d("WALogger").LOG(D(),a,Array.from(j.entries()).map(function(a){var b=a[0];a=a[1];return F(b,a)}).join("\n\t"));p.next=10;return b("regeneratorRuntime").awrap(d("WACryptoLtHash").LT_HASH_ANTI_TAMPERING.add(d("WACryptoLtHash").EMPTY_LT_HASH,Array.from(j.values())));case 10:k=p.sent;p.next=13;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generateEncryptionKeys(i));case 13:l=p.sent;m=l.snapshotMacKey;n=d("WASyncdCryptoUtils").to64BitNetworkOrder(f.version);o=d("WASyncdCryptoUtils").toUtf8(a).buffer;d("WALogger").LOG(C(),a,f.version,d("WASyncdCryptoUtils").arrayBufferToHexPadded(k),d("WASyncdCryptoUtils").arrayBufferToHexPadded(n),d("WASyncdCryptoUtils").arrayBufferToHexPadded(o),d("WASyncdCryptoUtils").arrayBufferToHexPadded(e)).devConsole("\n  --- DEV ONLY ---\n  snapshotMacKey: "+d("WASyncdCryptoUtils").arrayBufferToHexPadded(m));p.next=20;return b("regeneratorRuntime").awrap(I(a,e,m,k,n,o,!0,h.length,c.version.version,null,null,null,null));case 20:return p.abrupt("return",k);case 21:case"end":return p.stop()}},null,this)}function c(a,c,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;return b("regeneratorRuntime").async(function(y){while(1)switch(y.prev=y.next){case 0:x=function(){var c,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b("regeneratorRuntime").awrap(O(a,!1));case 2:c=f.sent,e=new Map(c.map(function(a){var b=a.indexMac;a=a.valueMac;return[d("WASyncdCryptoUtils").arrayBufferToHexPadded(b),d("WASyncdCryptoUtils").arrayBufferToHexPadded(a)]})),d("WALogger").LOG(z(),p.map(function(a){var b=a.operation,c=a.indexMac;a=a.valueMac;return(b===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET?"set":"remove")+" | "+F(c,a,!1)+" | "+(e.has(d("WASyncdCryptoUtils").arrayBufferToHexPadded(c))?"found":"did not find")+" indexMAC in the above logged macs"}).join("\n\t"));case 5:case"end":return f.stop()}},null,this)};f=c.version,g=c.mutations,h=c.snapshotMac,i=c.patchMac,j=c.keyId;k=j.id;y.next=5;return b("regeneratorRuntime").awrap(d("WASyncdKeyCache").getKeyData(k));case 5:l=y.sent;if(l){y.next=8;break}throw new(d("WASyncdError").SyncdMissingKeyError)();case 8:y.next=10;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generateEncryptionKeys(l));case 10:m=y.sent;n=m.snapshotMacKey;o=m.patchMacKey;p=g.map(function(a){return{operation:a.operation,indexMac:a.record.index.blob,valueMac:d("WASyncdCrypto").valueMacFromIndexAndValueCipherText(a.record.value.blob)}});y.next=16;return b("regeneratorRuntime").awrap(d("WABaseGlobals").runInTransaction({SyncActionStore:!0},function(d){var e,c;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:e=d.SyncActionStore;f.next=3;return b("regeneratorRuntime").awrap(e.getByCollections([a]));case 3:c=f.sent;return f.abrupt("return",c);case 5:case"end":return f.stop()}},null,this)}));case 16:q=y.sent;r=1e3;s=d("WABaseGlobals").getConfig().syncShouldCalculateLtHashFromScratch()&&q.length<r;d("WALogger").LOG(B(),s);if(!s){y.next=26;break}y.next=23;return b("regeneratorRuntime").awrap(M(q));case 23:y.t0=y.sent;y.next=29;break;case 26:y.next=28;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").getCollectionVersionLtHashInTransaction(a));case 28:y.t0=y.sent;case 29:t=y.t0;y.next=32;return b("regeneratorRuntime").awrap(K(a,p,e,c.version.version,E.Incoming,t));case 32:u=y.sent;v=d("WASyncdCryptoUtils").to64BitNetworkOrder(f.version);w=d("WASyncdCryptoUtils").toUtf8(a).buffer;d("WALogger").LOG(A(),a,f.version,d("WASyncdCryptoUtils").arrayBufferToHexPadded(h),d("WASyncdCryptoUtils").arrayBufferToHexPadded(i),d("WASyncdCryptoUtils").arrayBufferToHexPadded(v),d("WASyncdCryptoUtils").arrayBufferToHexPadded(w),d("WASyncdCryptoUtils").arrayBufferToHexPadded(d("WASyncdKeyTypes").fromSyncKeyId(k)));y.prev=36;y.next=39;return b("regeneratorRuntime").awrap(J(a,i,o,h,p.map(function(a){return a.valueMac}),v,w,g.length,f.version));case 39:y.next=41;return b("regeneratorRuntime").awrap(I(a,h,n,u.ltHash,v,w,!1,g.length,f.version,c.clientDebugData,t,u,c.deviceIndex));case 41:y.next=48;break;case 43:y.prev=43;y.t1=y["catch"](36);y.next=47;return b("regeneratorRuntime").awrap(x());case 47:throw y.t1;case 48:return y.abrupt("return",u.ltHash);case 49:case"end":return y.stop()}},null,this,[[36,43]])}function H(a,c){var e,f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:h.next=2;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").getCollectionVersionInTransaction(a).then(function(a){return(a=a==null?void 0:a.version)!=null?a:0}));case 2:e=h.sent;if(!(e!==c-1)){h.next=7;break}f=e>c-1?"greater-than-expected":"less-than-expected";d("WALogger").WARN(y(),a,c,e).sendLogs("syncd-version-check-error-local-version-"+f);throw new(d("WASyncdError").SyncdRetryableError)("syncd-version-check-error-local-version-"+f);case 7:h.next=9;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").getCollectionVersionLtHashInTransaction(a));case 9:g=h.sent;if(!(d("WACryptoUtils").arrayBuffersEqual(g,d("WACryptoLtHash").EMPTY_LT_HASH)&&c!==1)){h.next=13;break}d("WALogger").WARN(x(),a,c).sendLogs("syncd-empty-lthash-on-mac-mismatch");throw new(d("WASyncdError").SyncdRetryableError)("empty lthash");case 13:case"end":return h.stop()}},null,this)}function I(a,c,e,f,g,h,i,j,k,l,m,n,o){var p,q,r,s,x,y,z,A,B,C,D,E,F,G,I,J,K,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z;return b("regeneratorRuntime").async(function($){while(1)switch($.prev=$.next){case 0:q=d("WABaseGlobals").getConfig().syncdShouldNotFatalOnSnapshotMacMismatchInPatches()&&!i;$.next=3;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").getIsCollectionInMacMismatchFatalInTransaction(a));case 3:$.t0=p=$.sent;if(!($.t0!=null)){$.next=8;break}$.t1=p;$.next=9;break;case 8:$.t1=!1;case 9:r=$.t1;if(!(q&&r)){$.next=13;break}d("WALogger").LOG(w(),a);return $.abrupt("return");case 13:$.next=15;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generateSnapshotMac(e,f,g,h));case 15:s=$.sent;x=d("WACryptoUtils").arrayBuffersEqual(s,c);if(x){$.next=64;break}d("WALogger").WARN(v()).sendLogs("syncd: unable to validate snapshot mac.");d("WALogger").DEV(u(),d("WASyncdCryptoUtils").arrayBufferToHexPadded(c),d("WASyncdCryptoUtils").arrayBufferToHexPadded(s));if(i){$.next=23;break}$.next=23;return b("regeneratorRuntime").awrap(H(a,k));case 23:$.next=25;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"failed validate snapshot mac"));case 25:$.next=27;return b("regeneratorRuntime").awrap(L(a));case 27:y=$.sent;z=y.isLtHashConsistent;A=y.scratchLtHash;B=i?d("WASyncdMetricFatalError").SyncdFatalErrorType.SNAPSHOT_MAC_MISMATCH_IN_SNAPSHOT:d("WASyncdMetricFatalError").SyncdFatalErrorType.SNAPSHOT_MAC_MISMATCH_IN_PATCH;C=(l==null?void 0:l.collectionName)&&!d("WACryptoUtils").arrayBuffersEqual(h,l==null?void 0:l.collectionName);D=(l==null?void 0:l.newLthash)&&!d("WACryptoUtils").arrayBuffersEqual(f,l==null?void 0:l.newLthash);E=(l==null?void 0:l.patchVersion)&&!d("WACryptoUtils").arrayBuffersEqual(g,l==null?void 0:l.patchVersion);F=(l==null?void 0:l.currentLthash)&&m&&!d("WACryptoUtils").arrayBuffersEqual(m,l==null?void 0:l.currentLthash);G=(l==null?void 0:l.newLthashSubtract)&&(n==null?void 0:n.subtractResult)&&!d("WACryptoUtils").arrayBuffersEqual(n==null?void 0:n.subtractResult,l==null?void 0:l.newLthashSubtract);I=n==null?void 0:n.hasOverride;J=n==null?void 0:n.numAdd;K=n==null?void 0:n.numRemove;M=(l==null?void 0:l.currentLthash)&&A&&!d("WACryptoUtils").arrayBuffersEqual(A,l==null?void 0:l.currentLthash);N=o===0;O=(l==null?void 0:l.numberAdd)!=null&&(n==null?void 0:n.numAdd)!=null&&(n==null?void 0:n.numAdd)!==(l==null?void 0:l.numberAdd);P=(l==null?void 0:l.numberRemove)!=null&&(n==null?void 0:n.numRemove)!=null&&(n==null?void 0:n.numRemove)!==(l==null?void 0:l.numberRemove);Q=n==null?void 0:n.didUseFallback;R=n==null?void 0:n.hasMissingRemove;$.next=47;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").getCollectionVersionInTransaction(a));case 47:S=$.sent;T=S==null?void 0:S.didLastPatchFailPostValidation;U=(l==null?void 0:l.currentLthash)&&(S==null?void 0:S.lastPatchNewLtHashFromPatchDebugData)&&!d("WACryptoUtils").arrayBuffersEqual(S==null?void 0:S.lastPatchNewLtHashFromPatchDebugData,l==null?void 0:l.currentLthash);V=S==null?void 0:S.isLastPatchAnIncomingPatch;W=S==null?void 0:S.isLastPatchSenderAPrimaryDevice;X=S==null?void 0:S.didBootstrapFromSnapshot;Y=(S==null?void 0:S.lastPatchSenderDeviceId)!=null&&o!=null&&o===(S==null?void 0:S.lastPatchSenderDeviceId);$.next=56;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getConfig().getAreThereMoreCompanions());case 56:Z=$.sent;d("WASyncdMetricFatalError").reportSyncdFatalError(B,a,j,k,!q,z,C,F,D,E,G,I,J,K,M,N,Q,R,O,P,T,U,V,W,Y,X,Z);if(!q){$.next=63;break}$.next=61;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").updateIsCollectionInMacMismatchFatalInTransaction(a));case 61:d("WALogger").LOG(t(),a);return $.abrupt("return");case 63:throw new(d("WASyncdError").SyncdFatalError)("unable to validate snapshot mac");case 64:case"end":return $.stop()}},null,this)}function J(a,c,e,f,g,h,i,j,k){var l,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:n.next=2;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generatePatchMac(e,f,g,h,i));case 2:l=n.sent;m=d("WACryptoUtils").arrayBuffersEqual(l,c);if(m){n.next=13;break}n.next=7;return b("regeneratorRuntime").awrap(H(a,k));case 7:n.next=9;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"failed validate patch mac"));case 9:d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MAC_MISMATCH_PATCH,a,j,k);d("WALogger").WARN(s()).sendLogs("syncd: unable to validate patch mac.");d("WALogger").DEV(r(),c,l);throw new(d("WASyncdError").SyncdFatalError)("unable to validate patch mac");case 13:case"end":return n.stop()}},null,this)}function e(a,c,e,f){var g,h,i,j,k,l,m,n;return b("regeneratorRuntime").async(function(o){while(1)switch(o.prev=o.next){case 0:o.next=2;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").getCollectionVersionInTransaction(a).then(function(a){return(a=a==null?void 0:a.version)!=null?a:d("WASyncdConst").DEFAULT_COLLECTION_VERSION}));case 2:o.t0=o.sent;g=o.t0+1;o.next=6;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generateEncryptionKeys(f));case 6:h=o.sent;i=h.patchMacKey;j=h.snapshotMacKey;k=d("WASyncdCryptoUtils").to64BitNetworkOrder(g);l=d("WASyncdCryptoUtils").toUtf8(a).buffer;o.next=13;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generateSnapshotMac(j,c,k,l));case 13:m=o.sent;o.next=16;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generatePatchMac(i,m,e.map(function(a){return a.valueMac}),k,l));case 16:n=o.sent;d("WALogger").LOG(q(),a,g,d("WASyncdCryptoUtils").arrayBufferToHexPadded(k),d("WASyncdCryptoUtils").arrayBufferToHexPadded(l),d("WASyncdCryptoUtils").arrayBufferToHexPadded(m),d("WASyncdCryptoUtils").arrayBufferToHexPadded(n)).devConsole("\n  --- DEV ONLY ---\n  snapshotMacKey: "+d("WASyncdCryptoUtils").arrayBufferToHexPadded(j)+"\n  patchMacKey: "+d("WASyncdCryptoUtils").arrayBufferToHexPadded(i));return o.abrupt("return",{snapshotMac:m,patchMac:n});case 19:case"end":return o.stop()}},null,this)}function K(a,c,e,f,g,i){var j,k,l,m,q,r,s,t,u,v,w,x;return b("regeneratorRuntime").async(function(y){while(1)switch(y.prev=y.next){case 0:x=function(a){return e==null?(h||(h=b("Promise"))).resolve(null):e(a)};if(!((j=i)!=null)){y.next=5;break}y.t0=j;y.next=8;break;case 5:y.next=7;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").getCollectionVersionLtHashInTransaction(a));case 7:y.t0=y.sent;case 8:k=y.t0;y.next=11;return b("regeneratorRuntime").awrap(N(c.map(function(a){return a.indexMac})));case 11:l=y.sent;m=new Map();q=new Map();r=new Map();s=!1;t=!1;y.next=19;return b("regeneratorRuntime").awrap(d("WAPromiseEach").promiseEach(c,function(c){var e,h,i,j,k,n,u,v;return b("regeneratorRuntime").async(function(w){while(1)switch(w.prev=w.next){case 0:e=c.indexMac,h=c.valueMac,i=c.operation;j=G.decode(e);k=l.get(j);if(!k){w.next=7;break}i===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE?q.set(d("WASyncdCryptoUtils").arrayBufferToHexPadded(e),k):r.set(d("WASyncdCryptoUtils").arrayBufferToHexPadded(e),k);w.next=12;break;case 7:if(!(i===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE)){w.next=12;break}w.next=10;return b("regeneratorRuntime").awrap(x(e));case 10:n=w.sent,n!=null?(q.set(d("WASyncdCryptoUtils").arrayBufferToHexPadded(e),n),t=!0,d("WALogger").WARN(p(),a,(u=d("WABaseGlobals").getConfig().primaryPlatform())!=null?u:"[empty]",d("WASyncdCryptoUtils").arrayBufferToHexPadded(e).slice(-16)).tags("non-sad").sendLogs("syncd: fallback query")):(s=!0,d("WASyncdMetrics").reportSyncdCriticalEvent(d("WASyncdMetrics").SyncdCriticalEventType.MISSING_MUTATION_TO_REMOVE,a),d("WALogger").ERROR(o(),a,f,g,(v=d("WABaseGlobals").getConfig().primaryPlatform())!=null?v:"[empty]",d("WASyncdCryptoUtils").arrayBufferToHexPadded(e).slice(-16)).sendLogs("syncd: missing indexMAC from REMOVE"));case 12:i===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET&&m.set(d("WASyncdCryptoUtils").arrayBufferToHexPadded(e),h);case 13:case"end":return w.stop()}},null,this)}));case 19:y.next=21;return b("regeneratorRuntime").awrap(d("WACryptoLtHash").LT_HASH_ANTI_TAMPERING.subtractThenAdd(k,Array.from(m.values()),Array.from(q.values()).concat(Array.from(r.values()))));case 21:u=y.sent;v=u.ltHash;w=u.subtractResult;d("WALogger").LOG(n(),a,d("WASyncdCryptoUtils").arrayBufferToHexPadded(k),Array.from(m.entries()).map(function(a){var b=a[0];a=a[1];return F(b,a)}).join("\n\t"),Array.from(q.entries()).map(function(a){var b=a[0];a=a[1];return F(b,a)}).join("\n\t"),Array.from(r.entries()).map(function(a){var b=a[0];a=a[1];return F(b,a)}).join("\n\t"),d("WASyncdCryptoUtils").arrayBufferToHexPadded(v));return y.abrupt("return",{ltHash:v,numAdd:m.size,numRemove:q.size,hasOverride:r.size>0,subtractResult:w,hasMissingRemove:s,didUseFallback:t});case 26:case"end":return y.stop()}},null,this)}function L(a,c){var e,f,g,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:k.next=2;return b("regeneratorRuntime").awrap(d("WABaseGlobals").runInTransaction({SyncActionStore:!0,CollectionVersionStore:!0},function(c){var d,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:d=c.SyncActionStore,e=c.CollectionVersionStore;if(!(a==null)){g.next=7;break}g.next=4;return b("regeneratorRuntime").awrap(e.getAll());case 4:g.t0=g.sent;g.next=11;break;case 7:g.next=9;return b("regeneratorRuntime").awrap(e.get(a));case 9:g.t1=g.sent,g.t0=[g.t1];case 11:f=g.t0;return g.abrupt("return",(h||(h=b("Promise"))).all(f.filter(Boolean).map(function(a){var c,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:c=a.collection,e=a.ltHash;g.next=3;return b("regeneratorRuntime").awrap(d.getByCollections([c]));case 3:f=g.sent;return g.abrupt("return",{collection:c,ltHash:e,mutations:f});case 5:case"end":return g.stop()}},null,this)})));case 13:case"end":return g.stop()}},null,this)}));case 2:e=k.sent;f=0;e.map(function(a){a.collection;a.ltHash;a=a.mutations;f+=a.length});if(!(c!==void 0&&f>c)){k.next=7;break}return k.abrupt("return",{isLtHashConsistent:void 0,scratchLtHash:void 0,cachedLtHash:void 0});case 7:g=null;i=null;j=!0;k.next=12;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(e.map(function(a){var c,e,f,h;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:c=a.collection,e=a.ltHash,f=a.mutations;k.next=3;return b("regeneratorRuntime").awrap(M(f));case 3:h=k.sent,g==null&&(g=h),i==null&&(i=e),d("WACryptoUtils").arrayBuffersEqual(e,h)||(j=!1,d("WALogger").ERROR(m(),c).verbose().sendLogs("LtHash check failed"));case 7:case"end":return k.stop()}},null,this)})));case 12:return k.abrupt("return",{isLtHashConsistent:j,scratchLtHash:g,cachedLtHash:i});case 13:case"end":return k.stop()}},null,this)}function M(a){a=new Map(a.map(function(a){return[d("WASyncdCryptoUtils").arrayBufferToHexPadded(a.indexMac),a.valueMac]}));return d("WACryptoLtHash").LT_HASH_ANTI_TAMPERING.add(d("WACryptoLtHash").EMPTY_LT_HASH,Array.from(a.values()))}function N(a){var c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(d("WAGetSyncAction").getSyncActionsByIndexMacsInTransaction(a));case 2:c=e.sent;return e.abrupt("return",new Map(c.map(function(a){return[G.decode(a.indexMac),a.valueMac]})));case 4:case"end":return e.stop()}},null,this)}function O(a,c){var e,f,g,i,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:c===void 0&&(c=!0);e=c?20:1;d("WALogger").LOG(l(),a);n.next=5;return b("regeneratorRuntime").awrap(d("WABaseGlobals").runInTransaction({SyncActionStore:!0,CollectionVersionStore:!0},function(c){var d=c.SyncActionStore;c=c.CollectionVersionStore;return(h||(h=b("Promise"))).all([c.get(a).then(function(a){return a==null?void 0:a.version}),d.getByCollections([a])])}));case 5:f=n.sent;g=f[0];i=f[1];d("WALogger").LOG(k(),a,g,i.length);if(!(c&&i.length>100)){n.next=11;break}return n.abrupt("return",i);case 11:m=i.reduce(function(a,b,d){d%e===0&&a.push("");a[a.length-1]+=F(b.indexMac,b.valueMac,c)+" | ";return a},[]);m.forEach(function(a){return d("WALogger").LOG(j(),a)});return n.abrupt("return",i);case 14:case"end":return n.stop()}},null,this)}function f(a,c){var e,f,g,h,j,k,l,m,n,o,p,q,r,s;return b("regeneratorRuntime").async(function(t){while(1)switch(t.prev=t.next){case 0:t.next=2;return b("regeneratorRuntime").awrap(L(a,300));case 2:e=t.sent;f=e.isLtHashConsistent;g=e.scratchLtHash;h=e.cachedLtHash;j=g==null?"":d("WASyncdCryptoUtils").arrayBufferToHexPadded(g).slice(-16);k=h==null?"":d("WASyncdCryptoUtils").arrayBufferToHexPadded(h).slice(-16);t.next=10;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").getIsCollectionLthashInconsistentInTransaction(a));case 10:l=t.sent;if(!(l===!0)){t.next=15;break}t.next=14;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"lthash already inconsistent. scratchLtHash: "+j+", cachedLtHash: "+k+", context: "+c));case 14:return t.abrupt("return",!0);case 15:if(!(f===!1)){t.next=37;break}t.next=18;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"lthash first time inconsistent. scratchLtHash: "+j+", cachedLtHash: "+k+", context: "+c));case 18:t.next=20;return b("regeneratorRuntime").awrap(L(a,300));case 20:m=t.sent;n=m.isLtHashConsistent;o=m.scratchLtHash;p=m.cachedLtHash;q=o==null?"":d("WASyncdCryptoUtils").arrayBufferToHexPadded(o).slice(-16);r=p==null?"":d("WASyncdCryptoUtils").arrayBufferToHexPadded(p).slice(-16);s=n==null?"[undefined]":(!n).toString();t.next=29;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"lthash inconsistency second run. is inconsistent? "+s+" scratchLtHash: "+q+", cachedLtHash: "+r+", context: "+c));case 29:t.next=31;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().printSyncdLog());case 31:t.next=33;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").updateIsCollectionLthashInconsistentInTransaction(a));case 33:d("WALogger").ERROR(i(),a).verbose().sendLogs("syncd: lthash inconsistent");return t.abrupt("return",!0);case 37:if(!(f===!0)){t.next=41;break}t.next=40;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"lthash consistent. scratchLtHash: "+j+", cachedLtHash: "+k+", context: "+c));case 40:return t.abrupt("return",!1);case 41:t.next=43;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"lthash unknown if consistent. scratchLtHash: "+j+", cachedLtHash: "+k+", context: "+c));case 43:return t.abrupt("return",void 0);case 44:case"end":return t.stop()}},null,this)}g.SyncdPatchDirection=E;g.computeLtHashAndValidateSnapshot=a;g.computeLtHashAndValidatePatch=c;g.computeOutgoingSnapshotAndPatchMacs=e;g.computeLtHash=K;g.checkLtHash=L;g.logMacsInSnapshot=O;g.reportCollectionInconsistency=f}),98);
__d("WASyncdCollectionHandlerTypesConverter",["WAServerSync.pb","WASyncAction.pb","decodeProtobuf","encodeProtobuf"],(function(a,b,c,d,e,f,g){function h(a){a=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,a);return d("encodeProtobuf").encodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,{value:a}).readBuffer()}function a(a,b){return a.map(function(a){var c=h(a.binarySyncAction);return{index:a.index,action:a.action,binarySyncData:c,actionState:b,version:a.version,keyId:a.keyId,indexMac:a.indexMac,valueMac:a.valueMac,collection:a.collection,timestamp:a.timestamp}})}function b(a,b,c,d,e){return{index:a.index,binarySyncData:a.binarySyncData,version:a.version,keyId:a.keyId,indexMac:a.indexMac,valueMac:a.valueMac,collection:a.collection,timestamp:a.timestamp,action:c,actionState:b,modelId:d,modelType:e!=null?e:void 0}}function c(a){return a.map(function(a){return{collection:a.collection,index:a.index,action:a.action,indexMac:a.indexMac,keyId:a.keyId,operation:d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET,binarySyncData:a.binarySyncData,valueMac:a.valueMac,version:a.version}})}g.syncActionToSyncData=h;g.encryptedUploadMutationsToSyncActions=a;g.setMutationToSyncAction=b;g.syncActionsToDecryptedMutation=c}),98);
__d("WASyncdCollectionUtils",["WASyncdConst"],(function(a,b,c,d,e,f,g){function a(a){return a==null}function b(a){switch(a){case d("WASyncdConst").CollectionName.CriticalBlock:return!0;case d("WASyncdConst").CollectionName.CriticalUnblockLow:return!0;case d("WASyncdConst").CollectionName.Regular:return!1;case d("WASyncdConst").CollectionName.RegularHigh:return!1;case d("WASyncdConst").CollectionName.RegularLow:return!1}}g.isBootstrap=a;g.isCriticalCollection=b}),98);
__d("WASyncdDecode",["WAServerSync.pb","WASyncAction.pb","WASyncdError","WASyncdMetricFatalError","decodeProtobuf"],(function(a,b,c,d,e,f,g){function a(a,b){try{return d("decodeProtobuf").decodeProtobuf(d("WAServerSync.pb").ExternalBlobReferenceSpec,b)}catch(b){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.EXTERNAL_BLOB_REFERENCE_PROTOBUF_DESERIALIZATION_FAILED,a);throw new(d("WASyncdError").SyncdFatalError)("external blob reference protobuf deserialization failed")}}function b(a,b){try{return d("decodeProtobuf").decodeProtobuf(d("WAServerSync.pb").SyncdSnapshotSpec,b)}catch(b){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.SNAPSHOT_PROTOBUF_DESERIALIZATION_FAILED,a);throw new(d("WASyncdError").SyncdFatalError)("snapshot protobuf deserialization failed")}}function c(a,b){try{return d("decodeProtobuf").decodeProtobuf(d("WAServerSync.pb").SyncdPatchSpec,b)}catch(b){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.PATCH_PROTOBUF_DESERIALIZATION_FAILED,a);throw new(d("WASyncdError").SyncdFatalError)("patch protobuf deserialization failed")}}function e(a,b){try{return d("decodeProtobuf").decodeProtobuf(d("WAServerSync.pb").SyncdMutationsSpec,b)}catch(b){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MUTATIONS_PROTOBUF_DESERIALIZATION_FAILED,a);throw new(d("WASyncdError").SyncdFatalError)("mutations protobuf deserialization failed")}}function f(a,b){try{return d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,b)}catch(b){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.ACTION_DATA_PROTOBUF_DESERIALIZATION_FAILED,a);throw new(d("WASyncdError").SyncdFatalError)("action data protobuf deserialization failed")}}g.decodeExternalBlobReference=a;g.decodeSyncdSnapshot=b;g.decodeSyncdPatch=c;g.decodeSyncdMutations=e;g.decodeSyncActionData=f}),98);
__d("WASyncdValidateSyncActionProtobuf",["WASyncdError","WASyncdMetricFatalError"],(function(a,b,c,d,e,f,g){a=function(){function a(){}a.validateSyncActionDataProtobuf=function(a,b){var c=b.index,e=b.value,f=b.padding;b=b.version;if(!c){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_ACTION_INDEX,a);throw new(d("WASyncdError").SyncdFatalError)("missing action index")}if(b==null){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_ACTION_VERSION,a);throw new(d("WASyncdError").SyncdFatalError)("missing action version")}return{index:c,value:e,padding:f,version:b}};return a}();g["default"]=a}),98);
__d("WASyncdDecryptMutations",["Promise","WABaseGlobals","WACryptoUtils","WAServerSync.pb","WASyncdCrypto","WASyncdCryptoConst","WASyncdCryptoUtils","WASyncdDecode","WASyncdError","WASyncdKeyCache","WASyncdMetricFatalError","WASyncdValidateSyncActionProtobuf","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=new TextDecoder();function a(a,c){return(h||(h=b("Promise"))).all(c.records.map(function(b){return j(a,d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET,b)}))}function e(a,c){return(h||(h=b("Promise"))).all(c.mutations.map(function(b){return j(a,b.operation,b.record)}))}function j(a,c,e){var f,g,h,j,l,m,n,o,p;return b("regeneratorRuntime").async(function(q){while(1)switch(q.prev=q.next){case 0:f=e.keyId.id;q.next=3;return b("regeneratorRuntime").awrap(d("WASyncdKeyCache").getKeyData(f));case 3:g=q.sent;if(g){q.next=10;break}if(!(c===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE)){q.next=9;break}q.next=8;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"exception: no key data for remove mutations"));case 8:throw new(d("WASyncdError").SyncdFatalError)("no key data for remove mutations");case 9:throw new(d("WASyncdError").SyncdMissingKeyError)();case 10:q.next=12;return b("regeneratorRuntime").awrap(k(a,f,g,c,e));case 12:h=q.sent;j=h.syncAction;l=h.indexMac;m=h.valueMac;n=h.indexValueBinary;o=j.index,p=j.version;return q.abrupt("return",{index:i.decode(o),action:null,version:p,keyId:f,operation:c,indexMac:l,valueMac:m,collection:a,binarySyncData:n});case 19:case"end":return q.stop()}},null,this)}function k(a,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;return b("regeneratorRuntime").async(function(A){while(1)switch(A.prev=A.next){case 0:i=h.index.blob;j=h.value.blob;k=d("WASyncdCrypto").valueMacFromIndexAndValueCipherText(j);l=d("WASyncdCryptoUtils").split(j,d("WASyncdCryptoConst").IV_LENGTH,j.byteLength-d("WASyncdCryptoConst").MAC_LENGTH-d("WASyncdCryptoConst").IV_LENGTH);m=l[0];n=l[1];o=l[2];A.next=9;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generateEncryptionKeys(f));case 9:p=A.sent;q=p.indexKey,r=p.valueEncryptionKey,s=p.valueMacKey;t=d("WASyncdCryptoUtils").combine([m,n]);u=d("WASyncdCrypto").generateAssociatedData(g,e);A.next=15;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generateMac(u,t,s));case 15:v=A.sent;if(d("WACryptoUtils").arrayBuffersEqual(o,v)){A.next=19;break}d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.DECRYPTION_FAILED,a);throw new(d("WASyncdError").SyncdFatalError)("decryption failure: valueMAC mismatch");case 19:A.next=21;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").decryptCipherText(new Uint8Array(m),r,n));case 21:w=A.sent;x=d("WASyncdDecode").decodeSyncActionData(a,w);y=c("WASyncdValidateSyncActionProtobuf").validateSyncActionDataProtobuf(a,x);A.next=26;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generateIndexMac(q,y.index));case 26:z=A.sent;if(d("WACryptoUtils").arrayBuffersEqual(i,z)){A.next=30;break}d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.DECRYPTION_FAILED,a);throw new(d("WASyncdError").SyncdFatalError)("decryption failure: indexMAC mismatch");case 30:return A.abrupt("return",{syncAction:y,indexMac:i,valueMac:k,indexValueBinary:w});case 31:case"end":return A.stop()}},null,this)}g.tryDecryptSnapshot=a;g.tryDecryptPatch=e}),98);
__d("WASyncdGetActionHandler",["WABaseGlobals"],(function(a,b,c,d,e,f,g){var h=null,i=null;function a(a){h==null&&(h=new Map(d("WABaseGlobals").getConfig().syncdActionHandlers().map(function(a){return[a.action,a]})));return h.get(a)}function b(){i==null&&(i=Math.max.apply(Math,d("WABaseGlobals").getConfig().syncdActionHandlers().map(function(a){return a.version})));return i}g.getActionHandler=a;g.maxSupportedVersion=b}),98);
__d("WAAsyncSleep",["Promise","regeneratorRuntime"],(function(a,b,c,d,e,f){var g;function a(a,c,d){return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:c===void 0&&(c=200);d===void 0&&(d=200);if(!(a>0&&a%c===0)){e.next=5;break}e.next=5;return b("regeneratorRuntime").awrap(h(d));case 5:case"end":return e.stop()}},null,this)}function h(a){return new(g||(g=b("Promise")))(function(b){return setTimeout(b,a)})}f.asyncSleepAfterGivenLoopIteration=a;f.asyncSleep=h}),66);
__d("WASyncdStoreMissingKeys",["Promise","WAAsyncSleep","WABaseGlobals","WAGetMissingKey","WAGetSyncKey","WALogger","WASyncdCryptoUtils","WASyncdMetricFatalError","WATimeUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: fatal error: missing key on all clients"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: expired keys: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: actually missing keys: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing keys: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: all keys: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: check if has expired keys"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: fatal error: timeout while waiting for missing key"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: _timeoutWhileWaitingForMissingKey: no expired keys"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: _timeoutWhileWaitingForMissingKey"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: earliest missing key: ",", timestamp=",", timeoutMs=",""]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: _setMissingKeyTimeout: missing keys: ",""]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: updateMissingKeys: finish updating missing keys from device ",""]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: updateMissingKeys: begin updating missing keys from device ","\n      \tmissingKeys: [","]"],["syncd: updateMissingKeys: begin updating missing keys from device ","\n      \\tmissingKeys: [","]"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: updateMissingKeys from device ","\n    \tkeys with keyData: ","\n    \tkeys without keyData: ",""],["syncd: updateMissingKeys from device ","\n    \\tkeys with keyData: ","\n    \\tkeys without keyData: ",""]);v=function(){return a};return a}var w;function a(){var a;return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().getDeviceFingerprint());case 2:a=c.sent.deviceIndexes;return c.abrupt("return",d("WABaseGlobals").runInTransaction({MissingKeyStore:!0},function(c){var d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:d=c.MissingKeyStore;f.next=3;return b("regeneratorRuntime").awrap(d.getAll());case 3:e=f.sent;if(!(e.length===0)){f.next=6;break}return f.abrupt("return",(h||(h=b("Promise"))).resolve());case 6:e.forEach(function(b){var c=b.deviceResponses;c.forEach(function(c,d){a.includes(d)||b.deviceResponses["delete"](d)})});f.next=9;return b("regeneratorRuntime").awrap(d.bulkUpdate(e));case 9:f.next=11;return b("regeneratorRuntime").awrap(B({MissingKeyStore:d}));case 11:case"end":return f.stop()}},null,this)}));case 4:case"end":return c.stop()}},null,this)}function c(a,c){var e=[],f=[];a.forEach(function(a){var b=a.keyData;a=d("WASyncdCryptoUtils").syncKeyIdToHex(a.keyId);b?e.push(a):f.push(a)});d("WALogger").LOG(v(),c,e,f);return d("WABaseGlobals").runInTransaction({MissingKeyStore:!0},function(a){var g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:g=a.MissingKeyStore;if(!(e.length>0)){i.next=6;break}i.next=4;return b("regeneratorRuntime").awrap(g.bulkRemove(e));case 4:i.next=6;return b("regeneratorRuntime").awrap(y({MissingKeyStore:g}));case 6:if(!(f.length>0)){i.next=18;break}i.next=9;return b("regeneratorRuntime").awrap(g.bulkGet(f));case 9:i.t0=Boolean;h=i.sent.filter(i.t0);h.forEach(function(a){return a.deviceResponses.set(c,!1)});d("WALogger").LOG(u(),c,f);i.next=15;return b("regeneratorRuntime").awrap(g.bulkUpdate(h));case 15:d("WALogger").LOG(t(),c);i.next=18;return b("regeneratorRuntime").awrap(B({MissingKeyStore:g}));case 18:case"end":return i.stop()}},null,this)})}function x(){return d("WABaseGlobals").runInTransaction({MissingKeyStore:!0},function(a){a=a.MissingKeyStore;return y({MissingKeyStore:a})})}function y(a){var c,e,f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:c=a.MissingKeyStore;clearTimeout(w);w=null;h.next=5;return b("regeneratorRuntime").awrap(c.getAll());case 5:e=h.sent;if(!(e.length===0)){h.next=8;break}return h.abrupt("return");case 8:d("WALogger").LOG(s(),e.map(function(a){return d("WASyncdCryptoUtils").syncKeyIdToHex(a.keyId)})),f=e.reduce(function(a,b){return a.timestamp<b.timestamp?a:b}),g=d("WABaseGlobals").getConfig().syncdWaitForKeyTimeoutDays()*d("WATimeUtils").DAY_MILLISECONDS-(-f.timestamp+d("WATimeUtils").unixTimeMs()),d("WALogger").LOG(r(),d("WASyncdCryptoUtils").syncKeyIdToHex(f.keyId),f.timestamp,g),w=setTimeout(z,g);case 13:case"end":return h.stop()}},null,this)}function z(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:d("WALogger").LOG(q());a.next=3;return b("regeneratorRuntime").awrap(A());case 3:if(a.sent){a.next=6;break}d("WALogger").LOG(p());return a.abrupt("return");case 6:d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.TIMEOUT_WHILE_WAITING_FOR_MISSING_KEY),d("WALogger").ERROR(o()).sendLogs("syncd fatal error: timeout while waiting for missing key"),d("WABaseGlobals").getDbImpls().handleSyncdFatal();case 9:case"end":return a.stop()}},null,this)}function A(){var a,c,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:d("WALogger").LOG(n());g.next=3;return b("regeneratorRuntime").awrap(d("WAGetSyncKey").getAllSyncKeysInTransaction());case 3:g.t0=function(a){return d("WASyncdCryptoUtils").syncKeyIdToHex(a.keyId)};a=g.sent.map(g.t0);d("WALogger").LOG(m(),a);g.next=8;return b("regeneratorRuntime").awrap(d("WAGetMissingKey").getAllMissingKeysInTransaction());case 8:c=g.sent;d("WALogger").LOG(l(),c.map(function(a){return d("WASyncdCryptoUtils").syncKeyIdToHex(a.keyId)}));e=c.filter(function(b){return!a.includes(b.keyHex)});d("WALogger").LOG(k(),c.map(function(a){return d("WASyncdCryptoUtils").syncKeyIdToHex(a.keyId)}));f=e.filter(function(a){return d("WABaseGlobals").getConfig().syncdWaitForKeyTimeoutDays()*d("WATimeUtils").DAY_MILLISECONDS<d("WATimeUtils").unixTimeMs()-a.timestamp});d("WALogger").LOG(j(),f.map(function(a){return d("WASyncdCryptoUtils").syncKeyIdToHex(a.keyId)}));return g.abrupt("return",f.length>0);case 15:case"end":return g.stop()}},null,this)}function B(a){var c,e,f,g,h,j,k,l,m,n,o,p,q;return b("regeneratorRuntime").async(function(r){while(1)switch(r.prev=r.next){case 0:c=a.MissingKeyStore;r.next=3;return b("regeneratorRuntime").awrap(c.getAll());case 3:e=r.sent,(f=e,g=Array.isArray(f),h=0,f=g?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 5:if(!g){r.next=11;break}if(!(h>=f.length)){r.next=8;break}return r.abrupt("break",43);case 8:j=f[h++];r.next=15;break;case 11:h=f.next();if(!h.done){r.next=14;break}return r.abrupt("break",43);case 14:j=h.value;case 15:k=j,l=!0,(m=k.deviceResponses.values(),n=Array.isArray(m),o=0,m=n?m:m[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 18:if(!n){r.next=24;break}if(!(o>=m.length)){r.next=21;break}return r.abrupt("break",34);case 21:p=m[o++];r.next=28;break;case 24:o=m.next();if(!o.done){r.next=27;break}return r.abrupt("break",34);case 27:p=o.value;case 28:q=p;if(!(q==null)){r.next=32;break}l=!1;return r.abrupt("break",34);case 32:r.next=18;break;case 34:if(!l){r.next=41;break}d("WALogger").ERROR(i()).sendLogs("syncd: fatal error: missing key on all clients");d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_KEY_ON_ALL_CLIENTS);r.next=39;return b("regeneratorRuntime").awrap(d("WAAsyncSleep").asyncSleep(5e3));case 39:d("WABaseGlobals").getDbImpls().handleSyncdFatal();return r.abrupt("return");case 41:r.next=5;break;case 43:case"end":return r.stop()}},null,this)}function e(a,c){var e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:e=function(){var a=new Map();c.forEach(function(b){return a.set(b,null)});return a};f=a.map(function(a){return{keyHex:d("WASyncdCryptoUtils").syncKeyIdToHex(a),keyId:a,timestamp:d("WATimeUtils").unixTimeMs(),deviceResponses:e()}});g.next=4;return b("regeneratorRuntime").awrap(d("WAGetMissingKey").bulkUpdateMissingKeysInTransaction(f));case 4:g.next=6;return b("regeneratorRuntime").awrap(x());case 6:case"end":return g.stop()}},null,this)}g.updateMissingKeyDevices=a;g.updateMissingKeys=c;g.setMissingKeyTimeoutInTransaction=x;g.hasExpiredKeys=A;g.addMissingKeys=e}),98);
__d("WASyncdHandleMissingKeys",["Promise","WABaseGlobals","WAGetMissingKey","WAGetSyncKey","WALogger","WASyncdCryptoUtils","WASyncdError","WASyncdKeyTypes","WASyncdStoreMissingKeys","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: requestAllMissingKeys: missing keys: [","]"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: _handleMissingKeys: missing keys after filter: [","]"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: _handleMissingKeys: missing keys [","]"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: _handleMissingKeys: skipping due to resume from restart in progress"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: collection ","'s patches has missing keys ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: handleMissingKeysInPatches: missing key: keyId: ",", patch version: ",", patch device id: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: collection ","'s snapshot has missing keys ",""]);o=function(){return a};return a}var p=d("WASyncdKeyTypes").toSyncKeyId(new ArrayBuffer(0));function a(a,c){var e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:e=new Set();g.next=3;return b("regeneratorRuntime").awrap(d("WAGetSyncKey").getAllSyncKeysInTransaction());case 3:g.t0=function(a){return d("WASyncdCryptoUtils").syncKeyIdToHex(a.keyId)};f=g.sent.map(g.t0);c.records.forEach(function(a){a=a.keyId.id;if(d("WASyncdCryptoUtils").syncKeyIdsEqual(a,p))throw new(d("WASyncdError").SyncdFatalError)("snapshot has empty key");a=d("WASyncdCryptoUtils").syncKeyIdToHex(a);f.includes(a)||e.add(a)});d("WALogger").LOG(o(),a,Array.from(e));g.next=9;return b("regeneratorRuntime").awrap(q(e));case 9:case"end":return g.stop()}},null,this)}function c(a,c){var e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:e=new Set();g.next=3;return b("regeneratorRuntime").awrap(d("WAGetSyncKey").getAllSyncKeysInTransaction());case 3:g.t0=function(a){return d("WASyncdCryptoUtils").syncKeyIdToHex(a.keyId)};f=g.sent.map(g.t0);c.forEach(function(a){var b=a.keyId.id;if(d("WASyncdCryptoUtils").syncKeyIdsEqual(b,p))throw new(d("WASyncdError").SyncdFatalError)("syncd: patch has empty key. patch device id: ${p.deviceIndex}");b=d("WASyncdCryptoUtils").syncKeyIdToHex(b);f.includes(b)||(d("WALogger").LOG(n(),b,a.version.version,a.deviceIndex),e.add(b))});d("WALogger").LOG(m(),a,Array.from(e));g.next=9;return b("regeneratorRuntime").awrap(q(e));case 9:case"end":return g.stop()}},null,this)}function q(a){var c,e,f,g,i;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:if(!(d("WABaseGlobals").getConfig().offlineProcessingState()!=="idle")){m.next=3;break}d("WALogger").LOG(l());return m.abrupt("return");case 3:c=Array.from(a);d("WALogger").LOG(k(),c);m.t0=Set;m.next=8;return b("regeneratorRuntime").awrap(d("WAGetMissingKey").bulkGetMissingKeysInTransaction(c));case 8:m.t1=Boolean;m.t2=function(a){return a.keyHex};m.t3=m.sent.filter(m.t1).map(m.t2);e=new m.t0(m.t3);f=c.filter(function(a){return!e.has(a)});d("WALogger").LOG(j(),f);if(!(f.length===0)){m.next=16;break}return m.abrupt("return",(h||(h=b("Promise"))).resolve());case 16:g=f.map(function(a){return d("WASyncdKeyTypes").toSyncKeyId(d("WASyncdCryptoUtils").hexToUint8Array(a).buffer)});m.next=19;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().sendSyncdKeyRequest(g));case 19:i=m.sent;m.next=22;return b("regeneratorRuntime").awrap(d("WASyncdStoreMissingKeys").addMissingKeys(g,i));case 22:case"end":return m.stop()}},null,this)}function e(){var a;return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(d("WAGetMissingKey").getAllMissingKeysInTransaction());case 2:a=c.sent;d("WALogger").LOG(i(),a.map(function(a){return a.keyHex}));if(!(a.length===0)){c.next=6;break}return c.abrupt("return");case 6:c.next=8;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().sendSyncdKeyRequest(a.map(function(a){return a.keyId})));case 8:case"end":return c.stop()}},null,this)}g.handleMissingKeysInSnapshot=a;g.handleMissingKeysInPatches=c;g.requestAllMissingKeys=e}),98);
__d("WASyncdValidateServerSyncProtobuf",["WABaseGlobals","WALongInt","WASyncAction.pb","WASyncdError","WASyncdKeyTypes","WASyncdMetricFatalError","decodeProtobuf"],(function(a,b,c,d,e,f,g){a=function(){function a(){}a.validateSnapshotProtobuf=function(b,c){var e=c.version,f=c.records,g=c.mac;c=c.keyId;var h=e==null?void 0:e.version;if(!e||h==null){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_SNAPSHOT_VERSION,b);throw new(d("WASyncdError").SyncdFatalError)("missing snapshot version")}e=f.map(function(c){return a.validateRecordProtobuf(b,c)});if(!g){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_SNAPSHOT_MAC,b);throw new(d("WASyncdError").SyncdFatalError)("missing snapshot mac")}f=a.validateKeyIdProtobuf(b,c,d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_SNAPSHOT_KEY_ID);return{version:{version:d("WALongInt").numberOrThrowIfTooLarge(h)},records:e,mac:g,keyId:f}};a.validatePatchProtobuf=function(b,c){var e=c.version,f=c.mutations,g=c.externalMutations,h=c.snapshotMac,i=c.patchMac,j=c.keyId,k=c.exitCode,l=c.deviceIndex;c=c.clientDebugData;var m=e==null?void 0:e.version;if(!e||m==null){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_PATCH_VERSION,b);throw new(d("WASyncdError").SyncdFatalError)("missing patch version")}if(f&&f.length>0&&g){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.PATCH_WITH_BOTH_INLINE_AND_EXTERNAL_MUTATIONS,b);throw new(d("WASyncdError").SyncdFatalError)("patch with both inline and external mutations")}if(!h){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_PATCH_SNAPSHOT_MAC,b);throw new(d("WASyncdError").SyncdFatalError)("missing patch snapshot mac")}if(!i){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_PATCH_MAC,b);throw new(d("WASyncdError").SyncdFatalError)("missing patch mac")}e=a.validateKeyIdProtobuf(b,j,d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_PATCH_KEY_ID);j=void 0;var n=d("WABaseGlobals").getConfig().syncdShouldParsePatchDebugData();c!=null&&n&&(j=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").PatchDebugDataSpec,c));if(g){n=a.validateExternalBlobReference(b,g);return{version:{version:d("WALongInt").numberOrThrowIfTooLarge(m)},mutations:void 0,externalMutations:n,snapshotMac:h,patchMac:i,keyId:e,deviceIndex:l,clientDebugData:j}}c=f.map(function(c){return a.validateMutationProtobuf(b,c)});return{version:{version:d("WALongInt").numberOrThrowIfTooLarge(m)},mutations:c,externalMutations:void 0,exitCode:k,snapshotMac:h,patchMac:i,keyId:e,deviceIndex:l,clientDebugData:j}};a.validateExternalBlobReference=function(a,b){var c=b.mediaKey,e=b.directPath,f=b.handle,g=b.fileSizeBytes,h=b.fileSha256;b=b.fileEncSha256;if(!c){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_EXTERNAL_BLOB_REFERENCE_MEDIA_KEY,a);throw new(d("WASyncdError").SyncdFatalError)("missing external blob reference media key")}if(e==null){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_EXTERNAL_BLOB_REFERENCE_DIRECT_PATH,a);throw new(d("WASyncdError").SyncdFatalError)("missing external blob reference direct path")}if(!h){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_EXTERNAL_BLOB_REFERENCE_FILE_SHA256,a);throw new(d("WASyncdError").SyncdFatalError)("missing external blob reference file SHA256")}if(!b){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_EXTERNAL_BLOB_REFERENCE_FILE_ENC_SHA256,a);throw new(d("WASyncdError").SyncdFatalError)("missing external blob reference file enc SHA256")}return{mediaKey:c,directPath:e,handle:f,fileSizeBytes:g,fileSha256:h,fileEncSha256:b}};a.validateMutationProtobuf=function(b,c){var e=c.operation;c=c.record;if(e==null){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_MUTATION_OPERATION,b);throw new(d("WASyncdError").SyncdFatalError)("missing mutation operation")}if(!c){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_MUTATION_RECORD,b);throw new(d("WASyncdError").SyncdFatalError)("missing mutation record")}b=a.validateRecordProtobuf(b,c);return{operation:e,record:b}};a.validateRecordProtobuf=function(b,c){var e=c.index,f=c.value;c=c.keyId;var g=e==null?void 0:e.blob,h=f==null?void 0:f.blob;if(!e||!g){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_MUTATION_INDEX,b);throw new(d("WASyncdError").SyncdFatalError)("missing mutation index")}if(!f||!h){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_MUTATION_VALUE,b);throw new(d("WASyncdError").SyncdFatalError)("missing mutation value")}e=a.validateKeyIdProtobuf(b,c,d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_MUTATION_KEY_ID);return{index:{blob:g},value:{blob:h},keyId:e}};a.validateKeyIdProtobuf=function(a,b,c){var e=b==null?void 0:b.id;if(!b||!e){d("WASyncdMetricFatalError").reportSyncdFatalError(c,a);throw new(d("WASyncdError").SyncdFatalError)("missing mutation key id")}return{id:d("WASyncdKeyTypes").toSyncKeyId(e)}};return a}();g["default"]=a}),98);
__d("WASyncdMMSDownload",["WABaseGlobals","WASyncdDecode","WASyncdValidateServerSyncProtobuf","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,e){var f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:h.next=2;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().downloadSyncBlob(e,"snapshot",a));case 2:f=h.sent;g=d("WASyncdDecode").decodeSyncdSnapshot(a,f);return h.abrupt("return",c("WASyncdValidateServerSyncProtobuf").validateSnapshotProtobuf(a,g));case 5:case"end":return h.stop()}},null,this)}function e(a,e){var f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:h.next=2;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().downloadSyncBlob(e,"patch",a));case 2:f=h.sent;g=d("WASyncdDecode").decodeSyncdMutations(a,f).mutations;return h.abrupt("return",g.map(function(b){return c("WASyncdValidateServerSyncProtobuf").validateMutationProtobuf(a,b)}));case 5:case"end":return h.stop()}},null,this)}g.downloadSnapshot=a;g.downloadExternalPatch=e}),98);
/**
 * License: https://www.facebook.com/legal/license/MDzNl_j9yvg/
 */
__d("toposort-1.0.3",[],(function(a,b,c,d,e,f){"use strict";a={};var g={exports:a};function h(){g.exports=a=function(a){return b(c(a),a)};a.array=b;function b(a,b){var c=a.length,d=new Array(c),e={},f=c;while(f--)e[f]||g(a[f],f,[]);return d;function g(h,f,i){if(i.indexOf(h)>=0)throw new Error("Cyclic dependency: "+JSON.stringify(h));if(!~a.indexOf(h))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(h));if(e[f])return;e[f]=!0;var j=b.filter(function(a){return a[0]===h});if(f=j.length){i=i.concat(h);do{var k=j[--f][1];g(k,a.indexOf(k),i)}while(f)}d[--c]=h}}function c(a){var b=[];for(var c=0,d=a.length;c<d;c++){var e=a[c];b.indexOf(e[0])<0&&b.push(e[0]);b.indexOf(e[1])<0&&b.push(e[1])}return b}}var i=!1;function j(){i||(i=!0,h());return g.exports}function b(a){switch(a){case void 0:return j()}}e.exports=b}),null);
__d("toposort",["toposort-1.0.3"],(function(a,b,c,d,e,f){e.exports=b("toposort-1.0.3")()}),null);
__d("WASyncdToposortCrossIndex",["WASyncdError","WASyncdMetricFatalError","toposort"],(function(a,b,c,d,e,f,g){var h=new Map();function a(a){i();var b=[],e=[];try{a.forEach(function(c){b.push(c);var d=h.get(c.actionName);if(d==null)return;a.forEach(function(a){a!==c&&d.includes(a.actionName)&&j(a,c)&&(a.timestamp<c.timestamp?e.push([a,c]):e.push([c,a]))})});return c("toposort").array(b,e)}catch(a){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.CYCLIC_MUTATION_DEPENDENCY_IN_PATCH);throw new(d("WASyncdError").SyncdFatalError)("cyclic mutation dependency in patch")}}function i(){}function b(a,b){h.set(a,b)}function j(a,b){a=a.actionHandler.getChatJidAndMessageKey(a);b=b.actionHandler.getChatJidAndMessageKey(b);return a&&b?a.chatJid===b.chatJid&&(a.messageKey==null||b.messageKey==null||a.messageKey===b.messageKey):!1}g.sort=a;g._setDependency=b}),98);
__d("WASyncdResolveConflict",["Promise","WAGetPendingMutation","WASyncdConst","WASyncdToposortCrossIndex","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(a,c){var d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(a.map(function(a){var d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:d=c.get(a.index);if(!d){f.next=8;break}e=a.actionHandler;f.t0=a.index;f.next=6;return b("regeneratorRuntime").awrap(e.resolveConflicts(d,a));case 6:f.t1=f.sent;return f.abrupt("return",{remoteMutationIndex:f.t0,conflictResolutionState:f.t1});case 8:case"end":return f.stop()}},null,this)})));case 2:d=f.sent;e=new Map();d.forEach(function(a){a&&e.set(a.remoteMutationIndex,a.conflictResolutionState)});return f.abrupt("return",e);case 6:case"end":return f.stop()}},null,this)}function a(a,c){var e,f,g,h,j,k,l,m,n,o,p;return b("regeneratorRuntime").async(function(q){while(1)switch(q.prev=q.next){case 0:e=[];f=[];q.next=4;return b("regeneratorRuntime").awrap(d("WAGetPendingMutation").getSyncPendingMutationsByCollectionInTransaction(a));case 4:g=q.sent;h=new Map(g.map(function(a){return[a.index,a]}));q.next=8;return b("regeneratorRuntime").awrap(i(c,h));case 8:j=q.sent,c.forEach(function(a){var b=j.get(a.index);if(b)switch(b){case d("WASyncdConst").ConflictResolutionState.SkipRemote:break;case d("WASyncdConst").ConflictResolutionState.ApplyRemoteAndDropLocal:e.push(a);f=f.concat(g.filter(function(b){return b.index===a.index}));break;case d("WASyncdConst").ConflictResolutionState.SkipRemoteAndDropLocal:f=f.concat(g.filter(function(b){return b.index===a.index}));break}else e.push(a)}),k=d("WASyncdToposortCrossIndex").sort(e),l=[],m=0;case 13:if(!(m<k.length)){q.next=22;break}n=k[m].actionHandler;q.next=17;return b("regeneratorRuntime").awrap(n.dropMutationDueToCrossIndexConflict(k[m],h));case 17:o=q.sent,o||l.push(k[m]);case 19:m++;q.next=13;break;case 22:p=f.map(function(a){return a.id}).filter(Boolean);return q.abrupt("return",{remoteMutationsToApply:l,pendingMutationsToDrop:p});case 24:case"end":return q.stop()}},null,this)}g.resolveConflict=a}),98);
__d("WASyncdValidateMutations",["WALogger","WALongInt","WAServerSync.pb","WASyncAction.pb","WASyncdConst","WASyncdError","WASyncdMetricFatalError","decodeProtobuf"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["validation not required for local mutations"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: duplicate REMOVE mutation: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: duplicate SET mutation: ",""]);j=function(){return a};return a}function a(a,b){var c=new Set();b.forEach(function(b){b=b.version.version;if(c.has(b)){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.DUPLICATE_PATCH_VERSION_IN_COLLECTION,a);throw new(d("WASyncdError").SyncdFatalError)("duplicate patch version in collection")}c.add(b)})}function b(a,b,c){var e=new Set(),f=new Set();b.forEach(function(b){var g=!1;b.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET&&(e.has(b.index)?(d("WALogger").DEV(j(),b.index),g=!0):e.add(b.index));b.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE&&(f.has(b.index)?(d("WALogger").DEV(i(),b.index),g=!0):f.add(b.index));if(g)switch(c){case d("WASyncdConst").SyncDataType.Patch:d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_PATCH,a);throw new(d("WASyncdError").SyncdFatalError)("same index for multiple mutations in patch");case d("WASyncdConst").SyncDataType.Snapshot:d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_SNAPSHOT,a);throw new(d("WASyncdError").SyncdFatalError)("same index for multiple mutations in snapshot");case d("WASyncdConst").SyncDataType.Local:d("WALogger").WARN(h())}})}function c(a,b){return b.map(function(b){var c=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,b.binarySyncData);c=c.value;if(!c){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_ACTION_VALUE,a);throw new(d("WASyncdError").SyncdFatalError)("missing action value")}c=d("WALongInt").maybeNumberOrThrowIfTooLarge(c.timestamp);if(c==null){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_ACTION_TIMESTAMP,a);throw new(d("WASyncdError").SyncdFatalError)("missing action timestamp")}return{index:b.index,version:b.version,keyId:b.keyId,indexMac:b.indexMac,valueMac:b.valueMac,collection:b.collection,binarySyncData:b.binarySyncData,timestamp:c}})}g.validateNoDuplicatePatchVersionInCollection=a;g.validateNoSameIndexForMultipleMutations=b;g.validateAndTypeSetMutations=c}),98);
__d("WASyncdWamAppState",["WAPREList","WAPREMetrics","WAShiftTimer"],(function(a,b,c,d,e,f,g){var h=k(),i=new(d("WAShiftTimer").ShiftTimer)(c),j=1e3*60*5;function a(){i.isScheduled()&&i.forceRunNow()}function k(){return{mutationCount:0,invalidActionCount:0,unsupportedActionCount:0,keyRotationRemoveCount:0,storedMutationCount:0,uploadConflictCount:0,unsetActionCount:0,missingKeyCount:0}}function l(){h=k()}function m(a){return{"int":babelHelpers["extends"]({},a)}}function b(a){var b;return{mutationCount:(a==null?void 0:(b=a["int"])==null?void 0:b.mutationCount)||0,invalidActionCount:(a==null?void 0:(b=a["int"])==null?void 0:b.invalidActionCount)||0,unsupportedActionCount:(a==null?void 0:(b=a["int"])==null?void 0:b.unsupportedActionCount)||0,keyRotationRemoveCount:(a==null?void 0:(b=a["int"])==null?void 0:b.keyRotationRemoveCount)||0,storedMutationCount:(a==null?void 0:(b=a["int"])==null?void 0:b.storedMutationCount)||0,uploadConflictCount:(a==null?void 0:(b=a["int"])==null?void 0:b.uploadConflictCount)||0,unsetActionCount:(a==null?void 0:(b=a["int"])==null?void 0:b.unsetActionCount)||0,missingKeyCount:(a==null?void 0:(b=a["int"])==null?void 0:b.missingKeyCount)||0}}function c(){var a=m(h);l();d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.APP_STATE_SYNC_DAILY).endSuccess(a)}function n(){i.onOrBefore(j)}function e(a){if(a===0)return;h.mutationCount+=a;n()}function f(a){h.invalidActionCount=a,n()}function o(a){h.unsupportedActionCount=a,n()}function p(a){if(a===0)return;h.keyRotationRemoveCount+=a;n()}function q(a){h.storedMutationCount=a,n()}function r(){h.uploadConflictCount++,n()}function s(a){if(a===0)return;h.unsetActionCount+=a;n()}function t(a){h.missingKeyCount=a,n()}g.forceCommitAppState=a;g.clear=l;g.convertAppStateSyncDailyFromAnnotations=b;g.addMutationCount=e;g.setInvalidActionCount=f;g.setUnsupportedActionCount=o;g.addKeyRotationRemoveCount=p;g.setStoredMutationCount=q;g.incConflict=r;g.addUnsetActionCount=s;g.setMissingKeyCount=t}),98);
__d("WASyncdCollectionHandler",["Promise","WABaseGlobals","WACryptoUtils","WAErr","WAGetCollectionVersion","WAGetMissingKey","WAGetSyncAction","WALogger","WALongInt","WANullthrows","WAServerSync.pb","WASyncAction.pb","WASyncdAntiTampering","WASyncdCollectionHandlerTypesConverter","WASyncdCollectionUtils","WASyncdConst","WASyncdDecryptMutations","WASyncdError","WASyncdGetActionHandler","WASyncdHandleMissingKeys","WASyncdMMSDownload","WASyncdMetricCriticalBootstrapStage","WASyncdMetricFatalError","WASyncdMetrics","WASyncdResolveConflict","WASyncdValidateMutations","WASyncdValidateServerSyncProtobuf","WASyncdWamAppState","WATimeUtils","decodeProtobuf","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: no handler for action ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: invalid action ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: no handler for action ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: invalid action ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: after apply remove mutations for ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: before apply remove mutations for ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: completed apply set mutations for ","  ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: max timestamp from recent patch: "," days agp"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: after apply mutation batch for ","  ",""]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: actionStates after apply ",": ",""]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["synd: catching error during _applySetMutations: ",""]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: before apply mutation batch for ",". mutations count: ","  ",""]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: applying mutations "," ",""]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: completed final transaction in _applyPatch for "," v",""]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: processed "," mutations in patch version "," of collection ",""]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: completed _applyRemoveMutations for "," v",""]);x=function(){return a};return a}function y(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: completed computeLtHashAndValidatePatch for "," v",""]);y=function(){return a};return a}function z(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: ",": empty patch found"]);z=function(){return a};return a}function A(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: applying patch "," v"," from device ","\n    SET count: ","\n    REMOVE count: ",""]);A=function(){return a};return a}function B(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: no patches for collection ",""]);B=function(){return a};return a}function C(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: UI is unblocked, waited for ","ms"]);C=function(){return a};return a}function D(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: patches have "," mutations, wait for UI unblock"]);D=function(){return a};return a}function E(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: completed applying snapshot for ",""]);E=function(){return a};return a}function F(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: collection ","'s snapshot v"," applied"]);F=function(){return a};return a}function G(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: processed "," mutations in snapshot of collection "," v",""]);G=function(){return a};return a}function H(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: collection ","'s snapshot decrypted"]);H=function(){return a};return a}function I(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: collection ","'s snapshot validated"]);I=function(){return a};return a}function J(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: start validate ","'s snapshot"]);J=function(){return a};return a}function K(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: ","'s external patch downloaded"]);K=function(){return a};return a}function L(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: download patch for ",""]);L=function(){return a};return a}function M(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: download snapshot for ",""]);M=function(){return a};return a}function N(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: end _uploadSuccessful for ",""]);N=function(){return a};return a}function O(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: _uploadSuccessful: write to db for ",""]);O=function(){return a};return a}function P(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: _uploadSuccessful: unexpected server version (",") after patch upload, expected ",""]);P=function(){return a};return a}function Q(){var a=babelHelpers.taggedTemplateLiteralLoose(["",":\n      lastSuccessfulSyncEndTime = "," ("," days ago))\n      lastSyncAttemptStartTimes = ","\n      lastSyncAttemptStartTimes by days ago: ","\n    "]);Q=function(){return a};return a}function R(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing patch info:"]);R=function(){return a};return a}function S(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: could not log max timestamp: ",""]);S=function(){return a};return a}function T(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: retryable error: "," throws ",""]);T=function(){return a};return a}function U(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: fatal error: "," throws ",""]);U=function(){return a};return a}function V(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: key error: "," missing keys"]);V=function(){return a};return a}function W(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: applyAppStateSyncResponse: finished applying "," in ","ms"]);W=function(){return a};return a}function X(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: sync "," but there are no updates"]);X=function(){return a};return a}function Y(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: "," v"," uploaded successfully"]);Y=function(){return a};return a}function aa(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: "," patches applied successfully"]);aa=function(){return a};return a}function ba(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: has missing patches"]);ba=function(){return a};return a}function ca(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: has missing patches. collection: ",", localVersion: ",",\n           minPatch: ",""]);ca=function(){return a};return a}function da(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing keys: [","]"]);da=function(){return a};return a}function ea(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: "," snapshot and patches applied successfully"]);ea=function(){return a};return a}function fa(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: start applying collection ",""]);fa=function(){return a};return a}function ga(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: end applyIndividualMutations"]);ga=function(){return a};return a}function ha(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: end update db after apply individual mutations for collection ",""]);ha=function(){return a};return a}function ia(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: end apply individual mutations for collection ",""]);ia=function(){return a};return a}function ja(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: apply individual mutations for collection ",""]);ja=function(){return a};return a}function ka(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: start applyIndividualMutations"]);ka=function(){return a};return a}var la=0,ma=new ArrayBuffer(128);function a(a){var c,e,f,g;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:if(!(a.length===0)){i.next=2;break}return i.abrupt("return",(h||(h=b("Promise"))).resolve());case 2:c=a.sort(function(a,b){return a.timestamp-b.timestamp});d("WALogger").LOG(ka());e=d("WASyncdCollectionHandlerTypesConverter").syncActionsToDecryptedMutation(c);f=e.reduce(function(a,b){var c;c=(c=a.get(b.collection))!=null?c:[];c.push(b);a.set(b.collection,c);return a},new Map());g=Array.from(f.keys()).map(function(a){var c,e,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:d("WALogger").LOG(ja(),a);c=f.get(a);if(!(c===void 0)){j.next=4;break}return j.abrupt("return");case 4:j.next=6;return b("regeneratorRuntime").awrap(Z(a,c,d("WASyncdConst").SyncDataType.Local,null));case 6:e=j.sent;g=e.setMutationsToPersist;h=e.pendingMutationsToDrop;i=g.map(function(a){return{action:a.action,actionState:a.actionState,binarySyncData:a.binarySyncData,collection:a.collection,index:a.index,keyId:a.keyId,modelId:a.modelId,modelType:a.modelType,timestamp:a.timestamp,version:a.version}});d("WALogger").LOG(ia(),a);j.next=13;return b("regeneratorRuntime").awrap(d("WABaseGlobals").runInTransaction({SyncActionStore:!0,PendingMutationStore:!0},function(a){var c,d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:c=a.SyncActionStore,d=a.PendingMutationStore;e.next=3;return b("regeneratorRuntime").awrap(c.bulkUpdate(i));case 3:e.next=5;return b("regeneratorRuntime").awrap(d.bulkRemove(h));case 5:case"end":return e.stop()}},null,this)}));case 13:d("WALogger").LOG(ha(),a);case 14:case"end":return j.stop()}},null,this)});i.next=9;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(g));case 9:d("WALogger").LOG(ga());case 10:case"end":return i.stop()}},null,this)}function e(a,c,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;return b("regeneratorRuntime").async(function(y){while(1)switch(y.prev=y.next){case 0:f=a.name,g=a.version,h=a.patches,i=a.snapshot,j=a.syncedPendingMutationsId,k=a.syncedEncryptedMutations;d("WALogger").LOG(fa(),f);y.prev=2;e==null?void 0:e.mark("external_mutations_download_start",{patchCount:(l=a.patches)==null?void 0:l.length,snapshotSizeBytes:(m=a.snapshot)==null?void 0:m.fileSizeBytes});y.next=6;return b("regeneratorRuntime").awrap(qa(f,h,i,c));case 6:n=y.sent;o=n[0];p=n[1];e==null?void 0:e.mark("external_mutations_download_end",{patchesWithMutationsCount:p==null?void 0:p.length,snapshotRecordsCount:o==null?void 0:o.records.length});q=performance.now();if(!(o!=null)){y.next=17;break}y.next=14;return b("regeneratorRuntime").awrap(ta(f,o,p,e));case 14:d("WALogger").LOG(ea(),f);y.next=57;break;case 17:if(!(p!=null)){y.next=43;break}r=Math.min.apply(Math,p.map(function(a){return a.version.version}));s=c!=null&&r>c+1&&p.length>0;if(!s){y.next=38;break}y.next=23;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(f,"has missing patches"));case 23:y.next=25;return b("regeneratorRuntime").awrap(d("WAGetMissingKey").getAllMissingKeysInTransaction());case 25:t=y.sent;d("WALogger").LOG(da(),t.map(function(a){return a.keyHex+":"+a.timestamp}));d("WALogger").LOG(ca(),f,c,r);y.next=30;return b("regeneratorRuntime").awrap(na(f,p[0]));case 30:y.next=32;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().printSyncdLog());case 32:y.next=34;return b("regeneratorRuntime").awrap(oa());case 34:d("WALogger").ERROR(ba()).sendLogs("syncd: has missing patches");if(!d("WABaseGlobals").getConfig().syncdShouldFatalOnMissingPatch()){y.next=38;break}d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.SERVER_DID_NOT_SEND_ALL_PATCHES,f,void 0,(u=c)!=null?u:0);throw new(d("WASyncdError").SyncdFatalError)("syncd: has missing patches");case 38:y.next=40;return b("regeneratorRuntime").awrap(va(f,p,e));case 40:d("WALogger").LOG(aa(),f);y.next=57;break;case 43:if(!(g!=null)){y.next=53;break}y.next=46;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(f,"start upload patches. version: "+g+". mutation count: "+k.length));case 46:y.next=48;return b("regeneratorRuntime").awrap(pa(f,g,j,k));case 48:y.next=50;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(f,"end upload patches"));case 50:d("WALogger").LOG(Y(),f,g);y.next=57;break;case 53:if(!d("WASyncdCollectionUtils").isBootstrap(c)){y.next=56;break}y.next=56;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").updateCollectionVersionAndLtHashInTransaction(f,la,ma));case 56:d("WALogger").LOG(X(),f);case 57:v=Math.floor(performance.now()-q);d("WALogger").LOG(W(),f,v);(p||o)&&(d("WASyncdCollectionUtils").isBootstrap(c)&&!d("WASyncdCollectionUtils").isCriticalCollection(f)&&(w=o!=null,d("WASyncdMetrics").reportSyncdBootstrapDataApplied(f,w?d("WASyncdMetrics").SyncdBootstrapDataAppliedSnapshotUsed.SNAPSHOT_USED:d("WASyncdMetrics").SyncdBootstrapDataAppliedSnapshotUsed.SNAPSHOT_NOT_USED,v)));y.next=62;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").logMacsInSnapshot(a.name));case 62:return y.abrupt("return",a);case 65:y.prev=65;y.t0=y["catch"](2);x=y.t0.message;y.next=70;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(f,"error (maybe retryable): "+y.t0));case 70:if(!(y.t0 instanceof d("WASyncdError").SyncdMissingKeyError)){y.next=73;break}d("WALogger").WARN(V(),f);return y.abrupt("return",{name:f,state:d("WASyncdConst").CollectionState.Blocked});case 73:if(!(y.t0 instanceof d("WASyncdError").SyncdFatalError)){y.next=76;break}d("WALogger").ERROR(U(),f,x).sendLogs("syncd: fatal error: "+String(f)+" throws "+x);return y.abrupt("return",{name:f,state:d("WASyncdConst").CollectionState.ErrorFatal});case 76:d("WALogger").WARN(T(),f,x).sendLogs("syncd: retryable error: "+String(f)+" throws "+x);return y.abrupt("return",{name:f,state:d("WASyncdConst").CollectionState.ErrorRetry});case 78:case"end":return y.stop()}},null,this,[[2,65]])}function na(a,c){var e,f,g,h,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:k.prev=0;k.next=3;return b("regeneratorRuntime").awrap(d("WASyncdDecryptMutations").tryDecryptPatch(a,c));case 3:f=k.sent;g=f.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET});h=d("WASyncdValidateMutations").validateAndTypeSetMutations(a,g);i=h.length>0?h[0].timestamp:null;j=i==null?null:d("WATimeUtils").daysDiff(d("WATimeUtils").unixTimeMs(),i);k.next=10;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"max timestamp in first patch: "+((e=j)!=null?e:"n/a")+" days ago"));case 10:k.next=15;break;case 12:k.prev=12,k.t0=k["catch"](0),d("WALogger").WARN(S(),k.t0);case 15:case"end":return k.stop()}},null,this,[[0,12]])}function oa(){var a;return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:d("WALogger").LOG(R());c.next=3;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").getAllCollectionVersionsInTransaction());case 3:a=c.sent,a.forEach(function(a){var b;b=((b=a.lastSyncAttemptStartTimes)!=null?b:[]).map(function(a){return d("WATimeUtils").daysDiff(d("WATimeUtils").unixTimeMs(),a)});var c=a.lastSuccessfulSyncEndTime;c=c==null?null:d("WATimeUtils").daysDiff(d("WATimeUtils").unixTimeMs(),c);d("WALogger").LOG(Q(),a.collection,a.lastSuccessfulSyncEndTime,c,a.lastSyncAttemptStartTimes,b)});case 5:case"end":return c.stop()}},null,this)}function pa(a,c,e,f){var g,h,i,j,k,l,m,n;return b("regeneratorRuntime").async(function(o){while(1)switch(o.prev=o.next){case 0:o.next=2;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").logMacsInSnapshot(a));case 2:h=f.map(function(a){return{indexMac:a.indexMac,valueMac:a.valueMac,operation:a.operation}});o.next=5;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").computeLtHash(a,h,null,c,d("WASyncdAntiTampering").SyncdPatchDirection.Outgoing));case 5:i=o.sent;j=i.ltHash;k=d("WASyncdCollectionHandlerTypesConverter").encryptedUploadMutationsToSyncActions(f.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET}),d("WASyncdConst").SyncActionState.Success);o.next=10;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").getCollectionVersionInTransaction(a).then(function(a){return a==null?void 0:a.version}));case 10:o.t0=g=o.sent;if(!(o.t0!=null)){o.next=15;break}o.t1=g;o.next=16;break;case 15:o.t1=0;case 16:l=o.t1;c!==l+1&&d("WALogger").ERROR(P(),c,l+1).sendLogs("syncd: unexpected server version after patch upload");d("WALogger").LOG(O(),a);m=d("WABaseGlobals").getConfig().syncdShouldParsePatchDebugData();if(!m){o.next=23;break}o.next=23;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").reportCollectionInconsistency(a,"pre-processing outgoing patch "+c));case 23:o.next=25;return b("regeneratorRuntime").awrap(d("WABaseGlobals").runInTransaction({SyncActionStore:!0,PendingMutationStore:!0,CollectionVersionStore:!0},function(d){var f,g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:f=d.SyncActionStore,g=d.PendingMutationStore,h=d.CollectionVersionStore;i.next=3;return b("regeneratorRuntime").awrap(f.bulkSet(k));case 3:i.next=5;return b("regeneratorRuntime").awrap(g.bulkRemove(e));case 5:i.next=7;return b("regeneratorRuntime").awrap(h.update(a,{version:c,ltHash:j,isLastPatchAnIncomingPatch:!1,lastPatchNewLtHashFromPatchDebugData:void 0,isLastPatchSenderAPrimaryDevice:void 0,didLastPatchFailPostValidation:void 0,lastPatchSenderDeviceId:void 0}));case 7:case"end":return i.stop()}},null,this)}));case 25:d("WALogger").LOG(N(),a);if(!m){o.next=32;break}o.next=29;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").reportCollectionInconsistency(a,"post-processing outgoing patch "+c));case 29:n=o.sent;o.next=32;return b("regeneratorRuntime").awrap(xa(a,n));case 32:case"end":return o.stop()}},null,this)}function qa(a,e,f,g){var i,j,k,l,m,n,o,p,q,r;return b("regeneratorRuntime").async(function(s){while(1)switch(s.prev=s.next){case 0:i=(h||(h=b("Promise"))).resolve();j=0;k=d("WATimeUtils").unixTimeMs();f!=null&&(m=c("WASyncdValidateServerSyncProtobuf").validateExternalBlobReference(a,f),j+=d("WALongInt").numberOrThrowIfTooLarge((l=m.fileSizeBytes)!=null?l:0),d("WALogger").LOG(M(),a),i=d("WASyncdMMSDownload").downloadSnapshot(a,m));n=(h||(h=b("Promise"))).resolve();e!=null&&e.length>0&&(o=e.map(function(b){return c("WASyncdValidateServerSyncProtobuf").validatePatchProtobuf(a,b)}),n=(h||(h=b("Promise"))).all(o.map(function(c){var e,f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:e=c.mutations||[];f=c.externalMutations;if(!f){h.next=9;break}d("WALogger").LOG(L(),a);h.next=6;return b("regeneratorRuntime").awrap(d("WASyncdMMSDownload").downloadExternalPatch(a,f));case 6:e=h.sent,d("WALogger").LOG(K(),a),j+=d("WALongInt").numberOrThrowIfTooLarge((g=f.fileSizeBytes)!=null?g:0);case 9:return h.abrupt("return",{mutations:e,version:c.version,snapshotMac:c.snapshotMac,patchMac:c.patchMac,keyId:c.keyId,exitCode:c.exitCode,deviceIndex:c.deviceIndex,clientDebugData:c.clientDebugData});case 10:case"end":return h.stop()}},null,this)})));s.prev=6;s.next=9;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all([i,n]));case 9:r=s.sent;p=r[0];q=r[1];d("WASyncdCollectionUtils").isBootstrap(g)&&d("WASyncdMetrics").reportSyncdBootstrapAppStateDownloadMetric({collection:a,downloadStartTs:k,downloadSize:j,isSuccess:"success"});s.next=19;break;case 15:s.prev=15;s.t0=s["catch"](6);d("WASyncdCollectionUtils").isBootstrap(g)&&d("WASyncdMetrics").reportSyncdBootstrapAppStateDownloadMetric({collection:a,downloadStartTs:k,downloadSize:j,isSuccess:"failure"});throw s.t0;case 19:return s.abrupt("return",[p,q]);case 20:case"end":return s.stop()}},null,this,[[6,15]])}function ra(a){var c=function(c,e){var f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:a==null?void 0:a.mark("anti_tampering_start",{source:d("WASyncdConst").SyncDataType.Snapshot});g.next=3;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").computeLtHashAndValidateSnapshot(c,e));case 3:f=g.sent;a==null?void 0:a.mark("anti_tampering_end",{source:d("WASyncdConst").SyncDataType.Snapshot});return g.abrupt("return",f);case 6:case"end":return g.stop()}},null,this)},e=function(c,e){var f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:a==null?void 0:a.mark("decryption_start",{source:d("WASyncdConst").SyncDataType.Snapshot});g.next=3;return b("regeneratorRuntime").awrap(d("WASyncdDecryptMutations").tryDecryptSnapshot(c,e));case 3:f=g.sent;a==null?void 0:a.mark("decryption_end",{source:d("WASyncdConst").SyncDataType.Snapshot});return g.abrupt("return",f);case 6:case"end":return g.stop()}},null,this)};return{measuredComputeLtHashAndValidateSnapshot:c,measuredTryDecryptSnapshot:e}}function sa(a){var c=function(c,e,f){var g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:a==null?void 0:a.mark("anti_tampering_start",{source:d("WASyncdConst").SyncDataType.Patch});h.next=3;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").computeLtHashAndValidatePatch(c,e,f));case 3:g=h.sent;a==null?void 0:a.mark("anti_tampering_end",{source:d("WASyncdConst").SyncDataType.Patch});return h.abrupt("return",g);case 6:case"end":return h.stop()}},null,this)},e=function(c,e){var f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:a==null?void 0:a.mark("decryption_start",{source:d("WASyncdConst").SyncDataType.Patch});g.next=3;return b("regeneratorRuntime").awrap(d("WASyncdDecryptMutations").tryDecryptPatch(c,e));case 3:f=g.sent;a==null?void 0:a.mark("decryption_end",{source:d("WASyncdConst").SyncDataType.Patch});return g.abrupt("return",f);case 6:case"end":return g.stop()}},null,this)};return{measuredComputeLtHashAndValidatePatch:c,measuredTryDecryptPatch:e}}function ta(a,c,e,f){var g,h,i,j,k,l,m,n,o;return b("regeneratorRuntime").async(function(p){while(1)switch(p.prev=p.next){case 0:p.next=2;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"start _applySnapshotAndPatches. mutation count: "+c.records.length+", version: "+c.version.version));case 2:p.next=4;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").logMacsInSnapshot(a));case 4:p.prev=4;g=ra(f),h=g.measuredComputeLtHashAndValidateSnapshot,i=g.measuredTryDecryptSnapshot;f==null?void 0:f.mark("apply_start",{source:d("WASyncdConst").SyncDataType.Snapshot,snapshotRecordsCount:c.records.length});d("WALogger").LOG(J(),a);p.next=10;return b("regeneratorRuntime").awrap(h(a,c));case 10:j=p.sent;d("WALogger").LOG(I(),a);p.next=14;return b("regeneratorRuntime").awrap(i(a,c));case 14:k=p.sent;d("WALogger").LOG(H(),a);d("WASyncdWamAppState").addMutationCount(c.records.length);d("WASyncdMetricCriticalBootstrapStage").reportSyncdDecryptedMutations(d("WASyncdMetricCriticalBootstrapStage").SyncdDecryptMutationsType.SNAPSHOT_MUTATIONS,k);d("WASyncdValidateMutations").validateNoSameIndexForMultipleMutations(a,k,d("WASyncdConst").SyncDataType.Snapshot);l=c.version.version;p.next=22;return b("regeneratorRuntime").awrap(Z(a,k,d("WASyncdConst").SyncDataType.Snapshot,f));case 22:m=p.sent;n=m.setMutationsToPersist;o=m.pendingMutationsToDrop;d("WALogger").LOG(G(),k.length,a,l);d("WALogger").LOG(F(),a,l);f==null?void 0:f.mark("update_DB_start",{source:d("WASyncdConst").SyncDataType.Snapshot,setMutationsToPersistCount:n.length,pendingMutationsToDropCount:o.length});p.next=30;return b("regeneratorRuntime").awrap(d("WABaseGlobals").runInTransaction({SyncActionStore:!0,PendingMutationStore:!0,CollectionVersionStore:!0},function(c){var d,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:d=c.SyncActionStore,e=c.PendingMutationStore,f=c.CollectionVersionStore;g.next=3;return b("regeneratorRuntime").awrap(d.bulkSet(n));case 3:g.next=5;return b("regeneratorRuntime").awrap(e.bulkRemove(o));case 5:g.next=7;return b("regeneratorRuntime").awrap(f.update(a,{version:l,ltHash:j,isLastPatchAnIncomingPatch:!0,lastPatchNewLtHashFromPatchDebugData:void 0,isLastPatchSenderAPrimaryDevice:void 0,didLastPatchFailPostValidation:void 0,lastPatchSenderDeviceId:void 0,didBootstrapFromSnapshot:!0}));case 7:case"end":return g.stop()}},null,this)}));case 30:f==null?void 0:f.mark("update_DB_end",{source:d("WASyncdConst").SyncDataType.Snapshot});d("WALogger").LOG(E(),a);f==null?void 0:f.mark("apply_end",{source:d("WASyncdConst").SyncDataType.Snapshot,decryptedMutationsCount:k.length});p.next=43;break;case 35:p.prev=35;p.t0=p["catch"](4);p.next=39;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"exception "+p.t0.message));case 39:if(!(p.t0 instanceof d("WASyncdError").SyncdMissingKeyError)){p.next=42;break}p.next=42;return b("regeneratorRuntime").awrap(d("WASyncdHandleMissingKeys").handleMissingKeysInSnapshot(a,c));case 42:throw p.t0;case 43:p.next=45;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"done applying snapshot"));case 45:if(!e){p.next=50;break}f==null?void 0:f.mark("apply_start",{source:d("WASyncdConst").SyncDataType.Patch,patchCount:e.length});p.next=49;return b("regeneratorRuntime").awrap(va(a,e,f));case 49:f==null?void 0:f.mark("apply_end",{source:d("WASyncdConst").SyncDataType.Patch,patchCount:e.length});case 50:case"end":return p.stop()}},null,this,[[4,35]])}function ua(a){var c,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:c=d("WABaseGlobals").getConfig().syncdMaxMutationsToProcessDuringResume();if(!(a>c)){f.next=7;break}e=Date.now();d("WALogger").LOG(D(),a);f.next=6;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().handleSyncDelayApplyingPatchUntilUIUnblocks());case 6:d("WALogger").LOG(C(),Date.now()-e);case 7:case"end":return f.stop()}},null,this)}function va(a,c,e){var f,g,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:f=c.length===0?"n/a":c[c.length-1].version.version;j.next=3;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"start apply patches. count: "+c.length+", last patch version: "+f));case 3:if(!(c.length===0)){j.next=6;break}d("WALogger").LOG(B(),a);return j.abrupt("return",(h||(h=b("Promise"))).resolve());case 6:d("WASyncdValidateMutations").validateNoDuplicatePatchVersionInCollection(a,c);c.sort(function(a,b){return a.version.version>b.version.version?1:-1});j.prev=8;g=c.reduce(function(a,b){return a+b.mutations.length},0);j.next=12;return b("regeneratorRuntime").awrap(ua(g));case 12:i=0;case 13:if(!(i<c.length)){j.next=25;break}if(!(i<=4||i%10===0)){j.next=17;break}j.next=17;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"start applying patch "+c[i].version.version+" with "+c[i].mutations.length+" mutations"));case 17:j.next=19;return b("regeneratorRuntime").awrap(wa(a,c[i],e,i<=1));case 19:if(!(i<=4||i%10===0)){j.next=22;break}j.next=22;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"finished applying patch "+c[i].version.version+" with "+c[i].mutations.length+" mutations"));case 22:i++;j.next=13;break;case 25:j.next=27;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"after apply patches (total mutations: "+g+")"));case 27:j.next=37;break;case 29:j.prev=29;j.t0=j["catch"](8);j.next=33;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"exception"+j.t0.message));case 33:if(!(j.t0 instanceof d("WASyncdError").SyncdMissingKeyError)){j.next=36;break}j.next=36;return b("regeneratorRuntime").awrap(d("WASyncdHandleMissingKeys").handleMissingKeysInPatches(a,c));case 36:throw j.t0;case 37:case"end":return j.stop()}},null,this,[[8,29]])}function wa(a,c,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,B,C,D,E,F;return b("regeneratorRuntime").async(function(G){while(1)switch(G.prev=G.next){case 0:F=function(c){var e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b("regeneratorRuntime").awrap(d("WAGetSyncAction").getSyncActionsByCollectionsInTransaction([a]));case 2:f.t0=function(a){return d("WACryptoUtils").arrayBuffersEqual(c,a.indexMac)};f.t1=e=f.sent.filter(f.t0).pop();if(!(f.t1==null)){f.next=8;break}f.t2=void 0;f.next=9;break;case 8:f.t2=e.valueMac;case 9:return f.abrupt("return",f.t2);case 10:case"end":return f.stop()}},null,this)};f===void 0&&(f=!1);G.next=4;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").logMacsInSnapshot(a));case 4:g=d("WABaseGlobals").getConfig().syncdShouldParsePatchDebugData();if(!g){G.next=8;break}G.next=8;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").reportCollectionInconsistency(a,"pre-processing incoming patch "+c.version.version));case 8:if(!c.exitCode){G.next=21;break}j=c.exitCode.code;G.next=12;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"patch exit code "+((h=j)!=null?h:"")));case 12:G.t0=j;G.next=G.t0===100?15:G.t0===101?17:19;break;case 15:d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.TERMINAL_PATCH_MISSING_DATA,a);return G.abrupt("break",20);case 17:d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.TERMINAL_PATCH_DESERIALIZATION_ERROR,a);return G.abrupt("break",20);case 19:d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.TERMINAL_PATCH_UNKNOWN,a);case 20:throw new(d("WASyncdError").SyncdFatalError)("received terminal patch with exit code:  "+String(j)+" text: "+String((i=c.exitCode)==null?void 0:i.text)+"  ");case 21:G.next=23;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().handleSyncBeforeApplyPatch(c));case 23:k=c.mutations.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET}).length;l=c.mutations.length-k;d("WALogger").LOG(A(),a,c.version.version,c.deviceIndex,k,l);k===0&&l===0&&d("WALogger").WARN(z(),a).sendLogs("syncd: "+a+": empty patch found");m=sa(e),n=m.measuredComputeLtHashAndValidatePatch,o=m.measuredTryDecryptPatch;G.next=30;return b("regeneratorRuntime").awrap(n(a,c,F));case 30:p=G.sent;d("WALogger").LOG(y(),a,c.version.version);G.next=34;return b("regeneratorRuntime").awrap(o(a,c));case 34:q=G.sent;d("WASyncdMetricCriticalBootstrapStage").reportSyncdDecryptedMutations(d("WASyncdMetricCriticalBootstrapStage").SyncdDecryptMutationsType.PATCH_MUTATIONS,q);if(!f){G.next=39;break}G.next=39;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"after decrypt patch "+c.version.version));case 39:d("WASyncdWamAppState").addMutationCount(q.length);d("WASyncdValidateMutations").validateNoSameIndexForMultipleMutations(a,q,d("WASyncdConst").SyncDataType.Patch);r=Aa(q);s=r.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE});G.next=45;return b("regeneratorRuntime").awrap(ya(a,s));case 45:d("WALogger").LOG(x(),a,c.version.version);t=r.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET});G.next=49;return b("regeneratorRuntime").awrap(Z(a,t,d("WASyncdConst").SyncDataType.Patch,e,f));case 49:u=G.sent;B=u.setMutationsToPersist;C=u.pendingMutationsToDrop;d("WALogger").LOG(w(),q.length,c.version.version,a);e==null?void 0:e.mark("update_DB_start",{source:d("WASyncdConst").SyncDataType.Patch,setMutationsToPersistCount:B.length,pendingMutationsToDropCount:C.length});D=c.version.version;G.next=57;return b("regeneratorRuntime").awrap(d("WABaseGlobals").runInTransaction({SyncActionStore:!0,PendingMutationStore:!0,CollectionVersionStore:!0},function(d){var e,f,g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:f=d.SyncActionStore,g=d.PendingMutationStore,h=d.CollectionVersionStore;i.next=3;return b("regeneratorRuntime").awrap(f.bulkRemove(s.map(function(a){return a.index})));case 3:i.next=5;return b("regeneratorRuntime").awrap(f.bulkSet(B));case 5:i.next=7;return b("regeneratorRuntime").awrap(g.bulkRemove(C));case 7:i.next=9;return b("regeneratorRuntime").awrap(h.update(a,{version:D,ltHash:p,lastPatchNewLtHashFromPatchDebugData:(e=c.clientDebugData)==null?void 0:e.newLthash,isLastPatchAnIncomingPatch:!0,isLastPatchSenderAPrimaryDevice:c.deviceIndex===0,didLastPatchFailPostValidation:void 0,lastPatchSenderDeviceId:c.deviceIndex}));case 9:case"end":return i.stop()}},null,this)}));case 57:if(!g){G.next=63;break}G.next=60;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").reportCollectionInconsistency(a,"post-processing incoming patch "+c.version.version+". has remove: "+(l>0).toString()));case 60:E=G.sent;G.next=63;return b("regeneratorRuntime").awrap(xa(a,E));case 63:e==null?void 0:e.mark("update_DB_end",{source:d("WASyncdConst").SyncDataType.Patch});d("WALogger").LOG(v(),a,c.version.version);if(!f){G.next=68;break}G.next=68;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"after final transaction for patch "+c.version.version));case 68:case"end":return G.stop()}},null,this)}function xa(a,c){return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(d("WABaseGlobals").runInTransaction({CollectionVersionStore:!0},function(d){var e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:e=d.CollectionVersionStore;f.next=3;return b("regeneratorRuntime").awrap(e.update(a,{didLastPatchFailPostValidation:c}));case 3:case"end":return f.stop()}},null,this)}));case 2:case"end":return e.stop()}},null,this)}function Z(a,e,f,g,h){var i,j,k,l,m,n,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P;return b("regeneratorRuntime").async(function(Q){while(1)switch(Q.prev=Q.next){case 0:h===void 0&&(h=!1);d("WASyncdMetricCriticalBootstrapStage").reportSyncdCriticalBootstrapStage(d("WASyncdMetricCriticalBootstrapStage").SyncdCriticalBootstrapStageType.ABOUT_TO_APPLY_MUTATIONS);j=f===d("WASyncdConst").SyncDataType.Local?" (individual mutations)":"";k=[];l=d("WASyncdValidateMutations").validateAndTypeSetMutations(a,e);m=Ba(a,l),n=m.supportedMutations,v=m.unsupportedMutations;v.forEach(function(a){return k.push(d("WASyncdCollectionHandlerTypesConverter").setMutationToSyncAction(a,d("WASyncdConst").SyncActionState.Unsupported))});g==null?void 0:g.mark("conflict_resolution_start",{source:f,collectionName:a,count:n.length});Q.next=10;return b("regeneratorRuntime").awrap(d("WASyncdResolveConflict").resolveConflict(a,n));case 10:w=Q.sent,x=w.remoteMutationsToApply,y=w.pendingMutationsToDrop,z=n.filter(function(a){return!x.includes(a)}),g==null?void 0:g.mark("conflict_resolution_end",{source:f,collectionName:a,apply:x.length,drop:z.length}),z.forEach(function(a){return k.push(d("WASyncdCollectionHandlerTypesConverter").setMutationToSyncAction(a,d("WASyncdConst").SyncActionState.Skipped,a.actionName))}),g==null?void 0:g.mark("apply_set_mutations_start",{source:f,collectionName:a,count:x.length}),A=Ca(x),B=null,C=0;case 20:if(!(C<A.length)){Q.next=52;break}D=h&&C<=1;E=A[C][0].actionHandler;F=A[C].map(function(a){var b;a.binarySyncData?b=c("WANullthrows")(d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,a.binarySyncData).value):b=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,a.binarySyncAction);(B==null||B<a.timestamp)&&(B=a.timestamp);return{operation:"set",indexParts:a.indexArr,value:b,timestamp:a.timestamp}});if(!D){Q.next=27;break}Q.next=27;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"after deserialize. mutationsToApply length: "+F.length));case 27:G=[];H=!1;Q.prev=29;d("WALogger").DEV(u(),JSON.stringify(F,null,2),j);d("WALogger").LOG(t(),a,F.length,j);Q.next=34;return b("regeneratorRuntime").awrap(E.applyMutations(F,{setMutationsPendingToPersist:k,allSupportedSetMutations:x},D));case 34:G=Q.sent;if(!D){Q.next=38;break}Q.next=38;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"after apply. result length: "+G.length));case 38:Q.next=46;break;case 40:Q.prev=40;Q.t0=Q["catch"](29);if(!(Q.t0 instanceof d("WASyncdError").SyncdFatalError||a===d("WASyncdConst").CollectionName.CriticalBlock)){Q.next=44;break}throw Q.t0;case 44:H=!0,d("WALogger").WARN(s(),Q.t0);case 46:d("WALogger").DEV(r(),j,G.slice(0,100).map(function(a){return a.actionState}));d("WALogger").LOG(q(),a,j);for(I=0;I<A[C].length;I++)L=H?d("WASyncdConst").SyncActionState.Failed:G[I].actionState,k.push(d("WASyncdCollectionHandlerTypesConverter").setMutationToSyncAction(A[C][I],L,A[C][I].actionName,H?void 0:(J=G[I].orphanModel)==null?void 0:J.modelId,H?void 0:(K=G[I].orphanModel)==null?void 0:K.modelType));case 49:C++;Q.next=20;break;case 52:M=B;N=M==null?null:d("WATimeUtils").daysDiff(d("WATimeUtils").unixTimeMs(),M);d("WALogger").LOG(p(),(i=N)!=null?i:"n/a");if(!h){Q.next=58;break}Q.next=58;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"max timestamp from recent patch: "+((O=N)!=null?O:"n/a")+" days ago"));case 58:P=k.reduce(function(a,b){b=b.actionState;a[b]==null&&(a[b]=0);a[b]++;return a},{});g==null?void 0:g.mark("apply_set_mutations_end",babelHelpers["extends"]({source:f,collectionName:a,count:x.length},P));d("WASyncdMetricCriticalBootstrapStage").reportSyncdCriticalBootstrapStage(d("WASyncdMetricCriticalBootstrapStage").SyncdCriticalBootstrapStageType.APPLIED_MUTATIONS);d("WALogger").LOG(o(),a,j);return Q.abrupt("return",{setMutationsToPersist:k,pendingMutationsToDrop:y});case 63:case"end":return Q.stop()}},null,this,[[29,40]])}function ya(a,c){var e,f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:(e=za(c),f=e.supportedMutations),g=Ca(f),d("WALogger").LOG(n(),a),h=0;case 4:if(!(h<g.length)){j.next=11;break}i=g[h][0].actionHandler;j.next=8;return b("regeneratorRuntime").awrap(i.applyMutations(g[h].map(function(b){return{operation:"remove",indexParts:$(a,b.index)}}),{setMutationsPendingToPersist:[],allSupportedSetMutations:[]}));case 8:h++;j.next=4;break;case 11:d("WALogger").LOG(m(),a);case 12:case"end":return j.stop()}},null,this)}function za(a){a=a.map(function(a){if(a.version>d("WASyncdGetActionHandler").maxSupportedVersion())return{unsupported:a};var b=$(a.collection,a.index),c=d("WASyncdConst").Actions.cast(b[0]);if(!c){d("WALogger").WARN(l(),b[0]);return{unsupported:a}}var e=d("WASyncdGetActionHandler").getActionHandler(c);if(!e){d("WALogger").WARN(k(),c);return{unsupported:a}}a={collection:a.collection,index:a.index,indexMac:a.indexMac,keyId:a.keyId,binarySyncData:a.binarySyncData,valueMac:a.valueMac,version:a.version,indexArr:b,actionName:c,actionHandler:e};return{supported:a}});var b=[],c=[];a.map(function(a){var d=a.supported;a=a.unsupported;d!=null?b.push(d):a!=null&&c.push(a)});return{supportedMutations:b,unsupportedMutations:c}}function Aa(a){var b=a.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET}),c=new Set(b.map(function(a){return a.index}));a=a.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE});a.forEach(function(a){c.has(a.index)||b.push(a)});return b}function Ba(a,b){b=b.map(function(b){if(b.version>d("WASyncdGetActionHandler").maxSupportedVersion())return{unsupported:b};var c=$(a,b.index),e=d("WASyncdConst").Actions.cast(c[0]);if(!e){d("WALogger").WARN(j(),c[0]);return{unsupported:b}}var f=d("WASyncdGetActionHandler").getActionHandler(e);if(!f){d("WALogger").WARN(i(),e);return{unsupported:b}}return{supported:{collection:b.collection,index:b.index,indexMac:b.indexMac,keyId:b.keyId,timestamp:b.timestamp,binarySyncData:b.binarySyncData,valueMac:b.valueMac,version:b.version,indexArr:c,actionName:e,actionHandler:f}}});var c=[],e=[];b.map(function(a){var b=a.supported;a=a.unsupported;b!=null?c.push(b):a!=null&&e.push(a)});return{supportedMutations:c,unsupportedMutations:e}}function Ca(a){return a.reduce(function(a,b){a.length!==0&&b.actionName===a[a.length-1][0].actionName?a[a.length-1].push(b):a.push([b]);return a},[])}function $(a,b){try{b=JSON.parse(b);if(b.length<1)throw c("WAErr")();return b}catch(b){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.INVALID_ACTION_INDEX,a);throw new(d("WASyncdError").SyncdFatalError)("invalid action index")}}g.applyIndividualMutations=a;g.applyAppStateSyncResponse=e}),98);
__d("WASyncdOrphan",["Promise","WAGetSyncAction","WALogger","WASyncdCollectionHandler","WASyncdConst","WASyncdDisabled","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: end applyAllOrphansAndUnsupported"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: start applyAllOrphansAndUnsupported"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: finished applying orphans of type "," with ids=",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: applying orphans of type "," with ids=",""]);l=function(){return a};return a}function a(a,c){return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:if(!d("WASyncdDisabled").isSyncdDisabled()){e.next=2;break}return e.abrupt("return",(h||(h=b("Promise"))).resolve());case 2:e.next=4;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all([m(a),n(c)]));case 4:case"end":return e.stop()}},null,this)}function m(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(o(a,d("WASyncdConst").SyncModelType.Msg));case 2:case"end":return c.stop()}},null,this)}function n(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(o(a,d("WASyncdConst").SyncModelType.Chat));case 2:case"end":return c.stop()}},null,this)}function o(a,c){var e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:d("WALogger").DEV(l(),c,a);if(!d("WASyncdDisabled").isSyncdDisabled()){f.next=3;break}return f.abrupt("return",(h||(h=b("Promise"))).resolve());case 3:f.next=5;return b("regeneratorRuntime").awrap(d("WAGetSyncAction").getSyncActionsByModelInfosInTransaction(a.map(function(a){return[a,c,d("WASyncdConst").SyncActionState.Orphan]})));case 5:e=f.sent;f.next=8;return b("regeneratorRuntime").awrap(d("WASyncdCollectionHandler").applyIndividualMutations(e));case 8:d("WALogger").DEV(k(),c,a);case 9:case"end":return f.stop()}},null,this)}function c(){var a;return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:if(!d("WASyncdDisabled").isSyncdDisabled()){c.next=2;break}return c.abrupt("return",(h||(h=b("Promise"))).resolve());case 2:d("WALogger").LOG(j());c.next=5;return b("regeneratorRuntime").awrap(d("WAGetSyncAction").getSyncActionsByActionStatesInTransaction([d("WASyncdConst").SyncActionState.Orphan,d("WASyncdConst").SyncActionState.Unsupported]));case 5:a=c.sent;c.next=8;return b("regeneratorRuntime").awrap(d("WASyncdCollectionHandler").applyIndividualMutations(a));case 8:d("WALogger").LOG(i());case 9:case"end":return c.stop()}},null,this)}function e(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(o(a,d("WASyncdConst").SyncModelType.Agent));case 2:case"end":return c.stop()}},null,this)}function f(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(o(a,d("WASyncdConst").SyncModelType.ChatAssignment));case 2:case"end":return c.stop()}},null,this)}function p(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(o(a,d("WASyncdConst").SyncModelType.UserStatusMute));case 2:case"end":return c.stop()}},null,this)}g.checkOrphanMutations=a;g.checkOrphanMessages=m;g.checkOrphanChats=n;g.applyAllOrphansAndUnsupported=c;g.checkOrphanAgents=e;g.checkOrphanChatAssignments=f;g.checkOrphanUserStatusMutes=p}),98);
__d("WAMediaCalculateFilehash",["WACryptoDependencies","WACryptoSha256"],(function(a,b,c,d,e,f,g){function a(a){return d("WACryptoSha256").sha256Base64(a)}function b(){var a=d("WACryptoDependencies").getCrypto().getRandomValues(new Uint8Array(20));a=a.buffer;return d("WACryptoSha256").sha256Base64(a)}g.calculateFilehash=a;g.getRandomFilehash=b}),98);
__d("WASyncdRequestEncode",["WAServerSync.pb","WASyncAction.pb","WASyncdError","WASyncdMetricFatalError","encodeProtobuf"],(function(a,b,c,d,e,f,g){function a(a){try{return d("encodeProtobuf").encodeProtobuf(d("WAServerSync.pb").SyncdPatchSpec,a).readBuffer()}catch(a){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.PATCH_PROTOBUF_SERIALIZATION_FAILED);throw new(d("WASyncdError").SyncdFatalError)("patch protobuf serialization failed")}}function b(a){try{return d("encodeProtobuf").encodeProtobuf(d("WAServerSync.pb").SyncdMutationsSpec,a).readBuffer()}catch(a){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MUTATIONS_PROTOBUF_SERIALIZATION_FAILED);throw new(d("WASyncdError").SyncdFatalError)("mutations protobuf serialization failed")}}function c(a){try{return d("encodeProtobuf").encodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,a).readBuffer()}catch(a){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.ACTION_DATA_PROTOBUF_SERIALIZATION_FAILED);throw new(d("WASyncdError").SyncdFatalError)("action data protobuf serialization failed")}}g.encodeSyncdPatch=a;g.encodeSyncdMutations=b;g.encodeSyncActionData=c}),98);
__d("WASyncdEncryptMutations",["WAArrayBufferUtils","WACryptoDependencies","WAGetSyncAction","WAServerSync.pb","WASyncAction.pb","WASyncdCrypto","WASyncdCryptoConst","WASyncdCryptoUtils","WASyncdError","WASyncdKeyCache","WASyncdMetricFatalError","WASyncdRequestEncode","decodeProtobuf","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,i,j,k,l,m,n,o,p;return b("regeneratorRuntime").async(function(q){while(1)switch(q.prev=q.next){case 0:e=a.index,f=a.operation;g=c.keyId;i=c.keyData;q.t0=f;q.next=q.t0===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET?6:q.t0===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE?7:20;break;case 6:return q.abrupt("break",20);case 7:q.next=9;return b("regeneratorRuntime").awrap(d("WAGetSyncAction").getSyncActionInTransaction(e));case 9:j=q.sent;if(j){q.next=12;break}throw new(d("WASyncdError").SyncdFatalError)("no corresponding set mutation");case 12:k=j.keyId;q.next=15;return b("regeneratorRuntime").awrap(d("WASyncdKeyCache").getKeyData(k));case 15:l=q.sent;if(!(l==null)){q.next=18;break}throw new(d("WASyncdError").SyncdFatalError)("no key data for corresponding mutation");case 18:g=k,i=l;case 20:q.next=22;return b("regeneratorRuntime").awrap(h(a,g,i));case 22:m=q.sent;n=m.indexMac;o=m.indexAndValueCipherText;p=d("WASyncdCrypto").valueMacFromIndexAndValueCipherText(o);return q.abrupt("return",babelHelpers["extends"]({},a,{keyId:g,keyData:i,indexMac:n,indexAndValueCipherText:o,valueMac:p}));case 27:case"end":return q.stop()}},null,this)}function h(a,c,e){var f,g,h,j,k,l,m,n,o,p,q,r,s,t,u,v,w;return b("regeneratorRuntime").async(function(x){while(1)switch(x.prev=x.next){case 0:x.prev=0;f=a.index,g=a.binarySyncAction,h=a.operation,j=a.version;k=d("WAArrayBufferUtils").stringToArrayBuffer(f);x.next=5;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generateEncryptionKeys(e));case 5:l=x.sent;m=l.indexKey,n=l.valueEncryptionKey,o=l.valueMacKey;x.next=9;return b("regeneratorRuntime").awrap(d("WACryptoDependencies").getCrypto().getRandomValues(new Uint8Array(d("WASyncdCryptoConst").IV_LENGTH)));case 9:p=x.sent;q=d("WASyncdCrypto").generatePadding(k.byteLength,g.byteLength);r=i(k,g,q,j);x.next=14;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generateCipherText(p,n,r));case 14:s=x.sent;t=d("WASyncdCrypto").generateAssociatedData(h,c);x.next=18;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generateMac(t,s,o));case 18:u=x.sent;v=d("WASyncdCryptoUtils").combine([s,u]);x.next=22;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generateIndexMac(m,k));case 22:w=x.sent;return x.abrupt("return",{indexMac:w,indexAndValueCipherText:v});case 26:x.prev=26;x.t0=x["catch"](0);d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.ENCRYPTION_FAILED);throw new(d("WASyncdError").SyncdFatalError)("encryption failure");case 30:case"end":return x.stop()}},null,this,[[0,26]])}function i(a,b,c,e){return d("WASyncdRequestEncode").encodeSyncActionData({index:a,value:d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,b),padding:c,version:e})}g.encryptMutation=a}),98);
__d("WASyncdKeyManagementUtils",["WASyncdKeyTypes"],(function(a,b,c,d,e,f,g){function a(a){return new DataView(d("WASyncdKeyTypes").fromSyncKeyId(a)).getUint16(0)}function h(a){return new DataView(d("WASyncdKeyTypes").fromSyncKeyId(a)).getUint32(2)}function b(a){return h(a)+1}g.getKeyDeviceId=a;g.getKeyEpoch=h;g.generateNewKeyEpoch=b}),98);
__d("WAArrayBuffersConcat",[],(function(a,b,c,d,e,f){function a(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];var d=b.reduce(function(a,b){return a+b.byteLength},0),e=new Uint8Array(d),f=0;b.forEach(function(a){e.set(new Uint8Array(a),f),f+=a.byteLength});return e.buffer}f.concatArrayBuffers=a}),66);
__d("WASyncdRotateKey",["WAArrayBuffersConcat","WABaseGlobals","WAByteArray","WACryptoDependencies","WAJids","WASyncdKeyManagementUtils","WASyncdKeyTypes","WATimeUtils","equalsSet"],(function(a,b,c,d,e,f,g){var h=1,i=90;function a(a){a=a.timestamp;var b=Math.min(i,Math.max(h,d("WABaseGlobals").getConfig().syncdKeyMaxUseDays()));b=b*d("WATimeUtils").DAY_MILLISECONDS;a=d("WATimeUtils").unixTimeMs()-a;return a>b}function b(a,b){a=a.fingerprint;var d=b.rawId,e=b.currentIndex;b=b.deviceIndexes;var f=new Set(a.deviceIndexes);for(var g=a.currentIndex+1;g<=e;g++)f.add(g);return a.rawId!==d||!c("equalsSet")(f,new Set(b))}function e(a,b){b=j(b);var c=b.keyId;b=b.keyEpoch;var e=k(),f=d("WATimeUtils").unixTimeMs();return{keyId:c,keyEpoch:b,keyData:e,fingerprint:a,timestamp:f}}function j(a){if(a==null){var b=new Uint8Array(16);d("WACryptoDependencies").getCrypto().getRandomValues(b);b=d("WASyncdKeyManagementUtils").generateNewKeyEpoch(d("WASyncdKeyTypes").toSyncKeyId(b.buffer))}else b=d("WASyncdKeyManagementUtils").generateNewKeyEpoch(a.keyId);a=d("WAJids").interpretAsNumber(d("WAJids").extractDeviceId(d("WABaseGlobals").getMyDeviceJid()));return{keyId:d("WASyncdKeyTypes").toSyncKeyId(new Uint8Array(d("WAArrayBuffersConcat").concatArrayBuffers(d("WAByteArray").intToBytes(2,a).buffer,d("WAByteArray").intToBytes(4,b).buffer)).buffer),keyEpoch:b}}function k(){return d("WASyncdKeyTypes").toSyncKeyData(d("WACryptoDependencies").getCrypto().getRandomValues(new Uint8Array(32)).buffer)}g.hasKeyExpired=a;g.hasADeviceBeenRemoved=b;g.rotateKey=e}),98);
__d("WASyncdKeyManagement",["WABaseGlobals","WAErr","WAGetSyncKey","WALogger","WAPromiseQueue","WASyncdCryptoUtils","WASyncdKeyManagementUtils","WASyncdMetrics","WASyncdRotateKey","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: key rotation due to no key present"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: key rotation due to device removal"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: key rotation due to key expiry"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: stored key rotation key id ",""]);k=function(){return a};return a}var l=new(d("WAPromiseQueue").PromiseQueue)();function a(a){a===void 0&&(a=!0);return l.enqueue(function(){return m(a)})}function m(a){var e,f,g,l,o;return b("regeneratorRuntime").async(function(p){while(1)switch(p.prev=p.next){case 0:a===void 0&&(a=!0);p.next=3;return b("regeneratorRuntime").awrap(n());case 3:e=p.sent;p.next=6;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().getDeviceFingerprint());case 6:f=p.sent;g=!1;l=!1;if(!(e!=null)){p.next=16;break}g=d("WASyncdRotateKey").hasKeyExpired(e);l=d("WASyncdRotateKey").hasADeviceBeenRemoved(e,f);if(!(!a||!g&&!l)){p.next=14;break}return p.abrupt("return",{keyId:e.keyId,keyData:e.keyData});case 14:p.next=18;break;case 16:if(!(!a||d("WABaseGlobals").getConfig().isCompanion())){p.next=18;break}throw c("WAErr")("syncd: No sync key available");case 18:o=d("WASyncdRotateKey").rotateKey(f,e);d("WALogger").LOG(k(),d("WASyncdCryptoUtils").syncKeyIdToHex(o.keyId));p.next=22;return b("regeneratorRuntime").awrap(d("WAGetSyncKey").setSyncKeyInTransaction(o));case 22:p.next=24;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().sendSyncdKeyRotation([o]));case 24:g&&(d("WALogger").LOG(j()),d("WASyncdMetrics").reportSyncdKeyRotationEvent(d("WASyncdMetrics").SyncdKeyRotationEventType.APP_STATE_SYNC_KEY_EXPIRY));l&&(d("WALogger").LOG(i()),d("WASyncdMetrics").reportSyncdKeyRotationEvent(d("WASyncdMetrics").SyncdKeyRotationEventType.DEVICE_DEREGISTERATION));e==null&&(d("WALogger").LOG(h()),d("WASyncdMetrics").reportSyncdKeyRotationEvent(d("WASyncdMetrics").SyncdKeyRotationEventType.NO_KEYS));return p.abrupt("return",m(a));case 28:case"end":return p.stop()}},null,this)}function n(){var a,c,e,f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:j.next=2;return b("regeneratorRuntime").awrap(d("WAGetSyncKey").getAllSyncKeysInTransaction());case 2:a=j.sent;if(!(a.length===0)){j.next=5;break}return j.abrupt("return",null);case 5:c=a.map(function(a){return d("WASyncdKeyManagementUtils").getKeyEpoch(a.keyId)});e=Math.max.apply(Math,c);f=a.filter(function(a){return d("WASyncdKeyManagementUtils").getKeyEpoch(a.keyId)===e});g=f.map(function(a){return d("WASyncdKeyManagementUtils").getKeyDeviceId(a.keyId)});h=Math.min.apply(Math,g);i=g.indexOf(h);return j.abrupt("return",f[i]);case 12:case"end":return j.stop()}},null,this)}g.getActiveKey=a;g.getNewestKeyPair=n}),98);
__d("WASyncdMMSUpload",["WABaseGlobals"],(function(a,b,c,d,e,f,g){var h=100,i=2e3,j=10,k=100;function a(a){var b=Math.min(i,Math.max(d("WABaseGlobals").getConfig().syncdInlineMutationsMaxCount(),h));return a.length>b}function b(a){var b=Math.min(k,Math.max(d("WABaseGlobals").getConfig().syncdPatchProtobufMaxSize(),j))*1e3;return a.byteLength>b}g.exceedInlineMutationCount=a;g.exceedPatchProtobufSize=b}),98);
__d("WASyncdRequestBuilderTypesConverter",["WASyncAction.pb","decodeProtobuf","encodeProtobuf"],(function(a,b,c,d,e,f,g){function a(a,b){return a.map(function(a){var c=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,a.binarySyncData).value;c=d("encodeProtobuf").encodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,c).readBuffer();return{collection:a.collection,index:a.index,binarySyncAction:c,operation:b,version:a.version,timestamp:a.timestamp,action:a.action}})}g.syncActionsToPendingMutations=a}),98);
__d("WASyncdRequestBuilderBuild",["Promise","WABase64","WABaseGlobals","WAGetCollectionVersion","WAGetSyncAction","WAJids","WALogger","WAMediaCalculateFilehash","WAServerSync.pb","WASyncdAntiTampering","WASyncdConst","WASyncdCryptoUtils","WASyncdEncryptMutations","WASyncdKeyManagement","WASyncdKeyManagementUtils","WASyncdKeyTypes","WASyncdMMSUpload","WASyncdRequestBuilderTypesConverter","WASyncdRequestEncode","WASyncdWamAppState","WAWap","regeneratorRuntime","sortBy"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: end _buildCollectionNodes"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: skipping "," in sync iq patch because initial full sync\n        is incomplete"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: start _buildCollectionNodes"]);k=function(){return a};return a}var l=5;function a(a){var c,e,f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:j.next=2;return b("regeneratorRuntime").awrap(n(a));case 2:c=j.sent;e=c.collectionNodes;f=c.collectionWithEncryptedMutations;g=c.localCollectionVersions;h=c.collectionsToSkip;i=m(d("WAWap").wap("sync",null,e));return j.abrupt("return",{syncIqNode:i,collectionWithEncryptedMutations:f,localCollectionVersions:g,collectionsToSkip:h});case 9:case"end":return j.stop()}},null,this)}function e(){return m(d("WAWap").wap("delete_all_data",null))}function m(a){return d("WAWap").wap("iq",{to:d("WAWap").S_WHATSAPP_NET,xmlns:"w:sync:app:state",type:"set",id:d("WAWap").generateId()},a)}function n(a){var c,e,f,g,l,m,n;return b("regeneratorRuntime").async(function(p){while(1)switch(p.prev=p.next){case 0:d("WALogger").LOG(k());c=[];e=function(a,e){var f,g,h,i,k,l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:m.next=2;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").getCollectionVersionInTransaction(a).then(function(a){return a==null?void 0:a.version}));case 2:f=m.sent;if(!(e!=null&&e.length>0)){m.next=16;break}if(!(f==null)){m.next=9;break}d("WALogger").LOG(j(),a);c.push(a);m.next=16;break;case 9:m.next=11;return b("regeneratorRuntime").awrap(o(a,e));case 11:i=m.sent,k=i.patchNode,l=i.encryptedMutations,g=k,h=l;case 16:return m.abrupt("return",{collection:a,version:f,patchNode:g,encryptedMutations:h});case 17:case"end":return m.stop()}},null,this)};f=new Map();g=new Map();l=[];a.forEach(function(a,b){return l.push(e(b,a))});p.next=9;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(l));case 9:m=p.sent;n=m.map(function(a){var b=a.collection,c=a.version,e=a.patchNode;a=a.encryptedMutations;a&&g.set(b,a);f.set(b,c);return d("WAWap").wap("collection",{name:d("WAWap").CUSTOM_STRING(b),version:d("WAWap").INT((a=c)!=null?a:d("WASyncdConst").DEFAULT_COLLECTION_VERSION),return_snapshot:c===void 0?"true":"false"},e)});d("WALogger").LOG(i());return p.abrupt("return",{collectionNodes:n,collectionWithEncryptedMutations:g,localCollectionVersions:f,collectionsToSkip:c});case 13:case"end":return p.stop()}},null,this)}function o(a,c){var e,f,g,i,j,k,l,m,n,o,w,x,y,z,A;return b("regeneratorRuntime").async(function(B){while(1)switch(B.prev=B.next){case 0:B.next=2;return b("regeneratorRuntime").awrap(d("WASyncdKeyManagement").getActiveKey(!p(c)));case 2:e=B.sent;B.next=5;return b("regeneratorRuntime").awrap(v(a,c,e));case 5:f=B.sent;g=f.map(function(a){return d("WASyncdEncryptMutations").encryptMutation(a,e)});B.next=9;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(g));case 9:i=B.sent;j=i.map(function(a){return{indexMac:a.indexMac,valueMac:a.valueMac,operation:a.operation}});B.next=13;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").computeLtHash(a,j));case 13:k=B.sent;l=k.ltHash;B.next=17;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").computeOutgoingSnapshotAndPatchMacs(a,l,i,e.keyData));case 17:m=B.sent;n=m.snapshotMac;o=m.patchMac;w=i.map(function(a){return u(a.keyId,a.operation,a.indexMac,a.indexAndValueCipherText)});x=t(w);y=function(){var a,c;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().uploadSyncExternalPatch(x));case 2:a=f.sent;f.next=5;return b("regeneratorRuntime").awrap(q(a,x));case 5:c=f.sent;return f.abrupt("return",r(c,e.keyId,n,o));case 7:case"end":return f.stop()}},null,this)};if(!d("WASyncdMMSUpload").exceedInlineMutationCount(w)){B.next=29;break}B.next=26;return b("regeneratorRuntime").awrap(y());case 26:z=B.sent;B.next=34;break;case 29:z=s(w,e.keyId,n,o);if(!d("WASyncdMMSUpload").exceedPatchProtobufSize(z)){B.next=34;break}B.next=33;return b("regeneratorRuntime").awrap(y());case 33:z=B.sent;case 34:A=d("WAWap").wap("patch",null,z);return B.abrupt("return",{patchNode:A,encryptedMutations:i});case 36:case"end":return B.stop()}},null,this)}function p(a){return d("WABaseGlobals").getConfig().logoutInProgress()&&a.some(function(a){return JSON.parse(a.index)[0]===d("WASyncdConst").Actions.Sentinel})}function q(a,c){var e,f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:e=a.mediaKey,f=a.directPath,g=a.encFilehash,h=a.handle;j.next=3;return b("regeneratorRuntime").awrap(d("WAMediaCalculateFilehash").calculateFilehash(c));case 3:i=j.sent;return j.abrupt("return",{mediaKey:e,directPath:f,handle:h,fileSizeBytes:c.byteLength,fileSha256:d("WABase64").decodeB64(i),fileEncSha256:g});case 5:case"end":return j.stop()}},null,this)}function r(a,b,c,e){var f=d("WABaseGlobals").getConfig().syncdPatchDeviceIndexIncluded()?d("WAJids").extractDeviceId(d("WABaseGlobals").getMyDeviceJid()):void 0;return d("WASyncdRequestEncode").encodeSyncdPatch({keyId:{id:d("WASyncdKeyTypes").fromSyncKeyId(b)},externalMutations:a,snapshotMac:c,patchMac:e,deviceIndex:f})}function s(a,b,c,e){var f=d("WABaseGlobals").getConfig().syncdPatchDeviceIndexIncluded()?d("WAJids").extractDeviceId(d("WABaseGlobals").getMyDeviceJid()):void 0;return d("WASyncdRequestEncode").encodeSyncdPatch({keyId:{id:d("WASyncdKeyTypes").fromSyncKeyId(b)},mutations:a,snapshotMac:c,patchMac:e,deviceIndex:f})}function t(a){return d("WASyncdRequestEncode").encodeSyncdMutations({mutations:a})}function u(a,b,c,e){return{operation:b,record:{keyId:{id:d("WASyncdKeyTypes").fromSyncKeyId(a)},index:{blob:c},value:{blob:e}}}}function v(a,c,e){var f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:j.next=2;return b("regeneratorRuntime").awrap(d("WAGetSyncAction").getSyncActionsByCollectionsInTransaction([a]));case 2:f=j.sent;g=c;h=w(f,c,e.keyId);g=g.concat(h);i=x(f,g,e.keyId);d("WASyncdWamAppState").addKeyRotationRemoveCount(i.length);g=g.concat(i);return j.abrupt("return",g);case 10:case"end":return j.stop()}},null,this)}function w(a,b,e){a=a.filter(function(a){return!b.map(function(a){return a.index}).includes(a.index)&&!d("WASyncdCryptoUtils").syncKeyIdsEqual(a.keyId,e)});a=c("sortBy")(a,function(a){return d("WASyncdKeyManagementUtils").getKeyEpoch(a.keyId)});var f=Math.min(l,d("WABaseGlobals").getConfig().syncdAdditionalMutations());a=a.slice(0,f);return d("WASyncdRequestBuilderTypesConverter").syncActionsToPendingMutations(a,d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET)}function x(a,b,c){var e=b.map(function(a){return a.index});b=a.filter(function(a){return e.includes(a.index)});a=b.filter(function(a){return!d("WASyncdCryptoUtils").syncKeyIdsEqual(a.keyId,c)});return d("WASyncdRequestBuilderTypesConverter").syncActionsToPendingMutations(a,d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE)}g.buildSyncIqNode=a;g.buildDeleteAllIqNode=e;g._generateMutationsToUpload=v}),98);
__d("WASyncdRequestBuilderUtils",[],(function(a,b,c,d,e,f){function a(a){return g(a.reverse(),function(a){return a.index}).reverse()}function g(a,b){var c=new Set();return a.filter(function(a){a=b(a);if(c.has(a))return!1;c.add(a);return!0})}f.compactPatch=a}),66);
__d("WASyncdRequestBuilder",["Promise","WAGetPendingMutation","WASyncdRequestBuilderBuild","WASyncdRequestBuilderUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){var c,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:c=new Map();e=new Map();g.next=4;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(a.map(function(a){var f,g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:i.next=2;return b("regeneratorRuntime").awrap(d("WAGetPendingMutation").getSyncPendingMutationsByCollectionInTransaction(a));case 2:f=i.sent,g=f.map(function(a){return a.id}).filter(Boolean),e.set(a,g),h=d("WASyncdRequestBuilderUtils").compactPatch(f),c.set(a,h);case 7:case"end":return i.stop()}},null,this)})));case 4:g.next=6;return b("regeneratorRuntime").awrap(d("WASyncdRequestBuilderBuild").buildSyncIqNode(c));case 6:f=g.sent;return g.abrupt("return",{syncIqNode:f.syncIqNode,collectionWithPendingMutationsIds:e,collectionWithEncryptedMutations:f.collectionWithEncryptedMutations,localCollectionVersions:f.localCollectionVersions,collectionsToSkip:f.collectionsToSkip});case 8:case"end":return g.stop()}},null,this)}g["default"]=a}),98);
__d("WASyncdResponseParser",["WADeprecatedWapParser","WALogger","WASyncdConst","WASyncdDecode","WASyncdError","WASyncdMetricFatalError"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: collection "," did not get server error"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: collection "," got server code has_more_patches"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: retryable error: collection "," throws ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: fatal error 404: collection "," throws ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: fatal error: collection "," throws ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: collection "," got server error: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: successfully parsed collection ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: collection "," has no version, patches or snapshot"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: start parsing syncd collections"]);p=function(){return a};return a}a=new(c("WADeprecatedWapParser"))("syncResponseParser",function(a){d("WALogger").LOG(p());var b=[];a=a.child("sync");a.mapChildrenWithTag("collection",function(a){var c=babelHelpers["extends"]({},null),e=d("WASyncdConst").CollectionName.cast(a.attrString("name"));if(!e)throw new(d("WASyncdError").SyncdFatalError)("invalid collection name");c.name=e;c.state=q(a,c.name);a.hasAttr("version")&&(c.version=parseInt(a.attrString("version"),10));a.hasChild("patches")&&(c.patches=a.child("patches").mapChildrenWithTag("patch",function(a){return d("WASyncdDecode").decodeSyncdPatch(e,a.contentBytes())}));a.hasChild("snapshot")&&(c.snapshot=d("WASyncdDecode").decodeExternalBlobReference(e,a.child("snapshot").contentBytes()));b.push(c);c.version==null&&c.patches==null&&c.snapshot==null&&d("WALogger").LOG(o(),e);d("WALogger").LOG(n(),e)});return b});function q(a,b){if(a.hasAttr("type")&&a.attrString("type")==="error"){var c=a.child("error"),e=c.attrString("code");c=c.attrString("text");d("WALogger").LOG(m(),b,e);switch(e){case"409":return a.hasAttr("has_more_patches")?d("WASyncdConst").CollectionState.ConflictHasMore:d("WASyncdConst").CollectionState.Conflict;case"400":d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.XMPP_BAD_REQUEST_FOR_COLLECTION);d("WALogger").ERROR(l(),String(b),c).sendLogs("syncd: fatal error 400: collection "+String(b));return d("WASyncdConst").CollectionState.ErrorFatal;case"404":d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.XMPP_NOT_FOUND_FOR_COLLECTION);d("WALogger").ERROR(k(),String(b),c).sendLogs("syncd: fatal error: collection "+String(b));return d("WASyncdConst").CollectionState.ErrorFatal;default:d("WALogger").WARN(j(),String(b),c).sendLogs("syncd: retryable error: collection "+String(b));return d("WASyncdConst").CollectionState.ErrorRetry}}else if(a.hasAttr("has_more_patches")){d("WALogger").LOG(i(),b);return d("WASyncdConst").CollectionState.SuccessHasMore}else{d("WALogger").LOG(h(),b);return d("WASyncdConst").CollectionState.Success}}g.syncResponseParser=a}),98);
__d("WASyncdServerSync",["Promise","WABaseGlobals","WADeprecatedSendIq","WAGetCollectionVersion","WAGetPendingMutation","WALogger","WASyncdCollectionHandler","WASyncdConst","WASyncdError","WASyncdMetricCriticalBootstrapStage","WASyncdMetricFatalError","WASyncdMetrics","WASyncdRequestBuilder","WASyncdResponseParser","WASyncdWamAppState","WATimeUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: cannot log collection sync start: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: received sync response for collections: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: completed network operation for collections: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: sending sync request for collections: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: retryable error: syncd global throws ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: fatal error: syncd global throws ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: end apply collections: ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: start apply collections: ",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["\n\t"," v",""],["\\n\\t"," v",""]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: local collection versions:"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: deferred local mutation upload for ",""]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: reached max iterations for collections: ",""]);t=function(){return a};return a}var u=5,v=500;function a(a){var c,e,f,g,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:k.next=2;return b("regeneratorRuntime").awrap(A(a,"start serverSync"));case 2:c=[],e=[].concat(a),f=0;case 5:if(!(f<u||e.length>0&&f<v)){k.next=20;break}if(!(e.length===0)){k.next=8;break}return k.abrupt("break",20);case 8:k.next=10;return b("regeneratorRuntime").awrap(w(e));case 10:g=k.sent;i=g.doneCollections;j=g.refetchCollections;k.next=15;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(i.map(function(a){return A([a.name],"done collection, state: "+a.state)})));case 15:e=j;c=c.concat(i);f++;k.next=5;break;case 20:if(!(e.length>0)){k.next=25;break}k.next=23;return b("regeneratorRuntime").awrap(A(e,"error: max iterations"));case 23:d("WALogger").ERROR(t(),e).tags("syncd").sendLogs("syncd: max iteration"),c=c.concat(e.map(function(a){return{state:d("WASyncdConst").CollectionState.ErrorRetry,name:a}}));case 25:return k.abrupt("return",c);case 26:case"end":return k.stop()}},null,this)}function w(a){var c,e,f,g,i,j,k,l,t,u,v;return b("regeneratorRuntime").async(function(w){while(1)switch(w.prev=w.next){case 0:if(!(a.length===0)){w.next=2;break}return w.abrupt("return",{doneCollections:[],refetchCollections:[]});case 2:w.next=4;return b("regeneratorRuntime").awrap(z(a));case 4:w.prev=4;w.next=7;return b("regeneratorRuntime").awrap(x(a));case 7:c=w.sent;e=c.collectionDetails;f=c.localCollectionVersions;g=c.collectionsToUpload;g.length>0&&d("WALogger").LOG(s(),g);d("WALogger").LOG(r());f.forEach(function(a,b){d("WALogger").LOG(q(),b,(b=a)!=null?b:"(undefined)}")});i=[];j=[];e.forEach(function(a){switch(a.state){case d("WASyncdConst").CollectionState.ErrorRetry:case d("WASyncdConst").CollectionState.ErrorFatal:case d("WASyncdConst").CollectionState.Blocked:j.push(a);return;default:i.push(a)}(a.state===d("WASyncdConst").CollectionState.Conflict||a.state===d("WASyncdConst").CollectionState.ConflictHasMore)&&d("WASyncdWamAppState").incConflict()});d("WALogger").LOG(p(),i.map(function(a){return a.name}));k=new(d("WASyncdMetrics").SyncdEventFlow)();w.next=21;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(i.map(function(a){return d("WASyncdCollectionHandler").applyAppStateSyncResponse(a,f.get(a.name),k)})));case 21:l=w.sent;k.end();d("WALogger").LOG(o(),i.map(function(a){return a.name}));t=[];w.next=27;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(l.map(function(a){var c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:if(!(a.state===d("WASyncdConst").CollectionState.Conflict)){e.next=8;break}e.next=3;return b("regeneratorRuntime").awrap(d("WAGetPendingMutation").getSyncPendingMutationsByCollectionInTransaction(a.name));case 3:e.t0=e.sent.length;c=e.t0>0;c?t.push(a.name):(a.state=d("WASyncdConst").CollectionState.Success,j.push(a));e.next=15;break;case 8:if(!(a.state===d("WASyncdConst").CollectionState.ConflictHasMore||a.state===d("WASyncdConst").CollectionState.SuccessHasMore||a.state===d("WASyncdConst").CollectionState.Success&&g.some(function(b){return b===a.name}))){e.next=12;break}t.push(a.name);e.next=15;break;case 12:j.push(a);e.next=15;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").updateLastSuccessfulSyncEndTimeInTransaction(a.name));case 15:case"end":return e.stop()}},null,this)})));case 27:return w.abrupt("return",{doneCollections:j,refetchCollections:t});case 30:w.prev=30;w.t0=w["catch"](4);if(!(w.t0 instanceof d("WASyncdError").SyncdFatalError)){w.next=38;break}d("WALogger").ERROR(n(),w.t0.message).sendLogs("syncd: fatal error: syncd global throws "+w.t0.message);w.next=36;return b("regeneratorRuntime").awrap(A(a,"moving to fatal state: "+w.t0.name+" "+w.t0.message+" "+w.t0.stack));case 36:u=a.map(function(a){return{state:d("WASyncdConst").CollectionState.ErrorFatal,name:a}});return w.abrupt("return",{doneCollections:u,refetchCollections:[]});case 38:d("WALogger").WARN(m(),w.t0.message).sendLogs("syncd: retryable error: syncd global throws "+w.t0.message);w.next=41;return b("regeneratorRuntime").awrap(A(a,"retryable error: "+w.t0));case 41:v=a.map(function(a){return{state:d("WASyncdConst").CollectionState.ErrorRetry,name:a,serverBackoff:w.t0.errorBackoff}});return w.abrupt("return",{doneCollections:v,refetchCollections:[]});case 43:case"end":return w.stop()}},null,this,[[4,30]])}function x(a){var e,f,g,h,i,m,n,o,p,q,r;return b("regeneratorRuntime").async(function(s){while(1)switch(s.prev=s.next){case 0:s.next=2;return b("regeneratorRuntime").awrap(c("WASyncdRequestBuilder")(a));case 2:e=s.sent;f=e.syncIqNode;g=e.collectionWithPendingMutationsIds;h=e.collectionWithEncryptedMutations;i=e.localCollectionVersions;m=e.collectionsToSkip;d("WASyncdMetricCriticalBootstrapStage").reportSyncdCriticalBootstrapStage(d("WASyncdMetricCriticalBootstrapStage").SyncdCriticalBootstrapStageType.REQUEST_BUILT);d("WALogger").LOG(l(),a.map(function(a){var b;return"\n\t"+a+" v"+((b=i.get(a))!=null?b:"(undefined)")+" "+(((b=(b=g.get(a))==null?void 0:b.length)!=null?b:0)>0&&i.get(a)!=null?" with local changes":"")}));s.next=12;return b("regeneratorRuntime").awrap(A(a,"before sendIq"));case 12:s.next=14;return b("regeneratorRuntime").awrap(d("WADeprecatedSendIq").deprecatedSendIq(f,d("WASyncdResponseParser").syncResponseParser));case 14:n=s.sent;d("WALogger").LOG(k(),a);d("WASyncdMetricCriticalBootstrapStage").reportSyncdCriticalBootstrapStage(d("WASyncdMetricCriticalBootstrapStage").SyncdCriticalBootstrapStageType.RESPONSE_RECEIVED);if(!n.success){s.next=25;break}d("WASyncdMetricCriticalBootstrapStage").reportSyncdCriticalBootstrapStage(d("WASyncdMetricCriticalBootstrapStage").SyncdCriticalBootstrapStageType.RESPONSE_PARSED_VALID);s.next=21;return b("regeneratorRuntime").awrap(A(a,"after sendIq success"));case 21:o=n.result;d("WALogger").LOG(j(),o.map(function(a){var b="\n"+a.name;a.version!=null&&(b+="\n\tupdated to version "+a.version);a.snapshot!=null&&(b+="\n\tcontains snapshot");a.patches!=null&&(b+="\n\tcontains "+a.patches.length+" patches");return b}));o.forEach(function(a){var b=g.get(a.name);b&&(a.syncedPendingMutationsId=b);b=h.get(a.name);b&&(a.syncedEncryptedMutations=b)});return s.abrupt("return",{collectionDetails:o,localCollectionVersions:i,collectionsToUpload:m});case 25:p=n.errorCode,q=n.errorText,r=n.errorBackoff;throw y(p,q,r);case 27:case"end":return s.stop()}},null,this)}function y(a,b,c){switch(a){case 400:d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.XMPP_BAD_REQUEST_GLOBAL_ERROR);return new(d("WASyncdError").SyncdFatalError)(b);case 404:d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.XMPP_NOT_FOUND_GLOBAL_ERROR);return new(d("WASyncdError").SyncdFatalError)(b);case 405:d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.XMPP_BAD_METHOD_GLOBAL_ERROR);return new(d("WASyncdError").SyncdFatalError)(b);case 406:d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.XMPP_NOT_ACCEPTABLE_GLOBAL_ERROR);return new(d("WASyncdError").SyncdFatalError)(b);default:return new(d("WASyncdError").SyncdRetryableError)(b,c)}}function z(a){var c,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:g.prev=0;c=5;g.next=4;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").bulkGetCollectionVersionsInTransaction(a));case 4:e=g.sent;f=e.filter(Boolean).map(function(a){var b;b=((b=a.lastSyncAttemptStartTimes)!=null?b:[]).slice(-c+1);return{collection:a.collection,lastSyncAttemptStartTimes:[].concat(b,[d("WATimeUtils").unixTimeMs()])}});g.next=8;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").bulkSetCollectionSyncAttemptStartTimesInTransaction(f));case 8:g.next=13;break;case 10:g.prev=10,g.t0=g["catch"](0),d("WALogger").ERROR(i(),g.t0).tags("syncd").sendLogs("syncd: cannot log collection sync start");case 13:case"end":return g.stop()}},null,this,[[0,10]])}function A(a,c){return(h||(h=b("Promise"))).all(a.map(function(a){return d("WABaseGlobals").getDbImpls().writeSyncdLog(a,c)}))}g.serverSync=a}),98);
__d("WASyncd",["Promise","WABaseGlobals","WAGetCollectionVersion","WAGetMissingKey","WAGetPendingMutation","WAGetSyncAction","WAGetSyncKey","WALogger","WASyncdCollectionsStateMachine","WASyncdConst","WASyncdCryptoUtils","WASyncdDisabled","WASyncdKeyCache","WASyncdMetricCriticalBootstrapStage","WASyncdMetricFatalError","WASyncdOrphan","WASyncdServerSync","WASyncdWamAppState","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: syncing pending mutations and blocked collections due to app resume"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: syncPendingMutationsAndBlockedCollections: [","]"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: syncPendingMutationsAndBlockedCollections"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: retry is in flight"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: state machine tick"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: fatal error: expired collections"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: cleanup after handleRetry()"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: exception during handleRetry(): ",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: server sync retry successful"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: initiate server sync retry"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: cleanup after sync()"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: exception during sync(): ",""]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: server sync successful"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: initiate server sync"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: no collections to sync"]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: dirty collections: ",""]);x=function(){return a};return a}function y(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: syncBlockedCollections:\n    \tmoving blocked collections to dirty: [","]\n    \tadding inflight collections to pending: [","]"],["syncd: syncBlockedCollections:\n    \\tmoving blocked collections to dirty: [","]\n    \\tadding inflight collections to pending: [","]"]);y=function(){return a};return a}function z(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: sync blocked collections: ",""]);z=function(){return a};return a}function A(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd:\n        key id: ","\n        key timestamp: ","\n        key device indexes: ",""]);A=function(){return a};return a}function B(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: "," unsupported mutations"]);B=function(){return a};return a}function C(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd:\n        "," successful "," mutations\n        "," orphan "," mutations,\n        "," failed "," mutations"]);C=function(){return a};return a}function D(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: local version (",")for "," >= server version (","); will not mark for sync."]);D=function(){return a};return a}function E(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: local version (",") for "," less than server version (","); will mark for sync."]);E=function(){return a};return a}function F(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: server version for "," missing; will mark for sync."]);F=function(){return a};return a}function G(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: local version for "," missing; will mark for sync."]);G=function(){return a};return a}function H(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: start filter collections: ",""]);H=function(){return a};return a}function I(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: "," state before sync: ",""]);I=function(){return a};return a}function J(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: marking for sync: ",""]);J=function(){return a};return a}var K=1e3,L=1e3*60*60,M=2,N=new Set(),O=new Set(),P,Q=!1,R=0,S=0;function T(a,e){var f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:if(!(e!=null)){g.next=6;break}g.next=3;return b("regeneratorRuntime").awrap(U(a,e));case 3:g.t0=g.sent;g.next=7;break;case 6:g.t0=a;case 7:f=g.t0;d("WALogger").LOG(J(),f);f.forEach(function(a){var b=c("WASyncdCollectionsStateMachine").getCollectionState(a);d("WALogger").LOG(I(),a,b);b===d("WASyncdConst").CollectionSyncState.UpToDate?c("WASyncdCollectionsStateMachine").moveCollectionsToDirty([a]):b===d("WASyncdConst").CollectionSyncState.Dirty&&(O=new Set([].concat(Array.from(O),[a])))});g.next=12;return b("regeneratorRuntime").awrap(c("WASyncdCollectionsStateMachine").persistToDb());case 12:return g.abrupt("return",V());case 13:case"end":return g.stop()}},null,this)}function U(a,c){var e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:d("WALogger").LOG(H(),a);g.next=3;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").bulkGetCollectionVersionsInTransaction(a));case 3:e=g.sent;f=new Map(a.map(function(a,b){return[a,(a=e[b])==null?void 0:a.version]}));return g.abrupt("return",a.filter(function(a){var b=f.get(a);if(b==null){d("WALogger").LOG(G(),a);return!0}var e=c.get(a);if(e==null){d("WALogger").LOG(F(),a);return!0}if(b<e){d("WALogger").LOG(E(),b,a,e);return!0}d("WALogger").LOG(D(),b,a,e);return!1}));case 6:case"end":return g.stop()}},null,this)}function a(){var a,c,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:g.next=2;return b("regeneratorRuntime").awrap(d("WAGetSyncAction").countSyncActionsInTransaction());case 2:a=g.sent;d("WASyncdWamAppState").setStoredMutationCount(a);g.next=6;return b("regeneratorRuntime").awrap(d("WAGetSyncAction").getSyncActionsByActionStatesInTransaction([d("WASyncdConst").SyncActionState.Malformed]));case 6:c=g.sent;d("WASyncdWamAppState").setInvalidActionCount(c.length);g.next=10;return b("regeneratorRuntime").awrap(d("WAGetSyncAction").getSyncActionsByActionStatesInTransaction([d("WASyncdConst").SyncActionState.Unsupported]));case 10:e=g.sent;d("WASyncdWamAppState").setUnsupportedActionCount(e.length);g.next=14;return b("regeneratorRuntime").awrap(d("WAGetMissingKey").getMissingKeyCountTransaction());case 14:f=g.sent,d("WASyncdWamAppState").setMissingKeyCount(f);case 16:case"end":return g.stop()}},null,this)}function e(){var a,c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=7;break;e.next=3;return b("regeneratorRuntime").awrap(d("WAGetSyncAction").getAllSyncActions());case 3:a=e.sent,Array.from(d("WASyncdConst").Actions.members()).forEach(function(b){var c=a.filter(function(a){return a.action!=null&&a.action===b});if(c.length>0){var e=c.filter(function(a){return a.actionState===d("WASyncdConst").SyncActionState.Success||a.actionState===d("WASyncdConst").SyncActionState.Skipped}),f=c.filter(function(a){return a.actionState===d("WASyncdConst").SyncActionState.Orphan});c=c.filter(function(a){return a.actionState===d("WASyncdConst").SyncActionState.Malformed||a.actionState===d("WASyncdConst").SyncActionState.Failed});d("WALogger").DEV(C(),e.length,b,f.length,b,c.length,b)}}),c=a.filter(function(a){return a.actionState===d("WASyncdConst").SyncActionState.Unsupported}),d("WALogger").DEV(B(),c.length);case 7:case"end":return e.stop()}},null,this)}function f(){var a;return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=5;break;c.next=3;return b("regeneratorRuntime").awrap(d("WAGetSyncKey").getAllSyncKeysInTransaction());case 3:a=c.sent,a.forEach(function(a){d("WALogger").DEV(A(),d("WASyncdCryptoUtils").syncKeyIdToHex(a.keyId),a.timestamp,a.fingerprint.deviceIndexes)});case 5:case"end":return c.stop()}},null,this)}function e(){var a=c("WASyncdCollectionsStateMachine").getCollectionsInStateBlocked();d("WALogger").LOG(z(),a);c("WASyncdCollectionsStateMachine").moveCollectionsToDirty(a);O=new Set([].concat(Array.from(O),Array.from(N)));d("WALogger").LOG(y(),a,Array.from(N));return V()}function V(){var a,e,f,g;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:if(!d("WASyncdDisabled").isSyncdDisabled()){i.next=2;break}return i.abrupt("return",(h||(h=b("Promise"))).resolve());case 2:a=c("WASyncdCollectionsStateMachine").getCollectionsInStateDirty();d("WALogger").LOG(x(),a);e=new Set(a.filter(function(a){return!N.has(a)}));if(!(e.size===0)){i.next=8;break}d("WALogger").LOG(w());return i.abrupt("return",(h||(h=b("Promise"))).resolve());case 8:f=[];i.prev=9;N=new Set([].concat(Array.from(N),Array.from(e)));d("WALogger").LOG(v());i.next=14;return b("regeneratorRuntime").awrap(d("WASyncdServerSync").serverSync(Array.from(e)));case 14:f=i.sent;d("WALogger").LOG(u());g=f.filter(function(a){return a.state===d("WASyncdConst").CollectionState.ErrorRetry});g.length>0&&(S=g[0].serverBackoff||0,R=0);$(f);i.next=26;break;case 22:i.prev=22,i.t0=i["catch"](9),d("WALogger").LOG(t(),i.t0),c("WASyncdCollectionsStateMachine").moveCollectionsToFiniteRetry(Array.from(e));case 26:i.prev=26;d("WALogger").LOG(s());c("WASyncdCollectionsStateMachine").persistToDb();N=new Set(Array.from(N).filter(function(a){return!e.has(a)}));Z();i.next=33;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().handleSyncCompleted(f));case 33:return i.finish(26);case 34:case"end":return i.stop()}},null,this,[[9,22,26,34]])}function W(){if(d("WASyncdDisabled").isSyncdDisabled())return;var a=new Set(c("WASyncdCollectionsStateMachine").getCollectionsInStateRetry());if(a.size===0)return;P=setTimeout(function(){var e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.prev=0;Q=!0;R+=1;d("WALogger").LOG(r());f.next=6;return b("regeneratorRuntime").awrap(d("WASyncdServerSync").serverSync(Array.from(a)));case 6:e=f.sent;d("WALogger").LOG(q());$(e);f.next=15;break;case 11:f.prev=11,f.t0=f["catch"](0),d("WALogger").LOG(p(),f.t0),c("WASyncdCollectionsStateMachine").moveCollectionsToFiniteRetry(Array.from(a));case 15:f.prev=15;d("WALogger").LOG(o());Y();c("WASyncdCollectionsStateMachine").persistToDb();Q=!1;Z();return f.finish(15);case 22:case"end":return f.stop()}},null,this,[[0,11,15,22]])},X(R,S))}function X(a,b){a=Math.pow(M,a)*K;return Math.min(Math.max(a,b),L)}function Y(){var a=c("WASyncdCollectionsStateMachine").getExpiredCollections();a.length>0&&(c("WASyncdCollectionsStateMachine").moveCollectionsToFatal(a),d("WALogger").ERROR(n()).sendLogs("syncd: fatal error: expired collections"),d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.TOO_MANY_INTERNAL_SERVER_ERRORS_IN_7D))}function Z(){d("WALogger").LOG(m());c("WASyncdCollectionsStateMachine").getCollectionsInStateDirty().length>0&&(O=new Set(Array.from(O).filter(function(a){return N.has(a)})),V());var a=c("WASyncdCollectionsStateMachine").getCollectionsInStateRetry();if(a.length>0){if(Q){d("WALogger").LOG(l());return}P!=null&&clearTimeout(P);O=new Set(Array.from(O).filter(function(b){return!a.includes(b)}));W()}c("WASyncdCollectionsStateMachine").getCollectionsInStateFatal().length>0&&d("WABaseGlobals").getDbImpls().handleSyncdFatal({collections:c("WASyncdCollectionsStateMachine").getCollectionsInStateFatal()})}function $(a){return a.forEach(function(a){if(a.state===d("WASyncdConst").CollectionState.Success&&!O.has(a.name))return c("WASyncdCollectionsStateMachine").moveCollectionsToUpToDate([a.name]);if(a.state===d("WASyncdConst").CollectionState.ErrorRetry){d("WASyncdMetricCriticalBootstrapStage").reportSyncdCriticalBootstrapStage(d("WASyncdMetricCriticalBootstrapStage").SyncdCriticalBootstrapStageType.ENTERED_RETRY_MODE);return c("WASyncdCollectionsStateMachine").moveCollectionsToFiniteRetry([a.name])}if(a.state===d("WASyncdConst").CollectionState.ErrorFatal)return c("WASyncdCollectionsStateMachine").moveCollectionsToFatal([a.name]);if(a.state===d("WASyncdConst").CollectionState.Blocked&&!O.has(a.name))return c("WASyncdCollectionsStateMachine").moveCollectionsToBlocked([a.name])})}function aa(){var a,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:d("WALogger").LOG(k());g.next=3;return b("regeneratorRuntime").awrap(d("WAGetPendingMutation").getAllSyncPendingMutationsInTransaction());case 3:a=g.sent,e=c("WASyncdCollectionsStateMachine").getCollectionsInStateBlocked(),c("WASyncdCollectionsStateMachine").moveCollectionsToDirty(e),f=a.map(function(a){return a.collection}).concat(e),f.length>0&&(d("WALogger").LOG(j(),f),T(f));case 8:case"end":return g.stop()}},null,this)}function ba(){return c("WASyncdCollectionsStateMachine").loadStatesFromDb().then(function(){return Z()})}function ca(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:a.next=2;return b("regeneratorRuntime").awrap(d("WASyncdOrphan").applyAllOrphansAndUnsupported());case 2:d("WALogger").LOG(i());a.next=5;return b("regeneratorRuntime").awrap(aa());case 5:case"end":return a.stop()}},null,this)}function da(){return d("WABaseGlobals").runInTransaction({SyncActionStore:!0,CollectionVersionStore:!0,PendingMutationStore:!0,MissingKeyStore:!0,SyncKeyStore:!0},function(a){var e=a.SyncActionStore,f=a.CollectionVersionStore,g=a.PendingMutationStore,i=a.MissingKeyStore;a=a.SyncKeyStore;return(h||(h=b("Promise"))).all([e.clear(),f.clear(),g.clear(),i.clear(),a.clear()]).then(function(){c("WASyncdCollectionsStateMachine").clean(),d("WASyncdKeyCache").clearSyncKeysCache()})})}g.markCollectionsForSync=T;g.reportWam=a;g.logKeysInfoInIntern=f;g.syncBlockedCollections=e;g.initializeStateMachine=ba;g.processOnAppResume=ca;g.clearSyncdData=da}),98);
__d("WASyncdHandleKeyShare",["Promise","WAGetSyncKey","WALogger","WASyncd","WASyncdCryptoUtils","WASyncdStoreMissingKeys","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: stored key share key id "," from device ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: key share from device "," has no keys with keydata."]);j=function(){return a};return a}function a(a,c){return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:c.some(function(a){return a.fullKey!=null})||d("WALogger").LOG(j(),a);e.next=3;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(c.map(function(c){var e,f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:e=c.keyId,f=c.fullKey;if(!(f==null)){h.next=3;break}return h.abrupt("return");case 3:h.next=5;return b("regeneratorRuntime").awrap(d("WAGetSyncKey").getSyncKeyInTransaction_DO_NOT_USE(e));case 5:g=h.sent;if(g){h.next=10;break}h.next=9;return b("regeneratorRuntime").awrap(d("WAGetSyncKey").setSyncKeyInTransaction(f));case 9:d("WALogger").LOG(i(),d("WASyncdCryptoUtils").syncKeyIdToHex(e),a);case 10:case"end":return h.stop()}},null,this)})));case 3:e.next=5;return b("regeneratorRuntime").awrap(d("WASyncdStoreMissingKeys").updateMissingKeys(c.map(function(a){var b=a.keyId;a=a.fullKey;return{keyId:b,keyData:a==null?void 0:a.keyData}}),a));case 5:return e.abrupt("return",d("WASyncd").syncBlockedCollections());case 6:case"end":return e.stop()}},null,this)}g.handleKeyShare=a}),98);
__d("WAParseAppStateSyncKeyRequest",["WASyncdKeyTypes"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[];for(var a=a.keyIds,c=Array.isArray(a),e=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(c){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;f.keyId!=null&&b.push(d("WASyncdKeyTypes").toSyncKeyId(f.keyId))}return{keyIds:b}}g.parseAppStateSyncKeyRequest=a}),98);
__d("WAParseAppStateSyncKeyShare",["WALogger","WALongInt","WASyncdKeyManagementUtils","WASyncdKeyTypes"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Key missing keyId"]);h=function(){return a};return a}function a(a){var b=[],c=[];for(var a=a.keys,d=Array.isArray(a),e=0,a=d?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;f=i(f);f!=null&&(f.type==="orphan"?c.push(f.keyId):(f.type,b.push(f.keyData)))}return{keys:b,orphanKeys:c}}function i(a){var b,c,e,f,g,i;if(((b=a.keyId)==null?void 0:b.keyId)==null){d("WALogger").WARN(h());return null}b=d("WASyncdKeyTypes").toSyncKeyId(a.keyId.keyId);c=(c=a.keyData)==null?void 0:c.keyData;e=d("WALongInt").maybeNumberOrThrowIfTooLarge((e=a.keyData)==null?void 0:e.timestamp);f=(f=a.keyData)==null?void 0:(f=f.fingerprint)==null?void 0:f.currentIndex;g=(g=a.keyData)==null?void 0:(g=g.fingerprint)==null?void 0:g.deviceIndexes;i=(i=a.keyData)==null?void 0:(i=i.fingerprint)==null?void 0:i.rawId;return a.keyData==null||c==null||e==null||f==null||g==null||i==null?{keyId:b,type:"orphan"}:{keyData:{fingerprint:{currentIndex:f,deviceIndexes:g,rawId:i},keyData:d("WASyncdKeyTypes").toSyncKeyData(c),keyEpoch:d("WASyncdKeyManagementUtils").getKeyEpoch(b),keyId:b,timestamp:e},type:"key"}}g.parseAppStateSyncKeyShare=a}),98);
__d("WAMsgApplication.pb",["WACommon.pb","WAProtoConst"],(function(a,b,c,d,e,f,g){var h;a={DEFAULT:0,VANISH_MODE:1,DISAPPEARING_MESSAGES:2};b={};c={};e={};f={};var i={},j={},k={},l={},m={},n={};b.internalSpec={payload:[1,(h=d("WAProtoConst")).TYPES.MESSAGE,i],metadata:[2,h.TYPES.MESSAGE,c]};c.internalSpec={chatEphemeralSetting:[1,h.TYPES.MESSAGE,n],ephemeralSettingList:[2,h.TYPES.MESSAGE,f],ephemeralSharedSecret:[3,h.TYPES.BYTES],forwardingScore:[5,h.TYPES.UINT32],isForwarded:[6,h.TYPES.BOOL],businessMetadata:[7,h.TYPES.MESSAGE,(d=d("WACommon.pb")).SubProtocolSpec],frankingKey:[8,h.TYPES.BYTES],frankingVersion:[9,h.TYPES.INT32],quotedMessage:[10,h.TYPES.MESSAGE,e],threadType:[11,h.TYPES.ENUM,a],readonlyMetadataDataclass:[12,h.TYPES.STRING],groupId:[13,h.TYPES.STRING],groupSize:[14,h.TYPES.UINT32],groupIndex:[15,h.TYPES.UINT32],botResponseId:[16,h.TYPES.STRING],collapsibleId:[17,h.TYPES.STRING],__oneofs__:{ephemeral:["chatEphemeralSetting","ephemeralSettingList","ephemeralSharedSecret"]}};e.internalSpec={stanzaId:[1,h.TYPES.STRING],remoteJid:[2,h.TYPES.STRING],participant:[3,h.TYPES.STRING],payload:[4,h.TYPES.MESSAGE,i]};f.internalSpec={chatJid:[1,h.TYPES.STRING],ephemeralSetting:[2,h.TYPES.MESSAGE,n]};i.internalSpec={coreContent:[1,h.TYPES.MESSAGE,m],signal:[2,h.TYPES.MESSAGE,l],applicationData:[3,h.TYPES.MESSAGE,k],subProtocol:[4,h.TYPES.MESSAGE,j],__oneofs__:{content:["coreContent","signal","applicationData","subProtocol"]}};j.internalSpec={futureProof:[1,h.TYPES.ENUM,d.FUTURE_PROOF_BEHAVIOR],consumerMessage:[2,h.TYPES.MESSAGE,d.SubProtocolSpec],businessMessage:[3,h.TYPES.MESSAGE,d.SubProtocolSpec],paymentMessage:[4,h.TYPES.MESSAGE,d.SubProtocolSpec],multiDevice:[5,h.TYPES.MESSAGE,d.SubProtocolSpec],voip:[6,h.TYPES.MESSAGE,d.SubProtocolSpec],armadillo:[7,h.TYPES.MESSAGE,d.SubProtocolSpec],__oneofs__:{subProtocol:["consumerMessage","businessMessage","paymentMessage","multiDevice","voip","armadillo"]}};k.internalSpec={};l.internalSpec={};m.internalSpec={};n.internalSpec={ephemeralExpiration:[2,h.TYPES.UINT32],ephemeralSettingTimestamp:[3,h.TYPES.INT64],isEphemeralSettingReset:[4,h.TYPES.BOOL]};g.MESSAGE_APPLICATION_METADATA_THREAD_TYPE=a;g.MessageApplicationSpec=b;g.MessageApplication$MetadataSpec=c;g.MessageApplication$Metadata$QuotedMessageSpec=e;g.MessageApplication$Metadata$EphemeralSettingMapSpec=f;g.MessageApplication$PayloadSpec=i;g.MessageApplication$SubProtocolPayloadSpec=j;g.MessageApplication$ApplicationDataSpec=k;g.MessageApplication$SignalSpec=l;g.MessageApplication$ContentSpec=m;g.MessageApplication$EphemeralSettingSpec=n}),98);
__d("WAParseMessageApplication",["decodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b,c,e=a.payload;if(e==null)return{version:"v3",type:"error",error:"The messageApplication has no payload"};if(d("decodeProtobuf").getUnknownFields(a.payload)!=null)return{version:"v3",type:"error",error:"There are unknown fields in the message application payload"};e=e.subProtocol;if(e==null)return{version:"v3",type:"error",error:"The messageApplication payload has no subProtocol"};if(d("decodeProtobuf").getUnknownFields(e)!=null)return{version:"v3",type:"error",error:"messageApplication subProtocol has unknown fields",futureProof:e.futureProof};e=[];b=(b=a.payload)==null?void 0:(b=b.subProtocol)==null?void 0:b.consumerMessage;c=(c=a.payload)==null?void 0:(c=c.subProtocol)==null?void 0:c.armadillo;a=(a=a.payload)==null?void 0:(a=a.subProtocol)==null?void 0:a.multiDevice;if(b!=null){if(b.payload==null)return{version:"v3",type:"error",error:"subprotocol of type consumerMessage has no payload"};e.push({payload:new Uint8Array(b.payload),type:"success",subprotocolType:"consumerMessage"})}if(c!=null){if(c.payload==null)return{version:"v3",type:"error",error:"subprotocol of type armadillo has no payload"};e.push({payload:new Uint8Array(c.payload),type:"success",subprotocolType:"armadillo"})}if(a!=null){if(a.payload==null)return{version:"v3",type:"error",error:"subprotocol of type multiDevice has no payload"};e.push({payload:new Uint8Array(a.payload),type:"success",subprotocolType:"multiDevice"})}return e.length!==1?{version:"v3",type:"error",error:"Wrong number of subprotocols: "+e.length}:e[0]}g.parseMessageApplication=a}),98);
__d("WAMediaTransport.pb",["WACommon.pb","WAProtoConst"],(function(a,b,c,d,e,f,g){var h;a={NONE:0,LQ_4K:1,HQ_4K:2};b={NONE:0,GIPHY:1,TENOR:2};c={};e={};f={};var i={},j={},k={},l={},m={},n={},o={},p={},q={},r={},s={},t={},u={},v={},w={},x={},y={},z={},A={},B={};c.internalSpec={integral:[1,(h=d("WAProtoConst")).TYPES.MESSAGE,j],ancillary:[2,h.TYPES.MESSAGE,e]};e.internalSpec={fileLength:[1,h.TYPES.UINT64],mimetype:[2,h.TYPES.STRING],thumbnail:[3,h.TYPES.MESSAGE,f],objectId:[4,h.TYPES.STRING]};f.internalSpec={jpegThumbnail:[1,h.TYPES.BYTES],downloadableThumbnail:[2,h.TYPES.MESSAGE,i],thumbnailWidth:[3,h.TYPES.UINT32],thumbnailHeight:[4,h.TYPES.UINT32]};i.internalSpec={fileSha256:[1,h.TYPES.BYTES],fileEncSha256:[2,h.TYPES.BYTES],directPath:[3,h.TYPES.STRING],mediaKey:[4,h.TYPES.BYTES],mediaKeyTimestamp:[5,h.TYPES.INT64],objectId:[6,h.TYPES.STRING]};j.internalSpec={fileSha256:[1,h.TYPES.BYTES],mediaKey:[2,h.TYPES.BYTES],fileEncSha256:[3,h.TYPES.BYTES],directPath:[4,h.TYPES.STRING],mediaKeyTimestamp:[5,h.TYPES.INT64]};k.internalSpec={integral:[1,h.TYPES.MESSAGE,m],ancillary:[2,h.TYPES.MESSAGE,l]};l.internalSpec={height:[1,h.TYPES.UINT32],width:[2,h.TYPES.UINT32],scansSidecar:[3,h.TYPES.BYTES],scanLengths:[4,h.FLAGS.REPEATED|h.TYPES.UINT32],midQualityFileSha256:[5,h.TYPES.BYTES],hdType:[6,h.TYPES.ENUM,a]};m.internalSpec={transport:[1,h.TYPES.MESSAGE,c]};n.internalSpec={integral:[1,h.TYPES.MESSAGE,p],ancillary:[2,h.TYPES.MESSAGE,o]};o.internalSpec={seconds:[1,h.TYPES.UINT32],caption:[2,h.TYPES.MESSAGE,d("WACommon.pb").MessageTextSpec],gifPlayback:[3,h.TYPES.BOOL],height:[4,h.TYPES.UINT32],width:[5,h.TYPES.UINT32],sidecar:[6,h.TYPES.BYTES],gifAttribution:[7,h.TYPES.ENUM,b]};p.internalSpec={transport:[1,h.TYPES.MESSAGE,c]};q.internalSpec={integral:[1,h.TYPES.MESSAGE,s],ancillary:[2,h.TYPES.MESSAGE,r]};r.internalSpec={seconds:[1,h.TYPES.UINT32]};s.internalSpec={transport:[1,h.TYPES.MESSAGE,c]};t.internalSpec={integral:[1,h.TYPES.MESSAGE,v],ancillary:[2,h.TYPES.MESSAGE,u]};u.internalSpec={pageCount:[1,h.TYPES.UINT32]};v.internalSpec={transport:[1,h.TYPES.MESSAGE,c]};w.internalSpec={integral:[1,h.TYPES.MESSAGE,y],ancillary:[2,h.TYPES.MESSAGE,x]};x.internalSpec={pageCount:[1,h.TYPES.UINT32],height:[2,h.TYPES.UINT32],width:[3,h.TYPES.UINT32],firstFrameLength:[4,h.TYPES.UINT32],firstFrameSidecar:[5,h.TYPES.BYTES],mustacheText:[6,h.TYPES.STRING],isThirdParty:[7,h.TYPES.BOOL],receiverFetchId:[8,h.TYPES.STRING]};y.internalSpec={transport:[1,h.TYPES.MESSAGE,c],isAnimated:[2,h.TYPES.BOOL],receiverFetchId:[3,h.TYPES.STRING]};z.internalSpec={integral:[1,h.TYPES.MESSAGE,B],ancillary:[2,h.TYPES.MESSAGE,A]};A.internalSpec={displayName:[1,h.TYPES.STRING]};B.internalSpec={vcard:[1,h.TYPES.STRING],downloadableVcard:[2,h.TYPES.MESSAGE,c],__oneofs__:{contact:["vcard","downloadableVcard"]}};g.IMAGE_TRANSPORT_ANCILLARY_HD_TYPE=a;g.VIDEO_TRANSPORT_ANCILLARY_ATTRIBUTION=b;g.WAMediaTransportSpec=c;g.WAMediaTransport$AncillarySpec=e;g.WAMediaTransport$Ancillary$ThumbnailSpec=f;g.WAMediaTransport$Ancillary$Thumbnail$DownloadableThumbnailSpec=i;g.WAMediaTransport$IntegralSpec=j;g.ImageTransportSpec=k;g.ImageTransport$AncillarySpec=l;g.ImageTransport$IntegralSpec=m;g.VideoTransportSpec=n;g.VideoTransport$AncillarySpec=o;g.VideoTransport$IntegralSpec=p;g.AudioTransportSpec=q;g.AudioTransport$AncillarySpec=r;g.AudioTransport$IntegralSpec=s;g.DocumentTransportSpec=t;g.DocumentTransport$AncillarySpec=u;g.DocumentTransport$IntegralSpec=v;g.StickerTransportSpec=w;g.StickerTransport$AncillarySpec=x;g.StickerTransport$IntegralSpec=y;g.ContactTransportSpec=z;g.ContactTransport$AncillarySpec=A;g.ContactTransport$IntegralSpec=B}),98);
__d("WAConsumerApplication.pb",["WACommon.pb","WAProtoConst"],(function(a,b,c,d,e,f,g){var h;a={SMALL:1,MEDIUM:2,LARGE:3};b={SANS_SERIF:0,SERIF:1,NORICAN_REGULAR:2,BRYNDAN_WRITE:3,BEBASNEUE_REGULAR:4,OSWALD_HEAVY:5};c={NONE:0,VIDEO:1};e={};f={};var i={},j={},k={},l={},m={},n={},o={},p={},q={},r={},s={},t={},u={},v={},w={},x={},y={},z={},A={},B={},C={},D={},E={},F={},G={},H={},I={},J={},K={},L={},M={};e.internalSpec={payload:[1,(h=d("WAProtoConst")).TYPES.MESSAGE,f],metadata:[2,h.TYPES.MESSAGE,j]};f.internalSpec={content:[1,h.TYPES.MESSAGE,m],applicationData:[2,h.TYPES.MESSAGE,l],signal:[3,h.TYPES.MESSAGE,k],subProtocol:[4,h.TYPES.MESSAGE,i],__oneofs__:{payload:["content","applicationData","signal","subProtocol"]}};i.internalSpec={futureProof:[1,h.TYPES.ENUM,(d=d("WACommon.pb")).FUTURE_PROOF_BEHAVIOR]};j.internalSpec={specialTextSize:[1,h.TYPES.ENUM,a]};k.internalSpec={};l.internalSpec={revoke:[1,h.TYPES.MESSAGE,v],__oneofs__:{applicationContent:["revoke"]}};m.internalSpec={messageText:[1,h.TYPES.MESSAGE,d.MessageTextSpec],imageMessage:[2,h.TYPES.MESSAGE,I],contactMessage:[3,h.TYPES.MESSAGE,A],locationMessage:[4,h.TYPES.MESSAGE,D],extendedTextMessage:[5,h.TYPES.MESSAGE,C],statusTextMessage:[6,h.TYPES.MESSAGE,B],documentMessage:[7,h.TYPES.MESSAGE,F],audioMessage:[8,h.TYPES.MESSAGE,H],videoMessage:[9,h.TYPES.MESSAGE,G],contactsArrayMessage:[10,h.TYPES.MESSAGE,z],liveLocationMessage:[11,h.TYPES.MESSAGE,y],stickerMessage:[12,h.TYPES.MESSAGE,E],groupInviteMessage:[13,h.TYPES.MESSAGE,x],viewOnceMessage:[14,h.TYPES.MESSAGE,w],reactionMessage:[16,h.TYPES.MESSAGE,u],pollCreationMessage:[17,h.TYPES.MESSAGE,s],pollUpdateMessage:[18,h.TYPES.MESSAGE,r],editMessage:[19,h.TYPES.MESSAGE,n],__oneofs__:{content:["messageText","imageMessage","contactMessage","locationMessage","extendedTextMessage","statusTextMessage","documentMessage","audioMessage","videoMessage","contactsArrayMessage","liveLocationMessage","stickerMessage","groupInviteMessage","viewOnceMessage","reactionMessage","pollCreationMessage","pollUpdateMessage","editMessage"]}};n.internalSpec={key:[1,h.TYPES.MESSAGE,d.MessageKeySpec],message:[2,h.TYPES.MESSAGE,d.MessageTextSpec],timestampMs:[3,h.TYPES.INT64]};o.internalSpec={pollOption:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,t]};p.internalSpec={selectedOptions:[1,h.FLAGS.REPEATED|h.TYPES.BYTES],senderTimestampMs:[2,h.TYPES.INT64]};q.internalSpec={encPayload:[1,h.TYPES.BYTES],encIv:[2,h.TYPES.BYTES]};r.internalSpec={pollCreationMessageKey:[1,h.TYPES.MESSAGE,d.MessageKeySpec],vote:[2,h.TYPES.MESSAGE,q],addOption:[3,h.TYPES.MESSAGE,q]};s.internalSpec={encKey:[1,h.TYPES.BYTES],name:[2,h.TYPES.STRING],options:[3,h.FLAGS.REPEATED|h.TYPES.MESSAGE,t],selectableOptionsCount:[4,h.TYPES.UINT32]};t.internalSpec={optionName:[1,h.TYPES.STRING]};u.internalSpec={key:[1,h.TYPES.MESSAGE,d.MessageKeySpec],text:[2,h.TYPES.STRING],groupingKey:[3,h.TYPES.STRING],senderTimestampMs:[4,h.TYPES.INT64],reactionMetadataDataclassData:[5,h.TYPES.STRING],style:[6,h.TYPES.INT32]};v.internalSpec={key:[1,h.TYPES.MESSAGE,d.MessageKeySpec]};w.internalSpec={imageMessage:[1,h.TYPES.MESSAGE,I],videoMessage:[2,h.TYPES.MESSAGE,G],__oneofs__:{viewOnceContent:["imageMessage","videoMessage"]}};x.internalSpec={groupJid:[1,h.TYPES.STRING],inviteCode:[2,h.TYPES.STRING],inviteExpiration:[3,h.TYPES.INT64],groupName:[4,h.TYPES.STRING],jpegThumbnail:[5,h.TYPES.BYTES],caption:[6,h.TYPES.MESSAGE,d.MessageTextSpec]};y.internalSpec={location:[1,h.TYPES.MESSAGE,L],accuracyInMeters:[2,h.TYPES.UINT32],speedInMps:[3,h.TYPES.FLOAT],degreesClockwiseFromMagneticNorth:[4,h.TYPES.UINT32],caption:[5,h.TYPES.MESSAGE,d.MessageTextSpec],sequenceNumber:[6,h.TYPES.INT64],timeOffset:[7,h.TYPES.UINT32]};z.internalSpec={displayName:[1,h.TYPES.STRING],contacts:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,A]};A.internalSpec={contact:[1,h.TYPES.MESSAGE,d.SubProtocolSpec]};B.internalSpec={text:[1,h.TYPES.MESSAGE,C],textArgb:[6,h.TYPES.FIXED32],backgroundArgb:[7,h.TYPES.FIXED32],font:[8,h.TYPES.ENUM,b]};C.internalSpec={text:[1,h.TYPES.MESSAGE,d.MessageTextSpec],matchedText:[2,h.TYPES.STRING],canonicalUrl:[3,h.TYPES.STRING],description:[4,h.TYPES.STRING],title:[5,h.TYPES.STRING],thumbnail:[6,h.TYPES.MESSAGE,d.SubProtocolSpec],previewType:[7,h.TYPES.ENUM,c]};D.internalSpec={location:[1,h.TYPES.MESSAGE,L],address:[2,h.TYPES.STRING]};E.internalSpec={sticker:[1,h.TYPES.MESSAGE,d.SubProtocolSpec]};F.internalSpec={document:[1,h.TYPES.MESSAGE,d.SubProtocolSpec],fileName:[2,h.TYPES.STRING]};G.internalSpec={video:[1,h.TYPES.MESSAGE,d.SubProtocolSpec],caption:[2,h.TYPES.MESSAGE,d.MessageTextSpec]};H.internalSpec={audio:[1,h.TYPES.MESSAGE,d.SubProtocolSpec],ptt:[2,h.TYPES.BOOL]};I.internalSpec={image:[1,h.TYPES.MESSAGE,d.SubProtocolSpec],caption:[2,h.TYPES.MESSAGE,d.MessageTextSpec]};J.internalSpec={polygonVertices:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,K],location:[2,h.TYPES.MESSAGE,L],__oneofs__:{action:["location"]}};K.internalSpec={x:[1,h.TYPES.DOUBLE],y:[2,h.TYPES.DOUBLE]};L.internalSpec={degreesLatitude:[1,h.TYPES.DOUBLE],degreesLongitude:[2,h.TYPES.DOUBLE],name:[3,h.TYPES.STRING]};M.internalSpec={protocol:[1,h.TYPES.MESSAGE,d.SubProtocolSpec]};g.CONSUMER_APPLICATION_METADATA_SPECIAL_TEXT_SIZE=a;g.CONSUMER_APPLICATION_STATUS_TEXT_MESAGE_FONT_TYPE=b;g.CONSUMER_APPLICATION_EXTENDED_TEXT_MESSAGE_PREVIEW_TYPE=c;g.ConsumerApplicationSpec=e;g.ConsumerApplication$PayloadSpec=f;g.ConsumerApplication$SubProtocolPayloadSpec=i;g.ConsumerApplication$MetadataSpec=j;g.ConsumerApplication$SignalSpec=k;g.ConsumerApplication$ApplicationDataSpec=l;g.ConsumerApplication$ContentSpec=m;g.ConsumerApplication$EditMessageSpec=n;g.ConsumerApplication$PollAddOptionMessageSpec=o;g.ConsumerApplication$PollVoteMessageSpec=p;g.ConsumerApplication$PollEncValueSpec=q;g.ConsumerApplication$PollUpdateMessageSpec=r;g.ConsumerApplication$PollCreationMessageSpec=s;g.ConsumerApplication$OptionSpec=t;g.ConsumerApplication$ReactionMessageSpec=u;g.ConsumerApplication$RevokeMessageSpec=v;g.ConsumerApplication$ViewOnceMessageSpec=w;g.ConsumerApplication$GroupInviteMessageSpec=x;g.ConsumerApplication$LiveLocationMessageSpec=y;g.ConsumerApplication$ContactsArrayMessageSpec=z;g.ConsumerApplication$ContactMessageSpec=A;g.ConsumerApplication$StatusTextMesageSpec=B;g.ConsumerApplication$ExtendedTextMessageSpec=C;g.ConsumerApplication$LocationMessageSpec=D;g.ConsumerApplication$StickerMessageSpec=E;g.ConsumerApplication$DocumentMessageSpec=F;g.ConsumerApplication$VideoMessageSpec=G;g.ConsumerApplication$AudioMessageSpec=H;g.ConsumerApplication$ImageMessageSpec=I;g.ConsumerApplication$InteractiveAnnotationSpec=J;g.ConsumerApplication$PointSpec=K;g.ConsumerApplication$LocationSpec=L;g.ConsumerApplication$MediaPayloadSpec=M}),98);
__d("WAMessageKey",["WAErr","WAGlobals","WAJids","WAStanzaUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return a===d("WAJids").AUTHOR_ME||a==d("WAGlobals").getMyUserJid()}function a(a,b,e){if(e==null)throw c("WAErr")("messageKey is null");var f=e.id,g=e.remoteJid;if(f==null)throw c("WAErr")("messageKey.id is null");else if(g==null)throw c("WAErr")("messageKey.remoteJid is null");g=d("WAJids").interpretAndValidateJid(g);if(g.jidType==="unknown")throw c("WAErr")("messageKey.remoteJid is invalid");var i,j=d("WAJids").AUTHOR_ME;if(g.jidType==="group"){i=g.groupJid;if(h(b)&&e.fromMe===!0)j=d("WAJids").AUTHOR_ME;else if(e.fromMe==!0)j=b;else{var k=e.participant;if(k==null)throw c("WAErr")("key.participant is null");k=d("WAJids").interpretAndValidateJid(k);if(k.jidType==="msgrUser")j=k.userJid;else throw c("WAErr")("key.participant is invalid")}}else if(g.jidType==="msgrUser"||g.jidType==="msgrDevice"){k=d("WAJids").interpretAndValidateJid(a);if(k.jidType!=="msgrUser")throw c("WAErr")("expected user type jid.");i=k.userJid;h(b)?e.fromMe===!0?j=d("WAJids").AUTHOR_ME:j=k.userJid:e.fromMe===!0&&(j=k.userJid)}else throw c("WAErr")("Unsupported jidtype type");return{chat:i,author:h(j)?d("WAJids").AUTHOR_ME:j,externalId:d("WAStanzaUtils").toStanzaId(f)}}g.extractProtocolMessageId=a}),98);
__d("WAParseConsumerMessagePollCreation",["WAGlobals","WAHex","WAMsgType"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c,e){a={unstoredMsg:{type:d("WAMsgType").MSG_TYPE.FUTUREPROOF,msgContent:{protobuf:d("WAHex").bytesToBuffer(a),subtype:null},id:b.id,ts:b.ts,sentTs:b.sentTs,serverTs:b.serverTs,ack:b.ack,reportingMeta:c},unstoredMedia:null,unstoredQuotedMedia:null};return!e||!d("WAGlobals").getConfig().isPollsFallbackExperienceEnabled()?a:a}g["default"]=a}),98);
__d("WAParseProtocolUtils",["WAGlobals","WALogger","WALongInt","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unsupported franking version ",""]);h=function(){return a};return a}function a(a,b){b=i(b,a.serverTs);a=b==null?void 0:b.expirationTs;var c=b==null?void 0:b.deleteTs;b=b==null?void 0:b.ephemeralSetting;return{expirationTs:a,deleteTs:c,ephemeralSetting:b}}function b(a,b){b=j(b);b!=null&&(a.reportingMeta=b);return b}function i(a,b){var c;c=a==null?void 0:(c=a.chatEphemeralSetting)==null?void 0:c.ephemeralExpiration;a=a==null?void 0:(a=a.chatEphemeralSetting)==null?void 0:a.ephemeralSettingTimestamp;if(c==null||a==null||c===0||!d("WAGlobals").getConfig().isEphemeralMessagesEnabled())return null;b=d("WATimeUtils").castToUnixTime(b+d("WAGlobals").getConfig().ephemeralMaxDeletionWindowForUnseenMessage());var e=b,f=null;try{a=d("WALongInt").numberOrThrowIfTooLarge(a)/1e3;f=d("WATimeUtils").castToUnixTime(a)}catch(a){return null}return{expirationTs:b,deleteTs:e,ephemeralSetting:{expirationTs:c,updatedTs:f}}}function j(a){a=a==null?void 0:a.frankingVersion;a!=null&&a!==0&&d("WALogger").ERROR(h(),a);return{frankingKey:void 0,frankingTag:void 0,frankingVersion:a,reportingContent:void 0,reportingTag:void 0}}g.parseEphemerality=a;g.enhanceReportingMeta=b}),98);
__d("WAParseConsumerMessageProtocol",["WACommon.pb","WAConsumerApplication.pb","WAErr","WAGlobals","WAHex","WAJids","WALogger","WAMediaTransport.pb","WAMessageKey","WAMsgType","WAParseConsumerMessagePollCreation","WAParseMediaTransportProtocol","WAParseProtocolUtils","WAResultOrError","WAStanzaUtils","decodeProtobuf"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["parseConsumerMessageProtocol error :",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["WAParseConsumerMessageProtocol - ephemeralSetting duration is invalid ",", jidType: ",""]);i=function(){return a};return a}b=1;e=0;f=1;f=d("WAGlobals").getConfig().armadilloWebProcessFutureproof()?f+1:f;function a(a,b,e,f,g){var j;b=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAConsumerApplication.pb").ConsumerApplicationSpec,b);j=(j=b.payload)==null?void 0:(j=j.applicationData)==null?void 0:(j=j.revoke)==null?void 0:(j=j.key)==null?void 0:j.id;if(j!=null)return{unstoredMsg:{type:d("WAMsgType").MSG_TYPE.REVOKED,id:e.id,ts:e.ts,sentTs:e.sentTs,serverTs:e.serverTs,ack:e.ack,reportingMeta:e.reportingMeta,revokedExternalId:d("WAStanzaUtils").toStanzaId(j),unsendMsgContentDeleteTs:null,msgContent:null},unstoredMedia:null,unstoredQuotedMedia:null};j=(g==null?void 0:g.isForwarded)||!1;var k=d("WAParseProtocolUtils").parseEphemerality(e,g),l=k.expirationTs,u=k.deleteTs;k=k.ephemeralSetting;if(k!=null&&(k.expirationTs<0||k.expirationTs>86400)){var v=d("WAJids").interpretAndValidateJid(a);v=v.jidType;var w=k.expirationTs;k.expirationTs===4294967295&&(k.expirationTs=0);d("WALogger").ERROR(i(),w,v)}w=d("WAParseProtocolUtils").enhanceReportingMeta(e,g);g=(v=n(g))!=null?v:void 0;v=(v=b.payload)==null?void 0:v.content;if(!v)return{unstoredMsg:null,unstoredMedia:null,unstoredQuotedMedia:null};b=(b=b.metadata)==null?void 0:b.specialTextSize;var x=s(v),y={unstoredMsg:{type:d("WAMsgType").MSG_TYPE.FUTUREPROOF,msgContent:{protobuf:d("WAHex").bytesToBuffer(f),subtype:null},id:e.id,ts:e.ts,sentTs:e.sentTs,serverTs:e.serverTs,ack:e.ack,reportingMeta:w},unstoredMedia:null,unstoredQuotedMedia:null};try{switch(x){case"messageText":var z,A=v[x];if(A==null)throw c("WAErr")("consumerMessage has no messageText");z=((z=A.commands)==null?void 0:z.some(function(a){return a.commandType===d("WACommon.pb").COMMAND_COMMAND_TYPE.AI}))===!0;if(z)return y;if(A.text==null)throw c("WAErr")("consumerMessage has no messageText");return{unstoredMsg:babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.TEXT,msgContent:{content:A.text,mentionedJids:A.mentionedJid.map(d("WAJids").validateUserJid).filter(Boolean)},quote:g,expirationTs:l,deleteTs:u,ephemeralSetting:k,isForwarded:j},e,{specialTextSize:b}),unstoredMedia:null,unstoredQuotedMedia:null};case"reactionMessage":return{unstoredMsg:m(a,e,v[x]),unstoredMedia:null,unstoredQuotedMedia:null};case"imageMessage":z=o(v,e.ts);return{unstoredMsg:babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.IMAGE,quote:g,expirationTs:l,deleteTs:u,ephemeralSetting:k,isForwarded:j,mediaId:z.plaintextHash},e),unstoredMedia:z,unstoredQuotedMedia:null};case"videoMessage":A=v[x];if(A==null)throw c("WAErr")("consumerMessage has no videoMessage");z=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAMediaTransport.pb").VideoTransportSpec,A==null?void 0:(a=A.video)==null?void 0:a.payload);a=z==null?void 0:(A=z.integral)==null?void 0:(a=A.transport)==null?void 0:(A=a.ancillary)==null?void 0:A.mimetype;A=(z==null?void 0:(A=z.ancillary)==null?void 0:A.gifPlayback)===!0&&a==="image/gif";if(A&&!d("WAGlobals").getConfig().isGifEnabled())return y;a=d("WAParseMediaTransportProtocol").parseVideoMsg(z,e.ts,A);if(a==null)throw c("WAErr")("consumerMessage has no video media info");return{unstoredMsg:A?babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.GIF},e,{quote:g,expirationTs:l,deleteTs:u,ephemeralSetting:k,isForwarded:j,reportingMeta:w,mediaId:a.plaintextHash}):babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.VIDEO},e,{quote:g,expirationTs:l,deleteTs:u,ephemeralSetting:k,isForwarded:j,mediaId:a.plaintextHash}),unstoredMedia:a,unstoredQuotedMedia:null};case"audioMessage":z=p(v,e.ts);return{unstoredMsg:babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.PTT,quote:g,expirationTs:l,deleteTs:u,ephemeralSetting:k,isForwarded:j,mediaId:z.plaintextHash},e),unstoredMedia:z,unstoredQuotedMedia:null};case"stickerMessage":if(d("WAGlobals").getConfig().isStickerEnabled()){A=q(v,e.ts);return{unstoredMsg:babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.STICKER,quote:g,expirationTs:l,deleteTs:u,ephemeralSetting:k,isForwarded:j,reportingMeta:w,mediaId:A.plaintextHash},e),unstoredMedia:A,unstoredQuotedMedia:null}}return y;case"documentMessage":if(d("WAGlobals").getConfig().isDocumentReceiveEnabled()){a=r(v,e.ts);return{unstoredMsg:babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.DOCUMENT_FILE,quote:g,expirationTs:l,deleteTs:u,ephemeralSetting:k,isForwarded:j,reportingMeta:w,mediaId:a.plaintextHash},e),unstoredMedia:a,unstoredQuotedMedia:null}}return y;case"groupInviteMessage":return{unstoredMsg:null,unstoredMedia:null,unstoredQuotedMedia:null,unstoredIncomingGroupInvite:t(e,v)};case"editMessage":z=v[x];A=z==null?void 0:z.message;g=A==null?void 0:A.text;u=z==null?void 0:(l=z.key)==null?void 0:l.id;if(z==null||A==null||g==null)throw c("WAErr")("consumerMessage with editMessage type has no editMessage");if(u==null)throw c("WAErr")("consumerMessage with editMessage type has no original Msg External Id.");k=d("WAStanzaUtils").toStanzaId(u);return{unstoredEditMsg:{type:d("WAMsgType").MSG_TYPE.EDIT_ACTION,editMsgContent:{content:g,mentionedJids:A.mentionedJid.map(d("WAJids").validateUserJid).filter(Boolean)},originalMsgExternalId:k,id:e.id,ts:e.ts,sentTs:e.sentTs,serverTs:e.serverTs,ack:e.ack,reportingMeta:w,specialTextSize:b},unstoredMsg:null,unstoredMedia:null,unstoredQuotedMedia:null};case"pollCreationMessage":return c("WAParseConsumerMessagePollCreation")(f,e,w,v[x]);case"contactMessage":case"locationMessage":case"extendedTextMessage":case"statusTextMessage":case"contactsArrayMessage":case"liveLocationMessage":case"viewOnceMessage":default:return y}}catch(a){d("WALogger").ERROR(h(),a);return{unstoredMsg:null,unstoredMedia:null,unstoredQuotedMedia:null}}}function j(a){if(d("WAJids").isAuthorSystem(a))throw c("WAErr")("Got system author");return a}var k=30;function l(a){if(a==null)return d("WAResultOrError").makeResult(null);return a.length>k?d("WAResultOrError").makeError("invalid-reaction-text-length"):d("WAResultOrError").makeResult(a)}function m(a,b,e){if(e==null)throw c("WAErr")("consumerMessage has no reactionMessage");var f=j(b.id.author);a=d("WAMessageKey").extractProtocolMessageId(a,f,e.key);f=e.text;e=e.groupingKey;var g=l(f);if(!g.success){throw c("WAErr")('"'+((f=f)!=null?f:"")+'" is not a valid reaction ['+g.error+"]")}return{type:d("WAMsgType").MSG_TYPE.REACTION,ack:b.ack,id:b.id,reactToExternalId:a.externalId,reactToAuthor:a.author,reaction:g.value,groupingKey:e,ts:b.ts}}function n(a){var b,e;b=a==null?void 0:(b=a.quotedMessage)==null?void 0:b.stanzaId;e=a==null?void 0:(e=a.quotedMessage)==null?void 0:e.participant;a=a==null?void 0:(a=a.quotedMessage)==null?void 0:a.remoteJid;e=e!=null?d("WAJids").interpretAndValidateJid(e):null;var f;(e==null?void 0:e.jidType)==="msgrUser"&&e.userJid===d("WAGlobals").getMyUserJid()?f=d("WAJids").AUTHOR_ME:(e==null?void 0:e.jidType)==="msgrUser"?f=e.userJid:f=d("WAJids").AUTHOR_ME;if(b==null)return null;e={type:d("WAMsgType").MSG_TYPE.UNAVAILABLE,author:f,externalId:d("WAStanzaUtils").toStanzaId(b),ts:null};if(a!=null){f=d("WAJids").interpretAndValidateJid(a);if(f.jidType==="group")return{remoteJid:f.groupJid,content:e};else throw c("WAErr")("not supported")}else return{remoteJid:null,content:e}}function o(a,b){a=a.imageMessage;if(a==null)throw c("WAErr")("consumerMessage has no imageMessage");return d("WAParseMediaTransportProtocol").decodeImageTransport(a==null?void 0:(a=a.image)==null?void 0:a.payload,b)}function p(a,b){var e;a=a.audioMessage;if(a==null)throw c("WAErr")("consumerMessage has no audioMessage");e=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAMediaTransport.pb").AudioTransportSpec,a==null?void 0:(e=a.audio)==null?void 0:e.payload);e=d("WAParseMediaTransportProtocol").parseAudioMsg(e,(a==null?void 0:a.ptt)||!1,b);if(e==null)throw c("WAErr")("consumerMessage has no audio media info");return e}function q(a,b){a=a.stickerMessage;if(a==null)throw c("WAErr")("consumerMessage has no stickerMessage");a=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAMediaTransport.pb").StickerTransportSpec,a==null?void 0:(a=a.sticker)==null?void 0:a.payload);a=d("WAParseMediaTransportProtocol").parseStickerMsg(a,b);if(a==null)throw c("WAErr")("consumerMessage has no sticker media info");return a}function r(a,b){var e;a=a.documentMessage;if(a==null)throw c("WAErr")("consumerMessage has no documentMessage");e=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAMediaTransport.pb").DocumentTransportSpec,a==null?void 0:(e=a.document)==null?void 0:e.payload);a=a==null?void 0:a.fileName;e=d("WAParseMediaTransportProtocol").parseDocumentMsg(e,a,b);if(e==null)throw c("WAErr")("consumerMessage has no document media info");return e}function s(a){var b=Object.keys(a).filter(function(a){return a!=="$$unknownFieldCount"});if(b.length!==1)throw c("WAErr")(JSON.stringify(a)+" consumerMessage payload content should have exactly one field, instead found "+JSON.stringify(b));return b[0]}function t(a,b){b=b.groupInviteMessage;if(b==null)throw c("WAErr")("consumerMessage has no GroupInvite Data");return babelHelpers["extends"]({ack:a.ack,author:a.id.author,externalId:a.id.externalId,ts:a.ts},b)}g.MINIMAL_MEDIA_DURATION=b;g.DEFAULT_FILE_SIZE=e;g.SUPPORTED_TYPES_VERSION=f;g.parseConsumerMessageProtocol=a;g.interpretAsNonSystemAuthor=j;g.validReactionMessageText=l;g.parseReactionMessage=m;g.parseOneOfContentType=s}),98);
__d("WAMedia",[],(function(a,b,c,d,e,f){"use strict";a="Image";b="Video";c="Ptt";d="Gif";e="Sticker";var g="DocumentFile",h={IMAGE:a,VIDEO:b,PTT:c,GIF:d,STICKER:e,DOCUMENT_FILE:g};f.IMAGE=a;f.VIDEO=b;f.PTT=c;f.GIF=d;f.STICKER=e;f.DOCUMENT_FILE=g;f.MEDIA_TYPE=h}),66);
__d("WAParseMediaTransportProtocol",["WAErr","WALogger","WALongInt","WAMedia","WAMediaTransport.pb","WAMediaUtils","WAMsgMap","WAParseConsumerMessageProtocol","WAProgressiveJpegGetScanLengths","WATimeUtils","decodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["cannot compose mediaEntry with the media message"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["protobuf msg with too large size ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["protobuf msg with bad size ",", use default size instead"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["protobuf msg with no plaintext hash"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["There is unknown fileds in integral of VideoTransport"]);l=function(){return a};return a}function m(a,b,c){var e,f,g,m;if(!((e=a.integral)==null?void 0:e.transport))return null;e=(e=a.integral)==null?void 0:e.transport;if(d("decodeProtobuf").getUnknownFields(e.integral)!=null){d("WALogger").ERROR(l());return null}f=(f=e.integral)==null?void 0:f.fileSha256;if(!f){d("WALogger").ERROR(k());return null}g=(g=e.ancillary)==null?void 0:g.fileLength;g==null&&(d("WALogger").WARN(j(),g),g=d("WAParseConsumerMessageProtocol").DEFAULT_FILE_SIZE);try{g=d("WALongInt").numberOrThrowIfTooLarge(g)}catch(a){d("WALogger").ERROR(i(),g);return null}var n=null;if(((m=a.ancillary)==null?void 0:m.scansSidecar)!=null&&((m=a.ancillary)==null?void 0:m.scanLengths)!=null){n={sidecar:(m=a.ancillary)==null?void 0:m.scansSidecar,scanLengths:(m=a.ancillary)==null?void 0:(a=m.scanLengths)==null?void 0:a.map(d("WAProgressiveJpegGetScanLengths").asProgressiveJpegScanLength)}}if(((m=e.integral)==null?void 0:m.fileSha256)==null||((a=e.integral)==null?void 0:a.fileEncSha256)==null||((m=e.integral)==null?void 0:m.mediaKey)==null||((a=e.integral)==null?void 0:a.directPath)==null||((m=e.integral)==null?void 0:m.mediaKeyTimestamp)==null||((a=e.ancillary)==null?void 0:a.objectId)==null){d("WALogger").ERROR(h());return null}a=(m=e.ancillary.thumbnail)==null?void 0:m.downloadableThumbnail;b=d("WAMediaUtils").rawDataToMediaEntry(e.integral.fileSha256,e.integral.fileEncSha256,e.integral.mediaKey,e.integral.directPath,d("WATimeUtils").castLongIntToUnixTime(e.integral.mediaKeyTimestamp),b,(m=e.ancillary)==null?void 0:m.objectId,void 0,{directPath:a==null?void 0:a.directPath,fileEncSha256:a==null?void 0:a.fileEncSha256,fileSha256:a==null?void 0:a.fileSha256,mediaKey:a==null?void 0:a.mediaKey,mediaKeyTimestamp:(a==null?void 0:a.mediaKeyTimestamp)==null?null:d("WATimeUtils").castLongIntToUnixTime(a==null?void 0:a.mediaKeyTimestamp),objectId:a==null?void 0:a.objectId},c,n);return{size:g,plaintextHash:d("WAMediaUtils").toPlaintextHash(new Uint8Array(f)),mediaEntry:b}}function n(a,b){var c,e=m(a,"image");if(!e)return null;e=p(e,b);b=(b=a.ancillary)==null?void 0:b.width;c=(c=a.ancillary)==null?void 0:c.height;a.ancillary!=null&&(a.ancillary.width!=null&&a.ancillary.width===4294967295&&(b=void 0),a.ancillary.height!=null&&a.ancillary.height===4294967295&&(c=void 0));c=babelHelpers["extends"]({},e,{mediaType:d("WAMedia").MEDIA_TYPE.IMAGE,validatedVideoInfo:null,validatedImageInfo:{width:b,height:c,jpegThumbnail:(e=a.integral)==null?void 0:(b=e.transport)==null?void 0:(c=b.ancillary)==null?void 0:(e=c.thumbnail)==null?void 0:e.jpegThumbnail,jpegThumbnailHeight:(b=a.integral)==null?void 0:(c=b.transport)==null?void 0:(e=c.ancillary)==null?void 0:(b=e.thumbnail)==null?void 0:b.thumbnailHeight,jpegThumbnailWidth:(c=a.integral)==null?void 0:(e=c.transport)==null?void 0:(b=e.ancillary)==null?void 0:(a=b.thumbnail)==null?void 0:a.thumbnailWidth},validatedAudioInfo:null,validatedDocumentFileInfo:null});return c}function a(a,b){a=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAMediaTransport.pb").ImageTransportSpec,a);a=n(a,b);if(a==null)throw c("WAErr")("consumerMessage has no image media info");return a}function b(a,b,c){var e;if(!((e=a.integral)==null?void 0:e.transport))return null;e=m(a,c?"gif":"video");if(!e)return null;e=p(e,b);e=babelHelpers["extends"]({},e,{mediaType:c?d("WAMedia").MEDIA_TYPE.GIF:d("WAMedia").MEDIA_TYPE.VIDEO,validatedVideoInfo:c?null:{duration:(a==null?void 0:(b=a.ancillary)==null?void 0:b.seconds)!=null&&(a==null?void 0:(e=a.ancillary)==null?void 0:e.seconds)>d("WAParseConsumerMessageProtocol").MINIMAL_MEDIA_DURATION?a==null?void 0:(b=a.ancillary)==null?void 0:b.seconds:d("WAParseConsumerMessageProtocol").MINIMAL_MEDIA_DURATION,width:a==null?void 0:(e=a.ancillary)==null?void 0:e.width,height:a==null?void 0:(b=a.ancillary)==null?void 0:b.height,mimetype:a==null?void 0:(e=a.integral)==null?void 0:(b=e.transport)==null?void 0:(e=b.ancillary)==null?void 0:e.mimetype,jpegThumbnail:(b=a.integral)==null?void 0:(e=b.transport)==null?void 0:(b=e.ancillary)==null?void 0:(e=b.thumbnail)==null?void 0:e.jpegThumbnail,jpegThumbnailHeight:(b=a.integral)==null?void 0:(e=b.transport)==null?void 0:(b=e.ancillary)==null?void 0:(e=b.thumbnail)==null?void 0:e.thumbnailHeight,jpegThumbnailWidth:(b=a.integral)==null?void 0:(e=b.transport)==null?void 0:(b=e.ancillary)==null?void 0:(e=b.thumbnail)==null?void 0:e.thumbnailWidth},validatedImageInfo:c?{width:(b=a.ancillary)==null?void 0:b.width,height:(e=a.ancillary)==null?void 0:e.height,jpegThumbnail:(c=a.integral)==null?void 0:(b=c.transport)==null?void 0:(e=b.ancillary)==null?void 0:(c=e.thumbnail)==null?void 0:c.jpegThumbnail,jpegThumbnailHeight:(b=a.integral)==null?void 0:(e=b.transport)==null?void 0:(c=e.ancillary)==null?void 0:(b=c.thumbnail)==null?void 0:b.thumbnailHeight,jpegThumbnailWidth:(e=a.integral)==null?void 0:(c=e.transport)==null?void 0:(b=c.ancillary)==null?void 0:(a=b.thumbnail)==null?void 0:a.thumbnailWidth}:null,validatedAudioInfo:null,validatedDocumentFileInfo:null});return e}function e(a,b,c){if(!((b=a.integral)==null?void 0:b.transport))return null;b=m(a,"ptt");if(!b)return null;b=p(b,c);b=babelHelpers["extends"]({},b,{mediaType:d("WAMedia").MEDIA_TYPE.PTT,validatedVideoInfo:null,validatedImageInfo:null,validatedDocumentFileInfo:null,validatedAudioInfo:{duration:(a==null?void 0:(c=a.ancillary)==null?void 0:c.seconds)!=null&&(a==null?void 0:(b=a.ancillary)==null?void 0:b.seconds)>d("WAParseConsumerMessageProtocol").MINIMAL_MEDIA_DURATION?a==null?void 0:(c=a.ancillary)==null?void 0:c.seconds:d("WAParseConsumerMessageProtocol").MINIMAL_MEDIA_DURATION,mimetype:a==null?void 0:(b=a.integral)==null?void 0:(c=b.transport)==null?void 0:(a=c.ancillary)==null?void 0:a.mimetype,played:!1}});return b}function f(a,b){var c;if(!((c=a.integral)==null?void 0:c.transport))return null;c=m(a,"sticker");if(!c)return null;c=p(c,b);c=babelHelpers["extends"]({},c,{mediaType:d("WAMedia").MEDIA_TYPE.STICKER,validatedVideoInfo:null,validatedImageInfo:{width:(b=a.ancillary)==null?void 0:b.width,height:(c=a.ancillary)==null?void 0:c.height,jpegThumbnail:(b=a.integral)==null?void 0:(c=b.transport)==null?void 0:(b=c.ancillary)==null?void 0:(c=b.thumbnail)==null?void 0:c.jpegThumbnail,jpegThumbnailHeight:(b=a.integral)==null?void 0:(c=b.transport)==null?void 0:(b=c.ancillary)==null?void 0:(c=b.thumbnail)==null?void 0:c.thumbnailHeight,jpegThumbnailWidth:(b=a.integral)==null?void 0:(c=b.transport)==null?void 0:(a=c.ancillary)==null?void 0:(b=a.thumbnail)==null?void 0:b.thumbnailWidth},validatedAudioInfo:null,validatedDocumentFileInfo:null});return c}function o(a,b,c){var e;if(!((e=a.integral)==null?void 0:e.transport))return null;e=m(a,"document",b);if(!e)return null;e=p(e,c);return babelHelpers["extends"]({},e,{mediaType:d("WAMedia").MEDIA_TYPE.DOCUMENT_FILE,validatedVideoInfo:null,validatedImageInfo:null,validatedAudioInfo:null,validatedDocumentFileInfo:{mimetype:a==null?void 0:(c=a.integral)==null?void 0:(e=c.transport)==null?void 0:(a=e.ancillary)==null?void 0:a.mimetype,filename:(c=b)!=null?c:void 0}})}function p(a,b){return{mediaEntry:a.mediaEntry,plaintextHash:a.plaintextHash,size:a.size,msgIds:[],mediaEntries:new(d("WAMsgMap").MsgMap)(),ts:b}}g.getMediaMeta=m;g.parseImageMsg=n;g.decodeImageTransport=a;g.parseVideoMsg=b;g.parseAudioMsg=e;g.parseStickerMsg=f;g.parseDocumentMsg=o}),98);
__d("WAAckLevel",[],(function(a,b,c,d,e,f){"use strict";a={SENDER_BACKFILL_SENT:-7,INACTIVE_RECEIVED:-6,CONTENT_UNUPLOADABLE:-5,CONTENT_TOO_BIG:-4,CONTENT_GONE:-3,EXPIRED:-2,FAILED:-1,CLOCK:0,SENT:1,RECEIVED:2,READ:3,PLAYED:4};f.ACK=a}),66);
__d("WAParseV3Protocol",["WAAckLevel","WAAssertUnreachable","WAErr","WAGlobals","WAHex","WAMsgType","WAParseConsumerMessageProtocol"],(function(a,b,c,d,e,f,g){function a(a){return function(b,e,f,g,h){h={id:{chat:e,author:g,externalId:f},ts:h,serverTs:h,ack:d("WAAckLevel").ACK.RECEIVED,forwardingScore:b.type!=="futureProof"?(f=b==null?void 0:(g=b.metadata)==null?void 0:g.forwardingScore)!=null?f:0:0};g=b.type!=="futureProof"&&((g=b.metadata)==null?void 0:(f=g.chatEphemeralSetting)==null?void 0:f.ephemeralExpiration)!=null&&((g=b.metadata)==null?void 0:(f=g.chatEphemeralSetting)==null?void 0:f.ephemeralExpiration)>0;if(b.type==="futureProof"||g&&!d("WAGlobals").getConfig().isEphemeralMessagesEnabled())return{unstoredMsg:{type:d("WAMsgType").FUTUREPROOF,msgContent:{subtype:null,protobuf:d("WAHex").bytesToBuffer(b.protobuf)},id:h.id,ts:h.ts,sentTs:h.sentTs,serverTs:h.serverTs,ack:h.ack,reportingMeta:h.reportingMeta},unstoredMedia:null,unstoredQuotedMedia:null};else if(b.type==="subprotocol"){f=a==null?void 0:a.get(b.subprotocolType);if(f!=null)return f(e,b.subprotocol,h,b.protobuf,b.metadata);switch(b.subprotocolType){case"consumerMessage":return d("WAParseConsumerMessageProtocol").parseConsumerMessageProtocol(e,b.subprotocol,h,b.protobuf,b.metadata);case"businessMessage":throw c("WAErr")("unsupported subprotocolType: "+b.subprotocolType);case"paymentMessage":throw c("WAErr")("unsupported subprotocolType: "+b.subprotocolType);case"multiDevice":throw c("WAErr")("unsupported subprotocolType: "+b.subprotocolType);case"voip":throw c("WAErr")("unsupported subprotocolType: "+b.subprotocolType);default:throw c("WAErr")("Subprotocol parser for: "+b.subprotocolType+" was not found")}}else return c("WAAssertUnreachable")(b.type)}}g.createV3ProtocolParser=a}),98);
__d("WAStanzaRootTag",[],(function(a,b,c,d,e,f){a="notification";b="receipt";c="message";d="call";e="chatstate";var g="presence",h="appdata",i="failure",j="stream:error",k="ib",l="iq",m="error",n="success",o="xmlstreamend",p={NOTIFICATION:a,RECEIPT:b,MESSAGE:c,CHATSTATE:e,PRESENCE:g,APPDATA:h,CALL:d,IQ:l,IB:k,STREAM_ERROR:j,FAILURE:i,SUCCESS:n,ERROR:m,XML_STREAM_END:o};f.NOTIFICATION=a;f.RECEIPT=b;f.MESSAGE=c;f.CALL=d;f.CHATSTATE=e;f.PRESENCE=g;f.APPDATA=h;f.FAILURE=i;f.STREAM_ERROR=j;f.IB=k;f.IQ=l;f.ERROR=m;f.SUCCESS=n;f.XML_STREAM_END=o;f.STANZA_ROOT_TAG=p}),66);
__d("MAWUnsafeCoerce",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a}f.unsafeCoerce=a}),66);
__d("minBy",[],(function(a,b,c,d,e,f){var g=function(a,b){return a-b};function a(a,b,c){c=c||g;var d=void 0,e=null;for(var a=a,f=Array.isArray(a),h=0,a=f?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(f){if(h>=a.length)break;i=a[h++]}else{h=a.next();if(h.done)break;i=h.value}i=i;var j=b(i);(e===null||c(j,e)<0)&&(d=i,e=j)}return d}f["default"]=a}),66);
__d("zipWith",["minBy"],(function(a,b,c,d,e,f,g){function a(a){for(var b=arguments.length,d=new Array(b>1?b-1:0),e=1;e<b;e++)d[e-1]=arguments[e];if(d.length===0)return[];var f=c("minBy")(d,function(a){return a.length})||[];return f.map(function(b,c){b=d.map(function(a){return a[c]});return a.apply(void 0,b)})}g["default"]=a}),98);
__d("zip",["zipWith"],(function(a,b,c,d,e,f,g){function a(){for(var a=arguments.length,b=new Array(a),d=0;d<a;d++)b[d]=arguments[d];return c("zipWith").apply(void 0,[function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];return b}].concat(b))}g["default"]=a}),98);
__d("WAMsgIdToMessageKey",["WAGlobals","WAJids"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.author,c=a.externalId;a=a.chat;var e=d("WAJids").isAuthorMe(b),f=d("WAJids").interpretAsGroupJid(a);b=e?d("WAGlobals").getMyUserJid():b;a=a;f=f!=null?b:void 0;return{fromMe:e,id:c,remoteJid:a,participant:f}}g.msgIdToMessageKey=a}),98);
__d("WAAsConsumerApplication",["WAAssertUnreachable","WAConsumerApplication.pb","WAErr","WAMsgIdToMessageKey","WAMsgType"],(function(a,b,c,d,e,f,g){"use strict";b="image/jpeg";e="video/mp4";f="audio/wav";var h="image/gif",i="image/webp";function a(a){switch(a.type){case d("WAMsgType").MSG_TYPE.TEXT:return j(a);case d("WAMsgType").MSG_TYPE.REACTION:return k(a);case d("WAMsgType").MSG_TYPE.REVOKED:return l(a);default:return c("WAAssertUnreachable")(a.type)}}function j(a){var b={payload:{content:{messageText:{mentionedJid:[],text:a.msgContent.content}}}};if(a.specialTextSize!=null){a=a.specialTextSize===1?d("WAConsumerApplication.pb").CONSUMER_APPLICATION_METADATA_SPECIAL_TEXT_SIZE.SMALL:a.specialTextSize===2?d("WAConsumerApplication.pb").CONSUMER_APPLICATION_METADATA_SPECIAL_TEXT_SIZE.MEDIUM:d("WAConsumerApplication.pb").CONSUMER_APPLICATION_METADATA_SPECIAL_TEXT_SIZE.LARGE;b.metadata={specialTextSize:a}}return b}function k(a){if(a.reactToMsgId==null)throw c("WAErr")("cannot send reaction that reacts to no message");var b=d("WAMsgIdToMessageKey").msgIdToMessageKey(a.reactToMsgId);b={groupingKey:a.groupingKey==null?void 0:a.groupingKey,key:b,senderTimestampMs:a.ts,text:a.reaction==null?void 0:a.reaction};return{payload:{content:{reactionMessage:b}}}}function l(a){a={remoteJid:a.id.chat,fromMe:!0,id:a.revokedExternalId};return{payload:{applicationData:{revoke:{key:a}}}}}g.IMAGE_MIME_TYPE=b;g.VIDEO_MIME_TYPE=e;g.AUDIO_MIME_TYPE=f;g.GIF_MIME_TYPE=h;g.STICKER_MIME_TYPE=i;g.asConsumerApplication=a;g.encodeTextMessage=j;g.encodeReactionMessage=k}),98);
__d("WAFrankingTypes",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a}function b(a){return a}f.castToFrankingTag=a;f.castToFrankingKey=b}),66);
__d("WAFranking",["$InternalEnum","WACryptoDependencies","WACryptoHmac","WACryptoUtils","WAFrankingTypes","WAGlobals","WAPREList","WAPREMetrics","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h=32,i=0,j=b("$InternalEnum").Mirrored(["KEEP","DROP"]);function a(){var a=new Uint8Array(h);d("WACryptoDependencies").getCrypto().getRandomValues(a);return d("WAFrankingTypes").castToFrankingKey(a)}function c(a){return(a=a)!=null?a:i}function e(a,b){return d("WACryptoHmac").hmacSha256(a,b).then(function(a){return d("WAFrankingTypes").castToFrankingTag(new Uint8Array(a))})}function k(a,c,e,f){var g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:h.t0=f;h.next=h.t0===void 0?3:h.t0===0?3:7;break;case 3:h.next=5;return b("regeneratorRuntime").awrap(d("WACryptoHmac").hmacSha256(c,a));case 5:g=h.sent;return h.abrupt("return",d("WACryptoUtils").uint8ArraysEqual(new Uint8Array(g),e));case 7:return h.abrupt("return",!0);case 8:case"end":return h.stop()}},null,this)}function f(a,c){var e,f,g,h,i,l,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:if(!(!d("WAGlobals").getConfig().isFrankingEnabled()||a.version==="v3"&&a.type==="instamadillo")){n.next=2;break}return n.abrupt("return",j.KEEP);case 2:f=d("WAGlobals").getConfig().isFrankingDropOnInvalid();if(!((c==null?void 0:c.frankingTag)!=null&&a.version==="v3"&&a.type==="subprotocol"&&((e=a.metadata)==null?void 0:e.frankingKey)!=null&&a.frankingContent!=null)){n.next=20;break}g=c.frankingTag;h=a.frankingContent,i=a.metadata.frankingVersion;l=d("WAFrankingTypes").castToFrankingKey(new Uint8Array(a.metadata.frankingKey));m=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.FRANKING_VALIDATION);if(!(l==null)){n.next=11;break}m.endFail("tagButNoKey");return n.abrupt("return",f?j.DROP:j.KEEP);case 11:n.next=13;return b("regeneratorRuntime").awrap(k(new Uint8Array(h),l,g,i));case 13:if(n.sent){n.next=16;break}m.endFail("tagMismatch");return n.abrupt("return",f?j.DROP:j.KEEP);case 16:c.frankingKey=l;c.reportingContent=h;m.endSuccess();return n.abrupt("return",j.KEEP);case 20:return n.abrupt("return",d("WAGlobals").getConfig().isFrankingDropOnMissing()?j.DROP:j.KEEP);case 21:case"end":return n.stop()}},null,this)}g.FrankingDecision=j;g.createFrankingKey=a;g.getFrankingVersion=c;g.genFrankingTag=e;g.validateFrankingTag=k;g.handleAndValidateFrankingFromIncomingMsg=f}),98);
__d("WAAsMessageApplication",["WAAsConsumerApplication","WAConsumerApplication.pb","WAFranking","WAMsgApplication.pb","encodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b;switch(a.type){default:b=d("WAAsConsumerApplication").asConsumerApplication(a)}var c=a.forwardingScore!=null?a.forwardingScore:0;a=a.isForwarded!=null?a.isForwarded:!1;c={metadata:{chatEphemeralSetting:null,forwardingScore:c,frankingKey:d("WAFranking").createFrankingKey(),frankingVersion:d("WAFranking").getFrankingVersion(),isForwarded:a,quotedMessage:null}};if(b!=null){a=d("encodeProtobuf").encodeProtobuf(d("WAConsumerApplication.pb").ConsumerApplicationSpec,b);c.payload={subProtocol:{consumerMessage:{payload:a.readBuffer(),version:1}}}}return d("encodeProtobuf").encodeProtobuf(d("WAMsgApplication.pb").MessageApplicationSpec,c).readByteArray()}function b(a){return a}g.asMessageApplication=a;g.castToMessageApplicationBytes=b}),98);
__d("WAFrankingNode",["Promise","WAFranking","WALogger"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Can't handle franking version ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Franking key is missing"]);j=function(){return a};return a}function a(a,c,e){if(c==null){d("WALogger").ERROR(j());return(h||(h=b("Promise"))).resolve(null)}if(e!=null&&e!==0){d("WALogger").ERROR(i(),e);return(h||(h=b("Promise"))).resolve(null)}return d("WAFranking").genFrankingTag(c,a)}g.genFrankingTagFromMessageApplicationEncode=a}),98);
__d("WAGenReportingMeta",["WAByteArray","WAFranking","WAFrankingNode","WAGlobals","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,c,e){var f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:if(!d("WAGlobals").getConfig().isFrankingEnabled()){g.next=7;break}g.next=3;return b("regeneratorRuntime").awrap(d("WAFrankingNode").genFrankingTagFromMessageApplicationEncode(a,c,e));case 3:f=g.sent;return g.abrupt("return",{frankingKey:c,frankingTag:f,frankingVersion:d("WAFranking").getFrankingVersion(e),reportingContent:d("WAByteArray").uint8ArrayToBuffer(a),reportingTag:null});case 7:return g.abrupt("return",{frankingKey:c,frankingTag:null,frankingVersion:d("WAFranking").getFrankingVersion(e),reportingContent:null,reportingTag:null});case 8:case"end":return g.stop()}},null,this)}g.genReportingMeta=a}),98);
__d("WAConvertRegistrationIdMixin",["WAParsableXmlNode"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return d("WAParsableXmlNode").convertBytesToUint(a.registrationElementValue,4)}g.registrationIdMixin=a}),98);
__d("WAConvertSignedPreKeyMixin",["WAParsableXmlNode"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return{id:d("WAParsableXmlNode").convertBytesToUint(a.skeyIdKeyIDMixin.elementValue,3),pubkey:a.skeyValueKeyDataMixin.elementValue,signature:a.skeySignatureElementValue}}g.convertSignedPreKeyMixin=a}),98);
__d("WASmaxInPreKeysIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQErrorResponseMixin=a}),98);
__d("WASmaxInPreKeysIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","bad-request");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",400);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorBadRequestMixin=a}),98);
__d("WASmaxInPreKeysIQErrorFallbackClientMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"text");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(a,"code",400,499);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorFallbackClientMixin=a}),98);
__d("WASmaxInPreKeysIQErrorNoValidJIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","not-acceptable");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",406);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorNoValidJIDMixin=a}),98);
__d("WASmaxInPreKeysRequestErrorsFetch",["WAResultOrError","WASmaxInPreKeysIQErrorBadRequestMixin","WASmaxInPreKeysIQErrorFallbackClientMixin","WASmaxInPreKeysIQErrorNoValidJIDMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPreKeysIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:b.value});var c=d("WASmaxInPreKeysIQErrorNoValidJIDMixin").parseIQErrorNoValidJIDMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorNoValidJID",value:c.value});var e=d("WASmaxInPreKeysIQErrorFallbackClientMixin").parseIQErrorFallbackClientMixin(a);return e.success?d("WAResultOrError").makeResult({name:"IQErrorFallbackClient",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorBadRequest","IQErrorNoValidJID","IQErrorFallbackClient"],[b,c,e])}g.parseRequestErrorsFetch=a}),98);
__d("WASmaxInPreKeysFetchKeyBundlesResponseRequestError",["WAResultOrError","WASmaxInPreKeysIQErrorResponseMixin","WASmaxInPreKeysRequestErrorsFetch","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInPreKeysIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInPreKeysRequestErrorsFetch").parseRequestErrorsFetch(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorRequestErrorsFetch:b.value}))}g.parseFetchKeyBundlesResponseRequestError=a}),98);
__d("WASmaxInPreKeysIQErrorFallbackServerMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"text");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(a,"code",500,599);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorFallbackServerMixin=a}),98);
__d("WASmaxInPreKeysIQErrorServiceUnavailableMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","service-unavailable");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",503);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorServiceUnavailableMixin=a}),98);
__d("WASmaxInPreKeysServerErrors",["WAResultOrError","WASmaxInPreKeysIQErrorFallbackServerMixin","WASmaxInPreKeysIQErrorServiceUnavailableMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPreKeysIQErrorServiceUnavailableMixin").parseIQErrorServiceUnavailableMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorServiceUnavailable",value:b.value});var c=d("WASmaxInPreKeysIQErrorFallbackServerMixin").parseIQErrorFallbackServerMixin(a);return c.success?d("WAResultOrError").makeResult({name:"IQErrorFallbackServer",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorServiceUnavailable","IQErrorFallbackServer"],[b,c])}g.parseServerErrors=a}),98);
__d("WASmaxInPreKeysFetchKeyBundlesResponseServerError",["WAResultOrError","WASmaxInPreKeysIQErrorResponseMixin","WASmaxInPreKeysServerErrors","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInPreKeysIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInPreKeysServerErrors").parseServerErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorServerErrors:b.value}))}g.parseFetchKeyBundlesResponseServerError=a}),98);
__d("WASmaxInPreKeysEnums",["WAJids"],(function(a,b,c,d,e,f,g){b={validators:[(a=d("WAJids")).validateDeviceJid,a.validateDeviceJid],typeName:"DeviceJid|DeviceJid"};c={validators:[a.validateDeviceJid,a.validateDomainJid],typeName:"DeviceJid|DomainJid"};e={validators:[a.validateUserJid,a.validateUserJid],typeName:"UserJid|UserJid"};g.DEVICEJID_DEVICEJID=b;g.DEVICEJID_DOMAINJID=c;g.USERJID_USERJID=e}),98);
__d("WASmaxInPreKeysIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQResultResponseMixin=a}),98);
__d("WASmaxInPreKeysFetchKeyBundlesUserErrorFallbackMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!b.success)return b;a=d("WASmaxParseUtils").attrString(b.value,"text");if(!a.success)return a;b=d("WASmaxParseUtils").attrIntRange(b.value,"code",500,599);return!b.success?b:d("WAResultOrError").makeResult({errorText:a.value,errorCode:b.value})}g.parseFetchKeyBundlesUserErrorFallbackMixin=a}),98);
__d("WASmaxInPreKeysFetchKeyBundlesUserErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!b.success)return b;a=d("WASmaxParseUtils").attrString(b.value,"text");if(!a.success)return a;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,b.value,"code",500);return!b.success?b:d("WAResultOrError").makeResult({errorText:a.value,errorCode:b.value})}g.parseFetchKeyBundlesUserErrorMixin=a}),98);
__d("WASmaxInPreKeysDeviceIdentityMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"device-identity");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytes(a.value);return!a.success?a:d("WAResultOrError").makeResult({deviceIdentityElementValue:a.value})}g.parseDeviceIdentityMixin=a}),98);
__d("WASmaxInPreKeysKeyDataMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").contentBytesRange(a,32,32);return!a.success?a:d("WAResultOrError").makeResult({elementValue:a.value})}g.parseKeyDataMixin=a}),98);
__d("WASmaxInPreKeysIdentityKeyMixin",["WASmaxInPreKeysKeyDataMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"identity");if(!a.success)return a;a=d("WASmaxInPreKeysKeyDataMixin").parseKeyDataMixin(a.value);return!a.success?a:a}g.parseIdentityKeyMixin=a}),98);
__d("WASmaxInPreKeysKeyTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"type");if(!a.success)return a;a=d("WASmaxParseUtils").contentLiteralBytes(a.value,new Uint8Array([5]));return!a.success?a:d("WAResultOrError").makeResult({typeElementValue:a.value})}g.parseKeyTypeMixin=a}),98);
__d("WASmaxInPreKeysKeyIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"id");if(!b.success)return b;b=d("WASmaxParseUtils").contentBytesRange(a,3,3);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}g.parseKeyIDMixin=a}),98);
__d("WASmaxInPreKeysPreKeyMixin",["WAResultOrError","WASmaxInPreKeysKeyDataMixin","WASmaxInPreKeysKeyIDMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"key");if(!a.success)return a;var b=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"id");if(!b.success)return b;a=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"value");if(!a.success)return a;b=d("WASmaxInPreKeysKeyIDMixin").parseKeyIDMixin(b.value);if(!b.success)return b;a=d("WASmaxInPreKeysKeyDataMixin").parseKeyDataMixin(a.value);return!a.success?a:d("WAResultOrError").makeResult({keyIdKeyIDMixin:b.value,keyValueKeyDataMixin:a.value})}g.parsePreKeyMixin=a}),98);
__d("WASmaxInPreKeysRegistrationIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"registration");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytesRange(a.value,4,4);return!a.success?a:d("WAResultOrError").makeResult({registrationElementValue:a.value})}g.parseRegistrationIDMixin=a}),98);
__d("WASmaxInPreKeysSignedPreKeyMixin",["WAResultOrError","WASmaxInPreKeysKeyDataMixin","WASmaxInPreKeysKeyIDMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"skey");if(!a.success)return a;var b=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"id");if(!b.success)return b;var c=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"value");if(!c.success)return c;a=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"signature");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytesRange(a.value,64,64);if(!a.success)return a;b=d("WASmaxInPreKeysKeyIDMixin").parseKeyIDMixin(b.value);if(!b.success)return b;c=d("WASmaxInPreKeysKeyDataMixin").parseKeyDataMixin(c.value);return!c.success?c:d("WAResultOrError").makeResult({skeySignatureElementValue:a.value,skeyIdKeyIDMixin:b.value,skeyValueKeyDataMixin:c.value})}g.parseSignedPreKeyMixin=a}),98);
__d("WASmaxInPreKeysFetchKeyBundlesUserSuccessMixin",["WAResultOrError","WASmaxInPreKeysDeviceIdentityMixin","WASmaxInPreKeysIdentityKeyMixin","WASmaxInPreKeysKeyTypeMixin","WASmaxInPreKeysPreKeyMixin","WASmaxInPreKeysRegistrationIDMixin","WASmaxInPreKeysSignedPreKeyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,a,"is_cloud_api","true");if(!c.success)return c;var e=d("WASmaxInPreKeysRegistrationIDMixin").parseRegistrationIDMixin(a);if(!e.success)return e;var f=d("WASmaxInPreKeysKeyTypeMixin").parseKeyTypeMixin(a),g=d("WASmaxInPreKeysIdentityKeyMixin").parseIdentityKeyMixin(a);if(!g.success)return g;var h=d("WASmaxInPreKeysPreKeyMixin").parsePreKeyMixin(a),i=d("WASmaxInPreKeysSignedPreKeyMixin").parseSignedPreKeyMixin(a);if(!i.success)return i;a=d("WASmaxInPreKeysDeviceIdentityMixin").parseDeviceIdentityMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({t:b.value,isCloudApi:c.value},e.value,{keyTypeMixin:f.success?f.value:null},g.value,{preKeyMixin:h.success?h.value:null},i.value,{deviceIdentityMixin:a.success?a.value:null}))}g.parseFetchKeyBundlesUserSuccessMixin=a}),98);
__d("WASmaxInPreKeysUserFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup",["WAResultOrError","WASmaxInPreKeysFetchKeyBundlesUserErrorFallbackMixin","WASmaxInPreKeysFetchKeyBundlesUserErrorMixin","WASmaxInPreKeysFetchKeyBundlesUserSuccessMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPreKeysFetchKeyBundlesUserSuccessMixin").parseFetchKeyBundlesUserSuccessMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"FetchKeyBundlesUserSuccess",value:b.value});var c=d("WASmaxInPreKeysFetchKeyBundlesUserErrorMixin").parseFetchKeyBundlesUserErrorMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"FetchKeyBundlesUserError",value:c.value});var e=d("WASmaxInPreKeysFetchKeyBundlesUserErrorFallbackMixin").parseFetchKeyBundlesUserErrorFallbackMixin(a);return e.success?d("WAResultOrError").makeResult({name:"FetchKeyBundlesUserErrorFallback",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["UserSuccess","UserError","UserErrorFallback"],[b,c,e])}g.parseUserFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup=a}),98);
__d("WASmaxInPreKeysFetchKeyBundlesResponseSuccess",["WAResultOrError","WASmaxInPreKeysEnums","WASmaxInPreKeysIQResultResponseMixin","WASmaxInPreKeysUserFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxParseJid").attrJidEnum(a,"jid",d("WASmaxInPreKeysEnums").DEVICEJID_DEVICEJID);if(!b.success)return b;a=d("WASmaxInPreKeysUserFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup").parseUserFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({jid:b.value,userFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup:a.value})}function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"list");if(!c.success)return c;a=d("WASmaxInPreKeysIQResultResponseMixin").parseIQResultResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxParseUtils").mapChildrenWithTag(c.value,"user",0,1e5,h);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{listUser:b.value}))}g.parseFetchKeyBundlesResponseSuccessListUser=h;g.parseFetchKeyBundlesResponseSuccess=a}),98);
__d("WASmaxAttrs",["WAWap"],(function(a,b,c,d,e,f,g){function a(a,b){if(b==null)return d("WAWap").DROP_ATTR;else return a(b)}function b(a,b){if(b)return a;else return d("WAWap").DROP_ATTR}g.OPTIONAL=a;g.OPTIONAL_LITERAL=b}),98);
__d("WASmaxChildren",["WADeepEquals"],(function(a,b,c,d,e,f,g){function a(a,b){if(b==null)return null;else return a(b)}function b(a,b){if(b==null)return null;else if(b)return a()}function c(a,b){if(b)for(var c=1;c<b.length;c++)if(!d("WADeepEquals").deepEqual(b[c],b[0]))throw new Error("expected all homogeneous children to be equal, but they were not");c=h(a,b,0,Infinity);return c}function e(a,b){return i(a,b,0,Infinity)}function h(a,b,c,d){if(b==null){if(c>0)throw new Error("expected at least "+c+" children, but none provided");return[]}var e=b.length;if(e<c)throw new Error("expected at least "+c+" children, but found "+e);else if(e>d)throw new Error("expected at most "+d+" children, but found "+e);return b.map(function(b){return a(b)})}function i(a,b,c,d){if(b===0){if(c>0)throw new Error("expected at least "+c+" children, but none provided");return[]}if(b<c)throw new Error("expected at least "+c+" children, but found "+b);else if(b>d)throw new Error("expected at most "+d+" children, but found "+b);c=[];for(d=0;d<b;d++)c.push(a());return c}g.OPTIONAL_CHILD=a;g.HAS_OPTIONAL_CHILD=b;g.HOMOGENEOUS_CHILD=c;g.HOMOGENEOUS_CHILD_COUNT=e;g.REPEATED_CHILD=h;g.REPEATED_CHILD_COUNT=i}),98);
__d("WASmaxOutPreKeysClientRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{id:d("WAWap").generateId(),xmlns:"encrypt",to:d("WAWap").S_WHATSAPP_NET});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeClientRequestMixin=a}),98);
__d("WASmaxOutPreKeysFetchKeyBundlesRequest",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxOutPreKeysClientRequestMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.userJid;a=a.hasUserReasonIdentity;b=d("WASmaxJsx").smax("user",{jid:d("WAWap").JID(b),reason:d("WASmaxAttrs").OPTIONAL_LITERAL("identity",a)});return b}function a(a){a=a.userArgs;a=d("WASmaxOutPreKeysClientRequestMixin").mergeClientRequestMixin(d("WASmaxJsx").smax("iq",{type:"get"},d("WASmaxJsx").smax("key",null,d("WASmaxChildren").REPEATED_CHILD(h,a,1,1e5))));return a}g.makeFetchKeyBundlesRequestKeyUser=h;g.makeFetchKeyBundlesRequest=a}),98);
__d("WASmaxPreKeysFetchKeyBundlesRPC",["WAComms","WASmaxInPreKeysFetchKeyBundlesResponseRequestError","WASmaxInPreKeysFetchKeyBundlesResponseServerError","WASmaxInPreKeysFetchKeyBundlesResponseSuccess","WASmaxOutPreKeysFetchKeyBundlesRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:e=d("WASmaxOutPreKeysFetchKeyBundlesRequest").makeFetchKeyBundlesRequest(a);j.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(e,c));case 3:f=j.sent;g=d("WASmaxInPreKeysFetchKeyBundlesResponseSuccess").parseFetchKeyBundlesResponseSuccess(f,e);if(!g.success){j.next=7;break}return j.abrupt("return",{name:"FetchKeyBundlesResponseSuccess",value:g.value});case 7:h=d("WASmaxInPreKeysFetchKeyBundlesResponseRequestError").parseFetchKeyBundlesResponseRequestError(f,e);if(!h.success){j.next=10;break}return j.abrupt("return",{name:"FetchKeyBundlesResponseRequestError",value:h.value});case 10:i=d("WASmaxInPreKeysFetchKeyBundlesResponseServerError").parseFetchKeyBundlesResponseServerError(f,e);if(!i.success){j.next=13;break}return j.abrupt("return",{name:"FetchKeyBundlesResponseServerError",value:i.value});case 13:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("FetchKeyBundles",{Success:g,RequestError:h,ServerError:i}));case 14:case"end":return j.stop()}},null,this)}g.sendFetchKeyBundlesRPC=a}),98);
__d("WAFetchPreKeyBundlesProtocol",["WAConvertRegistrationIdMixin","WAConvertSignedPreKeyMixin","WAParsableXmlNode","WAResultOrError","WASignalKeys","WASmaxPreKeysFetchKeyBundlesRPC","WATagsLogger","WATimeUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["RequestError: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["ServerError: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["fetched prekey successfully"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["start fetching prekey of ","..."]);k=function(){return a};return a}var l=d("WATagsLogger").TAGS(["fetchPreKeyBundlesProtocol"]);function a(a){var c,e,f,g;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:l.LOG(k(),a.join(", "));n.next=3;return b("regeneratorRuntime").awrap(d("WASmaxPreKeysFetchKeyBundlesRPC").sendFetchKeyBundlesRPC({userArgs:a.map(function(a){return{userJid:a,hasUserReasonIdentity:!1}})}));case 3:c=n.sent;n.t0=c.name;n.next=n.t0==="FetchKeyBundlesResponseSuccess"?7:n.t0==="FetchKeyBundlesResponseServerError"?11:n.t0==="FetchKeyBundlesResponseRequestError"?14:17;break;case 7:l.LOG(j());e=new Map();c.value.listUser.map(function(a){var b=a.userFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup;b.name==="FetchKeyBundlesUserSuccess"&&e.set(a.jid,m(b.value))});return n.abrupt("return",d("WAResultOrError").makeResult(e));case 11:f=c.value.errorServerErrors.name;l.WARN(i(),f);return n.abrupt("return",d("WAResultOrError").makeError({type:"server-error",payload:f}));case 14:g=c.value.errorRequestErrorsFetch.name;l.ERROR(h(),g);return n.abrupt("return",d("WAResultOrError").makeError({type:"request-error",payload:g}));case 17:case"end":return n.stop()}},null,this)}function m(a){var b=d("WAConvertRegistrationIdMixin").registrationIdMixin(a),c=d("WASignalKeys").serializeIdentity(a.elementValue),e=d("WAConvertSignedPreKeyMixin").convertSignedPreKeyMixin(a),f=a.preKeyMixin?n(a.preKeyMixin):null;a=d("WATimeUtils").castToUnixTime(a.t||0);return{keys:{regId:b,identity:c,oneTimeKey:f,signedKey:{id:e.id,signature:e.signature,publicKey:d("WASignalKeys").serializeIdentity(e.pubkey)}},timestamp:a}}function n(a){return{id:d("WAParsableXmlNode").convertBytesToUint(a.keyIdKeyIDMixin.elementValue,3),publicKey:d("WASignalKeys").serializeIdentity(a.keyValueKeyDataMixin.elementValue)}}g.fetchPreKeyBundlesProtocol=a}),98);
__d("WABulkRequestKeys",["WAFetchPreKeyBundlesProtocol","WAResultOrError","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(d("WAFetchPreKeyBundlesProtocol").fetchPreKeyBundlesProtocol(a));case 2:c=e.sent;if(c.success){e.next=5;break}return e.abrupt("return",d("WAResultOrError").makeError("errRequestKeysParsingFailed"));case 5:return e.abrupt("return",d("WAResultOrError").makeResult(c.value));case 6:case"end":return e.stop()}},null,this)}g.bulkRequestKeys=a}),98);
__d("WAHandleFailureUtils",["WABridge","WAGlobals"],(function(a,b,c,d,e,f,g){c={GENERIC_FAILURE:"400",NOT_AUTHORIZED:"401",TEMP_BANNED:"402",BANNED:"403",CAT_EXPIRED:"413",CAT_INVALID:"414",NOT_FOUND:"415",INTERNAL_ERROR:"500",SERVER_UNAVAILABLE:"503"};function h(){return d("WAGlobals").getDbImpls().clearSignalAndTempStores()}function a(){return h().then(function(){d("WABridge").getBridge().fireAndForget("event","logout",{})})}function b(){return h().then(function(){d("WABridge").getBridge().fireAndForget("event","reregisterDevice",{})})}g.FAILURE_CODES=c;g.clearRegistrationAndTempData=h;g.deregisterPhone=a;g.reregisterPhone=b}),98);
__d("WASignalEntityStoreV2",["$InternalEnum","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h=b("$InternalEnum").Mirrored(["NOT_PERSISTED","PERSIST_IN_PROGRESS","PERSISTED"]);a=function(){function a(){this.$1=new Map()}var c=a.prototype;c.TEST_ONLY_LOAD_FROM_MEMORY=function(a){return this.$2(a)};c.$2=function(a){a=this.$1.get(a);return a!=null?{entity:a.entity,deleted:a.deleted}:null};c.load=function(a,c){var d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:d=this.$2(a);if(!(d==null?void 0:d.deleted)){f.next=3;break}return f.abrupt("return",null);case 3:if(!(d!=null&&d.entity!=null)){f.next=5;break}return f.abrupt("return",d.entity);case 5:f.next=7;return b("regeneratorRuntime").awrap(c(a));case 7:e=f.sent;this.$3(a,e);return f.abrupt("return",e);case 10:case"end":return f.stop()}},null,this)};c.bulkLoad=function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o,p;return b("regeneratorRuntime").async(function(q){while(1)switch(q.prev=q.next){case 0:d=[],e=new Map(),f=0;case 3:if(!(f<a.length)){q.next=15;break}g=a[f];h=this.$2(g);if(!(h==null)){q.next=9;break}d.push(g);return q.abrupt("continue",12);case 9:if(!h.deleted){q.next=11;break}return q.abrupt("continue",12);case 11:h.entity!=null?e.set(g,h.entity):d.push(g);case 12:f++;q.next=3;break;case 15:q.next=17;return b("regeneratorRuntime").awrap(c(d));case 17:i=q.sent,(j=i.entries(),k=Array.isArray(j),l=0,j=k?j:j[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 19:if(!k){q.next=25;break}if(!(l>=j.length)){q.next=22;break}return q.abrupt("break",36);case 22:m=j[l++];q.next=29;break;case 25:l=j.next();if(!l.done){q.next=28;break}return q.abrupt("break",36);case 28:m=l.value;case 29:n=m,o=n[0],p=n[1],e.set(o,p),this.$3(o,p);case 34:q.next=19;break;case 36:return q.abrupt("return",e);case 37:case"end":return q.stop()}},null,this)};c.$3=function(a,b){this.$1.set(a,{entity:b,status:h.PERSISTED,deleted:!1})};c.store=function(a,b){this.$1.set(a,{entity:b,status:h.NOT_PERSISTED,deleted:!1})};c.remove=function(a){this.$1.set(a,{entity:null,status:h.NOT_PERSISTED,deleted:!0})};c.pureSnapshot=function(){var a=[],b=Array.from(this.$1.entries()).filter(function(a){a[0];a=a[1];return a.status===h.NOT_PERSISTED}).filter(function(b){var c=b[0];b=b[1];b.deleted&&a.push({id:c});return!b.deleted}).filter(function(a){a[0];a=a[1];return a.entity!=null}).map(function(a){var b=a[0];a=a[1];return{id:b,cachedEntity:a.entity}});return{update:b,remove:a}};c.snapshot=function(){var a=this,b=this.pureSnapshot();b.remove.forEach(function(b){b=b.id;b=a.$1.get(b);b&&(b.status=h.PERSIST_IN_PROGRESS)});b.update.forEach(function(b){b=b.id;b=a.$1.get(b);b&&(b.status=h.PERSIST_IN_PROGRESS)});return b};c.markSnapshotAsCommitted=function(){this.$1.forEach(function(a){a.status===h.PERSIST_IN_PROGRESS&&(a.status=h.PERSISTED)})};c.markSnapshotAsFailed=function(){this.$1.forEach(function(a){a.status===h.PERSIST_IN_PROGRESS&&(a.status=h.NOT_PERSISTED)})};c.clear=function(){this.$1=new Map()};return a}();g.PersistStatus=h;g.SignalEntityStore=a}),98);
__d("WASignalIdentityStore",["Promise","WAJids","WALogger","WASignalEntityStoreV2","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[WASignalIdentityStore] This should never happen."]);i=function(){return a};return a}a=function(){function a(){this.$1=new Map(),this.$2=new(d("WASignalEntityStoreV2").SignalEntityStore)()}var c=a.prototype;c.bulkLoadIdentities=function(a){var c=this,d,e,f,g,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:d=function(){var a,d,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:if(!f){k.next=6;break}if(!(g>=e.length)){k.next=3;break}return k.abrupt("return","break");case 3:i=e[g++];k.next=10;break;case 6:g=e.next();if(!g.done){k.next=9;break}return k.abrupt("return","break");case 9:i=g.value;case 10:a=i;d=a[0];j=a[1];k.next=15;return b("regeneratorRuntime").awrap(c.loadIdentitiesByUser(d,function(){return(h||(h=b("Promise"))).resolve(j)}));case 15:case"end":return k.stop()}},null,this)},(e=a,f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 2:k.next=4;return b("regeneratorRuntime").awrap(d());case 4:j=k.sent;if(!(j==="break")){k.next=7;break}return k.abrupt("break",9);case 7:k.next=2;break;case 9:return k.abrupt("return",a);case 10:case"end":return k.stop()}},null,this)};c.loadIdentitiesByUser=function(a,c){var e,f,g;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:e=this.$1.get(a);if(!(e==null)){j.next=13;break}j.t0=this;j.t1=a;j.next=6;return b("regeneratorRuntime").awrap(c(a));case 6:j.t2=j.sent;f=j.t0.$3.call(j.t0,j.t1,j.t2);g=Array.from(f.keys());this.$1.set(a,new Set(g));return j.abrupt("return",this.$2.bulkLoad(g,function(){return(h||(h=b("Promise"))).resolve(f)}));case 13:return j.abrupt("return",this.$2.bulkLoad(Array.from(e),function(a){a.length>0&&d("WALogger").ERROR(i());return(h||(h=b("Promise"))).resolve(new Map())}));case 14:case"end":return j.stop()}},null,this)};c.$3=function(a,b){b=new Map(b);var c=this.$2.pureSnapshot(),e=c.remove;c=c.update;for(var e=e,f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=e.length)break;h=e[g++]}else{g=e.next();if(g.done)break;h=g.value}h=h;h=h.id;b["delete"](h)}for(h=c,g=Array.isArray(h),f=0,h=g?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(g){if(f>=h.length)break;e=h[f++]}else{f=h.next();if(f.done)break;e=f.value}c=e;e=c.id;c=c.cachedEntity;c!=null&&d("WAJids").extractUserJid(e)===a&&b.set(e,c)}return b};c.store=function(a,b){this.$2.store(a,b);b=d("WAJids").extractUserJid(a);b=this.$1.get(b);b!=null&&b.add(a)};c.remove=function(a){this.$2.remove(a);var b=d("WAJids").extractUserJid(a);b=this.$1.get(b);b!=null&&b["delete"](a)};c.clear=function(){this.$2.clear(),this.$1=new Map()};c.load=function(a,b){return this.$2.load(a,b)};c.bulkLoad=function(a,b){return this.$2.bulkLoad(a,b)};c.snapshot=function(){return this.$2.snapshot()};c.pureSnapshot=function(){return this.pureSnapshot()};c.markSnapshotAsCommitted=function(){this.$2.markSnapshotAsCommitted()};c.markSnapshotAsFailed=function(){this.$2.markSnapshotAsFailed()};return a}();g.SignalIdentityStore=a}),98);
__d("WATabLock",["WAResolvable"],(function(a,b,c,d,e,f,g){var h=new(d("WAResolvable").Resolvable)(),i=null;function a(a){if(i!=null)return i.promise;var b=navigator.locks;i=new(d("WAResolvable").Resolvable)();var c=i;if(b==null){c.resolve();return c.promise}b.request("WATabLock-"+a,function(){c.resolve();return h.promise});return c.promise}g.lockTab=a}),98);
__d("WAInMemorySignalStore",["Promise","WACryptoManager","WACryptoUtils","WAGlobals","WAICDCUtils","WAIdentityUtils","WAJids","WAJobDefinitions","WAJobOrchestratorTypes","WAJobs","WAPromiseQueue","WAProtocolQueueState","WAResultOrError","WASignalEntityStoreV2","WASignalIdentityStore","WATabLock","WATagsLogger","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Cannot perform signal LLA ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Transaction code is done, trying to persist changes"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Persist mode: active"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Users with unknown devices: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Snapshot save: end"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Snapshot save: start"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Snapshot: ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Removing old identity: ",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["Removing my device identity. This should not happen"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["Device notification of one user cannot remove identity the other one "]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["Removing session dur to identity mismatch: ",""]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["Device notification of one user cannot remove session the other one"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["Receiving an identity for my device but it is different from original one"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["Update user devices: userJid: ","; new identities: ","; previous identities: ","}"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);w=function(){return a};return a}var x=d("WATagsLogger").TAGS(["CryptoManager","InMemorySignalStore"]);a=function(){function a(a,c){var e=this;this.$9="persist";this.$11=new(d("WAPromiseQueue").PromiseQueue)();this.loadSession=function(a,b){return e.$1.load(a,function(a){return e.$10.loadSession(a,b)})};this.loadSessions=function(a){return e.$1.bulkLoad(a,function(a){return e.$10.loadSessions(a).then(function(a){return new Map(Array.from(a.entries()).map(function(a){return[a[0],a[1]]}))})}).then(function(a){return new Map(Array.from(a.entries()).map(function(a){return[a[0],a[1]]}))})};this.loadSignedPreKey=function(a){return e.$7.load(a,function(){return e.$10.loadSignedPreKey(a)})};this.bulkLoadIdentities=function(a){return e.$10.bulkLoadIdentities(a).then(function(a){return e.$5.bulkLoadIdentities(a)})};this.loadIdentities=function(a){return e.$5.loadIdentitiesByUser(a,function(){return e.$10.loadIdentities(a)})};this.loadOneTimePreKey=function(a){return e.$6.load(a,function(){return e.$10.loadOneTimePreKey(a)})};this.saveSenderKeySession=function(a,c,d){e.storeSenderKeySession(a,c,d);return(h||(h=b("Promise"))).resolve()};this.loadSenderKeySession=function(a,c){var f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:g.next=2;return b("regeneratorRuntime").awrap(e.$8.load(d("WACryptoManager").encodeSenderKey(a,c),function(){var d;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b("regeneratorRuntime").awrap(e.$10.loadSenderKeySession(a,c));case 2:d=f.sent;return f.abrupt("return",d.success?d.value:null);case 4:case"end":return f.stop()}},null,this)}));case 2:f=g.sent;if(!(f==null)){g.next=5;break}return g.abrupt("return",d("WAResultOrError").makeError("errLoadSenderKeySession"));case 5:return g.abrupt("return",d("WAResultOrError").makeResult(f));case 6:case"end":return g.stop()}},null,this)};this.handleNewSession=function(a,c,f,g,i){e.storeSession(a,c);f!=null&&e.storeIdentity(a,f);g!=null&&e.removeOneTimePreKey(g);return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult())};this.$20=function(a,c){e.$3.store(a,c);return(h||(h=b("Promise"))).resolve()};this.$21=function(a){return e.$3.load(a,function(){return e.$10.loadICDC(a)})};this.$22=function(a,c){e.$2.store(a,c);return(h||(h=b("Promise"))).resolve()};this.$23=function(a){e.$5.remove(a);return(h||(h=b("Promise"))).resolve()};this.calculateICDC=function(a){return e.runInTransaction(function(c){var f=c.loadIdentities,g=c.loadICDC;if(a.length===0)return d("WAResultOrError").makeError("missing_participants");var i=new Set();return(h||(h=b("Promise"))).all(a.map(function(a){var c,h,j,k,l,m,n,o,p,q,r;return b("regeneratorRuntime").async(function(s){while(1)switch(s.prev=s.next){case 0:s.next=2;return b("regeneratorRuntime").awrap(f(a));case 2:c=s.sent;s.next=5;return b("regeneratorRuntime").awrap(g(a));case 5:h=s.sent;s.next=8;return b("regeneratorRuntime").awrap(e.$10.loadLastSyncTs(a));case 8:j=s.sent;d("WAICDCUtils").isLastSyncTsExpired(j)&&i.add(a);k=new Map(Array.from(c.entries()).map(function(a){var b=a[0];a=a[1];return[d("WAIdentityUtils").removeKeyTypeIfNeeded(a).toString(),b]}));if(!(h==null||d("WAICDCUtils").isICDCIndexInvalid(h))){s.next=14;break}i.add(a);return s.abrupt("return",null);case 14:l=[],(m=h.devices,n=Array.isArray(m),o=0,m=n?m:m[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 16:if(!n){s.next=22;break}if(!(o>=m.length)){s.next=19;break}return s.abrupt("break",34);case 19:p=m[o++];s.next=26;break;case 22:o=m.next();if(!o.done){s.next=25;break}return s.abrupt("break",34);case 25:p=o.value;case 26:q=p;r=k.get(d("WAIdentityUtils").removeKeyTypeIfNeeded(q).toString());if(!(r==null)){s.next=31;break}i.add(a);return s.abrupt("continue",32);case 31:l.push({id:d("WAJids").extractDeviceId(r),identity:d("WAIdentityUtils").removeKeyTypeIfNeeded(q)});case 32:s.next=16;break;case 34:return s.abrupt("return",{devices:l,sequence:h.sequence,signingDeviceIndex:h.signingDeviceIndex,timestamp:h.timestamp,user:a});case 35:case"end":return s.stop()}},null,this)})).then(function(a){var b=a.filter(Boolean);return b.length===0?d("WAResultOrError").makeError("invalid_icdc_info"):d("WAResultOrError").makeResult({icdcInfo:a.filter(Boolean),usersWithMissingICDC:i})})["catch"](function(a){x.ERROR(w(),a);return d("WAResultOrError").makeError("invalid_icdc_info")})})};this.$10=a;this.$13=c;this.$12=c.regId.toString();this.$5=new(d("WASignalIdentityStore").SignalIdentityStore)();this.$1=new((a=d("WASignalEntityStoreV2")).SignalEntityStore)();this.$2=new a.SignalEntityStore();this.$3=new a.SignalEntityStore();this.$4=new a.SignalEntityStore();this.$6=new a.SignalEntityStore();this.$7=new a.SignalEntityStore();this.$8=new a.SignalEntityStore()}var c=a.prototype;c.storeSession=function(a,b){this.$1.store(a,b)};c.storeIdentity=function(a,b){if(!b)return;this.$5.store(a,b)};c.useCache=function(){this.$9="memory"};c.useImmediateFlushing=function(){this.$9="persist"};c.removeOneTimePreKey=function(a){this.$6.remove(a)};c.storeSenderKeySession=function(a,b,c){this.$8.store(d("WACryptoManager").encodeSenderKey(a,b),c)};c.updateUserDevicesInfo=function(a){var c=this;return this.runInTransaction(function(e){var f,g,i,j,k,l,m,n,o,w,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T;return b("regeneratorRuntime").async(function(U){while(1)switch(U.prev=U.next){case 0:f=e.saveIdentity,g=e.deleteIdentity,i=e.saveDhash,j=e.saveICDC,k=e.loadIdentities;U.next=3;return b("regeneratorRuntime").awrap(k(a.jid));case 3:l=U.sent,(m=a.devices,n=a.jid,o=a.notificationTs,w=a.dhash,y=a.icdcInfo),x.DEV(v(),n,m.map(function(b){b=b.id;return d("WAJids").toDeviceJid(a.jid,b)}).join(","),Array.from(l.keys()).join(",")),z=new Set(l.keys()),A=[],B=[],(C=m,D=Array.isArray(C),E=0,C=D?C:C[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 10:if(!D){U.next=16;break}if(!(E>=C.length)){U.next=13;break}return U.abrupt("break",42);case 13:F=C[E++];U.next=20;break;case 16:E=C.next();if(!E.done){U.next=19;break}return U.abrupt("break",42);case 19:F=E.value;case 20:G=F;H=G.id;I=G.identity;J=G.model;K=G.platform;L=d("WAJids").toDeviceJid(a.jid,H);M=l.get(L);d("WAGlobals").getMyDeviceJid()===L&&(N=d("WACryptoUtils").uint8ArraysEqual(d("WAIdentityUtils").removeKeyTypeIfNeeded(c.$13.staticKeyPair.publicKey),d("WAIdentityUtils").removeKeyTypeIfNeeded(I)),N||x.ERROR(u()));z["delete"](L);if(!(M==null)){U.next=33;break}B.push({instruction:"identityAdded",consumerRetries:0,jid:d("WAJids").extractUserJid(L),type:"instruction",device:L,identity:I,model:J,platform:K,notificationTs:o});U.next=40;break;case 33:if(d("WACryptoUtils").uint8ArraysEqual(M,I)){U.next=40;break}if(!(d("WAJids").extractUserJid(L)!==n)){U.next=37;break}x.ERROR(t());return U.abrupt("continue",40);case 37:A.push(L),x.DEV(s(),L),B.push({instruction:"identityChanged",consumerRetries:0,jid:d("WAJids").extractUserJid(L),type:"instruction",device:L,identity:I,model:J,platform:K,notificationTs:o});case 40:U.next=10;break;case 42:O=[],(P=z,Q=Array.isArray(P),R=0,P=Q?P:P[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 44:if(!Q){U.next=50;break}if(!(R>=P.length)){U.next=47;break}return U.abrupt("break",64);case 47:S=P[R++];U.next=54;break;case 50:R=P.next();if(!R.done){U.next=53;break}return U.abrupt("break",64);case 53:S=R.value;case 54:T=S;if(!(d("WAJids").extractUserJid(T)!==n)){U.next=58;break}x.ERROR(r());return U.abrupt("continue",62);case 58:O.push(T),d("WAGlobals").getMyDeviceJid()===T&&x.ERROR(q()),x.DEV(p(),T),B.push({instruction:"identityRemoved",consumerRetries:0,jid:d("WAJids").extractUserJid(T),type:"instruction",device:T,notificationTs:o});case 62:U.next=44;break;case 64:return U.abrupt("return",(h||(h=b("Promise"))).all([w!=null?i(n,w):(h||(h=b("Promise"))).resolve(),y!=null?j(n,y):(h||(h=b("Promise"))).resolve()].concat(Array.from(O).map(function(a){return g(a)}),[O.concat(A).map(function(a){return c.$14(a)})],m.map(function(b){var a=b.id;b=b.identity;return f(d("WAJids").toDeviceJid(n,a),b)}))).then(function(){return d("WAResultOrError").makeResult(B)}));case 65:case"end":return U.stop()}},null,this)}).then(function(a){if(a.success&&a.value.length>0)return d("WAProtocolQueueState").persistStanzas(a.value)}).then(function(){return d("WAResultOrError").makeResult()})};c.savePendingToDatabase=function(){var a=this,c=this.$15();if(c==null)return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult([]));x.DEV(o(),c);x.LOG(n());return this.$10.bulkSaveSignalData(c).then(function(b){x.LOG(m());a.$16();return b},function(c){a.$17();return(h||(h=b("Promise"))).reject(c)})};c.clear=function(){this.$1.clear(),this.$5.clear(),this.$6.clear(),this.$7.clear(),this.$8.clear(),this.$2.clear(),this.$3.clear()};c.$18=function(a){return d("WATabLock").lockTab(this.$12).then(a)};c.$19=function(a){if(a.length===0)return;x.DEV(l(),a);d("WAJobs").getJobManager().fireAndForget(d("WAJobDefinitions").createStartJobInfo("getDevices",{ignoreDhash:!0,reason:"UnknownDevice",scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.LOW},users:new Set(a)}))};c.memoryLock=function(a){var b=this;return this.$18(function(){b.$9="memory";return a()["finally"](function(){x.LOG(k()),b.$9="persist"})})};c.$14=function(a){this.$1.remove(a);return(h||(h=b("Promise"))).resolve()};c.runInTransaction=function(a,c){var e=this;return this.$18(function(){var d=function(){return(h||(h=b("Promise"))).resolve(a({deletePreKeyGenerations:e.$10.deletePreKeyGenerations,getLastPreKeyGenerationId:e.$10.getLastPreKeyGenerationId,getPreKeyGenerationsTimestamps:e.$10.getPreKeyGenerationsTimestamps,handleNewSession:e.handleNewSession,loadLatestSignedPreKey:e.$10.loadLatestSignedPreKey,loadOneTimePreKey:e.loadOneTimePreKey,loadPreKeys:e.$10.loadPreKeys,loadSenderKeySession:e.loadSenderKeySession,loadSession:e.loadSession,loadSessions:e.loadSessions,loadSignedPreKey:e.loadSignedPreKey,loadIdentities:e.loadIdentities,saveOneTimePreKey:e.$10.saveOneTimePreKey,savePreKeysGeneration:e.$10.savePreKeysGeneration,saveSenderKeySession:e.saveSenderKeySession,saveSignedPreKeyIfNew:e.$10.saveSignedPreKeyIfNew,saveIdentity:function(a,c){return(h||(h=b("Promise"))).resolve(e.storeIdentity(a,c))},saveICDC:e.$20,loadICDC:e.$21,saveDhash:e.$22,deleteIdentity:e.$23,bulkLoadIdentities:e.bulkLoadIdentities})).then(function(a){if(a.success===!0){if(e.$9==="memory")return a;x.LOG(j());return e.savePendingToDatabase().then(function(b){(c==null?void 0:c.fetchUnknownDevices)===!0&&e.$19(b.value);return a})}else return a})};return e.$11.enqueue(d)})["catch"](function(a){x.ERROR(i(),a);return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeError("runtime-exception",a))})};c.$16=function(){this.$1.markSnapshotAsCommitted(),this.$2.markSnapshotAsCommitted(),this.$3.markSnapshotAsCommitted(),this.$5.markSnapshotAsCommitted(),this.$6.markSnapshotAsCommitted(),this.$7.markSnapshotAsCommitted(),this.$8.markSnapshotAsCommitted()};c.$17=function(){this.$1.markSnapshotAsFailed(),this.$2.markSnapshotAsFailed(),this.$3.markSnapshotAsFailed(),this.$5.markSnapshotAsFailed(),this.$6.markSnapshotAsFailed(),this.$7.markSnapshotAsFailed(),this.$8.markSnapshotAsFailed()};c.$15=function(){var a=this.$1.snapshot(),b=[],c=a.remove.map(function(a){return a.id});a.update.forEach(function(a){var c=a.id;a=a.cachedEntity;if(a==null)return;b.push({id:c,updated:a})});var e=[];this.$8.snapshot().update.forEach(function(a){var b=d("WACryptoManager").decodeSenderKey(a.id),c=b.groupId;b=b.deviceId;a.cachedEntity!=null&&c&&b&&e.push({groupId:c,author:b,updated:a.cachedEntity})});a=this.$5.snapshot();var f=a.remove.map(function(a){return a.id}),g=[];a.update.forEach(function(a){var b=a.id;a=a.cachedEntity;if(a==null)return;g.push({id:b,identity:a})});a=this.$6.snapshot().remove;var h=this.$2.snapshot(),i=[];for(var h=h.update,j=Array.isArray(h),k=0,h=j?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var l;if(j){if(k>=h.length)break;l=h[k++]}else{k=h.next();if(k.done)break;l=k.value}l=l;var m=l.cachedEntity;l=l.id;m!=null&&i.push({id:l,dhash:m})}l=this.$3.snapshot();m=[];for(k=l.update,j=Array.isArray(k),h=0,k=j?k:k[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(j){if(h>=k.length)break;l=k[h++]}else{h=k.next();if(h.done)break;l=h.value}l=l;var n=l.cachedEntity;l=l.id;n!=null&&m.push({id:l,icdc:n})}return b.length===0&&c.length===0&&g.length===0&&e.length===0&&a.length===0&&m.length===0&&i.length===0&&f.length===0?null:{dhashUpdate:i,icdcUpdate:m,identityRemove:f,identityUpdate:g,preKeyRemove:a,senderKeySessionUpdate:e,sessionRemove:c,sessionUpdate:b}};c.warmCache=function(a){return this.runInTransaction(function(c){var e,f,g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:e=c.bulkLoadIdentities,f=c.loadSessions;i.next=3;return b("regeneratorRuntime").awrap(e(a.map(d("WAJids").interpretAsUserJid).filter(Boolean)));case 3:g=i.sent;h=Array.from(g.values()).reduce(function(a,b){return a.concat(Array.from(b.keys()))},[]);i.next=7;return b("regeneratorRuntime").awrap(f(h));case 7:return i.abrupt("return",d("WAResultOrError").makeResult());case 8:case"end":return i.stop()}},null,this)}).then(function(){})};return a}();g.InMemorySignalStoreImpl=a}),98);
__d("WARequestKeysBatcher",["WAResolvable"],(function(a,b,c,d,e,f,g){var h={delayMs:50,maxSize:100};function a(a,b){b=b===void 0?h:b;var c=b.delayMs,e=b.maxSize,f=null;function g(b){f&&f.args===b&&(f=null);return a(b)}return function(a){if(f!=null)f.args.push(a);else{var b=[a],h=new(d("WAResolvable").Resolvable)();a=h.promise.then(g);var i=function(){return void h.resolve(b)},j=setTimeout(i,c);f={args:b,batchPromise:a,run:i,timer:j}}a=f;i=a.args;j=a.batchPromise;var k=i.length-1;if(i.length>=e){clearTimeout((a=f)==null?void 0:a.timer);f.run();f=null}return j.then(function(a){return a[k]})}}g.makeSimpleBatcher=a}),98);
__d("WARequestKeys",["WABulkRequestKeys","WAPromiseManagement","WARequestKeysBatcher","WAResultOrError","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";a=d("WARequestKeysBatcher").makeSimpleBatcher(function(a){var c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(d("WABulkRequestKeys").bulkRequestKeys(a));case 2:c=e.sent;if(!(c.success===!1)){e.next=5;break}return e.abrupt("return",a.map(function(){return c}));case 5:return e.abrupt("return",a.map(function(a){a=c.value.get(a);return a?d("WAResultOrError").makeResult(a):d("WAResultOrError").makeError("errRequestKeysNoKeys")}));case 6:case"end":return e.stop()}},null,this)});c=d("WAPromiseManagement").cacheWhilePending(function(a){return a},a);g.requestKeys=c}),98);
__d("WACryptoManagerUtils",["MAWLoggerUtils","Promise","WABulkRequestKeys","WACryptoManager","WAErr","WAGlobals","WAHandleFailureUtils","WAInMemorySignalStore","WALogger","WAPREList","WAPREMetrics","WARequestKeys","WAResultOrError","WASignalKeys","WASignalSignatures","WATagsLogger","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[SendMessage] Fail encrypt messages"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Cannot generate one time prekey"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Cannot deserialize signed prekey"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["No signed prekey"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["DecryptMsg error: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["DecryptMsg error: ",""]);n=function(){return a};return a}var o=d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.SignedPrekey]);function a(a){var b=new(d("WAInMemorySignalStore").InMemorySignalStoreImpl)(a.db,a.regInfo),c=p();return{manager:d("WACryptoManager").initCryptoManager({regInfo:a.regInfo,storage:b,network:c}),storage:b}}function p(){return{requestKeys:d("WARequestKeys").requestKeys,bulkRequestKeys:d("WABulkRequestKeys").bulkRequestKeys}}function q(a,b){if(b.success)a==null?void 0:a.endSuccess();else{var c,e=b.error;d("WALogger").WARN(n(),e);switch(e){case"errDuplicateMsg":a==null?void 0:a.addPoint(e);a==null?void 0:a.endSuccess();return;case"errCryptoDeserialization":case"errSignalNoSession":case"errSignalInvalidMsg":case"errInvalidMac":case"errSignalInvalidSignedPreKey":case"errSignalSignedPreKeyIdMismatch":case"errSignalSignedPreKeyDeserialization":case"errSignalInvalidOneTimeKey":case"errSignalOneTimeKeyMismatch":case"errSignalOneTimeKeyDeserialization":case"errSignalInvalidKey":case"errSignalDecryptionFailed":case"errSignalDeserializeInvalidProtoFormat":case"errSignalDeserializeRatchetKeyBadFormat":case"errSignalDeserializePkInvalidProtoFormat":case"errSignalDeserializePkKeyBadFormat":case"errSignalTooManyMessagesInFuture":case"errSignalEmptyVersionContentSuffix":case"errSignalContentExceededExpectedLength":case"errSignalGrpInvalidProtoFormat":case"errSignalGrpInvalidKeyFormat":case"errSignalGrpVersionContentEmpty":case"errSignalGrpInvalidVersionContentLength":case"errSignalGrpSenderKeyInvalidProtoFormat":case"errSignalGrpSenderKeyProtoError":case"errSignalGrpTooManyMessagesInFuture":c=e;break;default:typeof e==="string"?c=e:(d("WALogger").ERROR(m(),b),c="fail");break}a==null?void 0:a.endFail(c)}}function e(a,c,e,f,g){var i=null;return d("WACryptoManager").decryptContent(f.cryptoManager,c,{ciphertext:e,type:a},function(a,c){i={plaintext:a,remoteIdentity:c};return(h||(h=b("Promise"))).resolve()}).then(function(a){q(g,a);if(a.success)return d("WAResultOrError").makeResult(i);else return a})}function f(a,c,e,f,g){var i=null;return d("WACryptoManager").decryptGroupContent(f.cryptoManager,a,c,e,function(a){i={plaintext:a};return(h||(h=b("Promise"))).resolve()}).then(function(a){q(g,a);if(a.success)return d("WAResultOrError").makeResult(i);else return a})}function r(a,b){return d("WACryptoManager").getParticipantInfo(b,a)}function s(a){return a.storage.runInTransaction(function(a){a=a.getPreKeyGenerationsTimestamps;return a().then(function(a){return d("WAResultOrError").makeResult(a)})}).then(function(a){return a.success===!0?a.value:[]})}function t(a,b){return b.storage.runInTransaction(function(b){b=b.deletePreKeyGenerations;return b(a).then(function(){return d("WAResultOrError").makeResult()})}).then(function(){})}function u(a,b,c,e){return d("WACryptoManager").saveSenderKeySession(e.cryptoManager,a,b,c)}function v(a){var e,f,g,i,m,n,p,q;return b("regeneratorRuntime").async(function(r){while(1)switch(r.prev=r.next){case 0:r.next=2;return b("regeneratorRuntime").awrap(a.storage.runInTransaction(function(a){a=a.loadLatestSignedPreKey;return a().then(d("WAResultOrError").makeResult)}));case 2:e=r.sent;if(!(e.success===!1)){r.next=9;break}o.ERROR(l());if(!(e==null?void 0:(f=e.payload)==null?void 0:(g=f.message)==null?void 0:g.includes("lastSignedPrekeyId"))){r.next=8;break}r.next=8;return b("regeneratorRuntime").awrap(d("WAHandleFailureUtils").reregisterPhone());case 8:throw c("WAErr")("No signed prekey");case 9:i=d("WASignalSignatures").deserializeSignedPreKey(e.value);if(!(i==null)){r.next=13;break}o.ERROR(k());throw c("WAErr")("Cannot deserialize signed prekey");case 13:r.next=15;return b("regeneratorRuntime").awrap(d("WACryptoManager").generateOneTimePreKey(a));case 15:m=r.sent;if(!(m==null)){r.next=19;break}d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.OneTimePrekey]).ERROR(j());throw c("WAErr")("Cannot generate one time prekey");case 19:n=a.regInfo,p=n.regId,q=n.staticKeyPair;return r.abrupt("return",(h||(h=b("Promise"))).resolve({regId:p,keyType:d("WASignalKeys").KEY_TYPE,publicKey:q.publicKey,signedPreKey:i,preKey:m}));case 21:case"end":return r.stop()}},null,this)}function w(a,b,c){var e=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.MESSAGE_ENCRYPTION,{string:{chat:"group",jid:a}},void 0);return d("WACryptoManager").encryptGroupContent(c.cryptoManager,a,d("WAGlobals").getMyDeviceJid(),b).then(function(a){if(a.success)e.endSuccess();else{var b=a.error;switch(b){case"identity-mismatch":break;default:break}e.endFail(b)}return a})}function x(a,b,c){var e=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.MESSAGE_ENCRYPTION,{string:{chat:"1:1",jid:c}},void 0);return d("WACryptoManager").bulkEncryptContent(b.cryptoManager,a).then(function(a){if(a.success)e.endSuccess();else{var b=a.error;switch(b){case"missing":case"mismatch":case"runtime-exception":break;default:break}e.endFail(b)}return a})}function y(a,b,c,e,f,g){var h=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.MESSAGE_ENCRYPTION,{string:{chat:"1:1",jid:g}},void 0);return d("WACryptoManager").encryptContent(c.cryptoManager,a,b,e||d("WACryptoManager").DEFAULT_SESSION_REQUEST,f).then(function(a){if(a.success)h.endSuccess();else{var b=a.error;switch(b){case"identity-mismatch":case"errSignalInvalidKey":break;default:break}h.endFail(b)}return a})}function z(a,b){return d("WACryptoManager").bulkEncryptContent(b.cryptoManager,a).then(function(a){if(a.success===!1){d("WALogger").ERROR(i());return new Map()}return a.value})}function A(a,c){return d("WACryptoManager").acquireSessionLocks(a,function(){var e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b("regeneratorRuntime").awrap(d("WACryptoManager").ensureSessionsExists(c.cryptoManager,a));case 2:e=f.sent;return f.abrupt("return",c.cryptoManager.storage.runInTransaction(function(a){var c=a.handleNewSession;return(h||(h=b("Promise"))).all(Array.from(e.entries()).map(function(a){var b=a[0];a=a[1];return c(b,a,a.remote.pubKey)})).then(function(){return d("WAResultOrError").makeResult()})}).then(function(){}));case 4:case"end":return f.stop()}},null,this)})}g.createCryptoManager=a;g.decryptMsg=e;g.decryptGroupMsg=f;g.getParticipantInfo=r;g.getPreKeyGenerationsTimestamps=s;g.deletePreKeyGenerations=t;g.saveSenderKeySession=u;g.getSignalInfoForRetry=v;g.encryptGroupContentWithMetrics=w;g.bulkEncryptMsgWithMetrics=x;g.encryptMsgWithMetrics=y;g.bulkEncrypt=z;g.bulkPreEstablishOutgoingSession=A}),98);
__d("WAPreKeysStanzaUtils",["WAWap"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b;return(b=d("WAWap")).wap("key",null,b.wap("id",null,b.BIG_ENDIAN_CONTENT(a.id,3)),b.wap("value",null,a.keyPair.publicKey))}function b(a){var b;return(b=d("WAWap")).wap("skey",null,b.wap("id",null,b.BIG_ENDIAN_CONTENT(a.id,3)),b.wap("value",null,a.keyPair.publicKey),b.wap("signature",null,a.signature))}function c(a){var b=a.child("skey"),c=null;if(a.hasChild("key")){var d=a.child("key");c={id:d.child("id").contentUint(3),publicKey:d.child("value").contentSerializedPubKey()}}return{identity:a.child("identity").contentSerializedPubKey(),signedKey:{id:b.child("id").contentUint(3),publicKey:b.child("value").contentSerializedPubKey(),signature:b.child("signature").contentBytes(64)},oneTimeKey:c}}g.xmppPreKey=a;g.xmppSignedPreKey=b;g.readSessionInfo=c}),98);
__d("WAGetKeysForUpload",["MAWLoggerUtils","WAResultOrError","WASignalKeys","WATagsLogger"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to deserialize prekey received from the db"]);h=function(){return a};return a}var i=d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.PrekeyGenerateAndUpload,d("MAWLoggerUtils").Tag.SignedPrekey]);function a(a,b){return a.storage.runInTransaction(function(c){c=c.loadPreKeys;return c(b).then(function(b){var c=b.preKeys;b=b.signedPreKey;var e=[];c.forEach(function(a){a=d("WASignalKeys").deserializePreKey(a);a==null?i.ERROR(h()):e.push(a)});return d("WAResultOrError").makeResult({regInfo:a.regInfo,keyType:d("WASignalKeys").KEY_TYPE,preKeys:e,signedPreKey:b})})})}g.getKeysForUpload=a}),98);
__d("WASmaxInPreKeysIQErrorItemNotFoundMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","item-not-found");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",404);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorItemNotFoundMixin=a}),98);
__d("WASmaxInPreKeysIQErrorNotAcceptableMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"field");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"name");if(!b.success)return b;a=d("WASmaxParseUtils").attrString(a,"reason");return!a.success?a:d("WAResultOrError").makeResult({name:b.value,reason:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"field",h);if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","not-acceptable");if(!c.success)return c;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",406);return!a.success?a:d("WAResultOrError").makeResult({text:c.value,code:a.value,field:b.value})}g.parseIQErrorNotAcceptableField=h;g.parseIQErrorNotAcceptableMixin=a}),98);
__d("WASmaxInPreKeysRequestErrorsFetchDigest",["WAResultOrError","WASmaxInPreKeysIQErrorFallbackClientMixin","WASmaxInPreKeysIQErrorItemNotFoundMixin","WASmaxInPreKeysIQErrorNotAcceptableMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPreKeysIQErrorNotAcceptableMixin").parseIQErrorNotAcceptableMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorNotAcceptable",value:b.value});var c=d("WASmaxInPreKeysIQErrorItemNotFoundMixin").parseIQErrorItemNotFoundMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorItemNotFound",value:c.value});var e=d("WASmaxInPreKeysIQErrorFallbackClientMixin").parseIQErrorFallbackClientMixin(a);return e.success?d("WAResultOrError").makeResult({name:"IQErrorFallbackClient",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorNotAcceptable","IQErrorItemNotFound","IQErrorFallbackClient"],[b,c,e])}g.parseRequestErrorsFetchDigest=a}),98);
__d("WASmaxInPreKeysFetchDigestResponseRequestError",["WAResultOrError","WASmaxInPreKeysIQErrorResponseMixin","WASmaxInPreKeysRequestErrorsFetchDigest","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInPreKeysIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInPreKeysRequestErrorsFetchDigest").parseRequestErrorsFetchDigest(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorRequestErrorsFetchDigest:b.value}))}g.parseFetchDigestResponseRequestError=a}),98);
__d("WASmaxInPreKeysFetchDigestResponseServerError",["WAResultOrError","WASmaxInPreKeysIQErrorResponseMixin","WASmaxInPreKeysServerErrors","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInPreKeysIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInPreKeysServerErrors").parseServerErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorServerErrors:b.value}))}g.parseFetchDigestResponseServerError=a}),98);
__d("WASmaxInPreKeysKeysHashMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"hash");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytesRange(a.value,20,20);return!a.success?a:d("WAResultOrError").makeResult({hashElementValue:a.value})}g.parseKeysHashMixin=a}),98);
__d("WASmaxInPreKeysPreKeyIDListMixin",["WAResultOrError","WASmaxInPreKeysKeyIDMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"id");if(!b.success)return b;b=d("WASmaxInPreKeysKeyIDMixin").parseKeyIDMixin(a);return!b.success?b:b}function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"list");if(!a.success)return a;a=d("WASmaxParseUtils").mapChildrenWithTag(a.value,"id",0,2e4,h);return!a.success?a:d("WAResultOrError").makeResult({listId:a.value})}g.parsePreKeyIDListListId=h;g.parsePreKeyIDListMixin=a}),98);
__d("WASmaxInPreKeysIdentityDigestBundleMixin",["WAResultOrError","WASmaxInPreKeysIdentityKeyMixin","WASmaxInPreKeysKeyTypeMixin","WASmaxInPreKeysKeysHashMixin","WASmaxInPreKeysPreKeyIDListMixin","WASmaxInPreKeysRegistrationIDMixin","WASmaxInPreKeysSignedPreKeyMixin"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPreKeysRegistrationIDMixin").parseRegistrationIDMixin(a);if(!b.success)return b;var c=d("WASmaxInPreKeysIdentityKeyMixin").parseIdentityKeyMixin(a);if(!c.success)return c;var e=d("WASmaxInPreKeysPreKeyIDListMixin").parsePreKeyIDListMixin(a);if(!e.success)return e;var f=d("WASmaxInPreKeysSignedPreKeyMixin").parseSignedPreKeyMixin(a);if(!f.success)return f;var g=d("WASmaxInPreKeysKeyTypeMixin").parseKeyTypeMixin(a);a=d("WASmaxInPreKeysKeysHashMixin").parseKeysHashMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,c.value,e.value,f.value,{keyTypeMixin:g.success?g.value:null},a.value))}g.parseIdentityDigestBundleMixin=a}),98);
__d("WASmaxInPreKeysFetchDigestResponseSuccess",["WAResultOrError","WASmaxInPreKeysIQResultResponseMixin","WASmaxInPreKeysIdentityDigestBundleMixin","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"digest");if(!c.success)return c;var e=d("WASmaxParseReference").optionalAttrStringFromReference(b,["digest","identity_type"]);if(!e.success)return e;e=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,c.value,"identity_type",e.value);if(!e.success)return e;c=d("WASmaxInPreKeysIdentityDigestBundleMixin").parseIdentityDigestBundleMixin(c.value);if(!c.success)return c;a=d("WASmaxInPreKeysIQResultResponseMixin").parseIQResultResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({hasDigestIdentityType:e.value!=null,digestIdentityDigestBundleMixin:c.value},a.value))}g.parseFetchDigestResponseSuccess=a}),98);
__d("WASmaxOutPreKeysDeprecatedFBIDIdentityTypeMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("smax$any",{identity_type:"fbid"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeDeprecatedFBIDIdentityTypeMixin=a}),98);
__d("WASmaxOutPreKeysFetchDigestRequest",["WASmaxJsx","WASmaxMixins","WASmaxOutPreKeysClientRequestMixin","WASmaxOutPreKeysDeprecatedFBIDIdentityTypeMixin"],(function(a,b,c,d,e,f,g){function a(a){a=a.hasDeprecatedFBIDIdentityType;a=d("WASmaxOutPreKeysClientRequestMixin").mergeClientRequestMixin(d("WASmaxJsx").smax("iq",{type:"get"},d("WASmaxMixins").optionalMerge(d("WASmaxOutPreKeysDeprecatedFBIDIdentityTypeMixin").mergeDeprecatedFBIDIdentityTypeMixin,d("WASmaxJsx").smax("digest",null),a)));return a}g.makeFetchDigestRequest=a}),98);
__d("WASmaxPreKeysFetchDigestRPC",["WAComms","WASmaxInPreKeysFetchDigestResponseRequestError","WASmaxInPreKeysFetchDigestResponseServerError","WASmaxInPreKeysFetchDigestResponseSuccess","WASmaxOutPreKeysFetchDigestRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:e=d("WASmaxOutPreKeysFetchDigestRequest").makeFetchDigestRequest(a);j.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(e,c));case 3:f=j.sent;g=d("WASmaxInPreKeysFetchDigestResponseSuccess").parseFetchDigestResponseSuccess(f,e);if(!g.success){j.next=7;break}return j.abrupt("return",{name:"FetchDigestResponseSuccess",value:g.value});case 7:h=d("WASmaxInPreKeysFetchDigestResponseRequestError").parseFetchDigestResponseRequestError(f,e);if(!h.success){j.next=10;break}return j.abrupt("return",{name:"FetchDigestResponseRequestError",value:h.value});case 10:i=d("WASmaxInPreKeysFetchDigestResponseServerError").parseFetchDigestResponseServerError(f,e);if(!i.success){j.next=13;break}return j.abrupt("return",{name:"FetchDigestResponseServerError",value:i.value});case 13:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("FetchDigest",{Success:g,RequestError:h,ServerError:i}));case 14:case"end":return j.stop()}},null,this)}g.sendFetchDigestRPC=a}),98);
__d("WARequestPreKeyDigestProtocol",["WABinary","WAConvertRegistrationIdMixin","WAConvertSignedPreKeyMixin","WACryptoDependencies","WACryptoUtils","WAParsableXmlNode","WAResultOrError","WASignalKeys","WASmaxPreKeysFetchDigestRPC","WATagsLogger","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": ",""]);i=function(){return a};return a}var j=d("WATagsLogger").TAGS(["requestPreKeyDigestProtocol"]);function a(a){return d("WASmaxPreKeysFetchDigestRPC").sendFetchDigestRPC({}).then(function(b){switch(b.name){case"FetchDigestResponseServerError":var c=b.value.errorServerErrors.name;j.ERROR(i(),b.name,c);return d("WAResultOrError").makeError({type:"server-error",payload:c});case"FetchDigestResponseRequestError":c=b.value.errorRequestErrorsFetchDigest.name;j.ERROR(h(),b.name,c);return d("WAResultOrError").makeError({type:"request-error",payload:c});default:b.name;c=k(b.value.digestIdentityDigestBundleMixin);return l(c,a).then(function(a){return a==="ok"?d("WAResultOrError").makeResult():d("WAResultOrError").makeError({type:"compare-error",payload:a})})}})}function k(a){var b=d("WAConvertRegistrationIdMixin").registrationIdMixin(a),c=d("WAConvertSignedPreKeyMixin").convertSignedPreKeyMixin(a),e=a.listId.map(function(a){return d("WASignalKeys").castToPreKeyId(d("WAParsableXmlNode").convertBytesToUint(a.elementValue,3))});a=a.hashElementValue;return{regId:b,skeyId:c.id,preKeyIds:e,hash:a}}function l(a,c){var e,f,g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:if(!(a.regId!==c.regInfo.regId)){i.next=2;break}return i.abrupt("return","RegIdMismatch");case 2:if(!(a.skeyId!==c.signedPreKey.id)){i.next=4;break}return i.abrupt("return","SignedPreKeyIdMismatch");case 4:e=new Map();c.preKeys.forEach(function(a){return e.set(a.id,a)});f=a.preKeyIds.some(function(a){return!e.has(a)});if(!f){i.next=9;break}return i.abrupt("return","UnknownPreKey");case 9:g=a.preKeyIds.map(function(a){return e.get(a)}).filter(Boolean);i.next=12;return b("regeneratorRuntime").awrap(m(c,g));case 12:h=i.sent;if(d("WACryptoUtils").uint8ArraysEqual(h,a.hash)){i.next=15;break}return i.abrupt("return","HashMismatch");case 15:return i.abrupt("return","ok");case 16:case"end":return i.stop()}},null,this)}function m(a,b){var c=new(d("WABinary").Binary)();c.writeByteArray(a.regInfo.staticKeyPair.publicKey);c.writeByteArray(a.signedPreKey.keyPair.publicKey);c.writeByteArray(a.signedPreKey.signature);b.forEach(function(a){c.writeByteArray(a.keyPair.publicKey)});return d("WACryptoDependencies").getCrypto().subtle.digest("SHA-1",c.readByteArray()).then(function(a){return new Uint8Array(a)})}g.requestPreKeyDigestProtocol=a}),98);
__d("WARequestPreKeyDigest",["WABridge","WAErr","WAGetKeysForUpload","WAGlobals","WAJobDefinitions","WAJobOrchestratorTypes","WAJobs","WALogger","WAOdsEnums","WAPromiseManagement","WARequestPreKeyDigestProtocol","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["PreKey digest comparison failed: ",""]);h=function(){return a};return a}function i(a){var e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:g.next=2;return b("regeneratorRuntime").awrap(a(function(a){a=a.cryptoManager;return d("WAGetKeysForUpload").getKeysForUpload(a)}));case 2:e=g.sent;if(!(e.success===!1)){g.next=6;break}d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.PREKEY_DIGEST,key:"fail"});throw c("WAErr")("Error while loading keys: "+e.error);case 6:g.next=8;return b("regeneratorRuntime").awrap(d("WARequestPreKeyDigestProtocol").requestPreKeyDigestProtocol(e.value));case 8:f=g.sent;if(!(f.success===!1)){g.next=17;break}d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.PREKEY_DIGEST,key:"fail"});if(!(f.error.type==="compare-error")){g.next=16;break}d("WALogger").ERROR(h(),f.error.payload);g.next=15;return b("regeneratorRuntime").awrap(d("WAJobs").getJobManager().waitUntilPersisted(d("WAJobDefinitions").createStartJobInfo("generateAndUploadPreKeys",{scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.HIGH},reason:"prekey digest comparison failed",uniqueJob:!0})));case 15:return g.abrupt("return");case 16:throw c("WAErr")("Error while requesting key digest: "+f.error.type+" "+f.error.payload);case 17:f.success,d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.PREKEY_DIGEST,key:"success"});case 19:case"end":return g.stop()}},null,this)}a=d("WAJobs").getPersistedJobsApi().definePersistedJob().finalStep("requestPreKeyDigest",d("WAPromiseManagement").nullaryCacheWhilePending(function(){return i(function(a){return d("WAGlobals").getWaOneQueue().enqueue(a,{operationType:"request_prekey_digest",flush:!1})})})).end();g.requestPreKeyDigestFn=i;g.requestPreKeyDigest=a}),98);
__d("WAReceiptUtils",["WACryptoManagerUtils","WADeprecatedSendIq","WAPREList","WAPREMetrics","WAPreKeysStanzaUtils","WARequestPreKeyDigest","WAWap","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(a,c){var e,f,g,h,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:e=a.retryCount;f=e+1;g=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.RETRY_RECEIPTS_SENT,{"int":{retries:f}});if(!(f>=3)){k.next=6;break}k.next=6;return b("regeneratorRuntime").awrap(d("WARequestPreKeyDigest").requestPreKeyDigestFn(function(a){return a(c)}));case 6:h=null;if(!(f>=2)){k.next=11;break}k.next=10;return b("regeneratorRuntime").awrap(d("WACryptoManagerUtils").getSignalInfoForRetry(c.cryptoManager));case 10:h=k.sent;case 11:j=c.cryptoManager.regInfo.regId;g.endSuccess();return k.abrupt("return",i(a,f,j,h));case 14:case"end":return k.stop()}},null,this)}function a(a,c){var e,f,g,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:e=a.externalId,f=a.from,g=a.participant;f.type==="group"?i=f.groupJid:(f.type,i=f.deviceJid);j.t0=b("regeneratorRuntime");j.t1=d("WADeprecatedSendIq").deprecatedSendStanzaAndWaitForAck;j.next=6;return b("regeneratorRuntime").awrap(h(a,c));case 6:j.t2=j.sent;j.t3={id:e,"class":"receipt",from:i,participant:g};j.t4=j.t1(j.t2,j.t3);j.next=11;return j.t0.awrap.call(j.t0,j.t4);case 11:case"end":return j.stop()}},null,this)}function i(a,b,c,e){var f=null;if(e!=null){var g=e.keyType,h=e.signedPreKey,i=e.preKey;e=e.publicKey;var j=a.deviceIdentity!=null?d("WAWap").wap("device-identity",null,a.deviceIdentity):null;f=d("WAWap").wap("keys",null,d("WAWap").wap("type",null,d("WAWap").BIG_ENDIAN_CONTENT(g,1)),d("WAWap").wap("identity",null,e),d("WAPreKeysStanzaUtils").xmppPreKey(i),d("WAPreKeysStanzaUtils").xmppSignedPreKey(h),j)}a.from.type==="group"?g=a.from.groupJid:(a.from.type,g=a.from.deviceJid);return d("WAWap").wap("receipt",{id:d("WAWap").CUSTOM_STRING(a.externalId),to:d("WAWap").JID(g),participant:a.participant?d("WAWap").DEVICE_JID(a.participant):d("WAWap").DROP_ATTR,recipient:a.recipient?d("WAWap").USER_JID(a.recipient):d("WAWap").DROP_ATTR,type:"retry",category:a.category!=null?d("WAWap").CUSTOM_STRING(a.category):d("WAWap").DROP_ATTR},d("WAWap").wap("retry",{v:"1",count:d("WAWap").INT(b),id:d("WAWap").CUSTOM_STRING(a.externalId),t:d("WAWap").INT(a.ts)}),d("WAWap").wap("registration",null,d("WAWap").BIG_ENDIAN_CONTENT(c)),f)}g.makeRetryReceipt=h;g.sendRetryReceipt=a}),98);
__d("WASmaxOutReceiptBizOriginalEnvelopeMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.originalEnvelopeElementValue;a=d("WASmaxJsx").smax("biz",null,d("WASmaxJsx").smax("original_envelope",null,a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBizOriginalEnvelopeMixin=a}),98);
__d("WASmaxOutReceiptFromProxyAccountMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.receiptActualFrom;a=d("WASmaxJsx").smax("receipt",{actual_from:d("WAWap").JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeFromProxyAccountMixin=a}),98);
__d("WASmaxOutReceiptNeedPrivacyTokenMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("receipt",{privacy_token:"false"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNeedPrivacyTokenMixin=a}),98);
__d("WASmaxOutReceiptRecipientMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.receiptRecipient;a=d("WASmaxJsx").smax("receipt",{recipient:d("WAWap").USER_JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeRecipientMixin=a}),98);
__d("WASmaxOutReceiptSenderAggregatedPublishMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.itemId;a=d("WASmaxJsx").smax("item",{id:d("WAWap").STANZA_ID(a)});return a}function i(a){var b=a.itemArgs;a=a.receiptId;a=d("WASmaxJsx").smax("receipt",{id:d("WAWap").STANZA_ID(a)},d("WASmaxJsx").smax("list",null,d("WASmaxChildren").REPEATED_CHILD(h,b,0,255)));return a}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeSenderAggregatedPublishListItem=h;g.mergeSenderAggregatedPublishMixin=a}),98);
__d("WASmaxOutReceiptSingleMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.receiptId;a=d("WASmaxJsx").smax("receipt",{id:d("WAWap").STANZA_ID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeSingleMixin=a}),98);
__d("WASmaxOutReceiptSenderAggregatedPublishOrSingleMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutReceiptSenderAggregatedPublishMixin","WASmaxOutReceiptSingleMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.senderAggregatedPublish)return d("WASmaxOutReceiptSenderAggregatedPublishMixin").mergeSenderAggregatedPublishMixin(a,b.senderAggregatedPublish);if(b.single)return d("WASmaxOutReceiptSingleMixin").mergeSingleMixin(a,b.single);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeSenderAggregatedPublishOrSingleMixinGroup=a}),98);
__d("WASmaxOutReceiptBroadcastDeviceDeprecatedMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.receiptTo;a=d("WASmaxJsx").smax("receipt",{to:d("WAWap").BROADCAST_JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBroadcastDeviceDeprecatedMixin=a}),98);
__d("WASmaxOutReceiptBroadcastDeviceMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.receiptTo;a=a.receiptParticipant;b=d("WASmaxJsx").smax("receipt",{to:d("WAWap").BROADCAST_JID(b),participant:d("WAWap").DEVICE_JID(a)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBroadcastDeviceMixin=a}),98);
__d("WASmaxOutReceiptGroupDeviceDeprecatedMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.receiptTo;a=d("WASmaxJsx").smax("receipt",{to:d("WAWap").GROUP_JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeGroupDeviceDeprecatedMixin=a}),98);
__d("WASmaxOutReceiptGroupDeviceMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.receiptTo;a=a.receiptParticipant;b=d("WASmaxJsx").smax("receipt",{to:d("WAWap").GROUP_JID(b),participant:d("WAWap").JID(a)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeGroupDeviceMixin=a}),98);
__d("WASmaxOutReceiptIndividualDeviceMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.receiptTo;a=d("WASmaxJsx").smax("receipt",{to:d("WAWap").JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualDeviceMixin=a}),98);
__d("WASmaxOutReceiptStatusDeviceDeprecatedMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.receiptTo;a=d("WASmaxJsx").smax("receipt",{to:d("WAWap").JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeStatusDeviceDeprecatedMixin=a}),98);
__d("WASmaxOutReceiptStatusDeviceMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.receiptTo;a=a.receiptParticipant;b=d("WASmaxJsx").smax("receipt",{to:d("WAWap").JID(b),participant:d("WAWap").DEVICE_JID(a)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeStatusDeviceMixin=a}),98);
__d("WASmaxOutReceiptDeviceMixins",["WASmaxMixinGroupExhaustiveError","WASmaxOutReceiptBroadcastDeviceDeprecatedMixin","WASmaxOutReceiptBroadcastDeviceMixin","WASmaxOutReceiptGroupDeviceDeprecatedMixin","WASmaxOutReceiptGroupDeviceMixin","WASmaxOutReceiptIndividualDeviceMixin","WASmaxOutReceiptStatusDeviceDeprecatedMixin","WASmaxOutReceiptStatusDeviceMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.groupDevice)return d("WASmaxOutReceiptGroupDeviceMixin").mergeGroupDeviceMixin(a,b.groupDevice);if(b.individualDevice)return d("WASmaxOutReceiptIndividualDeviceMixin").mergeIndividualDeviceMixin(a,b.individualDevice);if(b.statusDevice)return d("WASmaxOutReceiptStatusDeviceMixin").mergeStatusDeviceMixin(a,b.statusDevice);if(b.broadcastDevice)return d("WASmaxOutReceiptBroadcastDeviceMixin").mergeBroadcastDeviceMixin(a,b.broadcastDevice);if(b.groupDeviceDeprecated)return d("WASmaxOutReceiptGroupDeviceDeprecatedMixin").mergeGroupDeviceDeprecatedMixin(a,b.groupDeviceDeprecated);if(b.statusDeviceDeprecated)return d("WASmaxOutReceiptStatusDeviceDeprecatedMixin").mergeStatusDeviceDeprecatedMixin(a,b.statusDeviceDeprecated);if(b.broadcastDeviceDeprecated)return d("WASmaxOutReceiptBroadcastDeviceDeprecatedMixin").mergeBroadcastDeviceDeprecatedMixin(a,b.broadcastDeviceDeprecated);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeDeviceMixins=a}),98);
__d("WASmaxOutReceiptDeviceMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutReceiptDeviceMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.deviceMixinsArgs;a=d("WASmaxOutReceiptDeviceMixins").mergeDeviceMixins(d("WASmaxJsx").smax("receipt",null),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeDeviceMixin=a}),98);
__d("WASmaxOutReceiptInteropDeviceMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.receiptTo;a=d("WASmaxJsx").smax("receipt",{to:d("WAWap").JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeInteropDeviceMixin=a}),98);
__d("WASmaxOutReceiptInteropUserMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.receiptTo;a=d("WASmaxJsx").smax("receipt",{to:d("WAWap").JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeInteropUserMixin=a}),98);
__d("WASmaxOutReceiptBroadcastUserDeprecatedMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.receiptTo;a=d("WASmaxJsx").smax("receipt",{to:d("WAWap").BROADCAST_JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBroadcastUserDeprecatedMixin=a}),98);
__d("WASmaxOutReceiptBroadcastUserMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.receiptTo;a=a.receiptParticipant;b=d("WASmaxJsx").smax("receipt",{to:d("WAWap").BROADCAST_JID(b),participant:d("WAWap").USER_JID(a)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBroadcastUserMixin=a}),98);
__d("WASmaxOutReceiptGroupUserDeprecatedMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.receiptTo;a=d("WASmaxJsx").smax("receipt",{to:d("WAWap").GROUP_JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeGroupUserDeprecatedMixin=a}),98);
__d("WASmaxOutReceiptGroupUserMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.receiptTo;a=a.receiptParticipant;b=d("WASmaxJsx").smax("receipt",{to:d("WAWap").GROUP_JID(b),participant:d("WAWap").JID(a)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeGroupUserMixin=a}),98);
__d("WASmaxOutReceiptIndividualUserDeprecatedMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.receiptTo;a=a.receiptParticipant;b=d("WASmaxJsx").smax("receipt",{to:d("WAWap").USER_JID(b),participant:d("WAWap").JID(a)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualUserDeprecatedMixin=a}),98);
__d("WASmaxOutReceiptIndividualUserMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.receiptTo;a=d("WASmaxJsx").smax("receipt",{to:d("WAWap").JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualUserMixin=a}),98);
__d("WASmaxOutReceiptStatusUserDeprecatedMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.receiptTo;a=d("WASmaxJsx").smax("receipt",{to:d("WAWap").JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeStatusUserDeprecatedMixin=a}),98);
__d("WASmaxOutReceiptStatusUserMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.receiptTo;a=a.receiptParticipant;b=d("WASmaxJsx").smax("receipt",{to:d("WAWap").JID(b),participant:d("WAWap").USER_JID(a)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeStatusUserMixin=a}),98);
__d("WASmaxOutReceiptUserMixins",["WASmaxMixinGroupExhaustiveError","WASmaxOutReceiptBroadcastUserDeprecatedMixin","WASmaxOutReceiptBroadcastUserMixin","WASmaxOutReceiptGroupUserDeprecatedMixin","WASmaxOutReceiptGroupUserMixin","WASmaxOutReceiptIndividualUserDeprecatedMixin","WASmaxOutReceiptIndividualUserMixin","WASmaxOutReceiptStatusUserDeprecatedMixin","WASmaxOutReceiptStatusUserMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.groupUser)return d("WASmaxOutReceiptGroupUserMixin").mergeGroupUserMixin(a,b.groupUser);if(b.individualUserDeprecated)return d("WASmaxOutReceiptIndividualUserDeprecatedMixin").mergeIndividualUserDeprecatedMixin(a,b.individualUserDeprecated);if(b.individualUser)return d("WASmaxOutReceiptIndividualUserMixin").mergeIndividualUserMixin(a,b.individualUser);if(b.statusUser)return d("WASmaxOutReceiptStatusUserMixin").mergeStatusUserMixin(a,b.statusUser);if(b.broadcastUser)return d("WASmaxOutReceiptBroadcastUserMixin").mergeBroadcastUserMixin(a,b.broadcastUser);if(b.groupUserDeprecated)return d("WASmaxOutReceiptGroupUserDeprecatedMixin").mergeGroupUserDeprecatedMixin(a,b.groupUserDeprecated);if(b.statusUserDeprecated)return d("WASmaxOutReceiptStatusUserDeprecatedMixin").mergeStatusUserDeprecatedMixin(a,b.statusUserDeprecated);if(b.broadcastUserDeprecated)return d("WASmaxOutReceiptBroadcastUserDeprecatedMixin").mergeBroadcastUserDeprecatedMixin(a,b.broadcastUserDeprecated);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeUserMixins=a}),98);
__d("WASmaxOutReceiptUserMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutReceiptUserMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.userMixinsArgs;a=d("WASmaxOutReceiptUserMixins").mergeUserMixins(d("WASmaxJsx").smax("receipt",null),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeUserMixin=a}),98);
__d("WASmaxOutReceiptUserOrDeviceOrInteropUserOrInteropDeviceMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutReceiptDeviceMixin","WASmaxOutReceiptInteropDeviceMixin","WASmaxOutReceiptInteropUserMixin","WASmaxOutReceiptUserMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.user)return d("WASmaxOutReceiptUserMixin").mergeUserMixin(a,b.user);if(b.device)return d("WASmaxOutReceiptDeviceMixin").mergeDeviceMixin(a,b.device);if(b.interopUser)return d("WASmaxOutReceiptInteropUserMixin").mergeInteropUserMixin(a,b.interopUser);if(b.interopDevice)return d("WASmaxOutReceiptInteropDeviceMixin").mergeInteropDeviceMixin(a,b.interopDevice);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeUserOrDeviceOrInteropUserOrInteropDeviceMixinGroup=a}),98);
__d("WASmaxOutReceiptPublishDeliveryRequest",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutReceiptBizOriginalEnvelopeMixin","WASmaxOutReceiptFromProxyAccountMixin","WASmaxOutReceiptNeedPrivacyTokenMixin","WASmaxOutReceiptRecipientMixin","WASmaxOutReceiptSenderAggregatedPublishOrSingleMixinGroup","WASmaxOutReceiptUserOrDeviceOrInteropUserOrInteropDeviceMixinGroup"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxOutReceiptBizOriginalEnvelopeMixin").mergeBizOriginalEnvelopeMixin(d("WASmaxJsx").smax("biz",null),a);return a}function a(a){var b=a.bizArgs,c=a.recipientMixinArgs,e=a.fromProxyAccountMixinArgs,f=a.hasNeedPrivacyToken,g=a.userOrDeviceOrInteropUserOrInteropDeviceMixinGroupArgs;a=a.senderAggregatedPublishOrSingleMixinGroupArgs;b=d("WASmaxOutReceiptSenderAggregatedPublishOrSingleMixinGroup").mergeSenderAggregatedPublishOrSingleMixinGroup(d("WASmaxOutReceiptUserOrDeviceOrInteropUserOrInteropDeviceMixinGroup").mergeUserOrDeviceOrInteropUserOrInteropDeviceMixinGroup(d("WASmaxMixins").optionalMerge(d("WASmaxOutReceiptNeedPrivacyTokenMixin").mergeNeedPrivacyTokenMixin,d("WASmaxMixins").optionalMerge(d("WASmaxOutReceiptFromProxyAccountMixin").mergeFromProxyAccountMixin,d("WASmaxMixins").optionalMerge(d("WASmaxOutReceiptRecipientMixin").mergeRecipientMixin,d("WASmaxJsx").smax("receipt",null,d("WASmaxChildren").OPTIONAL_CHILD(h,b)),c),e),f),g),a);return b}g.makePublishDeliveryRequestBiz=h;g.makePublishDeliveryRequest=a}),98);
__d("WASmaxOutReceiptBroadcastDeviceBroadcastDeviceOrBroadcastDeviceDeprecatedMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutReceiptBroadcastDeviceDeprecatedMixin","WASmaxOutReceiptBroadcastDeviceMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.broadcastDevice)return d("WASmaxOutReceiptBroadcastDeviceMixin").mergeBroadcastDeviceMixin(a,b.broadcastDevice);if(b.broadcastDeviceDeprecated)return d("WASmaxOutReceiptBroadcastDeviceDeprecatedMixin").mergeBroadcastDeviceDeprecatedMixin(a,b.broadcastDeviceDeprecated);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeBroadcastDeviceBroadcastDeviceOrBroadcastDeviceDeprecatedMixinGroup=a}),98);
__d("WASmaxOutReceiptSenderTypeMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("receipt",{type:"sender"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeSenderTypeMixin=a}),98);
__d("WASmaxOutReceiptPublishSenderBroadcastDeviceSenderTypeMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutReceiptBroadcastDeviceBroadcastDeviceOrBroadcastDeviceDeprecatedMixinGroup","WASmaxOutReceiptSenderTypeMixin"],(function(a,b,c,d,e,f,g){function h(a){a=a.broadcastDeviceBroadcastDeviceOrBroadcastDeviceDeprecatedMixinGroupArgs;a=d("WASmaxOutReceiptBroadcastDeviceBroadcastDeviceOrBroadcastDeviceDeprecatedMixinGroup").mergeBroadcastDeviceBroadcastDeviceOrBroadcastDeviceDeprecatedMixinGroup(d("WASmaxOutReceiptSenderTypeMixin").mergeSenderTypeMixin(d("WASmaxJsx").smax("receipt",null)),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePublishSenderBroadcastDeviceSenderTypeMixin=a}),98);
__d("WASmaxOutReceiptGroupDeviceGroupDeviceOrGroupDeviceDeprecatedMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutReceiptGroupDeviceDeprecatedMixin","WASmaxOutReceiptGroupDeviceMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.groupDevice)return d("WASmaxOutReceiptGroupDeviceMixin").mergeGroupDeviceMixin(a,b.groupDevice);if(b.groupDeviceDeprecated)return d("WASmaxOutReceiptGroupDeviceDeprecatedMixin").mergeGroupDeviceDeprecatedMixin(a,b.groupDeviceDeprecated);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeGroupDeviceGroupDeviceOrGroupDeviceDeprecatedMixinGroup=a}),98);
__d("WASmaxOutReceiptPublishSenderGroupDeviceSenderTypeMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutReceiptGroupDeviceGroupDeviceOrGroupDeviceDeprecatedMixinGroup","WASmaxOutReceiptSenderTypeMixin"],(function(a,b,c,d,e,f,g){function h(a){a=a.groupDeviceGroupDeviceOrGroupDeviceDeprecatedMixinGroupArgs;a=d("WASmaxOutReceiptGroupDeviceGroupDeviceOrGroupDeviceDeprecatedMixinGroup").mergeGroupDeviceGroupDeviceOrGroupDeviceDeprecatedMixinGroup(d("WASmaxOutReceiptSenderTypeMixin").mergeSenderTypeMixin(d("WASmaxJsx").smax("receipt",null)),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePublishSenderGroupDeviceSenderTypeMixin=a}),98);
__d("WASmaxOutReceiptIndividualDeviceDeprecatedMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.receiptTo;a=a.receiptParticipant;b=d("WASmaxJsx").smax("receipt",{to:d("WAWap").DEVICE_JID(b),participant:d("WAWap").JID(a)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualDeviceDeprecatedMixin=a}),98);
__d("WASmaxOutReceiptIndividualDeviceIndividualDeviceDeprecatedOrIndividualDeviceMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutReceiptIndividualDeviceDeprecatedMixin","WASmaxOutReceiptIndividualDeviceMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.individualDeviceDeprecated)return d("WASmaxOutReceiptIndividualDeviceDeprecatedMixin").mergeIndividualDeviceDeprecatedMixin(a,b.individualDeviceDeprecated);if(b.individualDevice)return d("WASmaxOutReceiptIndividualDeviceMixin").mergeIndividualDeviceMixin(a,b.individualDevice);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeIndividualDeviceIndividualDeviceDeprecatedOrIndividualDeviceMixinGroup=a}),98);
__d("WASmaxOutReceiptPeerReceiptDeprecatedMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.receiptRecipient;a=d("WASmaxJsx").smax("receipt",{recipient:d("WASmaxAttrs").OPTIONAL(d("WAWap").USER_JID,a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePeerReceiptDeprecatedMixin=a}),98);
__d("WASmaxOutReceiptRecipientOrPeerReceiptDeprecatedMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutReceiptPeerReceiptDeprecatedMixin","WASmaxOutReceiptRecipientMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.recipient)return d("WASmaxOutReceiptRecipientMixin").mergeRecipientMixin(a,b.recipient);if(b.peerReceiptDeprecated)return d("WASmaxOutReceiptPeerReceiptDeprecatedMixin").mergePeerReceiptDeprecatedMixin(a,b.peerReceiptDeprecated);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeRecipientOrPeerReceiptDeprecatedMixinGroup=a}),98);
__d("WASmaxOutReceiptPublishSenderIndividualDeviceSenderTypeMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutReceiptIndividualDeviceIndividualDeviceDeprecatedOrIndividualDeviceMixinGroup","WASmaxOutReceiptRecipientOrPeerReceiptDeprecatedMixinGroup","WASmaxOutReceiptSenderTypeMixin"],(function(a,b,c,d,e,f,g){function h(a){var b=a.individualDeviceIndividualDeviceDeprecatedOrIndividualDeviceMixinGroupArgs;a=a.recipientOrPeerReceiptDeprecatedMixinGroupArgs;b=d("WASmaxOutReceiptRecipientOrPeerReceiptDeprecatedMixinGroup").mergeRecipientOrPeerReceiptDeprecatedMixinGroup(d("WASmaxOutReceiptIndividualDeviceIndividualDeviceDeprecatedOrIndividualDeviceMixinGroup").mergeIndividualDeviceIndividualDeviceDeprecatedOrIndividualDeviceMixinGroup(d("WASmaxOutReceiptSenderTypeMixin").mergeSenderTypeMixin(d("WASmaxJsx").smax("receipt",null)),b),a);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePublishSenderIndividualDeviceSenderTypeMixin=a}),98);
__d("WASmaxOutReceiptStatusDeviceStatusDeviceOrStatusDeviceDeprecatedMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutReceiptStatusDeviceDeprecatedMixin","WASmaxOutReceiptStatusDeviceMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.statusDevice)return d("WASmaxOutReceiptStatusDeviceMixin").mergeStatusDeviceMixin(a,b.statusDevice);if(b.statusDeviceDeprecated)return d("WASmaxOutReceiptStatusDeviceDeprecatedMixin").mergeStatusDeviceDeprecatedMixin(a,b.statusDeviceDeprecated);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeStatusDeviceStatusDeviceOrStatusDeviceDeprecatedMixinGroup=a}),98);
__d("WASmaxOutReceiptPublishSenderStatusDeviceSenderTypeMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutReceiptSenderTypeMixin","WASmaxOutReceiptStatusDeviceStatusDeviceOrStatusDeviceDeprecatedMixinGroup"],(function(a,b,c,d,e,f,g){function h(a){a=a.statusDeviceStatusDeviceOrStatusDeviceDeprecatedMixinGroupArgs;a=d("WASmaxOutReceiptStatusDeviceStatusDeviceOrStatusDeviceDeprecatedMixinGroup").mergeStatusDeviceStatusDeviceOrStatusDeviceDeprecatedMixinGroup(d("WASmaxOutReceiptSenderTypeMixin").mergeSenderTypeMixin(d("WASmaxJsx").smax("receipt",null)),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePublishSenderStatusDeviceSenderTypeMixin=a}),98);
__d("WASmaxOutReceiptPublishSenderGroupOrPublishSenderIndividualOrPublishSenderStatusOrPublishSenderBroadcastDeviceSenderTypeMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutReceiptPublishSenderBroadcastDeviceSenderTypeMixin","WASmaxOutReceiptPublishSenderGroupDeviceSenderTypeMixin","WASmaxOutReceiptPublishSenderIndividualDeviceSenderTypeMixin","WASmaxOutReceiptPublishSenderStatusDeviceSenderTypeMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.publishSenderGroupDeviceSenderType)return d("WASmaxOutReceiptPublishSenderGroupDeviceSenderTypeMixin").mergePublishSenderGroupDeviceSenderTypeMixin(a,b.publishSenderGroupDeviceSenderType);if(b.publishSenderIndividualDeviceSenderType)return d("WASmaxOutReceiptPublishSenderIndividualDeviceSenderTypeMixin").mergePublishSenderIndividualDeviceSenderTypeMixin(a,b.publishSenderIndividualDeviceSenderType);if(b.publishSenderStatusDeviceSenderType)return d("WASmaxOutReceiptPublishSenderStatusDeviceSenderTypeMixin").mergePublishSenderStatusDeviceSenderTypeMixin(a,b.publishSenderStatusDeviceSenderType);if(b.publishSenderBroadcastDeviceSenderType)return d("WASmaxOutReceiptPublishSenderBroadcastDeviceSenderTypeMixin").mergePublishSenderBroadcastDeviceSenderTypeMixin(a,b.publishSenderBroadcastDeviceSenderType);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergePublishSenderGroupOrPublishSenderIndividualOrPublishSenderStatusOrPublishSenderBroadcastDeviceSenderTypeMixinGroup=a}),98);
__d("WASmaxOutReceiptPublishSenderRequest",["WASmaxJsx","WASmaxOutReceiptPublishSenderGroupOrPublishSenderIndividualOrPublishSenderStatusOrPublishSenderBroadcastDeviceSenderTypeMixinGroup","WASmaxOutReceiptSenderAggregatedPublishOrSingleMixinGroup"],(function(a,b,c,d,e,f,g){function a(a){var b=a.publishSenderGroupOrPublishSenderIndividualOrPublishSenderStatusOrPublishSenderBroadcastDeviceSenderTypeMixinGroupArgs;a=a.senderAggregatedPublishOrSingleMixinGroupArgs;b=d("WASmaxOutReceiptSenderAggregatedPublishOrSingleMixinGroup").mergeSenderAggregatedPublishOrSingleMixinGroup(d("WASmaxOutReceiptPublishSenderGroupOrPublishSenderIndividualOrPublishSenderStatusOrPublishSenderBroadcastDeviceSenderTypeMixinGroup").mergePublishSenderGroupOrPublishSenderIndividualOrPublishSenderStatusOrPublishSenderBroadcastDeviceSenderTypeMixinGroup(d("WASmaxJsx").smax("receipt",null),b),a);return b}g.makePublishSenderRequest=a}),98);
__d("WASendDeliveryReceiptProtocol",["Promise","WAComms","WAGlobals","WAJids","WASmaxOutReceiptPublishDeliveryRequest","WASmaxOutReceiptPublishSenderRequest"],(function(a,b,c,d,e,f,g){"use strict";var h;c=function(a){var c=a.stanzaId,e=a.author;a=a.from;if(!d("WAJids").isAuthorMe(e))return(h||(h=b("Promise"))).resolve(d("WAComms").castSmaxStanza(l({recipient:e,from:a,stanzaId:c})));else return(h||(h=b("Promise"))).resolve(d("WAComms").castSmaxStanza(m({recipient:d("WAGlobals").getMyUserJid(),stanzaId:c,recipientDevice:a})))};function i(a){var b=a.stanzaId,c=a.from;a=a.chat;var e=d("WAJids").extractUserJid(c);return d("WAJids").switchOnMsgrChatJidType(a,{group:function(a){return e===d("WAGlobals").getMyUserJid()?j({chat:a,from:c,stanzaId:b}):k({chat:a,from:c,stanzaId:b})},user:function(a){return e===d("WAGlobals").getMyUserJid()?m({recipient:e,recipientDevice:c,stanzaId:b}):l({recipient:e,from:c,stanzaId:b})}})}function a(a){d("WAComms").castSmaxStanza(i(a))}function j(a){var b=a.stanzaId,c=a.chat;a=a.from;c={publishSenderGroupDeviceSenderType:{groupDeviceGroupDeviceOrGroupDeviceDeprecatedMixinGroupArgs:{groupDevice:{receiptTo:c,receiptParticipant:a}}}};a={single:{receiptId:b}};b={publishSenderGroupOrPublishSenderIndividualOrPublishSenderStatusOrPublishSenderBroadcastDeviceSenderTypeMixinGroupArgs:c,senderAggregatedPublishOrSingleMixinGroupArgs:a};return d("WASmaxOutReceiptPublishSenderRequest").makePublishSenderRequest(b)}function k(a){var b=a.stanzaId,c=a.chat;a=a.from;c={device:{deviceMixinsArgs:{groupDevice:{receiptTo:c,receiptParticipant:a}}}};a={single:{receiptId:b}};b={senderAggregatedPublishOrSingleMixinGroupArgs:a,userOrDeviceOrInteropUserOrInteropDeviceMixinGroupArgs:c};return d("WASmaxOutReceiptPublishDeliveryRequest").makePublishDeliveryRequest(b)}function l(a){var b=a.stanzaId;a=a.from;a={device:{deviceMixinsArgs:{individualDevice:{receiptTo:a}}}};b={single:{receiptId:b}};b={senderAggregatedPublishOrSingleMixinGroupArgs:b,userOrDeviceOrInteropUserOrInteropDeviceMixinGroupArgs:a};return d("WASmaxOutReceiptPublishDeliveryRequest").makePublishDeliveryRequest(b)}function m(a){var b=a.recipientDevice,c=a.recipient;a=a.stanzaId;c={publishSenderIndividualDeviceSenderType:{recipientOrPeerReceiptDeprecatedMixinGroupArgs:{recipient:{receiptRecipient:c}},individualDeviceIndividualDeviceDeprecatedOrIndividualDeviceMixinGroupArgs:{individualDevice:{receiptTo:b}}}};b={single:{receiptId:a}};a={publishSenderGroupOrPublishSenderIndividualOrPublishSenderStatusOrPublishSenderBroadcastDeviceSenderTypeMixinGroupArgs:c,senderAggregatedPublishOrSingleMixinGroupArgs:b};return d("WASmaxOutReceiptPublishSenderRequest").makePublishSenderRequest(a)}g.sendIndividualMessageDeliveryReceipt=c;g.makeDeliveryReceipt=i;g.sendDeliveryReceipt=a}),98);
__d("WAServerRPCLogger",["WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";a=d("WATagsLogger").TAGS(["ServerRPC"]);g.logger=a}),98);
__d("WAResultOrErrorUtils",[],(function(a,b,c,d,e,f){function a(a){var b=[];a.forEach(function(a){a.success&&b.push(a.value)});return b}function b(a){var b=[];a.forEach(function(a){a.success||b.push(a.error)});return b}f.unpackValues=a;f.unpackErrors=b}),66);
__d("WAMapWithDefault",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b){this.$1=a,b!=null?this.$2=new Map(b):this.$2=new Map()}var b=a.prototype;b.size=function(){return this.$2.size};b.get=function(a){var b=this.$2.get(a);if(b!=null)return b;else{b=this.$1(a);this.$2.set(a,b);return b}};b.keys=function(){return this.$2.keys()};b.entries=function(){return this.$2.entries()};b.update=function(b,c){c=new Map(this.$2).set(b,c(this.get(b)));return new a(this.$1,c)};return a}();f.MapWithDefault=a}),66);
__d("WAScheduleAfterOfflineResume",["Promise","WAGlobals","WALogger","WAOfflineUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["AfterOfflineResume, flush: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["AfterOfflineResume: ",""]);j=function(){return a};return a}function a(){return(h||(h=b("Promise"))).resolve()}var k=new Map();function l(a){setTimeout(function(){return a()["catch"](function(a){return d("WALogger").ERROR(j(),a)})},0)}function c(a){var b=a.code,c=a.id,e=a.combine;a=a.useFirstCallback;var f=d("WAGlobals").getWaOneQueue();if(!f){l(b);return}if(f.getMode()===d("WAOfflineUtils").ServerRPCMode.ONLINE&&!k.has(c)){l(b);return}f=b;if(e===!0&&k.has(c)){b=k.get(c)||[];b.push(f);k.set(c,b);return}if(a!==!0){k.set(c,[f]);return}if(k.has(c))return;else k.set(c,[f])}function e(){var a=k.entries();k=new Map();for(var a=a,b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(b){if(c>=a.length)break;e=a[c++]}else{c=a.next();if(c.done)break;e=c.value}e=e;e[0];e=e[1];for(var f=0;f<e.length;f++){var g=e[f];g()["catch"](function(a){return d("WALogger").ERROR(i(),a)})}}}g.noopAction=a;g.scheduleAfterOfflineResume=c;g.flushPostponedActions=e}),98);
__d("WAMmsRetry.pb",["$InternalEnum","WAProtoConst"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({GENERAL_ERROR:0,SUCCESS:1,NOT_FOUND:2,DECRYPTION_ERROR:3});c={};e={};c.internalSpec={stanzaId:[1,(f=d("WAProtoConst")).TYPES.STRING],directPath:[2,f.TYPES.STRING],result:[3,f.TYPES.ENUM,a]};e.internalSpec={stanzaId:[1,f.TYPES.STRING]};g.MediaRetryNotification$ResultType=a;g.MediaRetryNotificationSpec=c;g.ServerErrorReceiptSpec=e}),98);
__d("WACryptoPkcs7",["WACryptoDependencies","WAErr"],(function(a,b,c,d,e,f,g){function a(a){var b=new Uint8Array(1);do d("WACryptoDependencies").getCrypto().getRandomValues(b);while(b[0]===0);h(a,b[0])}function b(a){var b=new Uint8Array(1);d("WACryptoDependencies").getCrypto().getRandomValues(b);h(a,(b[0]&15)+1)}function h(a,b){for(var c=0;c<b;c++)a.writeUint8(b)}function e(a){if(a.length===0)throw c("WAErr")("unpadPkcs7 given empty bytes");var b=a[a.length-1];if(b>a.length)throw c("WAErr")("unpadPkcs7 given "+a.length+" bytes, but pad is "+b);return new Uint8Array(a.buffer,a.byteOffset,a.length-b)}g.writeRandomPad=a;g.writeRandomPadMax16=b;g.writePad=h;g.unpadPkcs7=e}),98);
__d("WAAsMessageTransport",["WABinary","WACryptoPkcs7"],(function(a,b,c,d,e,f,g){function a(a,b,c,e,f){f===void 0&&(f=2);var g;b!=null&&(g={destinationJid:b});var h;a!=null&&(h={applicationPayload:{payload:a,version:f}});b=new(d("WABinary").Binary)();d("WACryptoPkcs7").writeRandomPadMax16(b);return{payload:h,protocol:{integral:{padding:b.readBuffer(),dsm:g},ancillary:{skdm:c==null?void 0:c,icdc:e==null?void 0:e}}}}g.asMessageTransport=a}),98);
__d("WAMapUtils",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){return new Map(Array.from(a.entries()).map(function(a){return[a[0],b(a[1],a[0])]}))}f.mapValues=a}),66);
__d("WAMsgTransport.pb",["WACommon.pb","WAProtoConst"],(function(a,b,c,d,e,f,g){var h;a={NOOP:0,UPSERT:1,DELETE:2,UPSERT_AND_DELETE:3};b={};c={};e={};f={};var i={},j={},k={},l={},m={},n={},o={};b.internalSpec={payload:[1,(h=d("WAProtoConst")).TYPES.MESSAGE,c],protocol:[2,h.TYPES.MESSAGE,e]};c.internalSpec={applicationPayload:[1,h.TYPES.MESSAGE,d("WACommon.pb").SubProtocolSpec],futureProof:[3,h.TYPES.ENUM,d("WACommon.pb").FUTURE_PROOF_BEHAVIOR]};e.internalSpec={integral:[1,h.TYPES.MESSAGE,m],ancillary:[2,h.TYPES.MESSAGE,f]};f.internalSpec={skdm:[2,h.TYPES.MESSAGE,l],deviceListMetadata:[3,h.TYPES.MESSAGE,o],icdc:[4,h.TYPES.MESSAGE,j],backupDirective:[5,h.TYPES.MESSAGE,i]};i.internalSpec={messageId:[1,h.TYPES.STRING],actionType:[2,h.TYPES.ENUM,a],supplementalKey:[3,h.TYPES.STRING]};j.internalSpec={senderIdentity:[1,h.TYPES.MESSAGE,k],recipientIdentities:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,k],recipientUserJids:[3,h.FLAGS.REPEATED|h.TYPES.STRING]};k.internalSpec={seq:[1,h.TYPES.INT32],signingDevice:[2,h.TYPES.BYTES],unknownDevices:[3,h.FLAGS.REPEATED|h.TYPES.BYTES],unknownDeviceIds:[4,h.FLAGS.REPEATED|h.TYPES.INT32]};l.internalSpec={groupId:[1,h.TYPES.STRING],axolotlSenderKeyDistributionMessage:[2,h.TYPES.BYTES]};m.internalSpec={padding:[1,h.TYPES.BYTES],dsm:[2,h.TYPES.MESSAGE,n]};n.internalSpec={destinationJid:[1,h.TYPES.STRING],phash:[2,h.TYPES.STRING]};o.internalSpec={senderKeyHash:[1,h.TYPES.BYTES],senderTimestamp:[2,h.TYPES.UINT64],recipientKeyHash:[8,h.TYPES.BYTES],recipientTimestamp:[9,h.TYPES.UINT64]};g.MESSAGE_TRANSPORT_PROTOCOL_ANCILLARY_BACKUP_DIRECTIVE_ACTION_TYPE=a;g.MessageTransportSpec=b;g.MessageTransport$PayloadSpec=c;g.MessageTransport$ProtocolSpec=e;g.MessageTransport$Protocol$AncillarySpec=f;g.MessageTransport$Protocol$Ancillary$BackupDirectiveSpec=i;g.MessageTransport$Protocol$Ancillary$ICDCParticipantDevicesSpec=j;g.MessageTransport$Protocol$Ancillary$ICDCParticipantDevices$ICDCIdentityListDescriptionSpec=k;g.MessageTransport$Protocol$Ancillary$SenderKeyDistributionMessageSpec=l;g.MessageTransport$Protocol$IntegralSpec=m;g.MessageTransport$Protocol$Integral$DeviceSentMessageSpec=n;g.DeviceListMetadataSpec=o}),98);
__d("WAProtocolMediaType",[],(function(a,b,c,d,e,f){function a(a){switch(a){case"image":case"sticker":case"gif":case"video":case"ptt":case"audio":case"document":case"product":return a;case"xma-image":return"document";default:return null}}f.castToProtocolMediaType=a}),66);
__d("WAEncNode",["WAAsMessageTransport","WACryptoManagerUtils","WAErr","WAGlobals","WALogger","WAMapUtils","WAMsgTransport.pb","WANullthrows","WAProtocolMediaType","encodeProtobuf"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg failed to encrypt message: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg failed to encrypt message: ",""]);i=function(){return a};return a}function a(a,b,e,f){var g=d("WAMapUtils").mapValues(a,function(a,b){var c=a.params;a=a.icdc;var d;switch(c.type){case"message":d=j({messageBytes:c.messageBytes,to:b,icdc:a,chat:c.chat,applicationPayloadVersion:c.applicationPayloadVersion});break;case"appdata":d=k({messageBytes:c.messageBytes});break;default:c.type,d=l({skdm:c.skdm,icdc:a})}return{plaintext:d}});return d("WACryptoManagerUtils").bulkEncryptMsgWithMetrics(g,b,e).then(function(b){if(!b.success){d("WALogger").ERROR(i(),b.error);return null}return d("WAMapUtils").mapValues(b.value,function(b,e){var g,h=b.type,i=b.ciphertext;b=b.baseKey;g=c("WANullthrows")((g=a.get(e))==null?void 0:g.params);var j=g.type==="message"&&g.messageType.type==="media"?d("WAProtocolMediaType").castToProtocolMediaType(g.messageType.mediaType):null;return{encType:"device",to:e,v:((e=g.messageBytes)==null?void 0:e.version)==="v2"?"2":"3",type:h,mediaType:j,count:f,ciphertext:i,baseKey:b}})})}function b(a,b,c,e,f,g,i){var m;switch(b.type){case"message":m=j({messageBytes:b.messageBytes,to:a,icdc:i,chat:b.chat,applicationPayloadVersion:b.applicationPayloadVersion});break;case"appdata":m=k({messageBytes:b.messageBytes});break;default:b.type,m=l({skdm:b.skdm,icdc:i})}i=d("WACryptoManagerUtils").encryptMsgWithMetrics(a,m,c,f,g,b==null?void 0:b.chat);return i.then(function(c){var f;if(!c.success){d("WALogger").ERROR(h(),c.error);return null}var g=b.type==="message"&&b.messageType.type==="media"?d("WAProtocolMediaType").castToProtocolMediaType(b.messageType.mediaType):null,i=c.value,j=i.type;i=i.ciphertext;return{encType:"device",to:a,v:((f=b.messageBytes)==null?void 0:f.version)==="v2"?"2":"3",type:j,mediaType:g,count:e,ciphertext:i,baseKey:c.value.baseKey}})}function j(a){var b=a.messageBytes,c=a.to,e=a.icdc,f=a.chat;a=a.applicationPayloadVersion;if(b.version==="v3"){var g=null;d("WAGlobals").isPeerDevice(c)&&(g=f);f=d("WAAsMessageTransport").asMessageTransport(b.bytes,g,null,e,a);return d("encodeProtobuf").encodeProtobuf(d("WAMsgTransport.pb").MessageTransportSpec,f).readByteArray()}else if(d("WAGlobals").isPeerDevice(c))return b.bytesForPeer;else return b.bytes}function k(a){a=a.messageBytes;if(a.version==="v3"){a=d("WAAsMessageTransport").asMessageTransport(a.bytes);return d("encodeProtobuf").encodeProtobuf(d("WAMsgTransport.pb").MessageTransportSpec,a).readByteArray()}else throw c("WAErr")("Plaintext v2 not supported yet")}function l(a){var b=a.skdm;a=a.icdc;b=d("WAAsMessageTransport").asMessageTransport(null,null,b,a);return d("encodeProtobuf").encodeProtobuf(d("WAMsgTransport.pb").MessageTransportSpec,b).readByteArray()}g.getEncNodes=a;g.getEncNode=b}),98);
__d("WAPhash",["Promise","WABase64","WABinary","WACryptoDependencies","WALogger","WASortedLists"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Calculate pHash -- end"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Calculate pHash -- Start"]);j=function(){return a};return a}function a(a){d("WALogger").LOG(j());a=d("WASortedLists").sortAndDedupe(a);var c=new(d("WABinary").Binary)();for(var e=0;e<a.length;e++)c.writeString(a[e]);return(h||(h=b("Promise"))).resolve(d("WACryptoDependencies").getCrypto().subtle.digest("SHA-256",c.readByteArray()).then(function(a){d("WALogger").LOG(i());a=new Uint8Array(a,0,6);return"2:"+d("WABase64").encodeB64(a)}))}g.calculatePHash=a}),98);
__d("WAEncUserMsg",["Promise","WAEncNode","WAGlobals","WAICDCUtils","WAJids","WAPhash","WATagsLogger"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["WAEncUserMsg -- getParticipantNodes -- receiverEncypted -- FALSE"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["WAEncUserMsg -- encrypt - getParticipantNodes -- EMPTY DEVICE JIDS"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["WAEncUserMsg -- encrypt -- getParticipantNodes -- START"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["WAEncUserMsg -- getParticipantNodes -- EMPTY NODE"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg -- encryptUserMsg -- user message -- DONE"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg -- encryptUserMsg -- user message -- OTHER_RECIPENT_DEVICE_EMPTY"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg -- encryptUserMsg -- user message -- ICDC"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["WAEncUserMsg -- no other recipient"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["WAEncUserMsg -- no recipient"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg -- encryptUserMsg -- user message -- START"]);r=function(){return a};return a}var s=d("WATagsLogger").TAGS(["WAEncUserMsg"]);function a(a,c,e,f){s.LOG(r());a.length===0&&s.ERROR(q());var g=!1;a.length===1&&(g=a[0].user===d("WAGlobals").getMyUserJid());var i=a.find(function(a){return a.user===d("WAGlobals").getMyUserJid()});i==null&&(i={user:d("WAGlobals").getMyUserJid(),devicesInfo:[]});var j=a.filter(function(a){return a.user!==d("WAGlobals").getMyUserJid()});j.length===0&&c.type!=="appdata"&&!g&&s.ERROR(p());g=d("WAICDCUtils").computeICDCParticipantDevices(i,j,e);s.LOG(o());i=a.flatMap(function(a){return a.devicesInfo}).map(function(a){return a.jid});v(a)&&s.LOG(n());return(h||(h=b("Promise"))).all([t(i,c,f,g),d("WAPhash").calculatePHash(i.concat(d("WAGlobals").getMyDeviceJid()))]).then(function(a){var b=a[0];a=a[1];s.LOG(m());return{participants:b,phash:a}})}function c(a,b,c){return t(a,b,c)}function t(a,b,c,d){return u(a,b,c,d).then(function(a){if(a.length===0){s.WARN(l());return}return a})}function e(a,b,c,e,f,g){return d("WAEncNode").getEncNode(a,b,c,e,f,g)}function u(a,b,c,e){var f=!1;s.LOG(k());(b.type!=="message"||d("WAJids").interpretAsGroupJid(b.chat)!=null)&&(f=!0);a=d("WAEncNode").getEncNodes(new Map(a.map(function(a){return[a,{params:b,icdc:e}]})),c).then(function(a){if(a==null){s.WARN(j());return[]}b.type==="message"&&(f=f||Array.from(a.keys()).some(function(a){return d("WAJids").extractUserJid(a)===b.chat}));return Array.from(a==null?void 0:a.values())});return a.then(function(a){if(f)return a;else{s.ERROR(i());return[]}}).then(function(a){return a.filter(Boolean)})}function v(a){return a.filter(function(a){return a.user!==d("WAGlobals").getMyUserJid()}).flatMap(function(a){return a.devicesInfo}).length===0}g.encryptUserMsg=a;g.encryptGroupFanoutMsg=c;g.encryptDeviceJidMessage=e}),98);
__d("WAGetGroupParticipantDevicesApi",["WAGlobals","WAResultOrError","WAResultOrErrorUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){return d("WAGlobals").runInTransaction({ContactsStore:!0,ParticipantsStore:!0,GroupInfoStore:!0},function(b){return h(b,a)},"getGroupParticipantDevices")};var h=function(a,c){var e,f,g,h,i,j,k,l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:e=a.ContactsStore,f=a.ParticipantsStore,g=a.GroupInfoStore;m.next=3;return b("regeneratorRuntime").awrap(g.has(c));case 3:h=m.sent;if(!(h===!1)){m.next=6;break}return m.abrupt("return",d("WAResultOrError").makeError("missing_group"));case 6:m.next=8;return b("regeneratorRuntime").awrap(f.bulkGetInGroup(c));case 8:i=m.sent;if(i.success){m.next=11;break}return m.abrupt("return",d("WAResultOrError").makeError("missing_group"));case 11:j=i.value;if(!(j.length===0)){m.next=14;break}return m.abrupt("return",d("WAResultOrError").makeError("missing_participants"));case 14:m.next=16;return b("regeneratorRuntime").awrap(e.bulkGet(j.map(function(a){return a.user})).then(d("WAResultOrErrorUtils").unpackValues));case 16:k=m.sent;l=k.flatMap(function(a){return a.identities}).map(function(a){return a.device}).filter(function(a){return a!==d("WAGlobals").getMyDeviceJid()});return m.abrupt("return",d("WAResultOrError").makeResult({deviceJids:new Set(l)}));case 19:case"end":return m.stop()}},null,this)};g.getGroupParticipantDevices=a;g.getGroupParticipantDevicesTransactor=h}),98);
__d("WAEncGroupMsg",["WAAsMessageTransport","WACryptoManager","WACryptoManagerUtils","WAEncUserMsg","WAErr","WAGetGroupParticipantDevicesApi","WAGlobals","WAHex","WALogger","WAMsgTransport.pb","WAPhash","WAPromiseQueue","WAProtocolMediaType","WASortedLists","WATimeUtils","encodeProtobuf","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["encryptGroupMsg - end key distribution"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["encryptGroupMsg - start key distribution"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["encryptGroupMsg - Encrypt success"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["encryptGroupMsg - Finish encrypt group content"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["encryptGroupMsg - Finish group fanout msg "]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["encryptGroupMsg - Finish rotate participant info "]);m=function(){return a};return a}var n=30*d("WATimeUtils").DAY_SECONDS,o=new(d("WAPromiseQueue").PromiseQueue)();function p(a,e,f){return o.enqueue(function(){var g,h,i,j,k,l,m,o,p,q,r;return b("regeneratorRuntime").async(function(s){while(1)switch(s.prev=s.next){case 0:s.next=2;return b("regeneratorRuntime").awrap(d("WAGlobals").getDbImpls().getSenderKeyStatus(a));case 2:g=s.sent;h=g.ts,i=g.rotateSenderKey,j=g.hasSenderKey;k=g.senderKeyId;l=k==null||i||!d("WATimeUtils").happenedWithin(h,n);if(!(l||k==null)){s.next=21;break}s.next=9;return b("regeneratorRuntime").awrap(d("WACryptoManager").rotateGroupSenderKey(e.cryptoManager,a,d("WAGlobals").getMyDeviceJid()));case 9:m=s.sent;k=m.senderKeyId;s.next=13;return b("regeneratorRuntime").awrap(d("WAGlobals").getDbImpls().markSenderKeyAsRotated(a,k,d("WATimeUtils").unixTime()));case 13:o=s.sent;if(o.success){s.next=16;break}throw c("WAErr")("markSenderKeyAsRotated failed with error "+o.error);case 16:f==null?void 0:f.addPoint("finish_sk_rotation");p=o.value.needsSenderKey;return s.abrupt("return",{senderKeyId:k,needsSenderKey:p,groupParticipants:p});case 21:s.next=23;return b("regeneratorRuntime").awrap(d("WAGetGroupParticipantDevicesApi").getGroupParticipantDevices(a));case 23:q=s.sent;if(!q.error){s.next=26;break}throw c("WAErr")(q.error);case 26:r=new Set(q.value.deviceJids);(j||[]).forEach(function(a){return r["delete"](a)});f==null?void 0:f.addPoint("no_sk_rotation",{"int":{noRotationNeedsSK:r.size}});return s.abrupt("return",{senderKeyId:k,needsSenderKey:r,groupParticipants:q.value.deviceJids});case 30:case"end":return s.stop()}},null,this)})}function a(a,c,e,f,g,n){var o,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J;return b("regeneratorRuntime").async(function(K){while(1)switch(K.prev=K.next){case 0:n==null?void 0:n.addPoint("enc_group_start");K.next=3;return b("regeneratorRuntime").awrap(p(a,g,n));case 3:o=K.sent;r=o.senderKeyId;s=o.needsSenderKey;t=o.groupParticipants;d("WALogger").LOG(m());n==null?void 0:n.addPoint("rotated_participant_info");u=null;x=c.flatMap(function(a){return a.devicesInfo}).map(function(a){return a.jid});y=!d("WASortedLists").areEqual(d("WASortedLists").asSortedSet(t),d("WASortedLists").sortAndDedupe(x));z=f.type==="text"&&f.isRevoked;A=f.type==="media"?d("WAProtocolMediaType").castToProtocolMediaType(f.mediaType):null;if(!(y||z)){K.next=23;break}K.next=17;return b("regeneratorRuntime").awrap(d("WAEncUserMsg").encryptGroupFanoutMsg(x,{type:"message",messageBytes:e,messageType:f,chat:a},g));case 17:B=K.sent;B&&!(f.type==="text"&&f.isInvisible===!0)&&(v=B,w={encType:"group",to:a,v:e.version==="v3"?"3":"2",type:"skmsg",mediaType:A,ciphertext:null});d("WALogger").LOG(l());n==null?void 0:n.addPoint("finish_group_fanout_msg");K.next=45;break;case 23:e.version==="v3"?(D=d("WAAsMessageTransport").asMessageTransport(e.bytes),C=d("encodeProtobuf").encodeProtobuf(d("WAMsgTransport.pb").MessageTransportSpec,D).readByteArray()):C=e.bytes;K.next=26;return b("regeneratorRuntime").awrap(d("WACryptoManagerUtils").encryptGroupContentWithMetrics(a,C,g));case 26:E=K.sent;d("WALogger").LOG(k());n==null?void 0:n.addPoint("finish_encrypt_group_content");if(!E.success){K.next=45;break}d("WALogger").LOG(j());F=E.value;r!==F.senderKeyId&&t.forEach(function(a){return s.add(a)});if(!(s.size>0)){K.next=43;break}G={groupId:a,axolotlSenderKeyDistributionMessage:d("WAHex").bytesToBuffer(F.senderKeyDistributionProto)};d("WALogger").LOG(i());H=x.filter(function(a){return s.has(a)});K.next=39;return b("regeneratorRuntime").awrap(q(H,G,g));case 39:I=K.sent,d("WALogger").LOG(h()),n==null?void 0:n.addPoint("finish_skdm_enc_node"),I.length>0&&(v=I,u={group:a,senderKeyId:F.senderKeyId,knowsSenderKey:new Set(H)});case 43:w={encType:"group",to:a,v:e.version==="v2"?"2":"3",type:F.ciphertext.type,mediaType:A,ciphertext:F.ciphertext.ciphertext},f.type==="text"&&f.isInvisible===!0&&(w={encType:"group",to:a,v:e.version==="v2"?"2":"3",type:"skmsg",mediaType:null,ciphertext:null});case 45:K.next=47;return b("regeneratorRuntime").awrap(d("WAPhash").calculatePHash(x.concat(d("WAGlobals").getMyDeviceJid())));case 47:J=K.sent;n==null?void 0:n.addPoint("phash_finish");return K.abrupt("return",{phash:J,participants:v,encNode:w,senderKeyDistributionInfo:u});case 50:case"end":return K.stop()}},null,this)}function q(a,b,c){b=d("WAAsMessageTransport").asMessageTransport(null,null,b,null);var e=d("encodeProtobuf").encodeProtobuf(d("WAMsgTransport.pb").MessageTransportSpec,b).readByteArray();return d("WACryptoManagerUtils").bulkEncrypt(new Map(a.map(function(a){return[a,{plaintext:e}]})),c).then(function(a){var b=[];a.forEach(function(a,c){b.push({encType:"device",to:c,v:"3",type:a.type,ciphertext:a.ciphertext,mediaType:null,count:null,baseKey:null})});return b})}g.encryptGroupMsg=a}),98);
__d("WAGetDeviceIdentityMixin",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a!=null?{deviceIdentityElementValue:a}:null}f.getDeviceIdentityMixin=a}),66);
__d("WAParseFranking",["WAFranking","WAFrankingTypes"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b;if(a==null)return null;b=(b=a.maybeChild("franking_tag"))==null?void 0:b.contentBytes();return{frankingKey:null,frankingTag:b!=null?d("WAFrankingTypes").castToFrankingTag(b):null,reportingTag:(b=a.maybeChild("reporting_tag"))==null?void 0:b.contentBytes(),frankingVersion:d("WAFranking").getFrankingVersion(),reportingContent:null}}g.parseFrankingNode=a}),98);
__d("WASmaxInMessagePublishAckAdminEditMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ack");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"edit","3");return!b.success?b:d("WAResultOrError").makeResult({edit:b.value})}g.parseAckAdminEditMixin=a}),98);
__d("WASmaxInMessagePublishAckAdminRevokeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ack");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"edit","8");return!b.success?b:d("WAResultOrError").makeResult({edit:b.value})}g.parseAckAdminRevokeMixin=a}),98);
__d("WASmaxInMessagePublishAckMessageEditMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ack");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"edit","1");return!b.success?b:d("WAResultOrError").makeResult({edit:b.value})}g.parseAckMessageEditMixin=a}),98);
__d("WASmaxInMessagePublishAckMessagePinMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ack");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"edit","2");return!b.success?b:d("WAResultOrError").makeResult({edit:b.value})}g.parseAckMessagePinMixin=a}),98);
__d("WASmaxInMessagePublishEnums",[],(function(a,b,c,d,e,f){a={CBP:"CBP",NBP:"NBP"};b={delivery:"delivery",no_optimization:"no_optimization"};c={"false":"false","true":"true"};d={lid:"lid",pn:"pn"};f.ENUM_CBP_NBP=a;f.ENUM_DELIVERY_NOOPTIMIZATION=b;f.ENUM_FALSE_TRUE=c;f.ENUM_LID_PN=d}),66);
__d("WASmaxInMessagePublishAckPaidConversationMixin",["WAResultOrError","WASmaxInMessagePublishEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"delivery_context");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"optimization_goal",d("WASmaxInMessagePublishEnums").ENUM_DELIVERY_NOOPTIMIZATION);return!b.success?b:d("WAResultOrError").makeResult({optimizationGoal:b.value})}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"source_url");if(!b.success)return b;b=d("WASmaxParseUtils").contentString(a);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}function j(a){var b=d("WASmaxParseUtils").assertTag(a,"referral");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"source_url",i);if(!b.success)return b;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"source_type");return!a.success?a:d("WAResultOrError").makeResult({sourceType:a.value,sourceUrl:b.value})}function k(a){var b=d("WASmaxParseUtils").assertTag(a,"origin");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"referral",j);if(!b.success)return b;a=d("WASmaxParseUtils").attrString(a,"type");return!a.success?a:d("WAResultOrError").makeResult({type:a.value,referral:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ack");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxParseUtils").optionalChildWithTag(b.value,"delivery_context",h);if(!a.success)return a;var c=d("WASmaxParseUtils").optionalChildWithTag(b.value,"origin",k);if(!c.success)return c;var e=d("WASmaxParseUtils").attrString(b.value,"paid_convo_id");if(!e.success)return e;var f=d("WASmaxParseUtils").attrStringEnum(b.value,"pricing_model",d("WASmaxInMessagePublishEnums").ENUM_CBP_NBP);if(!f.success)return f;var g=d("WASmaxParseUtils").attrStringEnum(b.value,"billable",d("WASmaxInMessagePublishEnums").ENUM_FALSE_TRUE);if(!g.success)return g;var i=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,b.value,"expiration_timestamp",0,void 0);if(!i.success)return i;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,b.value,"pricing_category");return!b.success?b:d("WAResultOrError").makeResult({bizPaidConvoId:e.value,bizPricingModel:f.value,bizBillable:g.value,bizExpirationTimestamp:i.value,bizPricingCategory:b.value,bizDeliveryContext:a.value,bizOrigin:c.value})}g.parseAckPaidConversationBizDeliveryContext=h;g.parseAckPaidConversationBizOriginReferralSourceUrl=i;g.parseAckPaidConversationBizOriginReferral=j;g.parseAckPaidConversationBizOrigin=k;g.parseAckPaidConversationMixin=a}),98);
__d("WASmaxInMessagePublishAckRevokeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ack");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"edit","7");return!b.success?b:d("WAResultOrError").makeResult({edit:b.value})}g.parseAckRevokeMixin=a}),98);
__d("WASmaxInMessagePublishServerFrankingTagMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"franking");if(!a.success)return a;a=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"reporting_tag");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytesRange(a.value,16,128);return!a.success?a:d("WAResultOrError").makeResult({frankingReportingTagElementValue:a.value})}g.parseServerFrankingTagMixin=a}),98);
__d("WASmaxInMessagePublishAckMixin",["WAResultOrError","WASmaxInMessagePublishAckAdminEditMixin","WASmaxInMessagePublishAckAdminRevokeMixin","WASmaxInMessagePublishAckMessageEditMixin","WASmaxInMessagePublishAckMessagePinMixin","WASmaxInMessagePublishAckPaidConversationMixin","WASmaxInMessagePublishAckRevokeMixin","WASmaxInMessagePublishServerFrankingTagMixin","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"ack");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"class","message");if(!c.success)return c;b=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",b.value);if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var e=d("WASmaxInMessagePublishAckMessageEditMixin").parseAckMessageEditMixin(a),f=d("WASmaxInMessagePublishAckAdminEditMixin").parseAckAdminEditMixin(a),g=d("WASmaxInMessagePublishAckMessagePinMixin").parseAckMessagePinMixin(a),h=d("WASmaxInMessagePublishAckAdminRevokeMixin").parseAckAdminRevokeMixin(a),i=d("WASmaxInMessagePublishAckRevokeMixin").parseAckRevokeMixin(a),j=d("WASmaxInMessagePublishAckPaidConversationMixin").parseAckPaidConversationMixin(a);a=d("WASmaxInMessagePublishServerFrankingTagMixin").parseServerFrankingTagMixin(a);return d("WAResultOrError").makeResult({"class":c.value,t:b.value,ackMessageEditMixin:e.success?e.value:null,ackAdminEditMixin:f.success?f.value:null,ackMessagePinMixin:g.success?g.value:null,ackAdminRevokeMixin:h.success?h.value:null,ackRevokeMixin:i.success?i.value:null,ackPaidConversationMixin:j.success?j.value:null,serverFrankingTagMixin:a.success?a.value:null})}g.parseAckMixin=a}),98);
__d("WASmaxInMessagePublishApplicationNegativeAckMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ack");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"application_error",0,void 0);return!b.success?b:d("WAResultOrError").makeResult({applicationError:b.value})}g.parseApplicationNegativeAckMixin=a}),98);
__d("WASmaxInMessagePublishMessageNackRetryAttributesMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ack");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"backoff",0,86400);return!b.success?b:d("WAResultOrError").makeResult({backoff:b.value})}g.parseMessageNackRetryAttributesMixin=a}),98);
__d("WASmaxInMessagePublishNegativeAckMixin",["WAResultOrError","WASmaxInMessagePublishAckMixin","WASmaxInMessagePublishApplicationNegativeAckMixin","WASmaxInMessagePublishMessageNackRetryAttributesMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"ack");if(!c.success)return c;c=d("WASmaxParseUtils").attrString(a,"error");if(!c.success)return c;b=d("WASmaxInMessagePublishAckMixin").parseAckMixin(a,b);if(!b.success)return b;var e=d("WASmaxInMessagePublishApplicationNegativeAckMixin").parseApplicationNegativeAckMixin(a);a=d("WASmaxInMessagePublishMessageNackRetryAttributesMixin").parseMessageNackRetryAttributesMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({error:c.value},b.value,{applicationNegativeAckMixin:e.success?e.value:null,messageNackRetryAttributesMixin:a.success?a.value:null}))}g.parseNegativeAckMixin=a}),98);
__d("WASmaxInMessagePublishIndividualResponseNegative",["WAResultOrError","WASmaxInMessagePublishNegativeAckMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"ack");if(!c.success)return c;c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"recipient");if(!c.success)return c;a=d("WASmaxInMessagePublishNegativeAckMixin").parseNegativeAckMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({recipient:c.value},a.value))}g.parseIndividualResponseNegative=a}),98);
__d("WASmaxInMessagePublishAckRcatMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ack");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"rcat");if(!b.success)return b;a=d("WASmaxParseUtils").contentBytes(b.value);return!a.success?a:d("WAResultOrError").makeResult({rcatElementValue:a.value})}g.parseAckRcatMixin=a}),98);
__d("WASmaxInMessagePublishDeviceListStaleMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ack");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"phash");return!b.success?b:d("WAResultOrError").makeResult({phash:b.value})}g.parseDeviceListStaleMixin=a}),98);
__d("WASmaxInMessagePublishIndividualResponseSuccess",["WAResultOrError","WASmaxInMessagePublishAckMixin","WASmaxInMessagePublishAckRcatMixin","WASmaxInMessagePublishDeviceListStaleMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"ack");if(!c.success)return c;c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"recipient");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"participant");if(!e.success)return e;b=d("WASmaxInMessagePublishAckMixin").parseAckMixin(a,b);if(!b.success)return b;var f=d("WASmaxInMessagePublishDeviceListStaleMixin").parseDeviceListStaleMixin(a);a=d("WASmaxInMessagePublishAckRcatMixin").parseAckRcatMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({recipient:c.value,participant:e.value},b.value,{deviceListStaleMixin:f.success?f.value:null,ackRcatMixin:a.success?a.value:null}))}g.parseIndividualResponseSuccess=a}),98);
__d("WASmaxOutMessagePublishAutomatedMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("automated",null));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeAutomatedMixin=a}),98);
__d("WASmaxOutMessagePublishAuthMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.authVerificationTimestamp;a=a.authEnableRiskCheck;b=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("biz",null,d("WASmaxJsx").smax("auth",{verification_timestamp:d("WASmaxAttrs").OPTIONAL(d("WAWap").INT,b),enable_risk_check:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a)})));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeAuthMixin=a}),98);
__d("WASmaxOutMessagePublishBizAcceptTsMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.bizAcceptTs;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("biz",{accept_ts:d("WAWap").INT(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBizAcceptTsMixin=a}),98);
__d("WASmaxOutMessagePublishBizAutoResponseMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.bizAutoResponse;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("biz",{auto_response:d("WAWap").CUSTOM_STRING(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBizAutoResponseMixin=a}),98);
__d("WASmaxOutMessagePublishBizCampaignMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.bizCampaignId;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("biz",{campaign_id:d("WAWap").CUSTOM_STRING(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBizCampaignMixin=a}),98);
__d("WASmaxOutMessagePublishBizRolesMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.bizHostStorage,c=a.bizActualActors;a=a.bizPrivacyModeTs;b=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("biz",{host_storage:d("WAWap").INT(b),actual_actors:d("WAWap").INT(c),privacy_mode_ts:d("WAWap").INT(a)}));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBizRolesMixin=a}),98);
__d("WASmaxOutMessagePublishButtonsMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("biz",null,d("WASmaxJsx").smax("buttons",null)));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeButtonsMixin=a}),98);
__d("WASmaxOutMessagePublishExtensionsMetadataMixin",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.capabilityArgs;a=d("WASmaxJsx").smax("capabilities",null,d("WASmaxChildren").REPEATED_CHILD(i,a,1,50));return a}function i(a){a=a.capabilityName;a=d("WASmaxJsx").smax("capability",{name:d("WAWap").CUSTOM_STRING(a)});return a}function j(a){var b=a.capabilitiesArgs,c=a.extensionsMetadataWellVersion,e=a.extensionsMetadataDataApiVersion;a=a.extensionsMetadataFlowMessageVersion;c=d("WASmaxJsx").smax("native_flow",null,d("WASmaxJsx").smax("extensions_metadata",{well_version:d("WASmaxAttrs").OPTIONAL(d("WAWap").INT,c),data_api_version:d("WASmaxAttrs").OPTIONAL(d("WAWap").INT,e),flow_message_version:d("WAWap").INT(a)},d("WASmaxChildren").OPTIONAL_CHILD(h,b)));return c}function a(a,b){b=j(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeExtensionsMetadataExtensionsMetadataCapabilities=h;g.makeExtensionsMetadataExtensionsMetadataCapabilitiesCapability=i;g.mergeExtensionsMetadataMixin=a}),98);
__d("WASmaxOutMessagePublishNativeFlowMessageTypeMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishExtensionsMetadataMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.nativeFlowName,c=a.nativeFlowV;a=a.extensionsMetadataMixinArgs;b=d("WASmaxJsx").smax("interactive",{type:"native_flow"},d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishExtensionsMetadataMixin").mergeExtensionsMetadataMixin,d("WASmaxJsx").smax("native_flow",{name:d("WAWap").CUSTOM_STRING(b),v:d("WASmaxAttrs").OPTIONAL(d("WAWap").INT,c)}),a));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNativeFlowMessageTypeMixin=a}),98);
__d("WASmaxOutMessagePublishInteractiveMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishNativeFlowMessageTypeMixin"],(function(a,b,c,d,e,f,g){function h(a){var b=a.hasInteractiveV1;a=a.nativeFlowMessageTypeMixinArgs;b=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("biz",null,d("WASmaxOutMessagePublishNativeFlowMessageTypeMixin").mergeNativeFlowMessageTypeMixin(d("WASmaxJsx").smax("interactive",{v:d("WASmaxAttrs").OPTIONAL_LITERAL("1",b)}),a)));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeInteractiveMixin=a}),98);
__d("WASmaxOutMessagePublishNativeFlowMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.bizNativeFlowName;a=a.bizNativeFlowVersion;b=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("biz",{native_flow_name:d("WAWap").CUSTOM_STRING(b),native_flow_version:d("WASmaxAttrs").OPTIONAL(d("WAWap").INT,a)}));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNativeFlowMixin=a}),98);
__d("WASmaxOutMessagePublishButtonsOrNativeFlowOrInteractiveMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishButtonsMixin","WASmaxOutMessagePublishInteractiveMixin","WASmaxOutMessagePublishNativeFlowMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.isButtons)return d("WASmaxOutMessagePublishButtonsMixin").mergeButtonsMixin(a);if(b.nativeFlow)return d("WASmaxOutMessagePublishNativeFlowMixin").mergeNativeFlowMixin(a,b.nativeFlow);if(b.interactive)return d("WASmaxOutMessagePublishInteractiveMixin").mergeInteractiveMixin(a,b.interactive);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeButtonsOrNativeFlowOrInteractiveMixinGroup=a}),98);
__d("WASmaxOutMessagePublishConversionRecipientStatusMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.conversionRecipientStatus;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("conversion",{recipient_status:d("WAWap").CUSTOM_STRING(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeConversionRecipientStatusMixin=a}),98);
__d("WASmaxOutMessagePublishClickToWhatsAppTypeMixin",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.sourceUrlElementValue;a=d("WASmaxJsx").smax("source_url",null,a);return a}function i(a){var b,c,e=a.sourceUrlArgs,f=a.ctwaConversionSource,g=a.ctwaConversionData,i=a.ctwaSourceType,j=a.ctwaEntryPointConversionSource;a=a.ctwaEntryPointConversionApp;f=d("WASmaxJsx").smax("ctwa",{conversion_source:(b=d("WASmaxAttrs")).OPTIONAL((c=d("WAWap")).CUSTOM_STRING,f),conversion_data:b.OPTIONAL(c.CUSTOM_STRING,g),source_type:b.OPTIONAL(c.CUSTOM_STRING,i),entry_point_conversion_source:b.OPTIONAL(c.CUSTOM_STRING,j),entry_point_conversion_app:b.OPTIONAL(c.CUSTOM_STRING,a)},d("WASmaxChildren").OPTIONAL_CHILD(h,e));return f}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeClickToWhatsAppTypeSourceUrl=h;g.mergeClickToWhatsAppTypeMixin=a}),98);
__d("WASmaxOutMessagePublishCtwaConversionMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishClickToWhatsAppTypeMixin"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxOutMessagePublishClickToWhatsAppTypeMixin").mergeClickToWhatsAppTypeMixin(d("WASmaxJsx").smax("ctwa",null),a);return a}function i(a){a=a.ctwaArgs;a=d("WASmaxJsx").smax("message",null,d("WASmaxChildren").OPTIONAL_CHILD(h,a));return a}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeCtwaConversionCtwa=h;g.mergeCtwaConversionMixin=a}),98);
__d("WASmaxOutMessagePublishDeliveryContextMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b,c,e=a.deliveryContextHsmMaxBid,f=a.deliveryContextOptimizationGoal,g=a.deliveryContextTemplateId,h=a.deliveryContextCampaignId,i=a.deliveryContextSourceType,j=a.deliveryContextTierType,k=a.deliveryContextDeliveryType,l=a.deliveryContextClientToken;a=a.deliveryContextPrice;e=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("biz",null,d("WASmaxJsx").smax("delivery_context",{hsm_max_bid:(b=d("WASmaxAttrs")).OPTIONAL((c=d("WAWap")).INT,e),optimization_goal:b.OPTIONAL(c.CUSTOM_STRING,f),template_id:b.OPTIONAL(c.CUSTOM_STRING,g),campaign_id:b.OPTIONAL(c.CUSTOM_STRING,h),source_type:b.OPTIONAL(c.CUSTOM_STRING,i),tier_type:b.OPTIONAL(c.CUSTOM_STRING,j),delivery_type:b.OPTIONAL(c.CUSTOM_STRING,k),client_token:b.OPTIONAL(c.CUSTOM_STRING,l),price:b.OPTIONAL(c.INT,a)})));return e}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeDeliveryContextMixin=a}),98);
__d("WASmaxOutMessagePublishCapabilitiesMixin",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.hasFeatureV1;a=d("WASmaxJsx").smax("feature",{name:"full_catalog",v:d("WASmaxAttrs").OPTIONAL_LITERAL("1",a)});return a}function i(a){a=a.featureArgs;a=d("WASmaxJsx").smax("hsm",null,d("WASmaxJsx").smax("capabilities",null,d("WASmaxChildren").OPTIONAL_CHILD(h,a)));return a}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeCapabilitiesCapabilitiesFeature=h;g.mergeCapabilitiesMixin=a}),98);
__d("WASmaxOutMessagePublishHSMReviewMetadataMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b,c,e=a.anyCategory,f=a.anyTag,g=a.anyId;a=a.anySubTag;e=d("WASmaxJsx").smax("smax$any",{category:(b=d("WASmaxAttrs")).OPTIONAL((c=d("WAWap")).CUSTOM_STRING,e),tag:b.OPTIONAL(c.CUSTOM_STRING,f),id:b.OPTIONAL(c.CUSTOM_STRING,g),sub_tag:b.OPTIONAL(c.CUSTOM_STRING,a)});return e}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeHSMReviewMetadataMixin=a}),98);
__d("WASmaxOutMessagePublishHsmMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishCapabilitiesMixin","WASmaxOutMessagePublishHSMReviewMetadataMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.messageTtl,c=a.hasHsmV1,e=a.hasHsmButtons1,f=a.hSMReviewMetadataMixinArgs;a=a.capabilitiesMixinArgs;b=d("WASmaxJsx").smax("message",{ttl:d("WASmaxAttrs").OPTIONAL(d("WAWap").INT,b)},d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishCapabilitiesMixin").mergeCapabilitiesMixin,d("WASmaxOutMessagePublishHSMReviewMetadataMixin").mergeHSMReviewMetadataMixin(d("WASmaxJsx").smax("hsm",{v:d("WASmaxAttrs").OPTIONAL_LITERAL("1",c),buttons:d("WASmaxAttrs").OPTIONAL_LITERAL("1",e)}),f),a));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeHsmMixin=a}),98);
__d("WASmaxOutMessagePublishBizMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishAuthMixin","WASmaxOutMessagePublishBizAcceptTsMixin","WASmaxOutMessagePublishBizAutoResponseMixin","WASmaxOutMessagePublishBizCampaignMixin","WASmaxOutMessagePublishBizRolesMixin","WASmaxOutMessagePublishButtonsOrNativeFlowOrInteractiveMixinGroup","WASmaxOutMessagePublishConversionRecipientStatusMixin","WASmaxOutMessagePublishCtwaConversionMixin","WASmaxOutMessagePublishDeliveryContextMixin","WASmaxOutMessagePublishHsmMixin"],(function(a,b,c,d,e,f,g){function h(a){var b,c=a.hsmMixinArgs,e=a.bizRolesMixinArgs,f=a.bizAutoResponseMixinArgs,g=a.bizAcceptTsMixinArgs,h=a.bizCampaignMixinArgs,i=a.deliveryContextMixinArgs,j=a.authMixinArgs,k=a.conversionRecipientStatusMixinArgs,l=a.ctwaConversionMixinArgs;a=a.buttonsOrNativeFlowOrInteractiveMixinGroupArgs;b=(b=d("WASmaxMixins")).optionalMerge(d("WASmaxOutMessagePublishButtonsOrNativeFlowOrInteractiveMixinGroup").mergeButtonsOrNativeFlowOrInteractiveMixinGroup,b.optionalMerge(d("WASmaxOutMessagePublishCtwaConversionMixin").mergeCtwaConversionMixin,b.optionalMerge(d("WASmaxOutMessagePublishConversionRecipientStatusMixin").mergeConversionRecipientStatusMixin,b.optionalMerge(d("WASmaxOutMessagePublishAuthMixin").mergeAuthMixin,b.optionalMerge(d("WASmaxOutMessagePublishDeliveryContextMixin").mergeDeliveryContextMixin,b.optionalMerge(d("WASmaxOutMessagePublishBizCampaignMixin").mergeBizCampaignMixin,b.optionalMerge(d("WASmaxOutMessagePublishBizAcceptTsMixin").mergeBizAcceptTsMixin,b.optionalMerge(d("WASmaxOutMessagePublishBizAutoResponseMixin").mergeBizAutoResponseMixin,b.optionalMerge(d("WASmaxOutMessagePublishBizRolesMixin").mergeBizRolesMixin,b.optionalMerge(d("WASmaxOutMessagePublishHsmMixin").mergeHsmMixin,d("WASmaxJsx").smax("message",null),c),e),f),g),h),i),j),k),l),a);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBizMixin=a}),98);
__d("WASmaxOutMessagePublishClientFrankingTagMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.frankingTagElementValue;a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("franking",null,d("WASmaxJsx").smax("franking_tag",null,a)));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeClientFrankingTagMixin=a}),98);
__d("WASmaxOutMessagePublishClientReportingTokenMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.reportingTokenElementValue;a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("reporting",null,d("WASmaxJsx").smax("reporting_token",null,a)));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeClientReportingTokenMixin=a}),98);
__d("WASmaxOutMessagePublishDeviceIdentityMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.deviceIdentityElementValue;a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("device-identity",null,a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeDeviceIdentityMixin=a}),98);
__d("WASmaxOutMessagePublishInternalTestMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.testConfig;a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("test",{config:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeInternalTestMixin=a}),98);
__d("WASmaxOutMessagePublishMetaHideDecryptionPlaceholderMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("meta",{"decrypt-fail":"hide"}));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeMetaHideDecryptionPlaceholderMixin=a}),98);
__d("WASmaxOutMessagePublishMulticastMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("multicast",null));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeMulticastMixin=a}),98);
__d("WASmaxOutMessagePublishNoExtraFanoutMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",{device_fanout:"false"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNoExtraFanoutMixin=a}),98);
__d("WASmaxOutMessagePublishPreFilledNumberMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("url_number",null));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePreFilledNumberMixin=a}),98);
__d("WASmaxOutMessagePublishPreFilledTextMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("url_text",null));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePreFilledTextMixin=a}),98);
__d("WASmaxOutMessagePublishSenderIntentMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("meta",{sender_intent:"hosted"}));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeSenderIntentMixin=a}),98);
__d("WASmaxOutMessagePublishRequestIDMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.requestIdElementValue;a=d("WASmaxJsx").smax("trace",null,d("WASmaxJsx").smax("request_id",null,a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeRequestIDMixin=a}),98);
__d("WASmaxOutMessagePublishTraceIDMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.edgeIdElementValue;a=d("WASmaxJsx").smax("edge_id",null,a);return a}function i(a){var b=a.edgeIdArgs;a=a.traceIdElementValue;a=d("WASmaxJsx").smax("trace",null,d("WASmaxJsx").smax("trace_id",null,a),d("WASmaxChildren").OPTIONAL_CHILD(h,b));return a}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeTraceIDEdgeId=h;g.mergeTraceIDMixin=a}),98);
__d("WASmaxOutMessagePublishRequestOrTraceIDMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishRequestIDMixin","WASmaxOutMessagePublishTraceIDMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.requestID)return d("WASmaxOutMessagePublishRequestIDMixin").mergeRequestIDMixin(a,b.requestID);if(b.traceID)return d("WASmaxOutMessagePublishTraceIDMixin").mergeTraceIDMixin(a,b.traceID);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeRequestOrTraceIDMixinGroup=a}),98);
__d("WASmaxOutMessagePublishTraceContextMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishRequestOrTraceIDMixinGroup"],(function(a,b,c,d,e,f,g){function h(a){a=a.requestOrTraceIDMixinGroupArgs;a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxOutMessagePublishRequestOrTraceIDMixinGroup").mergeRequestOrTraceIDMixinGroup(d("WASmaxJsx").smax("trace",null),a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeTraceContextMixin=a}),98);
__d("WASmaxOutMessagePublishVerifiedNameNameMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.messageVerifiedName;a=d("WASmaxJsx").smax("message",{verified_name:d("WAWap").CUSTOM_STRING(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeVerifiedNameNameMixin=a}),98);
__d("WASmaxOutMessagePublishBaseMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishAutomatedMixin","WASmaxOutMessagePublishBizMixin","WASmaxOutMessagePublishClientFrankingTagMixin","WASmaxOutMessagePublishClientReportingTokenMixin","WASmaxOutMessagePublishDeviceIdentityMixin","WASmaxOutMessagePublishInternalTestMixin","WASmaxOutMessagePublishMetaHideDecryptionPlaceholderMixin","WASmaxOutMessagePublishMulticastMixin","WASmaxOutMessagePublishNoExtraFanoutMixin","WASmaxOutMessagePublishPreFilledNumberMixin","WASmaxOutMessagePublishPreFilledTextMixin","WASmaxOutMessagePublishSenderIntentMixin","WASmaxOutMessagePublishTraceContextMixin","WASmaxOutMessagePublishVerifiedNameNameMixin"],(function(a,b,c,d,e,f,g){function h(a){var b,c=a.deviceIdentityMixinArgs,e=a.hasNoExtraFanout,f=a.hasMulticast,g=a.hasPreFilledText,h=a.hasPreFilledNumber,i=a.hasAutomated,j=a.bizMixinArgs,k=a.verifiedNameNameMixinArgs,l=a.clientFrankingTagMixinArgs,m=a.clientReportingTokenMixinArgs,n=a.internalTestMixinArgs,o=a.hasMetaHideDecryptionPlaceholder,p=a.traceContextMixinArgs;a=a.hasSenderIntent;b=(b=d("WASmaxMixins")).optionalMerge(d("WASmaxOutMessagePublishSenderIntentMixin").mergeSenderIntentMixin,b.optionalMerge(d("WASmaxOutMessagePublishTraceContextMixin").mergeTraceContextMixin,b.optionalMerge(d("WASmaxOutMessagePublishMetaHideDecryptionPlaceholderMixin").mergeMetaHideDecryptionPlaceholderMixin,b.optionalMerge(d("WASmaxOutMessagePublishInternalTestMixin").mergeInternalTestMixin,b.optionalMerge(d("WASmaxOutMessagePublishClientReportingTokenMixin").mergeClientReportingTokenMixin,b.optionalMerge(d("WASmaxOutMessagePublishClientFrankingTagMixin").mergeClientFrankingTagMixin,b.optionalMerge(d("WASmaxOutMessagePublishVerifiedNameNameMixin").mergeVerifiedNameNameMixin,b.optionalMerge(d("WASmaxOutMessagePublishBizMixin").mergeBizMixin,b.optionalMerge(d("WASmaxOutMessagePublishAutomatedMixin").mergeAutomatedMixin,b.optionalMerge(d("WASmaxOutMessagePublishPreFilledNumberMixin").mergePreFilledNumberMixin,b.optionalMerge(d("WASmaxOutMessagePublishPreFilledTextMixin").mergePreFilledTextMixin,b.optionalMerge(d("WASmaxOutMessagePublishMulticastMixin").mergeMulticastMixin,b.optionalMerge(d("WASmaxOutMessagePublishNoExtraFanoutMixin").mergeNoExtraFanoutMixin,b.optionalMerge(d("WASmaxOutMessagePublishDeviceIdentityMixin").mergeDeviceIdentityMixin,d("WASmaxJsx").smax("message",null),c),e),f),g),h),i),j),k),l),m),n),o),p),a);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseMixin=a}),98);
__d("WASmaxOutMessagePublishGroupInviteTargetMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.metaGroupInvite;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("meta",{group_invite:d("WAWap").GROUP_JID(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeGroupInviteTargetMixin=a}),98);
__d("WASmaxOutMessagePublishBotFeedbackMessageTypeMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("bot",{type:"feedback"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBotFeedbackMessageTypeMixin=a}),98);
__d("WASmaxOutMessagePublishEncRetryMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.encCount;a=d("WASmaxJsx").smax("enc",{count:d("WAWap").INT(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEncRetryMixin=a}),98);
__d("WASmaxOutMessagePublishEncPayloadMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.encElementValue;a=d("WASmaxJsx").smax("enc",null,a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEncPayloadMixin=a}),98);
__d("WASmaxOutMessagePublishEncTypeIndividualMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishEncPayloadMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.encType;b=d("WASmaxOutMessagePublishEncPayloadMixin").mergeEncPayloadMixin(d("WASmaxJsx").smax("enc",{type:d("WAWap").CUSTOM_STRING(b)}),a);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEncTypeIndividualMixin=a}),98);
__d("WASmaxOutMessagePublishEncVersion2Mixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("enc",{v:"2"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEncVersion2Mixin=a}),98);
__d("WASmaxOutMessagePublishEncVersionFutureproofMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.encV;a=d("WASmaxJsx").smax("enc",{v:d("WAWap").INT(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEncVersionFutureproofMixin=a}),98);
__d("WASmaxOutMessagePublishEncVersion2OrFutureproofMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishEncVersion2Mixin","WASmaxOutMessagePublishEncVersionFutureproofMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.isEncVersion2)return d("WASmaxOutMessagePublishEncVersion2Mixin").mergeEncVersion2Mixin(a);if(b.encVersionFutureproof)return d("WASmaxOutMessagePublishEncVersionFutureproofMixin").mergeEncVersionFutureproofMixin(a,b.encVersionFutureproof);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeEncVersion2OrFutureproofMixinGroup=a}),98);
__d("WASmaxOutMessagePublishMediaTypeMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.encMediatype;a=d("WASmaxJsx").smax("enc",{mediatype:d("WAWap").CUSTOM_STRING(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeMediaTypeMixin=a}),98);
__d("WASmaxOutMessagePublishBotRequestMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishEncRetryMixin","WASmaxOutMessagePublishEncTypeIndividualMixin","WASmaxOutMessagePublishEncVersion2OrFutureproofMixinGroup","WASmaxOutMessagePublishMediaTypeMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.toJid,c=a.encRetryMixinArgs,e=a.encTypeIndividualMixinArgs,f=a.mediaTypeMixinArgs;a=a.encVersion2OrFutureproofMixinGroupArgs;b=d("WASmaxJsx").smax("to",{jid:d("WAWap").JID(b)},d("WASmaxOutMessagePublishEncVersion2OrFutureproofMixinGroup").mergeEncVersion2OrFutureproofMixinGroup(d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishMediaTypeMixin").mergeMediaTypeMixin,d("WASmaxOutMessagePublishEncTypeIndividualMixin").mergeEncTypeIndividualMixin(d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishEncRetryMixin").mergeEncRetryMixin,d("WASmaxJsx").smax("enc",null),c),e),f),a));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBotRequestMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypeMediaMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",{type:"media"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeContentTypeMediaMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypeTextMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",{type:"text"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeContentTypeTextMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypeTextOrMediaMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishContentTypeMediaMixin","WASmaxOutMessagePublishContentTypeTextMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.isContentTypeText)return d("WASmaxOutMessagePublishContentTypeTextMixin").mergeContentTypeTextMixin(a);if(b.isContentTypeMedia)return d("WASmaxOutMessagePublishContentTypeMediaMixin").mergeContentTypeMediaMixin(a);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeContentTypeTextOrMediaMixinGroup=a}),98);
__d("WASmaxOutMessagePublishBotLocalAutomatedTypeMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.botLocalAutomatedType;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("bot",{local_automated_type:d("WAWap").CUSTOM_STRING(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBotLocalAutomatedTypeMixin=a}),98);
__d("WASmaxOutMessagePublishBotMessageTypeMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.botType;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("bot",{type:d("WAWap").CUSTOM_STRING(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBotMessageTypeMixin=a}),98);
__d("WASmaxOutMessagePublishBusinessBotMessageMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.botBizBot;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("bot",{biz_bot:d("WAWap").CUSTOM_STRING(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBusinessBotMessageMixin=a}),98);
__d("WASmaxOutMessagePublishProductListMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("biz",null,d("WASmaxJsx").smax("list",{type:"product_list"})));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeProductListMixin=a}),98);
__d("WASmaxOutMessagePublishSingleSelectListMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.listV;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("biz",null,d("WASmaxJsx").smax("list",{type:"single_select",v:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a)})));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeSingleSelectListMixin=a}),98);
__d("WASmaxOutMessagePublishSingleSelectOrProductListMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishProductListMixin","WASmaxOutMessagePublishSingleSelectListMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.singleSelectList)return d("WASmaxOutMessagePublishSingleSelectListMixin").mergeSingleSelectListMixin(a,b.singleSelectList);if(b.isProductList)return d("WASmaxOutMessagePublishProductListMixin").mergeProductListMixin(a);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeSingleSelectOrProductListMixinGroup=a}),98);
__d("WASmaxOutMessagePublishContentTypeListFanoutMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeMediaMixin","WASmaxOutMessagePublishSingleSelectOrProductListMixinGroup"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("to",null,d("WASmaxJsx").smax("enc",{mediatype:"list"}));return a}function i(a){var b=a.toCount;a=a.singleSelectOrProductListMixinGroupArgs;b=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishSingleSelectOrProductListMixinGroup").mergeSingleSelectOrProductListMixinGroup,d("WASmaxOutMessagePublishContentTypeMediaMixin").mergeContentTypeMediaMixin(d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("participants",null,d("WASmaxChildren").HOMOGENEOUS_CHILD_COUNT(h,b)))),a);return b}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeContentTypeListFanoutParticipantsTo=h;g.mergeContentTypeListFanoutMixin=a}),98);
__d("WASmaxOutMessagePublishLiveLocationModeMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.metaLivelocMode;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("meta",{liveloc_mode:d("WAWap").CUSTOM_STRING(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeLiveLocationModeMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypeLiveLocationFanoutDeprecatedMixin",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeMediaMixin","WASmaxOutMessagePublishLiveLocationModeMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.encDuration;a=d("WASmaxJsx").smax("to",null,d("WASmaxJsx").smax("enc",{mediatype:"livelocation",duration:d("WASmaxAttrs").OPTIONAL(d("WAWap").INT,a)}));return a}function i(a){var b=a.toArgs;a=a.liveLocationModeMixinArgs;b=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishLiveLocationModeMixin").mergeLiveLocationModeMixin,d("WASmaxOutMessagePublishContentTypeMediaMixin").mergeContentTypeMediaMixin(d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("participants",null,d("WASmaxChildren").HOMOGENEOUS_CHILD(h,b)))),a);return b}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeContentTypeLiveLocationFanoutDeprecatedParticipantsTo=h;g.mergeContentTypeLiveLocationFanoutDeprecatedMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypeLiveLocationFanoutMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeMediaMixin","WASmaxOutMessagePublishLiveLocationModeMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.encDuration;a=d("WASmaxJsx").smax("to",null,d("WASmaxJsx").smax("enc",{mediatype:"livelocation",duration:d("WAWap").INT(a)}));return a}function i(a){var b=a.toArgs;a=a.liveLocationModeMixinArgs;b=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishLiveLocationModeMixin").mergeLiveLocationModeMixin,d("WASmaxOutMessagePublishContentTypeMediaMixin").mergeContentTypeMediaMixin(d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("participants",null,d("WASmaxChildren").HOMOGENEOUS_CHILD(h,b)))),a);return b}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeContentTypeLiveLocationFanoutParticipantsTo=h;g.mergeContentTypeLiveLocationFanoutMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypeMedianotifyMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",{type:"medianotify"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeContentTypeMedianotifyMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypeMediaOrMedianotifyMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishContentTypeMediaMixin","WASmaxOutMessagePublishContentTypeMedianotifyMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.isContentTypeMedia)return d("WASmaxOutMessagePublishContentTypeMediaMixin").mergeContentTypeMediaMixin(a);if(b.isContentTypeMedianotify)return d("WASmaxOutMessagePublishContentTypeMedianotifyMixin").mergeContentTypeMedianotifyMixin(a);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeContentTypeMediaOrMedianotifyMixinGroup=a}),98);
__d("WASmaxOutMessagePublishSenderContentBindingMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.senderContentBindingElementValue;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("sender_content_binding",null,a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeSenderContentBindingMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypeMediaFanoutDeprecatedMixin",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeMediaOrMedianotifyMixinGroup","WASmaxOutMessagePublishSenderContentBindingMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.encMediatype,c=a.hasEncStickerTypeAvatar;a=a.encNativeFlowName;b=d("WASmaxJsx").smax("to",null,d("WASmaxJsx").smax("enc",{mediatype:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,b),sticker_type:d("WASmaxAttrs").OPTIONAL_LITERAL("avatar",c),native_flow_name:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a)}));return b}function i(a){var b=a.toArgs,c=a.senderContentBindingMixinArgs;a=a.contentTypeMediaOrMedianotifyMixinGroupArgs;b=d("WASmaxOutMessagePublishContentTypeMediaOrMedianotifyMixinGroup").mergeContentTypeMediaOrMedianotifyMixinGroup(d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishSenderContentBindingMixin").mergeSenderContentBindingMixin,d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("participants",null,d("WASmaxChildren").HOMOGENEOUS_CHILD(h,b))),c),a);return b}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeContentTypeMediaFanoutDeprecatedParticipantsTo=h;g.mergeContentTypeMediaFanoutDeprecatedMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypeMediaFanoutMixin",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeMediaOrMedianotifyMixinGroup","WASmaxOutMessagePublishSenderContentBindingMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.encMediatype,c=a.hasEncStickerTypeAvatar;a=a.encNativeFlowName;b=d("WASmaxJsx").smax("to",null,d("WASmaxJsx").smax("enc",{mediatype:d("WAWap").CUSTOM_STRING(b),sticker_type:d("WASmaxAttrs").OPTIONAL_LITERAL("avatar",c),native_flow_name:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a)}));return b}function i(a){var b=a.toArgs,c=a.senderContentBindingMixinArgs;a=a.contentTypeMediaOrMedianotifyMixinGroupArgs;b=d("WASmaxOutMessagePublishContentTypeMediaOrMedianotifyMixinGroup").mergeContentTypeMediaOrMedianotifyMixinGroup(d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishSenderContentBindingMixin").mergeSenderContentBindingMixin,d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("participants",null,d("WASmaxChildren").HOMOGENEOUS_CHILD(h,b))),c),a);return b}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeContentTypeMediaFanoutParticipantsTo=h;g.mergeContentTypeMediaFanoutMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypePollCreationMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",{type:"poll"},d("WASmaxJsx").smax("meta",{polltype:"creation"}));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeContentTypePollCreationMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypePollVoteMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",{type:"poll"},d("WASmaxJsx").smax("meta",{polltype:"vote"}));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeContentTypePollVoteMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypeReactionMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",{type:"reaction"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeContentTypeReactionMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypePayMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",{type:"pay"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeContentTypePayMixin=a}),98);
__d("WASmaxOutMessagePublishPayNodeTypeMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.payType;a=d("WASmaxJsx").smax("pay",{type:d("WAWap").CUSTOM_STRING(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePayNodeTypeMixin=a}),98);
__d("WASmaxOutMessagePublishBasePayNodeMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishPayNodeTypeMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.payCountry,c=a.payVersion,e=a.payIsFirstSend;b=d("WASmaxOutMessagePublishPayNodeTypeMixin").mergePayNodeTypeMixin(d("WASmaxJsx").smax("pay",{country:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,b),version:d("WAWap").INT(c),is_first_send:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,e)}),a);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBasePayNodeMixin=a}),98);
__d("WASmaxOutMessagePublishLegacyAmountMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.payCurrency;a=a.payAmount;b=d("WASmaxJsx").smax("pay",{currency:d("WAWap").CUSTOM_STRING(b),amount:d("WAWap").CUSTOM_STRING(a)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeLegacyAmountMixin=a}),98);
__d("WASmaxOutMessagePublishMoneyMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.moneyValue,c=a.moneyOffset;a=a.moneyCurrency;b=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("money",{value:d("WAWap").CUSTOM_STRING(b),offset:d("WAWap").CUSTOM_STRING(c),currency:d("WAWap").CUSTOM_STRING(a)}));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeMoneyMixin=a}),98);
__d("WASmaxOutMessagePublishBaseIndividualPublishSendPayNodeMixin",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishBasePayNodeMixin","WASmaxOutMessagePublishLegacyAmountMixin","WASmaxOutMessagePublishMoneyMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxOutMessagePublishMoneyMixin").mergeMoneyMixin(d("WASmaxJsx").smax("amount",null),a);return a}function i(a){var b=a.amountArgs,c=a.payCredentialId,e=a.payDeviceId,f=a.payRequestId,g=a.legacyAmountMixinArgs;c=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishLegacyAmountMixin").mergeLegacyAmountMixin,d("WASmaxOutMessagePublishBasePayNodeMixin").mergeBasePayNodeMixin(d("WASmaxJsx").smax("pay",{"credential-id":d("WAWap").CUSTOM_STRING(c),"device-id":d("WAWap").CUSTOM_STRING(e),"request-id":d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,f)},d("WASmaxChildren").OPTIONAL_CHILD(h,b)),a),g);return c}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeBaseIndividualPublishSendPayNodeAmount=h;g.mergeBaseIndividualPublishSendPayNodeMixin=a}),98);
__d("WASmaxOutMessagePublishInstallmentMixin",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishMoneyMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxOutMessagePublishMoneyMixin").mergeMoneyMixin(d("WASmaxJsx").smax("due_amount",null),a);return a}function i(a){a=d("WASmaxOutMessagePublishMoneyMixin").mergeMoneyMixin(d("WASmaxJsx").smax("interest",null),a);return a}function j(a){var b=a.dueAmountArgs,c=a.interestArgs,e=a.installmentMaxCount;a=a.installmentSelectedCount;e=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("installment",{max_count:d("WASmaxAttrs").OPTIONAL(d("WAWap").INT,e),selected_count:d("WAWap").INT(a)},d("WASmaxChildren").OPTIONAL_CHILD(h,b),d("WASmaxChildren").OPTIONAL_CHILD(i,c)));return e}function a(a,b){b=j(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeInstallmentInstallmentDueAmount=h;g.makeInstallmentInstallmentInterest=i;g.mergeInstallmentMixin=a}),98);
__d("WASmaxOutMessagePublishBeneficiaryMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b,c=a.beneficiaryName,e=a.beneficiaryAddressLine1,f=a.beneficiaryAddressLine2,g=a.beneficiaryCity,h=a.beneficiaryState,i=a.beneficiaryCountry;a=a.beneficiaryPostalCode;c=d("WASmaxJsx").smax("beneficiary",{name:(b=d("WAWap")).CUSTOM_STRING(c),address_line1:b.CUSTOM_STRING(e),address_line2:d("WASmaxAttrs").OPTIONAL(b.CUSTOM_STRING,f),city:d("WASmaxAttrs").OPTIONAL(b.CUSTOM_STRING,g),state:d("WASmaxAttrs").OPTIONAL(b.CUSTOM_STRING,h),country:b.CUSTOM_STRING(i),postal_code:b.CUSTOM_STRING(a)});return c}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBeneficiaryMixin=a}),98);
__d("WASmaxOutMessagePublishBeneficiariesMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishBeneficiaryMixin"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxOutMessagePublishBeneficiaryMixin").mergeBeneficiaryMixin(d("WASmaxJsx").smax("beneficiary",null),a);return a}function i(a){a=a.beneficiaryArgs;a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxChildren").REPEATED_CHILD(h,a,1,5));return a}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeBeneficiariesBeneficiary=h;g.mergeBeneficiariesMixin=a}),98);
__d("WASmaxOutMessagePublishOrderInPaymentMixin",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishBeneficiariesMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxOutMessagePublishBeneficiariesMixin").mergeBeneficiariesMixin(d("WASmaxJsx").smax("beneficiaries",null),a);return a}function i(a){var b,c=a.beneficiariesArgs,e=a.orderId,f=a.orderMessageId,g=a.orderPaymentConfigId;a=a.orderType;e=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("order",{id:(b=d("WAWap")).CUSTOM_STRING(e),message_id:d("WASmaxAttrs").OPTIONAL(b.STANZA_ID,f),payment_config_id:d("WASmaxAttrs").OPTIONAL(b.CUSTOM_STRING,g),type:d("WASmaxAttrs").OPTIONAL(b.CUSTOM_STRING,a)},d("WASmaxChildren").OPTIONAL_CHILD(h,c)));return e}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeOrderInPaymentOrderBeneficiaries=h;g.mergeOrderInPaymentMixin=a}),98);
__d("WASmaxOutMessagePublishPaymentInitiatorMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.anyPaymentInitiator;a=d("WASmaxJsx").smax("smax$any",{payment_initiator:d("WAWap").CUSTOM_STRING(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePaymentInitiatorMixin=a}),98);
__d("WASmaxOutMessagePublishBRPublishSendPayNodeP2MMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishInstallmentMixin","WASmaxOutMessagePublishOrderInPaymentMixin","WASmaxOutMessagePublishPaymentInitiatorMixin"],(function(a,b,c,d,e,f,g){function h(a){var b=a.orderInPaymentMixinArgs,c=a.paymentInitiatorMixinArgs;a=a.installmentMixinArgs;b=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishInstallmentMixin").mergeInstallmentMixin,d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishPaymentInitiatorMixin").mergePaymentInitiatorMixin,d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishOrderInPaymentMixin").mergeOrderInPaymentMixin,d("WASmaxJsx").smax("pay",{"transaction-type":"p2m"}),b),c),a);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBRPublishSendPayNodeP2MMixin=a}),98);
__d("WASmaxOutMessagePublishBRPublishSendPayNodeP2PMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("pay",{"transaction-type":"p2p"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBRPublishSendPayNodeP2PMixin=a}),98);
__d("WASmaxOutMessagePublishBRPublishSendPayNodeP2POrMMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishBRPublishSendPayNodeP2MMixin","WASmaxOutMessagePublishBRPublishSendPayNodeP2PMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.isBRPublishSendPayNodeP2P)return d("WASmaxOutMessagePublishBRPublishSendPayNodeP2PMixin").mergeBRPublishSendPayNodeP2PMixin(a);if(b.bRPublishSendPayNodeP2M)return d("WASmaxOutMessagePublishBRPublishSendPayNodeP2MMixin").mergeBRPublishSendPayNodeP2MMixin(a,b.bRPublishSendPayNodeP2M);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeBRPublishSendPayNodeP2POrMMixinGroup=a}),98);
__d("WASmaxOutMessagePublishBRSendPayEloNodeMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b,c=a.eloDeviceSignature,e=a.eloWalletSignature,f=a.eloChallengeId;a=a.eloCardholderVerificationMethod;c=d("WASmaxJsx").smax("pay",null,d("WASmaxJsx").smax("elo",{device_signature:(b=d("WAWap")).CUSTOM_STRING(c),wallet_signature:b.CUSTOM_STRING(e),challenge_id:b.CUSTOM_STRING(f),cardholder_verification_method:b.CUSTOM_STRING(a)}));return c}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBRSendPayEloNodeMixin=a}),98);
__d("WASmaxOutMessagePublishBRPublishSendPayNodeDeprecatedMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishBRPublishSendPayNodeP2POrMMixinGroup","WASmaxOutMessagePublishBRSendPayEloNodeMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b,c=a.payId,e=a.payPaymentRails,f=a.payTrustedDeviceInfo,g=a.payNonce,h=a.bRSendPayEloNodeMixinArgs;a=a.bRPublishSendPayNodeP2POrMMixinGroupArgs;c=d("WASmaxOutMessagePublishBRPublishSendPayNodeP2POrMMixinGroup").mergeBRPublishSendPayNodeP2POrMMixinGroup(d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishBRSendPayEloNodeMixin").mergeBRSendPayEloNodeMixin,d("WASmaxJsx").smax("pay",{id:(b=d("WAWap")).CUSTOM_STRING(c),"payment-rails":d("WASmaxAttrs").OPTIONAL(b.CUSTOM_STRING,e),"trusted-device-info":d("WASmaxAttrs").OPTIONAL(b.CUSTOM_STRING,f),nonce:b.CUSTOM_STRING(g)}),h),a);return c}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBRPublishSendPayNodeDeprecatedMixin=a}),98);
__d("WASmaxOutMessagePublishBRPublishSendPayNodeMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishBRPublishSendPayNodeP2POrMMixinGroup","WASmaxOutMessagePublishBRSendPayEloNodeMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b,c=a.payId,e=a.payPaymentRails,f=a.payTrustedDeviceInfo,g=a.payNonce,h=a.bRSendPayEloNodeMixinArgs;a=a.bRPublishSendPayNodeP2POrMMixinGroupArgs;c=d("WASmaxOutMessagePublishBRPublishSendPayNodeP2POrMMixinGroup").mergeBRPublishSendPayNodeP2POrMMixinGroup(d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishBRSendPayEloNodeMixin").mergeBRSendPayEloNodeMixin,d("WASmaxJsx").smax("pay",{id:(b=d("WAWap")).CUSTOM_STRING(c),"payment-rails":b.CUSTOM_STRING(e),"trusted-device-info":b.CUSTOM_STRING(f),nonce:b.CUSTOM_STRING(g)}),h),a);return c}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBRPublishSendPayNodeMixin=a}),98);
__d("WASmaxOutMessagePublishOrderMessageMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b,c=a.orderOrderId,e=a.orderOrderMessageId,f=a.orderExpiryTs,g=a.orderOrderType;a=a.orderDiscountProgramName;e=d("WASmaxJsx").smax("order",{"order-id":(b=d("WAWap")).CUSTOM_STRING(c),"order-message-id":(c=d("WASmaxAttrs")).OPTIONAL(b.CUSTOM_STRING,e),"expiry-ts":c.OPTIONAL(b.INT,f),"order-type":c.OPTIONAL(b.CUSTOM_STRING,g),"discount-program-name":c.OPTIONAL(b.CUSTOM_STRING,a)});return e}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeOrderMessageMixin=a}),98);
__d("WASmaxOutMessagePublishUPIPublishSendPayNodeP2MMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishOrderMessageMixin","WASmaxOutMessagePublishPaymentInitiatorMixin"],(function(a,b,c,d,e,f,g){function h(a){a=a.orderArgs;a=d("WASmaxJsx").smax("upi",null,d("WASmaxChildren").OPTIONAL_CHILD(i,a));return a}function i(a){a=d("WASmaxOutMessagePublishOrderMessageMixin").mergeOrderMessageMixin(d("WASmaxJsx").smax("order",null),a);return a}function j(a){var b=a.upiArgs;a=a.paymentInitiatorMixinArgs;b=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishPaymentInitiatorMixin").mergePaymentInitiatorMixin,d("WASmaxJsx").smax("pay",{"transaction-type":"p2m"},d("WASmaxChildren").OPTIONAL_CHILD(h,b)),a);return b}function a(a,b){b=j(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeUPIPublishSendPayNodeP2MUpi=h;g.makeUPIPublishSendPayNodeP2MUpiOrder=i;g.mergeUPIPublishSendPayNodeP2MMixin=a}),98);
__d("WASmaxOutMessagePublishUPIPublishSendPayNodeP2PMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.hasPayTransactionTypeP2P;a=d("WASmaxJsx").smax("pay",{"transaction-type":d("WASmaxAttrs").OPTIONAL_LITERAL("p2p",a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeUPIPublishSendPayNodeP2PMixin=a}),98);
__d("WASmaxOutMessagePublishUPIPublishSendPayNodeP2POrMMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishUPIPublishSendPayNodeP2MMixin","WASmaxOutMessagePublishUPIPublishSendPayNodeP2PMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.uPIPublishSendPayNodeP2P)return d("WASmaxOutMessagePublishUPIPublishSendPayNodeP2PMixin").mergeUPIPublishSendPayNodeP2PMixin(a,b.uPIPublishSendPayNodeP2P);if(b.uPIPublishSendPayNodeP2M)return d("WASmaxOutMessagePublishUPIPublishSendPayNodeP2MMixin").mergeUPIPublishSendPayNodeP2MMixin(a,b.uPIPublishSendPayNodeP2M);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeUPIPublishSendPayNodeP2POrMMixinGroup=a}),98);
__d("WASmaxOutMessagePublishUPIPublishSendPayNodeMixin",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishUPIPublishSendPayNodeP2POrMMixinGroup","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.upiToken;a=d("WASmaxJsx").smax("upi",{token:d("WAWap").CUSTOM_STRING(a)});return a}function i(a){var b,c,e=a.upiArgs,f=a.payId,g=a.payMpin,i=a.payReceiverVpa,j=a.payReceiverVpaId,k=a.paySenderVpa,l=a.paySenderVpaId,m=a.paySeqNo,n=a.payUpiBankInfo,o=a.payMode,p=a.payPurposeCode,q=a.payMcc,r=a.payRefId;a=a.uPIPublishSendPayNodeP2POrMMixinGroupArgs;f=d("WASmaxOutMessagePublishUPIPublishSendPayNodeP2POrMMixinGroup").mergeUPIPublishSendPayNodeP2POrMMixinGroup(d("WASmaxJsx").smax("pay",{id:(b=d("WASmaxAttrs")).OPTIONAL((c=d("WAWap")).CUSTOM_STRING,f),mpin:b.OPTIONAL(c.CUSTOM_STRING,g),"receiver-vpa":c.CUSTOM_STRING(i),"receiver-vpa-id":b.OPTIONAL(c.CUSTOM_STRING,j),"sender-vpa":c.CUSTOM_STRING(k),"sender-vpa-id":b.OPTIONAL(c.CUSTOM_STRING,l),"seq-no":c.CUSTOM_STRING(m),"upi-bank-info":c.CUSTOM_STRING(n),mode:b.OPTIONAL(c.CUSTOM_STRING,o),"purpose-code":b.OPTIONAL(c.CUSTOM_STRING,p),mcc:b.OPTIONAL(c.CUSTOM_STRING,q),"ref-id":b.OPTIONAL(c.CUSTOM_STRING,r)},d("WASmaxChildren").OPTIONAL_CHILD(h,e)),a);return f}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeUPIPublishSendPayNodeUpi=h;g.mergeUPIPublishSendPayNodeMixin=a}),98);
__d("WASmaxOutMessagePublishBRPublishSendPayNodeOrBRPublishSendPayNodeDeprecatedOrUPIPublishSendPayNodeMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishBRPublishSendPayNodeDeprecatedMixin","WASmaxOutMessagePublishBRPublishSendPayNodeMixin","WASmaxOutMessagePublishUPIPublishSendPayNodeMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.bRPublishSendPayNode)return d("WASmaxOutMessagePublishBRPublishSendPayNodeMixin").mergeBRPublishSendPayNodeMixin(a,b.bRPublishSendPayNode);if(b.bRPublishSendPayNodeDeprecated)return d("WASmaxOutMessagePublishBRPublishSendPayNodeDeprecatedMixin").mergeBRPublishSendPayNodeDeprecatedMixin(a,b.bRPublishSendPayNodeDeprecated);if(b.uPIPublishSendPayNode)return d("WASmaxOutMessagePublishUPIPublishSendPayNodeMixin").mergeUPIPublishSendPayNodeMixin(a,b.uPIPublishSendPayNode);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeBRPublishSendPayNodeOrBRPublishSendPayNodeDeprecatedOrUPIPublishSendPayNodeMixinGroup=a}),98);
__d("WASmaxOutMessagePublishIntegrationPublishPayNodeMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishBRPublishSendPayNodeOrBRPublishSendPayNodeDeprecatedOrUPIPublishSendPayNodeMixinGroup"],(function(a,b,c,d,e,f,g){function h(a){a=a.bRPublishSendPayNodeOrBRPublishSendPayNodeDeprecatedOrUPIPublishSendPayNodeMixinGroupArgs;a=d("WASmaxOutMessagePublishBRPublishSendPayNodeOrBRPublishSendPayNodeDeprecatedOrUPIPublishSendPayNodeMixinGroup").mergeBRPublishSendPayNodeOrBRPublishSendPayNodeDeprecatedOrUPIPublishSendPayNodeMixinGroup(d("WASmaxJsx").smax("pay",null),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIntegrationPublishPayNodeMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualNonNoviPublishSendPayNodeMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishBaseIndividualPublishSendPayNodeMixin","WASmaxOutMessagePublishIntegrationPublishPayNodeMixin"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxOutMessagePublishIntegrationPublishPayNodeMixin").mergeIntegrationPublishPayNodeMixin(d("WASmaxOutMessagePublishBaseIndividualPublishSendPayNodeMixin").mergeBaseIndividualPublishSendPayNodeMixin(d("WASmaxJsx").smax("pay",null),a),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualNonNoviPublishSendPayNodeMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualPublishSendPayNodeMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishIndividualNonNoviPublishSendPayNodeMixin"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxOutMessagePublishIndividualNonNoviPublishSendPayNodeMixin").mergeIndividualNonNoviPublishSendPayNodeMixin(d("WASmaxJsx").smax("pay",null),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualPublishSendPayNodeMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualRequestPayNodeMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishBasePayNodeMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.payExpiryTs,c=a.payRequestId;b=d("WASmaxOutMessagePublishBasePayNodeMixin").mergeBasePayNodeMixin(d("WASmaxJsx").smax("pay",{"expiry-ts":d("WAWap").CUSTOM_STRING(b),"request-id":d("WAWap").CUSTOM_STRING(c)}),a);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualRequestPayNodeMixin=a}),98);
__d("WASmaxOutMessagePublishPayInviteNodeMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.payService;a=d("WASmaxJsx").smax("pay",{type:"invite",service:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePayInviteNodeMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualPublishSendPayOrIndividualRequestPayOrPayInviteNodeMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishIndividualPublishSendPayNodeMixin","WASmaxOutMessagePublishIndividualRequestPayNodeMixin","WASmaxOutMessagePublishPayInviteNodeMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.individualPublishSendPayNode)return d("WASmaxOutMessagePublishIndividualPublishSendPayNodeMixin").mergeIndividualPublishSendPayNodeMixin(a,b.individualPublishSendPayNode);if(b.individualRequestPayNode)return d("WASmaxOutMessagePublishIndividualRequestPayNodeMixin").mergeIndividualRequestPayNodeMixin(a,b.individualRequestPayNode);if(b.payInviteNode)return d("WASmaxOutMessagePublishPayInviteNodeMixin").mergePayInviteNodeMixin(a,b.payInviteNode);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeIndividualPublishSendPayOrIndividualRequestPayOrPayInviteNodeMixinGroup=a}),98);
__d("WASmaxOutMessagePublishIndividualPublishPayNodeMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishIndividualPublishSendPayOrIndividualRequestPayOrPayInviteNodeMixinGroup"],(function(a,b,c,d,e,f,g){function h(a){a=a.individualPublishSendPayOrIndividualRequestPayOrPayInviteNodeMixinGroupArgs;a=d("WASmaxOutMessagePublishIndividualPublishSendPayOrIndividualRequestPayOrPayInviteNodeMixinGroup").mergeIndividualPublishSendPayOrIndividualRequestPayOrPayInviteNodeMixinGroup(d("WASmaxJsx").smax("pay",null),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualPublishPayNodeMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualIndividualPublishPayNodeMessageMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishIndividualPublishPayNodeMixin"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxJsx").smax("message",null,d("WASmaxOutMessagePublishIndividualPublishPayNodeMixin").mergeIndividualPublishPayNodeMixin(d("WASmaxJsx").smax("pay",null),a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualIndividualPublishPayNodeMessageMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualContentTypePayIndividualMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypePayMixin","WASmaxOutMessagePublishIndividualIndividualPublishPayNodeMessageMixin"],(function(a,b,c,d,e,f,g){function h(a){a=a.individualIndividualPublishPayNodeMessageMixinArgs;a=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishIndividualIndividualPublishPayNodeMessageMixin").mergeIndividualIndividualPublishPayNodeMessageMixin,d("WASmaxOutMessagePublishContentTypePayMixin").mergeContentTypePayMixin(d("WASmaxJsx").smax("message",null)),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualContentTypePayIndividualMixin=a}),98);
__d("WASmaxOutMessagePublishContentFanoutMixins",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishContentTypeListFanoutMixin","WASmaxOutMessagePublishContentTypeLiveLocationFanoutDeprecatedMixin","WASmaxOutMessagePublishContentTypeLiveLocationFanoutMixin","WASmaxOutMessagePublishContentTypeMediaFanoutDeprecatedMixin","WASmaxOutMessagePublishContentTypeMediaFanoutMixin","WASmaxOutMessagePublishContentTypeMedianotifyMixin","WASmaxOutMessagePublishContentTypePollCreationMixin","WASmaxOutMessagePublishContentTypePollVoteMixin","WASmaxOutMessagePublishContentTypeReactionMixin","WASmaxOutMessagePublishContentTypeTextMixin","WASmaxOutMessagePublishIndividualContentTypePayIndividualMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.isContentTypeText)return d("WASmaxOutMessagePublishContentTypeTextMixin").mergeContentTypeTextMixin(a);if(b.contentTypeMediaFanout)return d("WASmaxOutMessagePublishContentTypeMediaFanoutMixin").mergeContentTypeMediaFanoutMixin(a,b.contentTypeMediaFanout);if(b.contentTypeMediaFanoutDeprecated)return d("WASmaxOutMessagePublishContentTypeMediaFanoutDeprecatedMixin").mergeContentTypeMediaFanoutDeprecatedMixin(a,b.contentTypeMediaFanoutDeprecated);if(b.contentTypeLiveLocationFanout)return d("WASmaxOutMessagePublishContentTypeLiveLocationFanoutMixin").mergeContentTypeLiveLocationFanoutMixin(a,b.contentTypeLiveLocationFanout);if(b.contentTypeLiveLocationFanoutDeprecated)return d("WASmaxOutMessagePublishContentTypeLiveLocationFanoutDeprecatedMixin").mergeContentTypeLiveLocationFanoutDeprecatedMixin(a,b.contentTypeLiveLocationFanoutDeprecated);if(b.individualContentTypePayIndividual)return d("WASmaxOutMessagePublishIndividualContentTypePayIndividualMixin").mergeIndividualContentTypePayIndividualMixin(a,b.individualContentTypePayIndividual);if(b.contentTypeListFanout)return d("WASmaxOutMessagePublishContentTypeListFanoutMixin").mergeContentTypeListFanoutMixin(a,b.contentTypeListFanout);if(b.isContentTypeReaction)return d("WASmaxOutMessagePublishContentTypeReactionMixin").mergeContentTypeReactionMixin(a);if(b.isContentTypePollCreation)return d("WASmaxOutMessagePublishContentTypePollCreationMixin").mergeContentTypePollCreationMixin(a);if(b.isContentTypePollVote)return d("WASmaxOutMessagePublishContentTypePollVoteMixin").mergeContentTypePollVoteMixin(a);if(b.isContentTypeMedianotify)return d("WASmaxOutMessagePublishContentTypeMedianotifyMixin").mergeContentTypeMedianotifyMixin(a);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeContentFanoutMixins=a}),98);
__d("WASmaxOutMessagePublishLidChatOriginMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.metaOrigin;a=a.metaSharePn;b=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("meta",{origin:d("WAWap").CUSTOM_STRING(b),share_pn:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a)}));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeLidChatOriginMixin=a}),98);
__d("WASmaxOutMessagePublishTDeprecatedMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.messageT;a=d("WASmaxJsx").smax("message",{t:d("WAWap").INT(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeTDeprecatedMixin=a}),98);
__d("WASmaxOutMessagePublishToContentBindingMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.toJid;a=a.contentBindingElementValue;b=d("WASmaxJsx").smax("to",{jid:d("WAWap").DEVICE_JID(b)},d("WASmaxJsx").smax("content_binding",null,a));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeToContentBindingMixin=a}),98);
__d("WASmaxOutMessagePublishAvatarStickerTypeMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("enc",{sticker_type:"avatar"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeAvatarStickerTypeMixin=a}),98);
__d("WASmaxOutMessagePublishEncMediaTypeDeprecatedMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishAvatarStickerTypeMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.encMediatype,c=a.encNativeFlowName;a=a.hasAvatarStickerType;b=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishAvatarStickerTypeMixin").mergeAvatarStickerTypeMixin,d("WASmaxJsx").smax("enc",{mediatype:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,b),native_flow_name:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,c)}),a);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEncMediaTypeDeprecatedMixin=a}),98);
__d("WASmaxOutMessagePublishEncVersion3Mixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("enc",{v:"3"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEncVersion3Mixin=a}),98);
__d("WASmaxOutMessagePublishEncVersion2Or3MixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishEncVersion2Mixin","WASmaxOutMessagePublishEncVersion3Mixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.isEncVersion2)return d("WASmaxOutMessagePublishEncVersion2Mixin").mergeEncVersion2Mixin(a);if(b.isEncVersion3)return d("WASmaxOutMessagePublishEncVersion3Mixin").mergeEncVersion3Mixin(a);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeEncVersion2Or3MixinGroup=a}),98);
__d("WASmaxOutMessagePublishToDeviceMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishEncMediaTypeDeprecatedMixin","WASmaxOutMessagePublishEncTypeIndividualMixin","WASmaxOutMessagePublishEncVersion2Or3MixinGroup","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.toJid,c=a.encTypeIndividualMixinArgs,e=a.encMediaTypeDeprecatedMixinArgs;a=a.encVersion2Or3MixinGroupArgs;b=d("WASmaxJsx").smax("to",{jid:d("WAWap").JID(b)},d("WASmaxOutMessagePublishEncVersion2Or3MixinGroup").mergeEncVersion2Or3MixinGroup(d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishEncMediaTypeDeprecatedMixin").mergeEncMediaTypeDeprecatedMixin,d("WASmaxOutMessagePublishEncTypeIndividualMixin").mergeEncTypeIndividualMixin(d("WASmaxJsx").smax("enc",null),c),e),a));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeToDeviceMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualIndividualFanoutMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishBotLocalAutomatedTypeMixin","WASmaxOutMessagePublishBotMessageTypeMixin","WASmaxOutMessagePublishBusinessBotMessageMixin","WASmaxOutMessagePublishContentFanoutMixins","WASmaxOutMessagePublishLidChatOriginMixin","WASmaxOutMessagePublishTDeprecatedMixin","WASmaxOutMessagePublishToContentBindingMixin","WASmaxOutMessagePublishToDeviceMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.toContentBindingMixinArgs;a=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishToContentBindingMixin").mergeToContentBindingMixin,d("WASmaxOutMessagePublishToDeviceMixin").mergeToDeviceMixin(d("WASmaxJsx").smax("to",null),a),b);return a}function a(){var a=d("WASmaxJsx").smax("enc",null);return a}function i(a){var b,c=a.toArgs,e=a.messageTo,f=a.tDeprecatedMixinArgs,g=a.botMessageTypeMixinArgs,i=a.businessBotMessageMixinArgs,j=a.lidChatOriginMixinArgs,k=a.botLocalAutomatedTypeMixinArgs;a=a.contentFanoutMixinsArgs;b=d("WASmaxOutMessagePublishContentFanoutMixins").mergeContentFanoutMixins((b=d("WASmaxMixins")).optionalMerge(d("WASmaxOutMessagePublishBotLocalAutomatedTypeMixin").mergeBotLocalAutomatedTypeMixin,b.optionalMerge(d("WASmaxOutMessagePublishLidChatOriginMixin").mergeLidChatOriginMixin,b.optionalMerge(d("WASmaxOutMessagePublishBusinessBotMessageMixin").mergeBusinessBotMessageMixin,b.optionalMerge(d("WASmaxOutMessagePublishBotMessageTypeMixin").mergeBotMessageTypeMixin,b.optionalMerge(d("WASmaxOutMessagePublishTDeprecatedMixin").mergeTDeprecatedMixin,d("WASmaxJsx").smax("message",{to:d("WAWap").JID(e)},d("WASmaxJsx").smax("participants",null,d("WASmaxChildren").REPEATED_CHILD(h,c,1,1997))),f),g),i),j),k),a);return b}function b(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeIndividualIndividualFanoutParticipantsTo=h;g.makeIndividualIndividualFanoutEnc=a;g.mergeIndividualIndividualFanoutMixin=b}),98);
__d("WASmaxOutMessagePublishEncListMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("enc",{mediatype:"list"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEncListMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypeListMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeMediaMixin","WASmaxOutMessagePublishEncListMixin","WASmaxOutMessagePublishSingleSelectOrProductListMixinGroup"],(function(a,b,c,d,e,f,g){function h(a){a=a.singleSelectOrProductListMixinGroupArgs;a=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishSingleSelectOrProductListMixinGroup").mergeSingleSelectOrProductListMixinGroup,d("WASmaxOutMessagePublishContentTypeMediaMixin").mergeContentTypeMediaMixin(d("WASmaxJsx").smax("message",null,d("WASmaxOutMessagePublishEncListMixin").mergeEncListMixin(d("WASmaxJsx").smax("enc",null)))),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeContentTypeListMixin=a}),98);
__d("WASmaxOutMessagePublishEncLiveLocationDeprecatedMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.encDuration;a=d("WASmaxJsx").smax("enc",{mediatype:"livelocation",duration:d("WASmaxAttrs").OPTIONAL(d("WAWap").INT,a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEncLiveLocationDeprecatedMixin=a}),98);
__d("WASmaxOutMessagePublishEncLiveLocationMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.encDuration;a=d("WASmaxJsx").smax("enc",{mediatype:"livelocation",duration:d("WAWap").INT(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEncLiveLocationMixin=a}),98);
__d("WASmaxOutMessagePublishEncLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishEncLiveLocationDeprecatedMixin","WASmaxOutMessagePublishEncLiveLocationMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.encLiveLocation)return d("WASmaxOutMessagePublishEncLiveLocationMixin").mergeEncLiveLocationMixin(a,b.encLiveLocation);if(b.encLiveLocationDeprecated)return d("WASmaxOutMessagePublishEncLiveLocationDeprecatedMixin").mergeEncLiveLocationDeprecatedMixin(a,b.encLiveLocationDeprecated);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeEncLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroup=a}),98);
__d("WASmaxOutMessagePublishContentTypeLiveLocationSingleMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeMediaMixin","WASmaxOutMessagePublishEncLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroup","WASmaxOutMessagePublishLiveLocationModeMixin"],(function(a,b,c,d,e,f,g){function h(a){var b=a.liveLocationModeMixinArgs;a=a.encLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroupArgs;a=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishLiveLocationModeMixin").mergeLiveLocationModeMixin,d("WASmaxOutMessagePublishContentTypeMediaMixin").mergeContentTypeMediaMixin(d("WASmaxJsx").smax("message",null,d("WASmaxOutMessagePublishEncLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroup").mergeEncLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroup(d("WASmaxJsx").smax("enc",null),a))),b);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeContentTypeLiveLocationSingleMixin=a}),98);
__d("WASmaxOutMessagePublishEncMediaTypeMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishAvatarStickerTypeMixin","WASmaxOutMessagePublishMediaTypeMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.encNativeFlowName,c=a.hasAvatarStickerType;b=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishAvatarStickerTypeMixin").mergeAvatarStickerTypeMixin,d("WASmaxOutMessagePublishMediaTypeMixin").mergeMediaTypeMixin(d("WASmaxJsx").smax("enc",{native_flow_name:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,b)}),a),c);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEncMediaTypeMixin=a}),98);
__d("WASmaxOutMessagePublishEncMediaTypeEncMediaTypeOrEncMediaTypeDeprecatedMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishEncMediaTypeDeprecatedMixin","WASmaxOutMessagePublishEncMediaTypeMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.encMediaType)return d("WASmaxOutMessagePublishEncMediaTypeMixin").mergeEncMediaTypeMixin(a,b.encMediaType);if(b.encMediaTypeDeprecated)return d("WASmaxOutMessagePublishEncMediaTypeDeprecatedMixin").mergeEncMediaTypeDeprecatedMixin(a,b.encMediaTypeDeprecated);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeEncMediaTypeEncMediaTypeOrEncMediaTypeDeprecatedMixinGroup=a}),98);
__d("WASmaxOutMessagePublishContentTypeMediaSingleMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeMediaOrMedianotifyMixinGroup","WASmaxOutMessagePublishEncMediaTypeEncMediaTypeOrEncMediaTypeDeprecatedMixinGroup","WASmaxOutMessagePublishSenderContentBindingMixin"],(function(a,b,c,d,e,f,g){function h(a){var b=a.senderContentBindingMixinArgs,c=a.contentTypeMediaOrMedianotifyMixinGroupArgs;a=a.encMediaTypeEncMediaTypeOrEncMediaTypeDeprecatedMixinGroupArgs;a=d("WASmaxOutMessagePublishContentTypeMediaOrMedianotifyMixinGroup").mergeContentTypeMediaOrMedianotifyMixinGroup(d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishSenderContentBindingMixin").mergeSenderContentBindingMixin,d("WASmaxJsx").smax("message",null,d("WASmaxOutMessagePublishEncMediaTypeEncMediaTypeOrEncMediaTypeDeprecatedMixinGroup").mergeEncMediaTypeEncMediaTypeOrEncMediaTypeDeprecatedMixinGroup(d("WASmaxJsx").smax("enc",null),a)),b),c);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeContentTypeMediaSingleMixin=a}),98);
__d("WASmaxOutMessagePublishContentMixins",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishContentTypeListMixin","WASmaxOutMessagePublishContentTypeLiveLocationSingleMixin","WASmaxOutMessagePublishContentTypeMediaSingleMixin","WASmaxOutMessagePublishContentTypePollCreationMixin","WASmaxOutMessagePublishContentTypePollVoteMixin","WASmaxOutMessagePublishContentTypeReactionMixin","WASmaxOutMessagePublishContentTypeTextMixin","WASmaxOutMessagePublishIndividualContentTypePayIndividualMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.isContentTypeText)return d("WASmaxOutMessagePublishContentTypeTextMixin").mergeContentTypeTextMixin(a);if(b.contentTypeMediaSingle)return d("WASmaxOutMessagePublishContentTypeMediaSingleMixin").mergeContentTypeMediaSingleMixin(a,b.contentTypeMediaSingle);if(b.contentTypeLiveLocationSingle)return d("WASmaxOutMessagePublishContentTypeLiveLocationSingleMixin").mergeContentTypeLiveLocationSingleMixin(a,b.contentTypeLiveLocationSingle);if(b.individualContentTypePayIndividual)return d("WASmaxOutMessagePublishIndividualContentTypePayIndividualMixin").mergeIndividualContentTypePayIndividualMixin(a,b.individualContentTypePayIndividual);if(b.contentTypeList)return d("WASmaxOutMessagePublishContentTypeListMixin").mergeContentTypeListMixin(a,b.contentTypeList);if(b.isContentTypeReaction)return d("WASmaxOutMessagePublishContentTypeReactionMixin").mergeContentTypeReactionMixin(a);if(b.isContentTypePollCreation)return d("WASmaxOutMessagePublishContentTypePollCreationMixin").mergeContentTypePollCreationMixin(a);if(b.isContentTypePollVote)return d("WASmaxOutMessagePublishContentTypePollVoteMixin").mergeContentTypePollVoteMixin(a);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeContentMixins=a}),98);
__d("WASmaxOutMessagePublishIndividualIndividualRetryToPeerMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.messageRecipient;a=d("WASmaxJsx").smax("message",{recipient:d("WAWap").USER_JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualIndividualRetryToPeerMixin=a}),98);
__d("WASmaxOutMessagePublishRetryMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishEncRetryMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.messageT;a=a.encRetryMixinArgs;b=d("WASmaxJsx").smax("message",{t:d("WASmaxAttrs").OPTIONAL(d("WAWap").INT,b)},d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishEncRetryMixin").mergeEncRetryMixin,d("WASmaxJsx").smax("enc",null),a));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeRetryMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualIndividualRetryMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishIndividualIndividualRetryToPeerMixin","WASmaxOutMessagePublishRetryMixin"],(function(a,b,c,d,e,f,g){function h(a){var b=a.individualIndividualRetryToPeerMixinArgs;a=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishIndividualIndividualRetryToPeerMixin").mergeIndividualIndividualRetryToPeerMixin,d("WASmaxOutMessagePublishRetryMixin").mergeRetryMixin(d("WASmaxJsx").smax("message",null),a),b);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualIndividualRetryMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualIndividualSingleContentBindingMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.contentBindingElementValue;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("content_binding",null,a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualIndividualSingleContentBindingMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualIndividualSingleMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishBotLocalAutomatedTypeMixin","WASmaxOutMessagePublishBotMessageTypeMixin","WASmaxOutMessagePublishBusinessBotMessageMixin","WASmaxOutMessagePublishContentMixins","WASmaxOutMessagePublishEncMediaTypeDeprecatedMixin","WASmaxOutMessagePublishEncTypeIndividualMixin","WASmaxOutMessagePublishEncVersion2Or3MixinGroup","WASmaxOutMessagePublishIndividualIndividualRetryMixin","WASmaxOutMessagePublishIndividualIndividualSingleContentBindingMixin","WASmaxOutMessagePublishLidChatOriginMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b,c=a.messageTo,e=a.individualIndividualRetryMixinArgs,f=a.individualIndividualSingleContentBindingMixinArgs,g=a.botMessageTypeMixinArgs,h=a.businessBotMessageMixinArgs,i=a.lidChatOriginMixinArgs,j=a.botLocalAutomatedTypeMixinArgs,k=a.contentMixinsArgs,l=a.encTypeIndividualMixinArgs,m=a.encMediaTypeDeprecatedMixinArgs;a=a.encVersion2Or3MixinGroupArgs;c=d("WASmaxOutMessagePublishContentMixins").mergeContentMixins((b=d("WASmaxMixins")).optionalMerge(d("WASmaxOutMessagePublishBotLocalAutomatedTypeMixin").mergeBotLocalAutomatedTypeMixin,b.optionalMerge(d("WASmaxOutMessagePublishLidChatOriginMixin").mergeLidChatOriginMixin,b.optionalMerge(d("WASmaxOutMessagePublishBusinessBotMessageMixin").mergeBusinessBotMessageMixin,b.optionalMerge(d("WASmaxOutMessagePublishBotMessageTypeMixin").mergeBotMessageTypeMixin,b.optionalMerge(d("WASmaxOutMessagePublishIndividualIndividualSingleContentBindingMixin").mergeIndividualIndividualSingleContentBindingMixin,b.optionalMerge(d("WASmaxOutMessagePublishIndividualIndividualRetryMixin").mergeIndividualIndividualRetryMixin,d("WASmaxJsx").smax("message",{to:d("WAWap").JID(c)},d("WASmaxOutMessagePublishEncVersion2Or3MixinGroup").mergeEncVersion2Or3MixinGroup(b.optionalMerge(d("WASmaxOutMessagePublishEncMediaTypeDeprecatedMixin").mergeEncMediaTypeDeprecatedMixin,d("WASmaxOutMessagePublishEncTypeIndividualMixin").mergeEncTypeIndividualMixin(d("WASmaxJsx").smax("enc",null),l),m),a)),e),f),g),h),i),j),k);return c}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualIndividualSingleMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualIndividualSingleOrIndividualFanoutMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishIndividualIndividualFanoutMixin","WASmaxOutMessagePublishIndividualIndividualSingleMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.individualIndividualSingle)return d("WASmaxOutMessagePublishIndividualIndividualSingleMixin").mergeIndividualIndividualSingleMixin(a,b.individualIndividualSingle);if(b.individualIndividualFanout)return d("WASmaxOutMessagePublishIndividualIndividualFanoutMixin").mergeIndividualIndividualFanoutMixin(a,b.individualIndividualFanout);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeIndividualIndividualSingleOrIndividualFanoutMixinGroup=a}),98);
__d("WASmaxOutMessagePublishIndividualBotRequestMessageMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishBotFeedbackMessageTypeMixin","WASmaxOutMessagePublishBotRequestMixin","WASmaxOutMessagePublishContentTypeTextOrMediaMixinGroup","WASmaxOutMessagePublishIndividualIndividualSingleOrIndividualFanoutMixinGroup","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.messageTo,c=a.contentTypeTextOrMediaMixinGroupArgs,e=a.individualIndividualSingleOrIndividualFanoutMixinGroupArgs,f=a.hasBotFeedbackMessageType;a=a.botRequestMixinArgs;b=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishIndividualIndividualSingleOrIndividualFanoutMixinGroup").mergeIndividualIndividualSingleOrIndividualFanoutMixinGroup,d("WASmaxOutMessagePublishContentTypeTextOrMediaMixinGroup").mergeContentTypeTextOrMediaMixinGroup(d("WASmaxJsx").smax("message",{to:d("WAWap").USER_JID(b)},d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishBotFeedbackMessageTypeMixin").mergeBotFeedbackMessageTypeMixin,d("WASmaxJsx").smax("bot",null,d("WASmaxOutMessagePublishBotRequestMixin").mergeBotRequestMixin(d("WASmaxJsx").smax("to",null),a)),f)),c),e);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualBotRequestMessageMixin=a}),98);
__d("WASmaxOutMessagePublishBotResponseMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.botEditTargetId,c=a.botSenderTimestampMs;a=a.botEdit;b=d("WASmaxJsx").smax("bot",{edit_target_id:d("WASmaxAttrs").OPTIONAL(d("WAWap").STANZA_ID,b),sender_timestamp_ms:d("WASmaxAttrs").OPTIONAL(d("WAWap").INT,c),edit:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBotResponseMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualContentTypeBotResponseMediaFanoutMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeMediaMixin"],(function(a,b,c,d,e,f,g){function h(a){a=a.toCount;a=d("WASmaxJsx").smax("participants",null,d("WASmaxChildren").REPEATED_CHILD_COUNT(i,a,2,2));return a}function i(){var a=d("WASmaxJsx").smax("to",null,d("WASmaxJsx").smax("enc",{mediatype:"image"}));return a}function j(a){a=a.participantsArgs;a=d("WASmaxOutMessagePublishContentTypeMediaMixin").mergeContentTypeMediaMixin(d("WASmaxJsx").smax("message",null,d("WASmaxChildren").OPTIONAL_CHILD(h,a)));return a}function a(a,b){b=j(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeIndividualContentTypeBotResponseMediaFanoutParticipants=h;g.makeIndividualContentTypeBotResponseMediaFanoutParticipantsTo=i;g.mergeIndividualContentTypeBotResponseMediaFanoutMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypeTextOrIndividualBotResponseMediaFanoutMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishContentTypeTextMixin","WASmaxOutMessagePublishIndividualContentTypeBotResponseMediaFanoutMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.isContentTypeText)return d("WASmaxOutMessagePublishContentTypeTextMixin").mergeContentTypeTextMixin(a);if(b.individualContentTypeBotResponseMediaFanout)return d("WASmaxOutMessagePublishIndividualContentTypeBotResponseMediaFanoutMixin").mergeIndividualContentTypeBotResponseMediaFanoutMixin(a,b.individualContentTypeBotResponseMediaFanout);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeContentTypeTextOrIndividualBotResponseMediaFanoutMixinGroup=a}),98);
__d("WASmaxOutMessagePublishEncTypeMessageSecretMessageMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishEncPayloadMixin"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxOutMessagePublishEncPayloadMixin").mergeEncPayloadMixin(d("WASmaxJsx").smax("enc",{type:"msmsg"}),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEncTypeMessageSecretMessageMixin=a}),98);
__d("WASmaxOutMessagePublishFromProxyAccountMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.botActualFrom;a=d("WASmaxJsx").smax("bot",{actual_from:d("WAWap").JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeFromProxyAccountMixin=a}),98);
__d("WASmaxOutMessagePublishMessageTargetMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.metaTargetId,c=a.metaTargetSenderJid;a=a.metaTargetChatJid;b=d("WASmaxJsx").smax("meta",{target_id:d("WAWap").STANZA_ID(b),target_sender_jid:d("WASmaxAttrs").OPTIONAL(d("WAWap").USER_JID,c),target_chat_jid:d("WASmaxAttrs").OPTIONAL(d("WAWap").JID,a)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeMessageTargetMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualBotResponseFanoutMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishBotResponseMixin","WASmaxOutMessagePublishContentTypeTextOrIndividualBotResponseMediaFanoutMixinGroup","WASmaxOutMessagePublishEncTypeMessageSecretMessageMixin","WASmaxOutMessagePublishEncVersion2OrFutureproofMixinGroup","WASmaxOutMessagePublishFromProxyAccountMixin","WASmaxOutMessagePublishMessageTargetMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.toArgs;a=d("WASmaxJsx").smax("participants",null,d("WASmaxChildren").REPEATED_CHILD(i,a,2,2));return a}function i(a){a=a.toJid;a=d("WASmaxJsx").smax("to",{jid:d("WAWap").USER_JID(a)});return a}function j(a){var b,c=a.participantsArgs,e=a.messageTo,f=a.contentTypeTextOrIndividualBotResponseMediaFanoutMixinGroupArgs,g=a.botResponseMixinArgs,i=a.fromProxyAccountMixinArgs,j=a.messageTargetMixinArgs,k=a.encTypeMessageSecretMessageMixinArgs;a=a.encVersion2OrFutureproofMixinGroupArgs;e=d("WASmaxOutMessagePublishContentTypeTextOrIndividualBotResponseMediaFanoutMixinGroup").mergeContentTypeTextOrIndividualBotResponseMediaFanoutMixinGroup((b=d("WASmaxJsx")).smax("message",{to:d("WAWap").USER_JID(e)},d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishFromProxyAccountMixin").mergeFromProxyAccountMixin,d("WASmaxOutMessagePublishBotResponseMixin").mergeBotResponseMixin(b.smax("bot",null),g),i),d("WASmaxOutMessagePublishMessageTargetMixin").mergeMessageTargetMixin(b.smax("meta",null),j),d("WASmaxOutMessagePublishEncVersion2OrFutureproofMixinGroup").mergeEncVersion2OrFutureproofMixinGroup(d("WASmaxOutMessagePublishEncTypeMessageSecretMessageMixin").mergeEncTypeMessageSecretMessageMixin(b.smax("enc",null),k),a),d("WASmaxChildren").OPTIONAL_CHILD(h,c)),f);return e}function a(a,b){b=j(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeIndividualBotResponseFanoutParticipants=h;g.makeIndividualBotResponseFanoutParticipantsTo=i;g.mergeIndividualBotResponseFanoutMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualBotResponseFanoutOrIndividualBotRequestMessageOrIndividualIndividualSingleOrIndividualIndividualFanoutMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishIndividualBotRequestMessageMixin","WASmaxOutMessagePublishIndividualBotResponseFanoutMixin","WASmaxOutMessagePublishIndividualIndividualFanoutMixin","WASmaxOutMessagePublishIndividualIndividualSingleMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.individualBotResponseFanout)return d("WASmaxOutMessagePublishIndividualBotResponseFanoutMixin").mergeIndividualBotResponseFanoutMixin(a,b.individualBotResponseFanout);if(b.individualBotRequestMessage)return d("WASmaxOutMessagePublishIndividualBotRequestMessageMixin").mergeIndividualBotRequestMessageMixin(a,b.individualBotRequestMessage);if(b.individualIndividualSingle)return d("WASmaxOutMessagePublishIndividualIndividualSingleMixin").mergeIndividualIndividualSingleMixin(a,b.individualIndividualSingle);if(b.individualIndividualFanout)return d("WASmaxOutMessagePublishIndividualIndividualFanoutMixin").mergeIndividualIndividualFanoutMixin(a,b.individualIndividualFanout);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeIndividualBotResponseFanoutOrIndividualBotRequestMessageOrIndividualIndividualSingleOrIndividualIndividualFanoutMixinGroup=a}),98);
__d("WASmaxOutMessagePublishIndividualRecipientDeprecaredMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.messageRecipient;a=d("WASmaxJsx").smax("message",{recipient:d("WAWap").USER_JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualRecipientDeprecaredMixin=a}),98);
__d("WASmaxOutMessagePublishMessageEditMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",{edit:"1"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeMessageEditMixin=a}),98);
__d("WASmaxOutMessagePublishMessagePinMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",{edit:"2"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeMessagePinMixin=a}),98);
__d("WASmaxOutMessagePublishRevokeMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",{edit:"7"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeRevokeMixin=a}),98);
__d("WASmaxOutMessagePublishMessageEditOrMessagePinOrRevokeMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishMessageEditMixin","WASmaxOutMessagePublishMessagePinMixin","WASmaxOutMessagePublishRevokeMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.isMessageEdit)return d("WASmaxOutMessagePublishMessageEditMixin").mergeMessageEditMixin(a);if(b.isMessagePin)return d("WASmaxOutMessagePublishMessagePinMixin").mergeMessagePinMixin(a);if(b.isRevoke)return d("WASmaxOutMessagePublishRevokeMixin").mergeRevokeMixin(a);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeMessageEditOrMessagePinOrRevokeMixinGroup=a}),98);
__d("WASmaxOutMessagePublishRecipientPNMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.messageRecipientPn;a=d("WASmaxJsx").smax("message",{recipient_pn:d("WAWap").USER_JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeRecipientPNMixin=a}),98);
__d("WASmaxOutMessagePublishRecipientUsernameMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.messageRecipientUsername;a=d("WASmaxJsx").smax("message",{recipient_username:d("WAWap").CUSTOM_STRING(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeRecipientUsernameMixin=a}),98);
__d("WASmaxOutMessagePublishRecipientPNOrUsernameMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishRecipientPNMixin","WASmaxOutMessagePublishRecipientUsernameMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.recipientPN)return d("WASmaxOutMessagePublishRecipientPNMixin").mergeRecipientPNMixin(a,b.recipientPN);if(b.recipientUsername)return d("WASmaxOutMessagePublishRecipientUsernameMixin").mergeRecipientUsernameMixin(a,b.recipientUsername);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeRecipientPNOrUsernameMixinGroup=a}),98);
__d("WASmaxOutMessagePublishThreadTypeTagEnumMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.metaThreadType;a=d("WASmaxJsx").smax("meta",{thread_type:d("WAWap").INT(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeThreadTypeTagEnumMixin=a}),98);
__d("WASmaxOutMessagePublishThreadTypeTagLegacyMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.metaThreadType;a=d("WASmaxJsx").smax("meta",{thread_type:d("WAWap").CUSTOM_STRING(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeThreadTypeTagLegacyMixin=a}),98);
__d("WASmaxOutMessagePublishThreadTypeTagEnumOrLegacyMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishThreadTypeTagEnumMixin","WASmaxOutMessagePublishThreadTypeTagLegacyMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.threadTypeTagEnum)return d("WASmaxOutMessagePublishThreadTypeTagEnumMixin").mergeThreadTypeTagEnumMixin(a,b.threadTypeTagEnum);if(b.threadTypeTagLegacy)return d("WASmaxOutMessagePublishThreadTypeTagLegacyMixin").mergeThreadTypeTagLegacyMixin(a,b.threadTypeTagLegacy);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeThreadTypeTagEnumOrLegacyMixinGroup=a}),98);
__d("WASmaxOutMessagePublishThreadTypeTagMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishThreadTypeTagEnumOrLegacyMixinGroup"],(function(a,b,c,d,e,f,g){function h(a){a=a.threadTypeTagEnumOrLegacyMixinGroupArgs;a=d("WASmaxJsx").smax("message",null,d("WASmaxOutMessagePublishThreadTypeTagEnumOrLegacyMixinGroup").mergeThreadTypeTagEnumOrLegacyMixinGroup(d("WASmaxJsx").smax("meta",null),a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeThreadTypeTagMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualRequest",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishBaseMixin","WASmaxOutMessagePublishGroupInviteTargetMixin","WASmaxOutMessagePublishIndividualBotResponseFanoutOrIndividualBotRequestMessageOrIndividualIndividualSingleOrIndividualIndividualFanoutMixinGroup","WASmaxOutMessagePublishIndividualRecipientDeprecaredMixin","WASmaxOutMessagePublishMessageEditOrMessagePinOrRevokeMixinGroup","WASmaxOutMessagePublishRecipientPNOrUsernameMixinGroup","WASmaxOutMessagePublishThreadTypeTagMixin","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b,c=a.messageId,e=a.groupInviteTargetMixinArgs,f=a.threadTypeTagMixinArgs,g=a.individualRecipientDeprecaredMixinArgs,h=a.individualBotResponseFanoutOrIndividualBotRequestMessageOrIndividualIndividualSingleOrIndividualIndividualFanoutMixinGroupArgs,i=a.messageEditOrMessagePinOrRevokeMixinGroupArgs,j=a.recipientPNOrUsernameMixinGroupArgs;b=(b=d("WASmaxMixins")).optionalMerge(d("WASmaxOutMessagePublishRecipientPNOrUsernameMixinGroup").mergeRecipientPNOrUsernameMixinGroup,b.optionalMerge(d("WASmaxOutMessagePublishMessageEditOrMessagePinOrRevokeMixinGroup").mergeMessageEditOrMessagePinOrRevokeMixinGroup,d("WASmaxOutMessagePublishIndividualBotResponseFanoutOrIndividualBotRequestMessageOrIndividualIndividualSingleOrIndividualIndividualFanoutMixinGroup").mergeIndividualBotResponseFanoutOrIndividualBotRequestMessageOrIndividualIndividualSingleOrIndividualIndividualFanoutMixinGroup(b.optionalMerge(d("WASmaxOutMessagePublishIndividualRecipientDeprecaredMixin").mergeIndividualRecipientDeprecaredMixin,b.optionalMerge(d("WASmaxOutMessagePublishThreadTypeTagMixin").mergeThreadTypeTagMixin,b.optionalMerge(d("WASmaxOutMessagePublishGroupInviteTargetMixin").mergeGroupInviteTargetMixin,d("WASmaxOutMessagePublishBaseMixin").mergeBaseMixin(d("WASmaxJsx").smax("message",{id:d("WAWap").STANZA_ID(c)}),a),e),f),g),h),i),j);return b}g.makeIndividualRequest=a}),98);
__d("WASmaxMessagePublishIndividualRPC",["WAComms","WASmaxInMessagePublishIndividualResponseNegative","WASmaxInMessagePublishIndividualResponseSuccess","WASmaxOutMessagePublishIndividualRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:e=d("WASmaxOutMessagePublishIndividualRequest").makeIndividualRequest(a);i.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(e,c));case 3:f=i.sent;g=d("WASmaxInMessagePublishIndividualResponseNegative").parseIndividualResponseNegative(f,e);if(!g.success){i.next=7;break}return i.abrupt("return",{name:"IndividualResponseNegative",value:g.value});case 7:h=d("WASmaxInMessagePublishIndividualResponseSuccess").parseIndividualResponseSuccess(f,e);if(!h.success){i.next=10;break}return i.abrupt("return",{name:"IndividualResponseSuccess",value:h.value});case 10:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Individual",{Negative:g,Success:h}));case 11:case"end":return i.stop()}},null,this)}g.sendIndividualRPC=a}),98);
__d("WASendMsgRPC",["WADeprecatedSendIq","WADeprecatedWapParser","WAGetDeviceIdentityMixin","WAJids","WALogger","WAParseFranking","WASmaxMessagePublishIndividualRPC","WATimeUtils","WAWap","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["WASendMsgRPC: Wrong media type: ",""]);h=function(){return a};return a}function a(a,c,e,f){var g,h,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S;return b("regeneratorRuntime").async(function(T){while(1)switch(T.prev=T.next){case 0:f===void 0&&(f=!1);g=d("WAJids").interpretAsGroupJid(a.protocolMsgId.chat);h=a.messageType.type==="text"&&a.messageType.invitedParticipantUserJid!=null;if(!(c.type==="direct_user")){T.next=17;break}p={individualIndividualSingle:{messageTo:c.message.to,individualIndividualRetryMixinArgs:l(a.count,c.recipient),contentMixinsArgs:k(a,c.message),encTypeIndividualMixinArgs:m(c.message),encVersion2Or3MixinGroupArgs:n(c.message)}};q={messageId:a.externalId,deviceIdentityMixinArgs:d("WAGetDeviceIdentityMixin").getDeviceIdentityMixin(a.deviceIdentity),hasNoExtraFanout:a.messageType.isInvisible===!0?!0:null,messageEditOrMessagePinOrRevokeMixinGroupArgs:o(a.messageType),clientFrankingTagMixinArgs:(e==null?void 0:e.frankingTag)?{frankingTagElementValue:e.frankingTag}:null,hasMetaHideDecryptionPlaceholder:a.messageType.isInvisible===!0?!0:null,groupInviteTargetMixinArgs:h&&g!=null?{metaGroupInvite:g}:null,individualBotResponseFanoutOrIndividualBotRequestMessageOrIndividualIndividualSingleOrIndividualIndividualFanoutMixinGroupArgs:p,internalTestMixinArgs:f?{testConfig:"armadillo_express"}:null};T.next=8;return b("regeneratorRuntime").awrap(d("WASmaxMessagePublishIndividualRPC").sendIndividualRPC(q));case 8:r=T.sent;if(!(r.name==="IndividualResponseSuccess")){T.next=15;break}t=((s=r.value.deviceListStaleMixin)==null?void 0:s.phash)!=null?{type:"mismatch",local:null,server:r.value.deviceListStaleMixin.phash}:{type:"ok"};u=r.value.serverFrankingTagMixin!=null&&e!=null?babelHelpers["extends"]({},e,{reportingTag:r.value.serverFrankingTagMixin.frankingReportingTagElementValue}):null;return T.abrupt("return",{type:"success",ts:d("WATimeUtils").castToUnixTime(r.value.t),phash:t,count:null,reportingMeta:u});case 15:r.name;return T.abrupt("return",{type:"error",errorCode:parseInt(r.value.error,10),applicationError:(v=r.value.applicationNegativeAckMixin)==null?void 0:v.applicationError});case 17:w=a.messageType.isInvisible===!0?"false":d("WAWap").DROP_ATTR;x=c.participant!=null?d("WAWap").JID(c.participant):d("WAWap").DROP_ATTR;y=c.phash!=null&&c.type==="group"?d("WAWap").CUSTOM_STRING(c.phash):d("WAWap").DROP_ATTR;z=a.messageType.type==="text"&&a.messageType.isRevoked?d("WAWap").CUSTOM_STRING("7"):d("WAWap").DROP_ATTR;A=!h||g==null?null:d("WAWap").wap("meta",{group_invite:d("WAWap").CUSTOM_STRING(g)});B=f?d("WAWap").wap("test",{config:d("WAWap").CUSTOM_STRING("armadillo_express")}):null;C=a.messageType.isInvisible===!0?d("WAWap").wap("meta",{"decrypt-fail":"hide"}):null;D=a.deviceIdentity!=null?d("WAWap").wap("device-identity",null,a.deviceIdentity):null;E=(e==null?void 0:e.frankingTag)!=null?d("WAWap").wap("franking",null,d("WAWap").wap("franking_tag",null,e.frankingTag)):null;F=null;c.participants!=null&&(F=d("WAWap").wap("participants",null,c.participants.map(function(a){return i(a)})));G=null;c.message!=null&&(G=i(c.message,!0));H=d("WAWap").wap("message",{device_fanout:w,id:d("WAWap").CUSTOM_STRING(a.externalId),to:d("WAWap").JID(c.messageTo),type:d("WAWap").CUSTOM_STRING(a.messageType.type),participant:x,phash:y,edit:z},A,E,F,G,C,D,B);T.next=33;return b("regeneratorRuntime").awrap(d("WADeprecatedSendIq").deprecatedSendStanzaAndReturnAck(H,{id:a.externalId,"class":"message",from:c.messageTo,participant:c.participant!=null?c.participant:null}));case 33:I=T.sent;J=j.parse(I);if(!J.success){T.next=46;break}K=J.success,L=K.errorCode,M=K.applicationError;if(!(L==null)){T.next=43;break}O=J.success,P=O.ts,Q=O.phash,R=O.count;S=e!=null?babelHelpers["extends"]({},e,{reportingTag:(N=J.success.reportingMeta)==null?void 0:N.reportingTag}):null;return T.abrupt("return",{type:"success",ts:P,phash:Q==null||Q===c.phash?{type:"ok"}:{type:"mismatch",local:c.phash,server:Q},count:R,reportingMeta:S});case 43:return T.abrupt("return",{type:"error",errorCode:L,applicationError:M});case 44:T.next=47;break;case 46:return T.abrupt("return",{type:"parsing_error"});case 47:case"end":return T.stop()}},null,this)}function i(a,b){b===void 0&&(b=!1);var c=d("WAWap").wap("enc",{v:d("WAWap").CUSTOM_STRING(a.v),type:d("WAWap").CUSTOM_STRING(a.type),mediatype:a.mediaType!=null?d("WAWap").CUSTOM_STRING(a.mediaType):d("WAWap").DROP_ATTR,count:a.count!=null?d("WAWap").INT(a.count):d("WAWap").DROP_ATTR},a.ciphertext);if(b||a.encType==="group")return c;else return d("WAWap").wap("to",{jid:d("WAWap").DEVICE_JID(a.to)},c)}var j=new(c("WADeprecatedWapParser"))("sendMsgAck",function(a){a.assertTag("ack");return{count:a.maybeAttrInt("count"),errorCode:a.maybeAttrInt("error"),phash:a.maybeAttrString("phash"),applicationError:a.maybeAttrInt("application_error"),ts:a.attrTime("t"),reportingMeta:d("WAParseFranking").parseFrankingNode(a.maybeChild("franking"))}});function k(a,b){if(a.messageType.type==="reaction")return{isContentTypeReaction:!0};if(a.messageType.type==="text")return{isContentTypeText:!0};a.messageType.type;if(b.mediaType!=null){b={contentTypeMediaOrMedianotifyMixinGroupArgs:{isContentTypeMedia:!0},encMediaTypeEncMediaTypeOrEncMediaTypeDeprecatedMixinGroupArgs:{encMediaType:{encMediatype:b.mediaType}}};return{contentTypeMediaSingle:b}}d("WALogger").ERROR(h(),a.messageType.mediaType);return{isContentTypeText:!0}}function l(a,b){a=a!=null?{encCount:a}:null;b=b!=null?{messageRecipient:b}:null;return{encRetryMixinArgs:a,individualIndividualRetryToPeerMixinArgs:b}}function m(a){return{encType:a.type,encElementValue:a.ciphertext}}function n(a){return a.v==="2"?{isEncVersion2:!0}:{isEncVersion3:!0}}function o(a){return a.type==="text"&&a.isRevoked?{isRevoke:!0}:null}g.sendStanza=a;g.createEncWapNode=i}),98);
__d("WASendMsgUtil",["Promise","WABridge","WAEncGroupMsg","WAEncUserMsg","WAGlobals","WAJids","WAJobDefinitions","WAJobs","WALogger","WAMsgType","WAOdsEnums","WAResultOrError","WASendMsgRPC","WAServerMediaType","WAStateMachines","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendMessage ack success is true, error: ",", chatType:",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendMessage ack success is false, chatType:",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Got phash mismatch, local[","] server[","]"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg -- encryptChatMessage -- finish encrypt group message"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg -- encryptChatMessage -- group message"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error during send message post-processing. Err: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["MAWSendMsg Failed to encrypt message for "," message"]);o=function(){return a};return a}var p=10002;function a(a,c,e){var f,g,i,j,k,l,m,q,r;return b("regeneratorRuntime").async(function(A){while(1)switch(A.prev=A.next){case 0:e===void 0&&(e=!1);x(a,c);j=e?3:2;k=function(b){return a.type==="chat"?t(a,c,j,{cryptoManager:b}):s(a,{cryptoManager:b},j)};if(!d("WAGlobals").getConfig().waEncryptionInOneQueue()){A.next=10;break}A.next=7;return b("regeneratorRuntime").awrap(d("WAGlobals").getWaOneQueue().enqueue(function(a){a=a.cryptoManager;return k(a)},{operationType:"encrypt",flush:!0}));case 7:i=A.sent;A.next=13;break;case 10:A.next=12;return b("regeneratorRuntime").awrap(k(d("WAGlobals").DEPRECATED_getCryptoManager()));case 12:i=A.sent;case 13:l=i.success?i.value.type:i.error;y(l,c);if(!(i.success===!1)){A.next=21;break}c==null?void 0:c.endFail("fail_encrypt");d("WALogger").ERROR(o(),l);A.next=20;return b("regeneratorRuntime").awrap(d("WAGlobals").getDbImpls().markMsgSendFailed(a.protocolMsgId));case 20:return A.abrupt("return",{type:"error"});case 21:m=i.value;c==null?void 0:c.addPoint("sending_stanza",{"int":{encMessageSize:((f=m.message)==null?void 0:(g=f.ciphertext)==null?void 0:g.length)||0}});A.next=25;return b("regeneratorRuntime").awrap(d("WASendMsgRPC").sendStanza(a,m,a.reportingMeta,e));case 25:q=A.sent;c==null?void 0:c.addPoint("ack_returned");if(!(q.type==="success")){A.next=38;break}A.prev=28;A.next=31;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all([u(a,m,q,c),v(a,q,c),w(m,c)]));case 31:return A.abrupt("return",{type:"success",baseKey:(r=m.message)==null?void 0:r.baseKey});case 34:A.prev=34;A.t0=A["catch"](28);d("WALogger").ERROR(n(),A.t0.message);return A.abrupt("return",{type:"error"});case 38:q.type;z(q,l,c);if(!(q.applicationError===p)){A.next=43;break}A.next=43;return b("regeneratorRuntime").awrap(d("WAGlobals").getDbImpls().handleReachabilityErrorAdminMsg(a.chat));case 43:A.next=45;return b("regeneratorRuntime").awrap(d("WAGlobals").getDbImpls().markMsgSendFailed(a.protocolMsgId));case 45:return A.abrupt("return",{type:"error"});case 46:case"end":return A.stop()}},null,this,[[28,34]])}function q(a){return d("WAStateMachines").getStateMachine("devicesStateMachine").reset([a]).then(function(){return d("WAStateMachines").getStateMachine("devicesStateMachine").waitForUserDevices([a],!0)})}function r(a){return d("WAJids").switchOnChatJidType(a,{interopUser:q,msgrUser:q,lidUser:q,phoneUser:q,group:function(a){return d("WAJobs").getJobManager().waitUntilPersisted(d("WAJobDefinitions").createStartJobInfo("queryGroups",{type:"single",group:a,request:"participant_change_recovery"}))}})}function s(a,c,e){var f,g,h,i,j,k,l,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:f=a.chat,g=a.to,h=a.messageBytes,i=a.messageType,j=a.count,k=a.sessionInfo,l=a.identityKey;n.next=3;return b("regeneratorRuntime").awrap(d("WAEncUserMsg").encryptDeviceJidMessage(g,{type:"message",chat:f,messageBytes:h,messageType:i,applicationPayloadVersion:e},c,j,k,l));case 3:m=n.sent;return n.abrupt("return",d("WAJids").switchOnUserChatJidType(f,{user:function(b){return m!=null?d("WAResultOrError").makeResult({type:"direct_user",messageTo:a.to,message:m,recipient:d("WAGlobals").isPeerDevice(a.to)?b:null}):d("WAResultOrError").makeError("direct_user")},group:function(b){return m!=null?d("WAResultOrError").makeResult({type:"direct_group",messageTo:b,participant:a.to,message:m}):d("WAResultOrError").makeError("direct_group")}}));case 5:case"end":return n.stop()}},null,this)}function t(a,c,e,f){var g=a.recipients,h=a.messageBytes,i=a.messageType,j=a.chat,k=a.icdcInfo;return d("WAJids").switchOnUserChatJidType(j,{user:function(a){var c,j;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:l.next=2;return b("regeneratorRuntime").awrap(d("WAEncUserMsg").encryptUserMsg(g,{type:"message",messageBytes:h,messageType:i,chat:a,applicationPayloadVersion:e},k,f));case 2:c=l.sent;j=c.participants;if(!(j!=null&&j.length>0)){l.next=6;break}return l.abrupt("return",d("WAResultOrError").makeResult({type:"user",messageTo:a,participants:j,phash:c.phash}));case 6:return l.abrupt("return",d("WAResultOrError").makeError("user"));case 7:case"end":return l.stop()}},null,this)},group:function(a){var e,j,k;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:d("WALogger").LOG(m());n.next=3;return b("regeneratorRuntime").awrap(d("WAEncGroupMsg").encryptGroupMsg(a,g,h,i,f,c));case 3:e=n.sent;d("WALogger").LOG(l());j=e.participants,k=e.encNode;if(!(j==null&&k==null)){n.next=8;break}return n.abrupt("return",d("WAResultOrError").makeError("group"));case 8:return n.abrupt("return",d("WAResultOrError").makeResult({type:"group",messageTo:a,participants:j,message:k,senderKeyDistributionInfo:e.senderKeyDistributionInfo,phash:e.phash}));case 9:case"end":return n.stop()}},null,this)}})}function c(a){var b=d("WAServerMediaType").getMediaType(a),c=a===d("WAMsgType").MSG_TYPE.REVOKED;if(b!=null)return{mediaType:b,type:"media"};else if(a===d("WAMsgType").MSG_TYPE.SK_DISTRIBUTION)return{isInvisible:!0,isRevoked:!1,type:"text"};else return{isRevoked:c,type:"text"}}function u(a,c,e,f){var g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:if(!(e.type!=="success")){i.next=2;break}return i.abrupt("return");case 2:g=e.phash;if(!(g.type==="mismatch")){i.next=11;break}i.next=6;return b("regeneratorRuntime").awrap(d("WAGlobals").getDbImpls().writeDebugMsg(a.chat,"Outgoing msg "+a.externalId+" got a phash mismatch: local["+((h=g.local)!=null?h:"undefined")+"] server["+g.server+"]"));case 6:d("WALogger").LOG(k(),g.local,g.server);d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.PHASH_MISMATCH,key:c.type});i.next=10;return b("regeneratorRuntime").awrap(r(a.chat));case 10:f==null?void 0:f.addPoint("participant_recovery_finished");case 11:case"end":return i.stop()}},null,this)}function v(a,c,e){return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:if(!(c.type!=="success")){f.next=2;break}return f.abrupt("return");case 2:f.next=4;return b("regeneratorRuntime").awrap(d("WAGlobals").getDbImpls().markMsgSent(a.protocolMsgId,c.ts,c.count,c.reportingMeta));case 4:e==null?void 0:e.addPoint("mark_msg_sent");case 5:case"end":return f.stop()}},null,this)}function w(a,c){var e,f,g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:if(!(a.senderKeyDistributionInfo!=null)){i.next=5;break}e=a.senderKeyDistributionInfo,f=e.group,g=e.senderKeyId,h=e.knowsSenderKey;i.next=4;return b("regeneratorRuntime").awrap(d("WAGlobals").getDbImpls().markSenderKeyAsSent(f,g,h));case 4:c==null?void 0:c.addPoint("mark_sender_key_sent");case 5:case"end":return i.stop()}},null,this)}function x(a,b){var c=0;a.type==="chat"&&(c=a.recipients.reduce(function(a,b){return a+b.devicesInfo.length},0));var d=a.messageType.type==="text"&&a.messageType.isRevoked;d=d?"revoke":a.messageType.type;b==null?void 0:b.addPoint("start_encrypt",{string:{sentMessageType:d},"int":{numDevices:c},bool:{isInvisibleMsg:a.messageType.type==="text"&&a.messageType.isInvisible===!0}})}function y(a,b){b==null?void 0:b.addPoint("finish_encrypt",{string:{chatType:a}})}function z(a,b,c){if(a.type==="success")return;a.type==="parsing_error"&&(d("WALogger").ERROR(j(),b),c==null?void 0:c.addPoint("ack_parse_fail"));var e=a.errorCode;a=a.applicationError;a===p&&(c==null?void 0:c.addPoint("reachability_error_code"));d("WALogger").ERROR(i(),e,b);e!=null&&(c==null?void 0:c.addPoint("ack_success_error_"+e));c==null?void 0:c.endFail("failed")}g.sendMessage=a;g.getMessageTypeFromMsg=c}),98);
__d("WADanglingQueue",["WAErr","WALogger","WAPersistedQueue"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Passive DQ: clear"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Passive DQ: flush"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Passive DQ: write"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Passive DQ: read"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Passive DQ: count"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["DanglingQueue is already initialized"]);m=function(){return a};return a}var n=null;function a(a){if(n!=null){d("WALogger").WARN(m());return n}a=d("WAPersistedQueue").initPersistedQueue("danglingQueue",a);n=a;return n}function o(){if(!n)throw c("WAErr")("Dangling queue not initialized");return n}function b(){d("WALogger").LOG(l());return o().count()}function e(){d("WALogger").LOG(k());return o().where()}function f(a){d("WALogger").LOG(j()),void o().write(a)}function p(){d("WALogger").LOG(i());return o().flush()}function q(){d("WALogger").LOG(h());return o().clear()}g.initDanglingQueue=a;g.danglingQueueCount=b;g.danglingQueueRead=e;g.danglingQueueWrite=f;g.danglingQueueFlush=p;g.danglingQueueClear=q}),98);
__d("WAWa5.pb",["$InternalEnum","WAProtoConst"],(function(a,b,c,d,e,f,g){c=(a=b("$InternalEnum"))({WHATSAPP:0,MESSENGER:1});e=a({SYSTEM:0,GOOGLE:1,HARDCODED:2,OVERRIDE:3,FALLBACK:4});f=a({CELLULAR_UNKNOWN:0,WIFI_UNKNOWN:1,CELLULAR_EDGE:100,CELLULAR_IDEN:101,CELLULAR_UMTS:102,CELLULAR_EVDO:103,CELLULAR_GPRS:104,CELLULAR_HSDPA:105,CELLULAR_HSUPA:106,CELLULAR_HSPA:107,CELLULAR_CDMA:108,CELLULAR_1XRTT:109,CELLULAR_EHRPD:110,CELLULAR_LTE:111,CELLULAR_HSPAP:112});b=a({PUSH:0,USER_ACTIVATED:1,SCHEDULED:2,ERROR_RECONNECT:3,NETWORK_SWITCH:4,PING_RECONNECT:5,UNKNOWN:6});var h=a({SHARE_EXTENSION:0,SERVICE_EXTENSION:1,INTENTS_EXTENSION:2}),i=a({WEB_BROWSER:0,APP_STORE:1,WIN_STORE:2,DARWIN:3,WIN32:4}),j=a({PHONE:0,TABLET:1,DESKTOP:2,WEARABLE:3,VR:4}),k=a({RELEASE:0,BETA:1,ALPHA:2,DEBUG:3});a=a({ANDROID:0,IOS:1,WINDOWS_PHONE:2,BLACKBERRY:3,BLACKBERRYX:4,S40:5,S60:6,PYTHON_CLIENT:7,TIZEN:8,ENTERPRISE:9,SMB_ANDROID:10,KAIOS:11,SMB_IOS:12,WINDOWS:13,WEB:14,PORTAL:15,GREEN_ANDROID:16,GREEN_IPHONE:17,BLUE_ANDROID:18,BLUE_IPHONE:19,FBLITE_ANDROID:20,MLITE_ANDROID:21,IGLITE_ANDROID:22,PAGE:23,MACOS:24,OCULUS_MSG:25,OCULUS_CALL:26,MILAN:27,CAPI:28,WEAROS:29,ARDEVICE:30,VRDEVICE:31,BLUE_WEB:32,IPAD:33,TEST:34,SMART_GLASSES:35});var l={},m={},n={},o={},p={},q={},r={},s={},t={},u={},v={};l.internalSpec={clientHello:[2,(d=d("WAProtoConst")).TYPES.MESSAGE,o],serverHello:[3,d.TYPES.MESSAGE,n],clientFinish:[4,d.TYPES.MESSAGE,m]};m.internalSpec={"static":[1,d.TYPES.BYTES],payload:[2,d.TYPES.BYTES]};n.internalSpec={ephemeral:[1,d.TYPES.BYTES],"static":[2,d.TYPES.BYTES],payload:[3,d.TYPES.BYTES]};o.internalSpec={ephemeral:[1,d.TYPES.BYTES],"static":[2,d.TYPES.BYTES],payload:[3,d.TYPES.BYTES]};p.internalSpec={username:[1,d.TYPES.UINT64],passive:[3,d.TYPES.BOOL],userAgent:[5,d.TYPES.MESSAGE,u],webInfo:[6,d.TYPES.MESSAGE,s],pushName:[7,d.TYPES.STRING],sessionId:[9,d.TYPES.SFIXED32],shortConnect:[10,d.TYPES.BOOL],connectType:[12,d.TYPES.ENUM,f],connectReason:[13,d.TYPES.ENUM,b],shards:[14,d.FLAGS.REPEATED|d.TYPES.INT32],dnsSource:[15,d.TYPES.MESSAGE,r],connectAttemptCount:[16,d.TYPES.UINT32],device:[18,d.TYPES.UINT32],devicePairingData:[19,d.TYPES.MESSAGE,q],product:[20,d.TYPES.ENUM,c],fbCat:[21,d.TYPES.BYTES],fbUserAgent:[22,d.TYPES.BYTES],oc:[23,d.TYPES.BOOL],lc:[24,d.TYPES.INT32],iosAppExtension:[30,d.TYPES.ENUM,h],fbAppId:[31,d.TYPES.UINT64],fbDeviceId:[32,d.TYPES.BYTES],pull:[33,d.TYPES.BOOL],paddingBytes:[34,d.TYPES.BYTES],yearClass:[36,d.TYPES.INT32],memClass:[37,d.TYPES.INT32]};q.internalSpec={eRegid:[1,d.TYPES.BYTES],eKeytype:[2,d.TYPES.BYTES],eIdent:[3,d.TYPES.BYTES],eSkeyId:[4,d.TYPES.BYTES],eSkeyVal:[5,d.TYPES.BYTES],eSkeySig:[6,d.TYPES.BYTES],buildHash:[7,d.TYPES.BYTES],deviceProps:[8,d.TYPES.BYTES]};r.internalSpec={dnsMethod:[15,d.TYPES.ENUM,e],appCached:[16,d.TYPES.BOOL]};s.internalSpec={refToken:[1,d.TYPES.STRING],version:[2,d.TYPES.STRING],webdPayload:[3,d.TYPES.MESSAGE,t],webSubPlatform:[4,d.TYPES.ENUM,i]};t.internalSpec={usesParticipantInKey:[1,d.TYPES.BOOL],supportsStarredMessages:[2,d.TYPES.BOOL],supportsDocumentMessages:[3,d.TYPES.BOOL],supportsUrlMessages:[4,d.TYPES.BOOL],supportsMediaRetry:[5,d.TYPES.BOOL],supportsE2EImage:[6,d.TYPES.BOOL],supportsE2EVideo:[7,d.TYPES.BOOL],supportsE2EAudio:[8,d.TYPES.BOOL],supportsE2EDocument:[9,d.TYPES.BOOL],documentTypes:[10,d.TYPES.STRING],features:[11,d.TYPES.BYTES]};u.internalSpec={platform:[1,d.TYPES.ENUM,a],appVersion:[2,d.TYPES.MESSAGE,v],mcc:[3,d.TYPES.STRING],mnc:[4,d.TYPES.STRING],osVersion:[5,d.TYPES.STRING],manufacturer:[6,d.TYPES.STRING],device:[7,d.TYPES.STRING],osBuildNumber:[8,d.TYPES.STRING],phoneId:[9,d.TYPES.STRING],releaseChannel:[10,d.TYPES.ENUM,k],localeLanguageIso6391:[11,d.TYPES.STRING],localeCountryIso31661Alpha2:[12,d.TYPES.STRING],deviceBoard:[13,d.TYPES.STRING],deviceExpId:[14,d.TYPES.STRING],deviceType:[15,d.TYPES.ENUM,j]};v.internalSpec={primary:[1,d.TYPES.UINT32],secondary:[2,d.TYPES.UINT32],tertiary:[3,d.TYPES.UINT32],quaternary:[4,d.TYPES.UINT32],quinary:[5,d.TYPES.UINT32]};g.ClientPayload$Product=c;g.ClientPayload$DNSSource$DNSResolutionMethod=e;g.ClientPayload$ConnectType=f;g.ClientPayload$ConnectReason=b;g.ClientPayload$IOSAppExtension=h;g.ClientPayload$WebInfo$WebSubPlatform=i;g.ClientPayload$UserAgent$DeviceType=j;g.ClientPayload$UserAgent$ReleaseChannel=k;g.ClientPayload$UserAgent$Platform=a;g.HandshakeMessageSpec=l;g.HandshakeMessage$ClientFinishSpec=m;g.HandshakeMessage$ServerHelloSpec=n;g.HandshakeMessage$ClientHelloSpec=o;g.ClientPayloadSpec=p;g.ClientPayload$DevicePairingRegistrationDataSpec=q;g.ClientPayload$DNSSourceSpec=r;g.ClientPayload$WebInfoSpec=s;g.ClientPayload$WebInfo$WebdPayloadSpec=t;g.ClientPayload$UserAgentSpec=u;g.ClientPayload$UserAgent$AppVersionSpec=v}),98);
__d("WACryptoCurve25519",["Promise","WALogger"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Curve25519.generateSharedSecret pubkey:",""]);i=function(){return a};return a}a=function(){function a(a,c){this.signalDependencies=a,this.keyPair=c?(h||(h=b("Promise"))).resolve(c):this.signalDependencies.generateIdentityKeyPair()}var c=a.prototype;c.generatePublicKey=function(){return this.keyPair.then(function(a){return a.publicKey})};c.generateSharedSecret=function(a){var b=this;return this.keyPair.then(function(c){c=c.privateKey;d("WALogger").LOG(i(),a).devConsole(c);return b.signalDependencies.calculateAgreement(new Uint8Array(a),c)})};return a}();g.Curve25519=a}),98);
__d("WAConnectivityReports",["WALogger","WAPREList","WAPREMetrics"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Connectivity]: ",". Reason: ",", clean: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Connectivity]: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Connectivity]: ",""]);j=function(){return a};return a}function a(a,b){d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.WA_DISCONNECT).endSuccess({string:{key:"code"+b.code}});a=a!=null?"WebSocket "+a+" closed. code: "+b.code:"WebSocket closed connection during initialization. Code: "+b.code;switch(b.code){case 1e3:case 1001:case 1006:d("WALogger").LOG(j(),a);break;case 1002:case 1003:case 1007:case 1008:case 1009:case 1010:case 1011:case 1015:d("WALogger").ERROR(i(),a);break;default:d("WALogger").ERROR(h(),a,b.reason,b.wasClean);break}}g.onWebSocketCloseEvent=a}),98);
__d("WASocketTransport",["Promise","WABinary","WAConnectivityReports","WAErr","WALogger"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["WebSocket #"," not opened"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["WebSocket #"," errored: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["WebSocket #"," dropped "," bytes"]);k=function(){return a};return a}var l=1,m=function(){function a(a){var b=this;this.$2=!1;this.onData=null;this.onClose=null;this.onError=null;this.dataToSend=new(d("WABinary").Binary)();this.$3=function(a){if(b.$2)return;a=new Uint8Array(a.data);b.onData?b.onData(a):d("WALogger").ERROR(k(),b.id,a.length)};this.$4=function(a){d("WAConnectivityReports").onWebSocketCloseEvent(b.id,a);if(b.$2)return;b.$6()};this.$5=function(a){d("WALogger").DEV(j(),b.id,a);if(b.$2)return;var c=b.onError;c&&c(String(a))};var c=l++;this.id=c;this.$1=a;a.onmessage=this.$3;a.onclose=this.$4;a.onerror=this.$5}var b=a.prototype;b.close=function(){if(this.$2)return;this.$1.close();this.$6()};b.requestSend=function(){if(this.$2){d("WALogger").ERROR(i(),this.id);return}if(!this.dataToSend.size())return;this.$1.send(this.dataToSend.readBuffer())};b.$6=function(){this.$2=!0,this.onClose&&this.onClose()};return a}();function a(a){var e=new WebSocket(a);e.binaryType="arraybuffer";return new(h||(h=b("Promise")))(function(a,b){e.onopen=a,e.onclose=function(a){d("WAConnectivityReports").onWebSocketCloseEvent(null,a),b(c("WAErr")("WebSocket closed immediately: "+a.reason+" "+a.code))}}).then(function(){return new m(e)})}g.openWebSocket=a}),98);
__d("WATreasureHunt",["Promise","WAResultOrError"],(function(a,b,c,d,e,f,g){var h,i=new(h||(h=b("Promise")))(function(){});function a(a,c,e,f){var g=0,j=0,k=!1,l=null,m=null;function n(a){if(!k){k=!0;l!=null&&(clearTimeout(l),l=null);return d("WAResultOrError").makeResult(a)}else{f==null?void 0:f(a);return i}}function o(){if(k)return i;j++;if(j===c)return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeError("max-hunters"));var a=m;a!=null&&j===g&&(l!=null&&(clearTimeout(l),l=null),a());return i}function p(){var d=g++;d=a(d).then(n,o);if(g<c){var f=new(h||(h=b("Promise")))(function(a){l=setTimeout(a,e),m=a}).then(p);return h.race([d,f])}else return d}return p()}g.treasureHunt=a}),98);
__d("WACert.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};c={};e={};f={};a.internalSpec={details:[1,(d=d("WAProtoConst")).TYPES.BYTES],signature:[2,d.TYPES.BYTES]};b.internalSpec={serial:[1,d.TYPES.UINT32],issuer:[2,d.TYPES.STRING],expires:[3,d.TYPES.UINT64],subject:[4,d.TYPES.STRING],key:[5,d.TYPES.BYTES]};c.internalSpec={leaf:[1,d.TYPES.MESSAGE,e],intermediate:[2,d.TYPES.MESSAGE,e]};e.internalSpec={details:[1,d.TYPES.BYTES],signature:[2,d.TYPES.BYTES]};f.internalSpec={serial:[1,d.TYPES.UINT32],issuerSerial:[2,d.TYPES.UINT32],key:[3,d.TYPES.BYTES],notBefore:[4,d.TYPES.UINT64],notAfter:[5,d.TYPES.UINT64]};g.NoiseCertificateSpec=a;g.NoiseCertificate$DetailsSpec=b;g.CertChainSpec=c;g.CertChain$NoiseCertificateSpec=e;g.CertChain$NoiseCertificate$DetailsSpec=f}),98);
__d("WAVerifyChainCertificateWA6",["WACert.pb","WACryptoUtils","WAHex","WALogger","WAResultOrError","WASignalKeys","WASignalOther","WASignalSignatures","decodeProtobuf"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(['parseCertificateWA6 certificate is missing "key"']);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(['parseCertificateWA6 certificate is missing "serial"']);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(['parseCertificateWA6 certificate is missing "issuer_serial"']);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(['parseCertificateWA6 certificate is missing "signature"']);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(['parseCertificateWA6 certificate is missing "details"']);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["verifyChainCertificateWA6 leafCert.key does not match handshake server.hello.static"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["verifyChainCertificateWA6: leaf certificate is poorly signed"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["verifyChainCertificateWA6 leaf certificate was not issued by RootCA"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["verifyChainCertificateWA6: invalid leaf certificate"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["verifying leaf certificate"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["verifyChainCertificateWA6: intermediate certificate is poorly signed"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["verifyChainCertificateWA6 intermediate certificate was not issued by RootCA"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["verifyChainCertificateWA6: invalid intermediate certificate"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["verifying intermediate certificate"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["verifyChainCertificateWA6: missing leaf and/or intermediate certificate"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["verifyChainCertificateWA6: extract leaf and intermediate certificate"]);w=function(){return a};return a}b="142375574d0a587166aae71ebe516437c4a28b73e3695c6ce1f7f9545da8ee6b";var x={SERIAL:0,ISSUER:"WhatsAppLongTerm1",PUBLIC_KEY:d("WASignalKeys").serializeIdentity(new Uint8Array(d("WAHex").parseHex(b)))};function a(a,b){d("WALogger").LOG(w());a=d("decodeProtobuf").decodeProtobuf(d("WACert.pb").CertChainSpec,a);var c=a.intermediate;a=a.leaf;if(c==null||a==null){d("WALogger").ERROR(v());return d("WAResultOrError").makeError("missing-certificate")}d("WALogger").LOG(u());c=y(c);if(!c.success){d("WALogger").ERROR(t());return d("WAResultOrError").makeError("invalid-certificate")}if(c.value.issuerSerial!==x.SERIAL){d("WALogger").ERROR(s());return d("WAResultOrError").makeError("invalid-certificate")}if(!z(c.value,x.PUBLIC_KEY)){d("WALogger").ERROR(r());return d("WAResultOrError").makeError("invalid-certificate")}d("WALogger").LOG(q());a=y(a);if(!a.success){d("WALogger").ERROR(p());return d("WAResultOrError").makeError("invalid-certificate")}if(a.value.issuerSerial!==c.value.serial){d("WALogger").ERROR(o());return d("WAResultOrError").makeError("invalid-certificate")}var e=d("WASignalKeys").serializeIdentity(new Uint8Array(c.value.key));if(!z(a.value,e)){d("WALogger").ERROR(n());return d("WAResultOrError").makeError("invalid-certificate")}if(!d("WACryptoUtils").arrayBuffersEqual(a.value.key,b)){d("WALogger").ERROR(m());return d("WAResultOrError").makeError("invalid-certificate")}return d("WAResultOrError").makeResult({leaf:a.value,intermediate:c.value})}function y(a){var b=a.details;a=a.signature;if(!b){d("WALogger").ERROR(l());return d("WAResultOrError").makeError("invalid-certificate")}if(!a){d("WALogger").ERROR(k());return d("WAResultOrError").makeError("invalid-certificate")}var c=d("decodeProtobuf").decodeProtobuf(d("WACert.pb").CertChain$NoiseCertificate$DetailsSpec,b),e=c.issuerSerial,f=c.serial,g=c.key,m=c.notAfter;c=c.notBefore;if(e==null){d("WALogger").ERROR(j());return d("WAResultOrError").makeError("invalid-certificate")}if(f==null){d("WALogger").ERROR(i());return d("WAResultOrError").makeError("invalid-certificate")}if(g==null){d("WALogger").ERROR(h());return d("WAResultOrError").makeError("invalid-certificate")}a=d("WASignalOther").ensureSize(new Uint8Array(a),64);return d("WAResultOrError").makeResult({serial:f,issuerSerial:e,key:g,notBefore:c,notAfter:m,details:b,signature:a})}function z(a,b){return d("WASignalSignatures").verifyMsgSignalVariant(b,new Uint8Array(a.details),a.signature)}g.ROOT_CA=x;g.verifyChainCertificateWA6=a;g.parseCertificateWA6=y}),98);
__d("WAFrameSocket",["WABinary","WAErrors","WALogger"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["FrameSocket: queueing partial frame of "," bytes"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Buffer to send: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["FrameSocket closed"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["FrameSocket error"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["FrameSocket closed, waiting for pending processing"]);l=function(){return a};return a}var m=function(b){babelHelpers.inheritsLoose(a,b);function a(a){var c="SocketClosed";a=b.call(this,(a=a)!=null?a:c)||this;a.name=c;return a}return a}(babelHelpers.wrapNativeSuper(Error));a=function(){function a(a,b){var c=this;this.$3=new(d("WABinary").Binary)();this.closed=!1;this.$4=!1;this.onFrame=null;this.onClose=null;this.$5=function(a){c.$3.writeByteArray(a),c.convertBufferedToFrames()};this.$6=function(){if(c.$3.peek(n)){d("WALogger").LOG(l());c.$4=!0;return}c.$9()};this.$7=function(a){d("WALogger").DEV(k()).devConsole(a)};this.$2=b;this.$1=a;a.onData=this.$5;a.onClose=this.$6;a.onError=this.$7}var b=a.prototype;b.sendFrame=function(a){if(this.$4)return;this.throwIfClosed();var b=this.$2,c=a.byteLength,d=this.$1.dataToSend;b?(this.$2=null,d.ensureAdditionalCapacity(b.length+3+c),d.writeByteArray(b)):d.ensureAdditionalCapacity(3+c);this.$8(c);d.writeUint8(c>>16);d.writeUint16(c&65535);d.write(a);this.$1.requestSend()};b.$9=function(){if(this.closed)return;d("WALogger").LOG(j());this.$4=!1;this.closed=!0;var a=this.onClose;a&&a()};b.$8=function(a){if(a>=1<<24){d("WALogger").WARN(i(),a);throw new(d("WAErrors").BufferTooLargeError)("Buffer too large: "+a)}};b.convertBufferedToFrames=function(){var a=this.$3,b=this.onFrame;while(b&&a.peek(n)){var c=o(a);c=a.readByteArray(c);b(c);b=this.onFrame}this.$4&&!a.peek(n)&&this.$9();b&&a.size()&&d("WALogger").LOG(h(),a.size())};b.throwIfClosed=function(){if(this.closed)throw new m()};b.close=function(){this.$1.close()};return a}();function n(a){if(a.size()<3)return!1;var b=o(a);return b<=a.size()}function o(a){return a.readUint8()<<16|a.readUint16()}g.SocketClosed=m;g.FrameSocket=a}),98);
__d("WANoiseSocket",["Promise","WACryptoDependencies","WALogger","WAPromiseQueue","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendFrame adding to queue with frame size: "," bytes"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["NoiseSocket socket closed while encrypting frame"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Sending encrypted frame to web socket"]);k=function(){return a};return a}a=(h||(h=b("Promise"))).reject("UNINITIALIZED HANDSHAKE");var l=new Uint8Array(0);a["catch"](function(){});c=function(){function a(a,b,c){var e=this;this.$4=[];this.$5=new(d("WAPromiseQueue").PromiseQueue)();this.$6=new(d("WAPromiseQueue").PromiseQueue)();this.$7=0;this.$8=0;this.$9=!1;this.$14=function(a){!e.$1.closed?(d("WALogger").DEV(k()).tags("WANoiseSocket"),e.$1.sendFrame(a)):d("WALogger").LOG(j())};this.$12=function(a){var b=e.$7++;e.$5.enqueueHandlers(o(e.$2,b,void 0,a),e.$15)};this.$13=function(){e.$9=!0,e.$5.wait().then(function(){e.$9=!1;var a=e.$11;a&&a()})};this.$15=function(a){e.$10?e.$10(a):e.$4.push(a)};this.$1=a;this.$3=b;this.$2=c;a.onFrame=this.$12;this.$1.onClose=this.$13;a.convertBufferedToFrames()}var c=a.prototype;c.sendFrameAsync=function(a){var c;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:d.next=2;return b("regeneratorRuntime").awrap(this.sendFrame(a));case 2:c=d.sent;return d.abrupt("return",c);case 4:case"end":return d.stop()}},null,this)};c.sendFrame=function(a){if(this.$9)return(h||(h=b("Promise"))).resolve();this.$1.throwIfClosed();var c=this.$8++;d("WALogger").DEV(i(),a.length).tags("WANoiseSocket");return this.$6.enqueueHandlers(n(this.$3,c,void 0,a),this.$14)};c.setOnFrame=function(a){this.$10=a};c.setOnClose=function(a){this.$11=a};c.close=function(){this.$1.close()};return a}();function m(a){var b=new ArrayBuffer(12),c=new DataView(b);c.setUint32(8,a);return new Uint8Array(b)}function n(a,b,c,e){return d("WACryptoDependencies").getCrypto().subtle.encrypt({name:"AES-GCM",iv:m(b),additionalData:c?new Uint8Array(c):l},a,e)}function o(a,b,c,e){return d("WACryptoDependencies").getCrypto().subtle.decrypt({name:"AES-GCM",iv:m(b),additionalData:c?new Uint8Array(c):l},a,e)}g.NoiseSocket=c}),98);
__d("WANoiseHandshake",["Promise","WABinary","WACryptoDependencies","WACryptoHkdf","WACryptoSha256","WAErrors","WANoiseSocket","WAResolvable"],(function(a,b,c,d,e,f,g){var h,i=(h||(h=b("Promise"))).reject("UNINITIALIZED HANDSHAKE"),j=new Uint8Array(0);i["catch"](function(){});a=function(){function a(a){var b=this;this.$2=i;this.$3=i;this.$4=i;this.$5=0;this.$1=a;this.$6=new(d("WAResolvable").Resolvable)();a.onClose=function(){b.$6.reject(new(d("WAErrors").Disconnected)("NoiseHandshake: SocketClosed"))};p(this.$6.promise)}var c=a.prototype;c.start=function(a,c){a=d("WABinary").Binary.build(a).readBuffer();a=a.byteLength===32?(h||(h=b("Promise"))).resolve(a):d("WACryptoSha256").sha256(a);this.$2=a;this.$3=a;this.$4=a.then(l);this.authenticate(c)};c.sendAndReceive=function(a){var c=this.$1,d=new(h||(h=b("Promise")))(function(b){c.onFrame=function(a){c.onFrame=null,b(a)},c.sendFrame(a)});return this.$7(d)};c.send=function(a){this.$1.sendFrame(a)};c.authenticate=function(a){this.$2=(h||(h=b("Promise"))).all([this.$2,a]).then(function(a){var b=a[0];a=a[1];b=d("WABinary").Binary.build(b,a).readByteArray();return d("WACryptoSha256").sha256(b)})};c.encrypt=function(a){var c=this.$5++;a=(h||(h=b("Promise"))).all([this.$4,this.$2,a]).then(function(a){var b=a[0],d=a[1];a=a[2];return m(b,c,d,a)});this.authenticate(a);return this.$7(a)};c.decrypt=function(a){var c=this.$5++,d=(h||(h=b("Promise"))).all([this.$4,this.$2]).then(function(b){var d=b[0];b=b[1];return n(d,c,b,a)});this.authenticate(a);return this.$7(d)};c.finish=function(){var a=this,c=this.$3.then(function(a){return o(a,new Uint8Array(0))}).then(function(a){var c=a[0];a=a[1];return(h||(h=b("Promise"))).all([l(c,["encrypt"]),l(a,["decrypt"])])}).then(function(b){var c=b[0];b=b[1];return new(d("WANoiseSocket").NoiseSocket)(a.$1,c,b)});return this.$7(c)};c.mixIntoKey=function(a){this.$5=0;a=(h||(h=b("Promise"))).all([this.$3,a]).then(function(a){var b=a[0];a=a[1];return o(b,new Uint8Array(a))});this.$3=a.then(function(a){return a[0]});this.$4=a.then(function(a){return l(a[1])});p(this.$3);p(this.$4)};c.$7=function(a){var c=this;return(h||(h=b("Promise"))).race([a,this.$6.promise]).then(function(a){return c.$6.resolveWasCalled()?c.$6.promise:a})};return a}();function k(a){var b=new ArrayBuffer(12),c=new DataView(b);c.setUint32(8,a);return new Uint8Array(b)}function l(a,b){b===void 0&&(b=["encrypt","decrypt"]);return d("WACryptoDependencies").getCrypto().subtle.importKey("raw",new Uint8Array(a),"AES-GCM",!1,b)}function m(a,b,c,e){return d("WACryptoDependencies").getCrypto().subtle.encrypt({name:"AES-GCM",iv:k(b),additionalData:c?new Uint8Array(c):j},a,e)}function n(a,b,c,e){return d("WACryptoDependencies").getCrypto().subtle.decrypt({name:"AES-GCM",iv:k(b),additionalData:c?new Uint8Array(c):j},a,e)}function o(a,b){return d("WACryptoHkdf").extractWithSaltAndExpand(b,new Uint8Array(a),"",64).then(function(a){return[a.slice(0,32),a.slice(32)]})}function p(a){a["catch"](function(){})}g.NoiseHandshake=a}),98);
__d("WAOpenChatSocket",["Promise","WABinary","WACryptoCurve25519","WAErr","WAFrameSocket","WALogger","WANoiseHandshake","WAResultOrError","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["openChatSocket performing full handshake"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["openChatSocket performing resume handshake"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["openChatSocket preIntro ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["doFallbackHandshake continuing handshake with given server hello"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["resumeNoiseHandshake performing fallback handshake"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["resumeNoiseHandshake deriving secrets"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["resumeNoiseHandshake continuing resume handshake"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["resumeNoiseHandshake rcv hello"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["resumeNoiseHandshake send hello"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["fullNoiseHandshake rcv hello"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["fullNoiseHandshake send hello"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["doFullHandshakeCore client finish and deriving secrets"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["doFullHandshakeCore parsing and verifying server certificate"]);u=function(){return a};return a}var v="Noise_XX_25519_AESGCM_SHA256\0\0\0\0",w="Noise_IK_25519_AESGCM_SHA256\0\0\0\0",x="Noise_XXfallback_25519_AESGCM_SHA256";function y(a,e,f,g,i){e=e||{};var j=e.ephemeral,k=e["static"];e=e.payload;if(j==null||k==null||e==null)return(h||(h=b("Promise"))).reject(c("WAErr")("doFullHandshakeCore server hello invalid proto"));a.authenticate(j);a.mixIntoKey(g.generateSharedSecret(j));k=a.decrypt(k);a.mixIntoKey(k.then(function(a){return g.generateSharedSecret(a)}));e=a.decrypt(e);return(h||(h=b("Promise"))).all([k,e]).then(function(a){var b=a[0];a=a[1];d("WALogger").LOG(u());return i.processCertificate({certificate:a,serverStatic:b})}).then(function(){var c=a.encrypt(i.staticKeyPair.generatePublicKey());a.mixIntoKey(i.staticKeyPair.generateSharedSecret(j));var d=a.encrypt((h||(h=b("Promise"))).resolve(f));return h.all([c,d])}).then(function(b){var c=b[0];b=b[1];d("WALogger").LOG(t());a.send(i.encodeHandshakeFinish({"static":c,payload:b}));return a.finish()})}function z(a,b,c,e){var f=new(d("WANoiseHandshake").NoiseHandshake)(a);f.start(v,e.protoHeader);a=c.generatePublicKey();f.authenticate(a);return a.then(function(a){d("WALogger").LOG(s());return f.sendAndReceive(e.encodeHandshakeHello({ephemeral:a}))}).then(function(a){d("WALogger").LOG(r());a=e.decodeServerHello(a);return y(f,a,b,c,e)})}function A(a,e,f,g,i){var j=new(d("WANoiseHandshake").NoiseHandshake)(a);j.start(w,i.protoHeader);var k=g.generatePublicKey();j.authenticate(f);j.authenticate(k);j.mixIntoKey(g.generateSharedSecret(f));var l=j.encrypt(i.staticKeyPair.generatePublicKey());j.mixIntoKey(i.staticKeyPair.generateSharedSecret(f));f=j.encrypt((h||(h=b("Promise"))).resolve(e));return h.all([k,f,l]).then(function(b){var a=b[0],c=b[1];b=b[2];d("WALogger").LOG(q());return j.sendAndReceive(i.encodeHandshakeHello({ephemeral:a,payload:c,"static":b}))}).then(function(b){d("WALogger").LOG(p());b=i.decodeServerHello(b);var f=b||{},h=f.ephemeral,k=f["static"];f=f.payload;if(k==null){d("WALogger").LOG(o());if(!h)throw c("WAErr")("serverHello missing serverEphemeral");if(!f)throw c("WAErr")("serverHello missing certificateCiphertext");j.authenticate(h);j.mixIntoKey(g.generateSharedSecret(h));j.mixIntoKey(i.staticKeyPair.generateSharedSecret(h));return j.decrypt(f).then(function(){d("WALogger").LOG(n());return j.finish()})}else{d("WALogger").LOG(m());return B(a,b,e,g,i)}})}function B(a,b,c,e,f){a=new(d("WANoiseHandshake").NoiseHandshake)(a);a.start(x,f.protoHeader);var g=e.generatePublicKey();a.authenticate(g);d("WALogger").LOG(l());return y(a,b,c,e,f)}function a(a,c){return a.openSocket().then(d("WAResultOrError").onResult(function(e){var f,g,l,m,n,o,p,q;return b("regeneratorRuntime").async(function(r){while(1)switch(r.prev=r.next){case 0:(h||(h=b("Promise"))).resolve().then(c);f=void 0;g=a.edgeInfo;g&&(l=new(d("WABinary").Binary)(),l.write("ED",0,1),l.writeUint8(g.byteLength>>16),l.writeUint16(g.byteLength&65535),l.writeBuffer(g),f=l.readByteArray(),d("WALogger").LOG(k(),f));m=f?d("WABinary").Binary.build(f,a.protoHeader).readByteArray():a.protoHeader;n=new(d("WAFrameSocket").FrameSocket)(e,m);r.next=8;return b("regeneratorRuntime").awrap(a.getClientPayload());case 8:o=r.sent;p=new(d("WACryptoCurve25519").Curve25519)(a.curveSignalDependencies);q=a.serverStaticKeyIfKnown();if(!q){r.next=16;break}d("WALogger").LOG(j());return r.abrupt("return",A(n,o,q,p,a));case 16:d("WALogger").LOG(i());return r.abrupt("return",z(n,o,p,a));case 18:case"end":return r.stop()}},null,this)}))}g.doFullHandshake=z;g.openChatSocket=a}),98);
__d("WASetClockSkewApi",["WAGlobals"],(function(a,b,c,d,e,f,g){a=function(a){return d("WAGlobals").runInTransaction({MetaInfoStore:!0},function(b){b=b.MetaInfoStore;return b.set("clockSkew",a.clockSkew)},"setClockSkew")};g.setClockSkew=a}),98);
__d("WASendPing",["WAComms","WALogger","WASetClockSkewApi","WATimeUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendPing: sending"]);h=function(){return a};return a}function a(){d("WALogger").LOG(h()),d("WAComms").sendPing()}function c(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:d("WATimeUtils").setClockSkew(a);c.next=3;return b("regeneratorRuntime").awrap(d("WASetClockSkewApi").setClockSkew({clockSkew:a}));case 3:case"end":return c.stop()}},null,this)}g.sendPing=a;g.updateClockSkew=c}),98);
__d("WAGetPrekeyIdsInRange",["WASignalKeys"],(function(a,b,c,d,e,f,g){"use strict";var h=16777215;function i(a){return a}function a(a,b){var c=[];a=i(a);var e=i(b);if(a<=e)for(var f=a;f<=b;f++)c.push(d("WASignalKeys").castToPreKeyId(f));else{for(b=a;b<h;b++)c.push(d("WASignalKeys").castToPreKeyId(b));for(f=1;f<=e;f++)c.push(d("WASignalKeys").castToPreKeyId(f))}return c}g.PRE_KEY_MAX_ID=h;g.getPrekeyIdsInRange=a}),98);
__d("MAWConvertXMATargetTypeToExtendedContentTargetType",["EchoMessageXMAFieldUtils","WAArmadilloXMA.pb","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Not a valid xmaTargetType: ",""]);h=function(){return a};return a}function a(a){switch(a){case d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_PHOTO_MENTION:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_MENTION;case d("EchoMessageXMAFieldUtils").XMAContentType.IG_SINGLE_IMAGE_POST_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_IMAGE_POST_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.IG_MULTIPOST_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_MULTIPOST_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.IG_SINGLE_VIDEO_POST_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_VIDEO_POST_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_PHOTO_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_VIDEO_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.IG_CLIPS_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_CLIPS_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.IG_IGTV_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_IGTV_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.IG_SHOP_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SHOP_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.IG_PROFILE_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_PROFILE_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_PHOTO_HIGHLIGHT_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_HIGHLIGHT_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_VIDEO_HIGHLIGHT_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_HIGHLIGHT_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_REPLY:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REPLY;case d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_REACTION:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REACTION;case d("EchoMessageXMAFieldUtils").XMAContentType.FB_FEED_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.FB_STORY_REPLY:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_REPLY;case d("EchoMessageXMAFieldUtils").XMAContentType.FB_STORY_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.FB_STORY_MENTION:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_MENTION;case d("EchoMessageXMAFieldUtils").XMAContentType.FB_FEED_VIDEO_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_VIDEO_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.FB_GAMING_CUSTOM_UPDATE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_GAMING_CUSTOM_UPDATE;case d("EchoMessageXMAFieldUtils").XMAContentType.FB_PRODUCER_STORY_REPLY:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_PRODUCER_STORY_REPLY;case d("EchoMessageXMAFieldUtils").XMAContentType.MSG_EXTERNAL_LINK_SHARE:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_EXTERNAL_LINK_SHARE;case d("EchoMessageXMAFieldUtils").XMAContentType.RTC_AUDIO_CALL:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_AUDIO_CALL;case d("EchoMessageXMAFieldUtils").XMAContentType.RTC_VIDEO_CALL:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_VIDEO_CALL;case d("EchoMessageXMAFieldUtils").XMAContentType.RTC_MISSED_AUDIO_CALL:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_AUDIO_CALL;case d("EchoMessageXMAFieldUtils").XMAContentType.RTC_MISSED_VIDEO_CALL:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_VIDEO_CALL;case d("EchoMessageXMAFieldUtils").XMAContentType.RTC_GROUP_AUDIO_CALL:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_AUDIO_CALL;case d("EchoMessageXMAFieldUtils").XMAContentType.RTC_GROUP_VIDEO_CALL:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_VIDEO_CALL;default:d("WALogger").ERROR(h(),a);return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_EXTERNAL_LINK_SHARE}}g.convertXMATargetTypeToExtendedContentTargetType=a}),98);
/**
 * License: https://www.facebook.com/legal/license/MDzNl_j9yvg/
 */
__d("fflate-0.6.10",[],(function(a,b,c,d,e,f){"use strict";var g={},h={exports:g};function i(){var a,b="";try{a={}.Worker}catch(a){}g["default"]=a?function(c,d,e,f,g){var h=!1,i=new a(c+b,{eval:!0}).on("error",function(a){return g(a,null)}).on("message",function(a){return g(null,a)}).on("exit",function(a){a&&!h&&g(new Error("exited with code "+a),null)});i.postMessage(e,f);i.terminate=function(){h=!0;return a.prototype.terminate.call(i)};return i}:function(a,b,c,d,e){setImmediate(function(){return e(new Error("async operations unsupported - update to Node 12+ (or Node 10-11 with the --experimental-worker CLI flag)"),null)});a=function(){};return{terminate:a,postMessage:a}}}var j=!1;function k(){j||(j=!0,i());return h.exports}var l={},m={exports:l};function n(){var a=k(),b=Uint8Array,c=Uint16Array,d=Uint32Array,e=new b([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),f=new b([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),g=new b([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),h=function(a,b){var e=new c(31);for(var f=0;f<31;++f)e[f]=b+=1<<a[f-1];a=new d(e[30]);for(var f=1;f<30;++f)for(b=e[f];b<e[f+1];++b)a[b]=b-e[f]<<5|f;return[e,a]},i=h(e,2),j=i[0],m=i[1];j[28]=258,m[258]=28;i=h(f,0);var n=i[0],o=i[1],p=new c(32768);for(h=0;h<32768;++h){i=(h&43690)>>>1|(h&21845)<<1;i=(i&52428)>>>2|(i&13107)<<2;i=(i&61680)>>>4|(i&3855)<<4;p[h]=((i&65280)>>>8|(i&255)<<8)>>>1}var q=function(a,b,d){var e=a.length,f=0,g=new c(b);for(;f<e;++f)++g[a[f]-1];var h=new c(b);for(f=0;f<b;++f)h[f]=h[f-1]+g[f-1]<<1;if(d){g=new c(1<<b);d=15-b;for(f=0;f<e;++f)if(a[f]){var i=f<<4|a[f],j=b-a[f],k=h[a[f]-1]++<<j;for(j=k|(1<<j)-1;k<=j;++k)g[p[k]>>>d]=i}}else{g=new c(e);for(f=0;f<e;++f)a[f]&&(g[f]=p[h[a[f]-1]++]>>>15-a[f])}return g},r=new b(288);for(h=0;h<144;++h)r[h]=8;for(h=144;h<256;++h)r[h]=9;for(h=256;h<280;++h)r[h]=7;for(h=280;h<288;++h)r[h]=8;var s=new b(32);for(h=0;h<32;++h)s[h]=5;var t=q(r,9,0),u=q(r,9,1),v=q(s,5,0),w=q(s,5,1),x=function(a){var b=a[0];for(var c=1;c<a.length;++c)a[c]>b&&(b=a[c]);return b},y=function(a,b,c){var d=b/8|0;return(a[d]|a[d+1]<<8)>>(b&7)&c},z=function(a,b){var c=b/8|0;return(a[c]|a[c+1]<<8|a[c+2]<<16)>>(b&7)},aa=function(a){return(a/8|0)+(a&7&&1)},A=function(a,e,f){(e==null||e<0)&&(e=0);(f==null||f>a.length)&&(f=a.length);var g=new(a instanceof c?c:a instanceof d?d:b)(f-e);g.set(a.subarray(e,f));return g},B=function(a,c,d){var h=a.length;if(!h||d&&!d.l&&h<5)return c||new b(0);var i=!c||d,k=!d||d.i;d||(d={});c||(c=new b(h*3));var l=function(a){var d=c.length;if(a>d){d=new b(Math.max(d*2,a));d.set(c);c=d}},m=d.f||0,o=d.p||0,p=d.b||0,r=d.l,s=d.d,t=d.m,v=d.n,B=h*8;do{if(!r){d.f=m=y(a,o,1);var C=y(a,o+1,3);o+=3;if(!C){var D=aa(o)+4,E=a[D-4]|a[D-3]<<8,F=D+E;if(F>h){if(k)throw"unexpected EOF";break}i&&l(p+E);c.set(a.subarray(D,F),p);d.b=p+=E,d.p=o=F*8;continue}else if(C==1)r=u,s=w,t=9,v=5;else if(C==2){E=y(a,o,31)+257;F=y(a,o+10,15)+4;C=E+y(a,o+5,31)+1;o+=14;var G=new b(C),H=new b(19);for(var I=0;I<F;++I)H[g[I]]=y(a,o+I*3,7);o+=F*3;F=x(H);var J=(1<<F)-1;H=q(H,F,1);for(var I=0;I<C;){F=H[y(a,o,J)];o+=F&15;var D=F>>>4;if(D<16)G[I++]=D;else{F=0;var K=0;D==16?(K=3+y(a,o,3),o+=2,F=G[I-1]):D==17?(K=3+y(a,o,7),o+=3):D==18&&(K=11+y(a,o,127),o+=7);while(K--)G[I++]=F}}D=G.subarray(0,E);K=G.subarray(E);t=x(D);v=x(K);r=q(D,t,1);s=q(K,v,1)}else throw"invalid block type";if(o>B){if(k)throw"unexpected EOF";break}}i&&l(p+131072);J=(1<<t)-1;H=(1<<v)-1;C=o;for(;;C=o){F=r[z(a,o)&J];G=F>>>4;o+=F&15;if(o>B){if(k)throw"unexpected EOF";break}if(!F)throw"invalid length/literal";if(G<256)c[p++]=G;else if(G==256){C=o,r=null;break}else{E=G-254;if(G>264){var I=G-257;D=e[I];E=y(a,o,(1<<D)-1)+j[I];o+=D}F=s[z(a,o)&H];G=F>>>4;if(!F)throw"invalid distance";o+=F&15;K=n[G];if(G>3){D=f[G];K+=z(a,o)&(1<<D)-1,o+=D}if(o>B){if(k)throw"unexpected EOF";break}i&&l(p+131072);F=p+E;for(;p<F;p+=4)c[p]=c[p-K],c[p+1]=c[p+1-K],c[p+2]=c[p+2-K],c[p+3]=c[p+3-K];p=F}}d.l=r,d.p=C,d.b=p;r&&(m=1,d.m=t,d.d=s,d.n=v)}while(!m);return p==c.length?c:A(c,0,p)},C=function(a,b,c){c<<=b&7;b=b/8|0;a[b]|=c;a[b+1]|=c>>>8},D=function(a,b,c){c<<=b&7;b=b/8|0;a[b]|=c;a[b+1]|=c>>>8;a[b+2]|=c>>>16},E=function(a,d){var e=[];for(var f=0;f<a.length;++f)a[f]&&e.push({s:f,f:a[f]});a=e.length;var g=e.slice();if(!a)return[L,0];if(a==1){var h=new b(e[0].s+1);h[e[0].s]=1;return[h,1]}e.sort(function(a,b){return a.f-b.f});e.push({s:-1,f:25001});h=e[0];var i=e[1],j=0,k=1,l=2;e[0]={s:-1,f:h.f+i.f,l:h,r:i};while(k!=a-1)h=e[e[j].f<e[l].f?j++:l++],i=e[j!=k&&e[j].f<e[l].f?j++:l++],e[k++]={s:-1,f:h.f+i.f,l:h,r:i};h=g[0].s;for(var f=1;f<a;++f)g[f].s>h&&(h=g[f].s);var m=new c(h+1);i=F(e[k-1],m,0);if(i>d){var f=0;j=0;l=i-d;h=1<<l;g.sort(function(a,b){return m[b.s]-m[a.s]||a.f-b.f});for(;f<a;++f){e=g[f].s;if(m[e]>d)j+=h-(1<<i-m[e]),m[e]=d;else break}j>>>=l;while(j>0){k=g[f].s;m[k]<d?j-=1<<d-m[k]++-1:++f}for(;f>=0&&j;--f){e=g[f].s;m[e]==d&&(--m[e],++j)}i=d}return[new b(m),i]},F=function(a,b,c){return a.s==-1?Math.max(F(a.l,b,c+1),F(a.r,b,c+1)):b[a.s]=c},G=function(a){var b=a.length;while(b&&!a[--b]);var d=new c(++b),e=0,f=a[0],g=1,h=function(a){d[e++]=a};for(var i=1;i<=b;++i)if(a[i]==f&&i!=b)++g;else{if(!f&&g>2){for(;g>138;g-=138)h(32754);g>2&&(h(g>10?g-11<<5|28690:g-3<<5|12305),g=0)}else if(g>3){h(f),--g;for(;g>6;g-=6)h(8304);g>2&&(h(g-3<<5|8208),g=0)}while(g--)h(f);g=1;f=a[i]}return[d.subarray(0,e),b]},H=function(a,b){var c=0;for(var d=0;d<b.length;++d)c+=a[d]*b[d];return c},I=function(a,b,c){var d=c.length;b=aa(b+2);a[b]=d&255;a[b+1]=d>>>8;a[b+2]=a[b]^255;a[b+3]=a[b+1]^255;for(var e=0;e<d;++e)a[b+e+4]=c[e];return(b+4+d)*8},J=function(a,b,d,h,i,j,k,l,m,n,o){C(b,o++,d);++i[256];d=E(i,15);var p=d[0];d=d[1];var u=E(j,15),w=u[0];u=u[1];var x=G(p),y=x[0];x=x[1];var z=G(w),aa=z[0];z=z[1];var A=new c(19);for(var B=0;B<y.length;++B)A[y[B]&31]++;for(var B=0;B<aa.length;++B)A[aa[B]&31]++;var F=E(A,7),J=F[0];F=F[1];var K=19;for(;K>4&&!J[g[K-1]];--K);var L=n+5<<3,M=H(i,r)+H(j,s)+k;i=H(i,p)+H(j,w)+k+14+3*K+H(A,J)+(2*A[16]+3*A[17]+7*A[18]);if(L<=M&&L<=i)return I(b,o,a.subarray(m,m+n));C(b,o,1+(i<M)),o+=2;if(i<M){j=q(p,d,0),k=p,A=q(w,u,0),L=w;a=q(J,F,0);C(b,o,x-257);C(b,o+5,z-1);C(b,o+10,K-4);o+=14;for(var B=0;B<K;++B)C(b,o+3*B,J[g[B]]);o+=3*K;m=[y,aa];for(n=0;n<2;++n){i=m[n];for(var B=0;B<i.length;++B){M=i[B]&31;C(b,o,a[M]),o+=J[M];M>15&&(C(b,o,i[B]>>>5&127),o+=i[B]>>>12)}}}else j=t,k=r,A=v,L=s;for(var B=0;B<l;++B)if(h[B]>255){M=h[B]>>>18&31;D(b,o,j[M+257]),o+=k[M+257];M>7&&(C(b,o,h[B]>>>23&31),o+=e[M]);d=h[B]&31;D(b,o,A[d]),o+=L[d];d>3&&(D(b,o,h[B]>>>5&8191),o+=f[d])}else D(b,o,j[h[B]]),o+=k[h[B]];D(b,o,j[256]);return o+k[256]},K=new d([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),L=new b(0),M=function(a,g,h,i,j,k){var l=a.length,n=new b(i+l+5*(1+Math.ceil(l/7e3))+j),p=n.subarray(i,n.length-j),q=0;if(!g||l<8)for(var r=0;r<=l;r+=65535){var s=r+65535;s<l?q=I(p,q,a.subarray(r,s)):(p[r]=k,q=I(p,q,a.subarray(r,l)))}else{s=K[g-1];g=s>>>13;s=s&8191;var t=(1<<h)-1,u=new c(32768),v=new c(t+1),w=Math.ceil(h/3),x=2*w;h=function(b){return(a[b]^a[b+1]<<w^a[b+2]<<x)&t};var y=new d(25e3),z=new c(288),B=new c(32),C=0,D=0,r=0,E=0,F=0,G=0;for(;r<l;++r){var H=h(r),M=r&32767,N=v[H];u[M]=N;v[H]=M;if(F<=r){var O=l-r;if((C>7e3||E>24576)&&O>423){q=J(a,p,0,y,z,B,D,E,G,r-G,q);E=C=D=0,G=r;for(var P=0;P<286;++P)z[P]=0;for(var P=0;P<30;++P)B[P]=0}var Q=2,R=0,ba=s,S=M-N&32767;if(O>2&&H==h(r-S)){H=Math.min(g,O)-1;var ca=Math.min(32767,r);O=Math.min(258,O);while(S<=ca&&--ba&&M!=N){if(a[r+Q]==a[r+Q-S]){var T=0;for(;T<O&&a[r+T]==a[r+T-S];++T);if(T>Q){Q=T,R=S;if(T>H)break;T=Math.min(S,T-2);var da=0;for(var P=0;P<T;++P){var U=r-S+P+32768&32767,V=u[U];V=U-V+32768&32767;V>da&&(da=V,N=U)}}}M=N,N=u[M];S+=M-N+32768&32767}}if(R){y[E++]=268435456|m[Q]<<18|o[R];V=m[Q]&31;U=o[R]&31;D+=e[V]+f[U];++z[257+V];++B[U];F=r+Q;++C}else y[E++]=a[r],++z[a[r]]}}q=J(a,p,k,y,z,B,D,E,G,r-G,q);!k&&q&7&&(q=I(p,q+1,L))}return A(n,0,i+aa(q)+j)},N=function(){var a=new Int32Array(256);for(var b=0;b<256;++b){var c=b,d=9;while(--d)c=(c&1&&-306674912)^c>>>1;a[b]=c}return a}(),O=function(){var a=-1;return{p:function(b){var c=a;for(var d=0;d<b.length;++d)c=N[c&255^b[d]]^c>>>8;a=c},d:function(){return~a}}},P=function(){var a=1,b=0;return{p:function(c){var d=a,e=b,f=c.length;for(var g=0;g!=f;){var h=Math.min(g+2655,f);for(;g<h;++g)e+=d+=c[g];d=(d&65535)+15*(d>>16),e=(e&65535)+15*(e>>16)}a=d,b=e},d:function(){a%=65521,b%=65521;return(a&255)<<24|a>>>8<<16|(b&255)<<8|b>>>8}}},Q=function(a,b,c,d,e){return M(a,b.level==null?6:b.level,b.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(a.length)))*1.5):12+b.mem,c,d,!e)},R=function(a,b){var c={};for(var d in a)c[d]=a[d];for(var d in b)c[d]=b[d];return c},ba=function(b,c,a){var d=b();b=b.toString();b=b.slice(b.indexOf("[")+1,b.lastIndexOf("]")).replace(/ /g,"").split(",");for(var e=0;e<d.length;++e){var f=d[e],g=b[e];if(typeof f=="function"){c+=";"+g+"=";var h=f.toString();if(f.prototype)if(h.indexOf("[native code]")!=-1){var i=h.indexOf(" ",8)+1;c+=h.slice(i,h.indexOf("(",i))}else{c+=h;for(i in f.prototype)c+=";"+g+".prototype."+i+"="+f.prototype[i].toString()}else c+=h}else a[g]=f}return[c,a]},S=[],ca=function(a){var e=[];for(var f in a)(a[f]instanceof b||a[f]instanceof c||a[f]instanceof d)&&e.push((a[f]=new a[f].constructor(a[f])).buffer);return e},T=function(c,d,e,f){var b;if(!S[e]){var g="",h={},i=c.length-1;for(var j=0;j<i;++j)b=ba(c[j],g,h),g=b[0],h=b[1];S[e]=ba(c[i],g,h)}b=R({},S[e][1]);return a["default"](S[e][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+d.toString()+"}",e,b,ca(b),f)},da=function(){return[b,c,d,e,f,g,j,n,u,w,p,q,x,y,z,aa,A,B,za,ha,ia]},U=function(){return[b,c,d,e,f,g,m,o,t,r,v,s,p,K,L,q,C,D,E,F,G,H,I,J,aa,A,M,Q,wa,ha]},V=function(){return[ma,pa,Z,O,N]},ea=function(){return[na,oa]},fa=function(){return[qa,Z,P]},ga=function(){return[ra]},ha=function(a){return postMessage(a,[a.buffer])},ia=function(a){return a&&a.size&&new b(a.size)},ja=function(a,b,c,d,e,f){var g=T(c,d,e,function(b,a){g.terminate(),f(b,a)});g.postMessage([a,b],b.consume?[a.buffer]:[]);return function(){g.terminate()}},W=function(a){a.ondata=function(a,b){return postMessage([a,b],[a.buffer])};return function(b){return a.push(b.data[0],b.data[1])}},ka=function(a,b,c,d,e){var f,g=T(a,d,e,function(a,c){a?(g.terminate(),b.ondata.call(b,a)):(c[1]&&g.terminate(),b.ondata.call(b,a,c[0],c[1]))});g.postMessage(c);b.push=function(a,c){if(f)throw"stream finished";if(!b.ondata)throw"no stream handler";g.postMessage([a,f=c],[a.buffer])};b.terminate=function(){g.terminate()}},X=function(a,b){return a[b]|a[b+1]<<8},Y=function(a,b){return(a[b]|a[b+1]<<8|a[b+2]<<16|a[b+3]<<24)>>>0},la=function(a,b){return Y(a,b)+Y(a,b+4)*4294967296},Z=function(a,b,c){for(;c;++b)a[b]=c,c>>>=8},ma=function(a,b){var c=b.filename;a[0]=31,a[1]=139,a[2]=8,a[8]=b.level<2?4:b.level==9?2:0,a[9]=3;b.mtime!=0&&Z(a,4,Math.floor(new Date(b.mtime||Date.now())/1e3));if(c){a[3]=8;for(b=0;b<=c.length;++b)a[b+10]=c.charCodeAt(b)}},na=function(a){if(a[0]!=31||a[1]!=139||a[2]!=8)throw"invalid gzip data";var b=a[3],c=10;b&4&&(c+=a[10]|(a[11]<<8)+2);for(var d=(b>>3&1)+(b>>4&1);d>0;d-=!a[c++]);return c+(b&2)},oa=function(a){var b=a.length;return(a[b-4]|a[b-3]<<8|a[b-2]<<16|a[b-1]<<24)>>>0},pa=function(a){return 10+(a.filename&&a.filename.length+1||0)},qa=function(a,b){b=b.level;b=b==0?0:b<6?1:b==9?3:2;a[0]=120,a[1]=b<<6|(b?32-2*b:1)},ra=function(a){if((a[0]&15)!=8||a[0]>>>4>7||(a[0]<<8|a[1])%31)throw"invalid zlib data";if(a[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function sa(a,b){!b&&typeof a=="function"&&(b=a,a={});this.ondata=b;return a}var ta=function(){function a(a,b){!b&&typeof a=="function"&&(b=a,a={}),this.ondata=b,this.o=a||{}}a.prototype.p=function(a,b){this.ondata(Q(a,this.o,0,0,!b),b)};a.prototype.push=function(a,b){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";this.d=b;this.p(a,b||!1)};return a}();l.Deflate=ta;var ua=function(){function a(a,b){ka([U,function(){return[W,ta]}],this,sa.call(this,a,b),function(a){a=new ta(a.data);onmessage=W(a)},6)}return a}();l.AsyncDeflate=ua;function va(a,b,c){c||(c=b,b={});if(typeof c!="function")throw"no callback";return ja(a,b,[U],function(a){return ha(wa(a.data[0],a.data[1]))},0,c)}l.deflate=va;function wa(a,b){return Q(a,b||{},0,0)}l.deflateSync=wa;var $=function(){function a(a){this.s={},this.p=new b(0),this.ondata=a}a.prototype.e=function(a){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";var c=this.p.length,d=new b(c+a.length);d.set(this.p),d.set(a,c),this.p=d};a.prototype.c=function(a){this.d=this.s.i=a||!1;a=this.s.b;var b=B(this.p,this.o,this.s);this.ondata(A(b,a,this.s.b),this.d);this.o=A(b,this.s.b-32768),this.s.b=this.o.length;this.p=A(this.p,this.s.p/8|0),this.s.p&=7};a.prototype.push=function(a,b){this.e(a),this.c(b)};return a}();l.Inflate=$;var xa=function(){function a(a){this.ondata=a,ka([da,function(){return[W,$]}],this,0,function(){var a=new $();onmessage=W(a)},7)}return a}();l.AsyncInflate=xa;function ya(a,b,c){c||(c=b,b={});if(typeof c!="function")throw"no callback";return ja(a,b,[da],function(a){return ha(za(a.data[0],ia(a.data[1])))},1,c)}l.inflate=ya;function za(a,b){return B(a,b)}l.inflateSync=za;var Aa=function(){function a(a,b){this.c=O(),this.l=0,this.v=1,ta.call(this,a,b)}a.prototype.push=function(a,b){ta.prototype.push.call(this,a,b)};a.prototype.p=function(a,b){this.c.p(a);this.l+=a.length;a=Q(a,this.o,this.v&&pa(this.o),b&&8,!b);this.v&&(ma(a,this.o),this.v=0);b&&(Z(a,a.length-8,this.c.d()),Z(a,a.length-4,this.l));this.ondata(a,b)};return a}();l.Gzip=Aa;l.Compress=Aa;i=function(){function a(a,b){ka([U,V,function(){return[W,ta,Aa]}],this,sa.call(this,a,b),function(a){a=new Aa(a.data);onmessage=W(a)},8)}return a}();l.AsyncGzip=i;l.AsyncCompress=i;function Ba(a,b,c){c||(c=b,b={});if(typeof c!="function")throw"no callback";return ja(a,b,[U,V,function(){return[Ca]}],function(a){return ha(Ca(a.data[0],a.data[1]))},2,c)}l.gzip=Ba;l.compress=Ba;function Ca(a,b){b||(b={});var c=O(),d=a.length;c.p(a);a=Q(a,b,pa(b),8);var e=a.length;return ma(a,b),Z(a,e-8,c.d()),Z(a,e-4,d),a}l.gzipSync=Ca;l.compressSync=Ca;var Da=function(){function a(a){this.v=1,$.call(this,a)}a.prototype.push=function(a,b){$.prototype.e.call(this,a);if(this.v){a=this.p.length>3?na(this.p):4;if(a>=this.p.length&&!b)return;this.p=this.p.subarray(a),this.v=0}if(b){if(this.p.length<8)throw"invalid gzip stream";this.p=this.p.subarray(0,-8)}$.prototype.c.call(this,b)};return a}();l.Gunzip=Da;var Ea=function(){function a(a){this.ondata=a,ka([da,ea,function(){return[W,$,Da]}],this,0,function(){var a=new Da();onmessage=W(a)},9)}return a}();l.AsyncGunzip=Ea;function Fa(a,b,c){c||(c=b,b={});if(typeof c!="function")throw"no callback";return ja(a,b,[da,ea,function(){return[Ga]}],function(a){return ha(Ga(a.data[0]))},3,c)}l.gunzip=Fa;function Ga(a,c){return B(a.subarray(na(a),-8),c||new b(oa(a)))}l.gunzipSync=Ga;var Ha=function(){function a(a,b){this.c=P(),this.v=1,ta.call(this,a,b)}a.prototype.push=function(a,b){ta.prototype.push.call(this,a,b)};a.prototype.p=function(a,b){this.c.p(a);a=Q(a,this.o,this.v&&2,b&&4,!b);this.v&&(qa(a,this.o),this.v=0);b&&Z(a,a.length-4,this.c.d());this.ondata(a,b)};return a}();l.Zlib=Ha;h=function(){function a(a,b){ka([U,fa,function(){return[W,ta,Ha]}],this,sa.call(this,a,b),function(a){a=new Ha(a.data);onmessage=W(a)},10)}return a}();l.AsyncZlib=h;function Ia(a,b,c){c||(c=b,b={});if(typeof c!="function")throw"no callback";return ja(a,b,[U,fa,function(){return[Ja]}],function(a){return ha(Ja(a.data[0],a.data[1]))},4,c)}l.zlib=Ia;function Ja(a,b){b||(b={});var c=P();c.p(a);a=Q(a,b,2,4);return qa(a,b),Z(a,a.length-4,c.d()),a}l.zlibSync=Ja;var Ka=function(){function a(a){this.v=1,$.call(this,a)}a.prototype.push=function(a,b){$.prototype.e.call(this,a);if(this.v){if(this.p.length<2&&!b)return;this.p=this.p.subarray(2),this.v=0}if(b){if(this.p.length<4)throw"invalid zlib stream";this.p=this.p.subarray(0,-4)}$.prototype.c.call(this,b)};return a}();l.Unzlib=Ka;var La=function(){function a(a){this.ondata=a,ka([da,ga,function(){return[W,$,Ka]}],this,0,function(){var a=new Ka();onmessage=W(a)},11)}return a}();l.AsyncUnzlib=La;function Ma(a,b,c){c||(c=b,b={});if(typeof c!="function")throw"no callback";return ja(a,b,[da,ga,function(){return[Na]}],function(a){return ha(Na(a.data[0],ia(a.data[1])))},5,c)}l.unzlib=Ma;function Na(a,b){return B((ra(a),a.subarray(2,-4)),b)}l.unzlibSync=Na;var Oa=function(){function a(a){this.G=Da,this.I=$,this.Z=Ka,this.ondata=a}a.prototype.push=function(a,c){if(!this.ondata)throw"no stream handler";if(!this.s){if(this.p&&this.p.length){var d=new b(this.p.length+a.length);d.set(this.p),d.set(a,this.p.length)}else this.p=a;if(this.p.length>2){var e=this;d=function(){e.ondata.apply(e,arguments)};this.s=this.p[0]==31&&this.p[1]==139&&this.p[2]==8?new this.G(d):(this.p[0]&15)!=8||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(d):new this.Z(d);this.s.push(this.p,c);this.p=null}}else this.s.push(a,c)};return a}();l.Decompress=Oa;i=function(){function a(a){this.G=Ea,this.I=xa,this.Z=La,this.ondata=a}a.prototype.push=function(a,b){Oa.prototype.push.call(this,a,b)};return a}();l.AsyncDecompress=i;function Pa(a,b,c){c||(c=b,b={});if(typeof c!="function")throw"no callback";return a[0]==31&&a[1]==139&&a[2]==8?Fa(a,b,c):(a[0]&15)!=8||a[0]>>4>7||(a[0]<<8|a[1])%31?ya(a,b,c):Ma(a,b,c)}l.decompress=Pa;function Qa(a,b){return a[0]==31&&a[1]==139&&a[2]==8?Ga(a,b):(a[0]&15)!=8||a[0]>>4>7||(a[0]<<8|a[1])%31?za(a,b):Na(a,b)}l.decompressSync=Qa;var Ra=function(a,c,d,e){for(var f in a){var g=a[f],h=c+f;g instanceof b?d[h]=[g,e]:Array.isArray(g)?d[h]=[g[0],R(e,g[1])]:Ra(g,h+"/",d,e)}},Sa=typeof TextEncoder!="undefined"&&new TextEncoder(),Ta=typeof TextDecoder!="undefined"&&new TextDecoder(),Ua=0;try{Ta.decode(L,{stream:!0}),Ua=1}catch(a){}var Va=function(a){for(var b="",c=0;;){var d=a[c++],e=(d>127)+(d>223)+(d>239);if(c+e>a.length)return[b,A(a,c-1)];!e?b+=String.fromCharCode(d):e==3?(d=((d&15)<<18|(a[c++]&63)<<12|(a[c++]&63)<<6|a[c++]&63)-65536,b+=String.fromCharCode(55296|d>>10,56320|d&1023)):e&1?b+=String.fromCharCode((d&31)<<6|a[c++]&63):b+=String.fromCharCode((d&15)<<12|(a[c++]&63)<<6|a[c++]&63)}};Ba=function(){function a(a){this.ondata=a,Ua?this.t=new TextDecoder():this.p=L}a.prototype.push=function(a,c){if(!this.ondata)throw"no callback";c=!!c;if(this.t){this.ondata(this.t.decode(a,{stream:!0}),c);if(c){if(this.t.decode().length)throw"invalid utf-8 data";this.t=null}return}if(!this.p)throw"stream finished";var d=new b(this.p.length+a.length);d.set(this.p);d.set(a,this.p.length);a=Va(d);d=a[0];a=a[1];if(c){if(a.length)throw"invalid utf-8 data";this.p=null}else this.p=a;this.ondata(d,c)};return a}();l.DecodeUTF8=Ba;h=function(){function a(a){this.ondata=a}a.prototype.push=function(a,b){if(!this.ondata)throw"no callback";if(this.d)throw"stream finished";this.ondata(Wa(a),this.d=b||!1)};return a}();l.EncodeUTF8=h;function Wa(a,c){if(c){var d=new b(a.length);for(var e=0;e<a.length;++e)d[e]=a.charCodeAt(e);return d}if(Sa)return Sa.encode(a);d=a.length;var f=new b(a.length+(a.length>>1)),g=0,h=function(a){f[g++]=a};for(var e=0;e<d;++e){if(g+5>f.length){var i=new b(g+8+(d-e<<1));i.set(f);f=i}i=a.charCodeAt(e);i<128||c?h(i):i<2048?(h(192|i>>6),h(128|i&63)):i>55295&&i<57344?(i=65536+(i&1023<<10)|a.charCodeAt(++e)&1023,h(240|i>>18),h(128|i>>12&63),h(128|i>>6&63),h(128|i&63)):(h(224|i>>12),h(128|i>>6&63),h(128|i&63))}return A(f,0,g)}l.strToU8=Wa;function Xa(a,b){if(b){b="";for(var c=0;c<a.length;c+=16384)b+=String.fromCharCode.apply(null,a.subarray(c,c+16384));return b}else if(Ta)return Ta.decode(a);else{c=Va(a);b=c[0];a=c[1];if(a.length)throw"invalid utf-8 data";return b}}l.strFromU8=Xa;var Ya=function(a){return a==1?3:a<6?2:a==9?1:0},Za=function(a,b){return b+30+X(a,b+26)+X(a,b+28)},$a=function(a,b,c){var d=X(a,b+28),e=Xa(a.subarray(b+46,b+46+d),!(X(a,b+8)&2048));d=b+46+d;var f=Y(a,b+20);c=c&&f==4294967295?ab(a,d):[f,Y(a,b+24),Y(a,b+42)];f=c[0];var g=c[1];c=c[2];return[X(a,b+10),f,g,e,d+X(a,b+30)+X(a,b+32),c]},ab=function(a,b){for(;X(a,b)!=1;b+=4+X(a,b+2));return[la(a,b+12),la(a,b+4),la(a,b+20)]},bb=function(a){var b=0;if(a)for(var c in a){var d=a[c].length;if(d>65535)throw"extra field too long";b+=d+4}return b},cb=function(b,c,d,e,f,g,h,i){var a=e.length,j=d.extra,k=i&&i.length,l=bb(j);Z(b,c,h!=null?33639248:67324752),c+=4;h!=null&&(b[c++]=20,b[c++]=d.os);b[c]=20,c+=2;b[c++]=d.flag<<1|(g==null&&8),b[c++]=f&&8;b[c++]=d.compression&255,b[c++]=d.compression>>8;f=new Date(d.mtime==null?Date.now():d.mtime);var m=f.getFullYear()-1980;if(m<0||m>119)throw"date not in range 1980-2099";Z(b,c,m<<25|f.getMonth()+1<<21|f.getDate()<<16|f.getHours()<<11|f.getMinutes()<<5|f.getSeconds()>>>1),c+=4;g!=null&&(Z(b,c,d.crc),Z(b,c+4,g),Z(b,c+8,d.size));Z(b,c+12,a);Z(b,c+14,l),c+=16;h!=null&&(Z(b,c,k),Z(b,c+6,d.attrs),(Z(b,c+10,h),c+=14));b.set(e,c);c+=a;if(l)for(m in j){f=j[m];g=f.length;Z(b,c,+m);Z(b,c+2,g);b.set(f,c+4),c+=4+g}k&&(b.set(i,c),c+=k);return c},db=function(a,b,c,d,e){Z(a,b,101010256),Z(a,b+8,c),Z(a,b+10,c),Z(a,b+12,d),Z(a,b+16,e)},eb=function(){function a(a){this.filename=a,this.c=O(),this.size=0,this.compression=0}a.prototype.process=function(a,b){this.ondata(null,a,b)};a.prototype.push=function(a,b){if(!this.ondata)throw"no callback - add to ZIP archive before pushing";this.c.p(a);this.size+=a.length;b&&(this.crc=this.c.d());this.process(a,b||!1)};return a}();l.ZipPassThrough=eb;Ia=function(){function a(a,b){var c=this;b||(b={});eb.call(this,a);this.d=new ta(b,function(a,b){c.ondata(null,a,b)});this.compression=8;this.flag=Ya(b.level)}a.prototype.process=function(a,b){try{this.d.push(a,b)}catch(a){this.ondata(a,null,b)}};a.prototype.push=function(a,b){eb.prototype.push.call(this,a,b)};return a}();l.ZipDeflate=Ia;i=function(){function a(a,b){var c=this;b||(b={});eb.call(this,a);this.d=new ua(b,function(a,b,d){c.ondata(a,b,d)});this.compression=8;this.flag=Ya(b.level);this.terminate=this.d.terminate}a.prototype.process=function(a,b){this.d.push(a,b)};a.prototype.push=function(a,b){eb.prototype.push.call(this,a,b)};return a}();l.AsyncZipDeflate=i;Pa=function(){function a(a){this.ondata=a,this.u=[],this.d=1}a.prototype.add=function(c){var d=this;if(this.d&2)throw"stream finished";var e=Wa(c.filename),a=e.length,f=c.comment,g=f&&Wa(f);f=a!=c.filename.length||g&&f.length!=g.length;var h=a+bb(c.extra)+30;if(a>65535)throw"filename too long";a=new b(h);cb(a,0,c,e,f);var i=[a],j=function(){for(var a=0,b=i;a<b.length;a++){var c=b[a];d.ondata(null,c,!1)}i=[]},k=this.d;this.d=0;var l=this.u.length,m=R(c,{f:e,u:f,o:g,t:function(){c.terminate&&c.terminate()},r:function(){j();if(k){var a=d.u[l+1];a?a.r():d.d=1}k=1}}),n=0;c.ondata=function(a,e,f){if(a)d.ondata(a,e,f),d.terminate();else{n+=e.length;i.push(e);if(f){a=new b(16);Z(a,0,134695760);Z(a,4,c.crc);Z(a,8,n);Z(a,12,c.size);i.push(a);m.c=n,m.b=h+n+16,m.crc=c.crc,m.size=c.size;k&&m.r();k=1}else k&&j()}};this.u.push(m)};a.prototype.end=function(){var a=this;if(this.d&2){if(this.d&1)throw"stream finishing";throw"stream finished"}this.d?this.e():this.u.push({r:function(){if(!(a.d&1))return;a.u.splice(-1,1);a.e()},t:function(){}});this.d=3};a.prototype.e=function(){var c=0,d=0,e=0;for(var f=0,a=this.u;f<a.length;f++){var g=a[f];e+=46+g.f.length+bb(g.extra)+(g.o?g.o.length:0)}a=new b(e+22);for(var f=0,h=this.u;f<h.length;f++){var g=h[f];cb(a,c,g,g.f,g.u,g.c,d,g.o);c+=46+g.f.length+bb(g.extra)+(g.o?g.o.length:0),d+=g.b}db(a,c,this.u.length,e,d);this.ondata(null,a,!0);this.d=2};a.prototype.terminate=function(){for(var b=0,a=this.u;b<a.length;b++){var c=a[b];c.t()}this.d=2};return a}();l.Zip=Pa;function fb(a,c,d){d||(d=c,c={});if(typeof d!="function")throw"no callback";var e={};Ra(a,"",e,c);var f=Object.keys(e),g=f.length,h=0,i=0,j=g,k=new Array(g),l=[],m=function(){for(var a=0;a<l.length;++a)l[a]()},n=function(){var a=new b(i+22),c=h,e=i-h;i=0;for(var f=0;f<j;++f){var g=k[f];try{var l=g.c.length;cb(a,i,g,g.f,g.u,l);var m=30+g.f.length+bb(g.extra),n=i+m;a.set(g.c,n);cb(a,h,g,g.f,g.u,l,i,g.m),h+=16+m+(g.m?g.m.length:0),i=n+l}catch(a){return d(a,null)}}db(a,h,k.length,e,c);d(null,a)};g||n();a=function(b){var c=f[b],a=e[c],j=a[0],o=a[1],p=O(),q=j.length;p.p(j);var r=Wa(c),s=r.length,t=o.comment,u=t&&Wa(t),v=u&&u.length,w=bb(o.extra),x=o.level==0?0:8;a=function(a,e){if(a)m(),d(a,null);else{a=e.length;k[b]=R(o,{size:q,crc:p.d(),c:e,f:r,m:u,u:s!=c.length||u&&t.length!=v,compression:x});h+=30+s+w+a;i+=76+2*(s+w)+(v||0)+a;--g||n()}};s>65535&&a("filename too long",null);if(!x)a(null,j);else if(q<16e4)try{a(null,wa(j,o))}catch(b){a(b,null)}else l.push(va(j,o,a))};for(c=0;c<j;++c)a(c);return m}l.zip=fb;function gb(c,d){d||(d={});var e={},f=[];Ra(c,"",e,d);c=0;d=0;for(var g in e){var a=e[g],h=a[0];a=a[1];var i=a.level==0?0:8,j=Wa(g),k=j.length,l=a.comment,m=l&&Wa(l),n=m&&m.length,o=bb(a.extra);if(k>65535)throw"filename too long";var p=i?wa(h,a):h,q=p.length,r=O();r.p(h);f.push(R(a,{size:h.length,crc:r.d(),c:p,f:j,m:m,u:k!=g.length||m&&l.length!=n,o:c,compression:i}));c+=30+k+o+q;d+=76+2*(k+o)+(n||0)+q}a=new b(d+22);h=c;r=d-c;for(p=0;p<f.length;++p){var j=f[p];cb(a,j.o,j,j.f,j.u,j.c.length);m=30+j.f.length+bb(j.extra);a.set(j.c,j.o+m);cb(a,c,j,j.f,j.u,j.c.length,j.o,j.m),c+=16+m+(j.m?j.m.length:0)}db(a,c,f.length,r,h);return a}l.zipSync=gb;var hb=function(){function a(){}a.prototype.push=function(a,b){this.ondata(null,a,b)};a.compression=0;return a}();l.UnzipPassThrough=hb;Qa=function(){function a(){var a=this;this.i=new $(function(b,c){a.ondata(null,b,c)})}a.prototype.push=function(a,b){try{this.i.push(a,b)}catch(c){this.ondata(c,a,b)}};a.compression=8;return a}();l.UnzipInflate=Qa;Ba=function(){function a(a,b){var c=this;b<32e4?this.i=new $(function(a,b){c.ondata(null,a,b)}):(this.i=new xa(function(a,b,d){c.ondata(a,b,d)}),this.terminate=this.i.terminate)}a.prototype.push=function(a,b){this.i.terminate&&(a=A(a,0)),this.i.push(a,b)};a.compression=8;return a}();l.AsyncUnzipInflate=Ba;h=function(){function a(a){this.onfile=a,this.k=[],this.o={0:hb},this.p=L}a.prototype.push=function(a,c){var d=this;if(!this.onfile)throw"no callback";if(!this.p)throw"stream finished";if(this.c>0){var e=Math.min(this.c,a.length),f=a.subarray(0,e);this.c-=e;this.d?this.d.push(f,!this.c):this.k[0].push(f);a=a.subarray(e);if(a.length)return this.push(a,c)}else{f=0;var g=0;e=void 0;var h=void 0;!this.p.length?h=a:!a.length?h=this.p:(h=new b(this.p.length+a.length),(h.set(this.p),h.set(a,this.p.length)));var i=h.length,j=this.c;a=j&&this.d;var k=function(){var a=Y(h,g);if(a==67324752){f=1,e=g;l.d=null;l.c=0;var b=X(h,g+6),c=X(h,g+8),k=b&2048;b=b&8;var m=X(h,g+26),n=X(h,g+28);if(i>g+30+m+n){var o=[];l.k.unshift(o);f=2;var p=Y(h,g+18),q=Y(h,g+22),r=Xa(h.subarray(g+30,g+=30+m),!k);p==4294967295?(m=b?[-2]:ab(h,g),p=m[0],q=m[1]):b&&(p=-1);g+=n;l.c=p;var s,t={name:r,compression:c,start:function(){if(!t.ondata)throw"no callback";if(!p)t.ondata(null,L,!0);else{var a=d.o[c];if(!a)throw"unknown compression type "+c;s=p<0?new a(r):new a(r,p,q);s.ondata=function(c,b,a){t.ondata(c,b,a)};for(var a=0,b=o;a<b.length;a++){var e=b[a];s.push(e,!1)}d.k[0]==o&&d.c?d.d=s:s.push(L,!0)}},terminate:function(){s&&s.terminate&&s.terminate()}};p>=0&&(t.size=p,t.originalSize=q);l.onfile(t)}return"break"}else if(j)if(a==134695760){e=g+=12+(j==-2&&8),f=3,l.c=0;return"break"}else if(a==33639248){e=g-=4,f=3,l.c=0;return"break"}},l=this;for(;g<i-4;++g){var m=k();if(m==="break")break}this.p=L;if(j<0){m=f?h.subarray(0,e-12-(j==-2&&8)-(Y(h,e-16)==134695760&&4)):h.subarray(0,g);a?a.push(m,!!f):this.k[+(f==2)].push(m)}if(f&2)return this.push(h.subarray(g),c);this.p=h.subarray(g)}if(c){if(this.c)throw"invalid zip file";this.p=null}};a.prototype.register=function(a){this.o[a.compression]=a};return a}();l.Unzip=h;function ib(a,c){if(typeof c!="function")throw"no callback";var d=[],e=function(){for(var a=0;a<d.length;++a)d[a]()},f={},g=a.length-22;for(;Y(a,g)!=101010256;--g)if(!g||a.length-g>65558){c("invalid zip file",null);return}var h=X(a,g+8);h||c(null,{});var i=h,j=Y(a,g+16),k=j==4294967295;if(k){g=Y(a,g-12);if(Y(a,g)!=101075792){c("invalid zip file",null);return}i=h=Y(a,g+32);j=Y(a,g+48)}g=function(g){g=$a(a,j,k);var i=g[0],l=g[1],m=g[2],n=g[3],o=g[4];g=g[5];g=Za(a,g);j=o;o=function(a,b){a?(e(),c(a,null)):(f[n]=b,--h||c(null,f))};if(!i)o(null,A(a,g,g+l));else if(i==8){g=a.subarray(g,g+l);if(l<32e4)try{o(null,za(g,new b(m)))}catch(a){o(a,null)}else d.push(ya(g,{size:m},o))}else o("unknown compression type "+i,null)};for(var l=0;l<i;++l)g(l);return e}l.unzip=ib;function jb(c){var d={},e=c.length-22;for(;Y(c,e)!=101010256;--e)if(!e||c.length-e>65558)throw"invalid zip file";var f=X(c,e+8);if(!f)return{};var g=Y(c,e+16),h=g==4294967295;if(h){e=Y(c,e-12);if(Y(c,e)!=101075792)throw"invalid zip file";f=Y(c,e+32);g=Y(c,e+48)}for(e=0;e<f;++e){var a=$a(c,g,h),i=a[0],j=a[1],k=a[2],l=a[3],m=a[4];a=a[5];a=Za(c,a);g=m;if(!i)d[l]=A(c,a,a+j);else if(i==8)d[l]=za(c.subarray(a,a+j),new b(k));else throw"unknown compression type "+i}return d}l.unzipSync=jb}var o=!1;function p(){o||(o=!0,n());return m.exports}function a(a){switch(a){case void 0:return p()}}e.exports=a}),null);
__d("fflate",["fflate-0.6.10"],(function(a,b,c,d,e,f){e.exports=b("fflate-0.6.10")()}),null);
__d("WAGzip",["Promise","WAErr","fflate"],(function(a,b,c,d,e,f,g){var h,i=function(b){babelHelpers.inheritsLoose(a,b);function a(a){var c;c=b.call(this,a)||this;c.$GzipWrapper2=[];c.ondata=function(a,b){c.$GzipWrapper2.push(a);if(!b)return;var d=0;c.$GzipWrapper2.forEach(function(a){d+=a.length});var e=new Uint8Array(d),f=0;c.$GzipWrapper2.forEach(function(a){e.set(a,f),f+=a.length});c.$GzipWrapper1=e};return c}var e=a.prototype;e.push=function(a,e){if(this.$GzipWrapper1!=null)throw c("WAErr")("Tried to push chunk to compressor after final block");a instanceof Uint8Array?b.prototype.push.call(this,a,e):a instanceof ArrayBuffer?b.prototype.push.call(this,new Uint8Array(a),e):b.prototype.push.call(this,d("fflate").strToU8(a),e)};e.result=function(){if(this.$GzipWrapper1==null)throw c("WAErr")("Tried to access result before adding final block");return this.$GzipWrapper1};return a}(d("fflate").Gzip);function a(a){a===void 0&&(a={});return new i(a)}function j(a){return d("fflate").decompressSync(a)}function e(a){return(h||(h=b("Promise"))).resolve(j(a))}g.GzipWrapper=i;g.createDeflate=a;g.inflate=j;g.gzipInflate=e}),98);
__d("WAJobRequirement",["Promise","WALogger"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["JobRequirement[","] blocker errored ",""]);i=function(){return a};return a}c=function(){function a(a){var c=this;this.$1=(h||(h=b("Promise"))).resolve();this.$2=!0;this.$3=null;this.$4=function(){var a=c.$3;if(a!=null){c.$3=null;return(h||(h=b("Promise"))).all(a).then(c.$4)}c.$2=!0};this.name=a}var c=a.prototype;c.addBlocker=function(a){var c=this;a=a["catch"](function(a){d("WALogger").ERROR(i(),c.name,a).sendLogs("job-blocker-rejected")});if(this.$2)this.$2=!1,this.$1=(h||(h=b("Promise"))).all([this.$1,a]).then(this.$4);else{var e=this.$3;e!=null?e.push(a):this.$3=[a]}};c.waitUntilSatisfied=function(){return this.$1};c.isSatisfied=function(){return this.$2};c.isSatisfiable=function(){return!0};return a}();e=function(a){babelHelpers.inheritsLoose(c,a);function c(c){c=a.call(this,c)||this;a.prototype.addBlocker.call(babelHelpers.assertThisInitialized(c),new(h||(h=b("Promise")))(function(){}));return c}var d=c.prototype;d.addBlocker=function(){};d.isSatisfiable=function(){return!1};return c}(c);function a(a,c){var d=a.filter(function(a){return!a.isSatisfiable()});if(d.length>0){var e=d.map(function(a){return a.name});return function(a){c==null?void 0:c("unsatisfiable",e,a);return d[0].waitUntilSatisfied()}}var f=a.map(function(){return(h||(h=b("Promise"))).resolve()}),g=(h||(h=b("Promise"))).resolve(),i=null,j=function c(){if(f.every(function(b,c){return b===a[c].waitUntilSatisfied()})){i=null;return}var d=[],e=a.map(function(a){var b=a.waitUntilSatisfied();a.isSatisfied()||(d.push(a.name),b.then(function(){var b=d.indexOf(a.name);d.splice(b,1)}));return b});f=e;i=d;return(h||(h=b("Promise"))).all(e).then(c)};return function(a){if(i==null){var b=j();b!=null&&(g=g.then(function(){return b}))}c==null?void 0:c(i==null?"satisfied":"unsatisfied",i,a);return g}}g.JobRequirement=c;g.UnsatisfiableJobRequirement=e;g.joinRequirements=a}),98);
__d("WAPersistedJobManager",["Promise","WAJobRequirement","WALogger","WAPromiseBackoffs","WATimeUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([""," waiting on ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([""," halting because of ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["waitUntilCompletedNonPersisted not implemented in PersistedJobManager"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["fireAndForgetNonPersisted not implemented in PersistedJobManager"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([""," has been loaded and is marked as deprecated"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["addPersistedJobImplementation called twice for ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["onJobStarted for "," threw exception ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": "," step not found"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose([""," failed with error ",""]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["onJobFinished for "," threw exception ",""]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": finished job"]);s=function(){return a};return a}function a(){var b=babelHelpers.taggedTemplateLiteralLoose(["",": Unhandled exception: ",""]);a=function(){return b};return b}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": Unhandled exception. Tried "," times"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": RetryOnBackoff"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": requires page"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": delaying until ",""]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": trim wait from "," to ",""]);x=function(){return a};return a}function y(){var a=babelHelpers.taggedTemplateLiteralLoose(["No implementation for ",".",""]);y=function(){return a};return a}function z(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": removing completed, expired job from db"]);z=function(){return a};return a}function A(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": skew detected, adjusting accordingly"]);A=function(){return a};return a}function B(){var a=babelHelpers.taggedTemplateLiteralLoose(["Running deprecated job ",""]);B=function(){return a};return a}function C(){var a=babelHelpers.taggedTemplateLiteralLoose(["No implementation for deprecated ",", job deleted"]);C=function(){return a};return a}function D(){var a=babelHelpers.taggedTemplateLiteralLoose(["No implementation for ",". Maybe it should have been put to the deprecated list?"]);D=function(){return a};return a}function E(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": InterruptJob"]);E=function(){return a};return a}function F(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": running step"]);F=function(){return a};return a}function G(){var a=babelHelpers.taggedTemplateLiteralLoose(["Persisted job missing for given ID"]);G=function(){return a};return a}function H(){var a=babelHelpers.taggedTemplateLiteralLoose(["No entry for job ",""]);H=function(){return a};return a}function I(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": restarting"]);I=function(){return a};return a}function J(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": stuck on the step ",", aborting the job"]);J=function(){return a};return a}var K=1,L=function(){function a(a){this.feature=a}var b=a.prototype;b.toString=function(){return"RequiresPage: "+this.feature};return a}(),M=function(){function a(a){this.backoffOptions=a}var b=a.prototype;b.toString=function(){return"RetryOnBackoff"};return a}(),N=function(a){this.result=a},O="$unstarted",P="$finished";c=function(){function a(a){var c=this,e=a.isRestartAfterCrash,f=a.accessors,g=a.unfinishedJobEntries,i=new Map();g=g.then(function(a){var g=[],j=[];a.forEach(function(a){a.stepHardStartCountAfterTimeout>=5?g.push(a):j.push(a)});return(h||(h=b("Promise"))).all(g.map(function(a){d("WALogger").ERROR(J(),R(a),a.step).devConsole(Q(a)).sendLogs("job-stuck-"+a.type);return f.deletePersistedJob(a.jobId)})).then(function(){j.forEach(function(a){if(i.has(a.jobId))return;d("WALogger").LOG(I(),Q(a));i.set(a.jobId,c.$1(a,e))})})});this.implementationLoaders=new Map();this.implementations=new Map();this.stepBlockers=new WeakMap();this.accessors=f;this.activeJobs=i;this.initialJobsPromise=g;this.listeners=a.listeners;this.deprecatedJobs=a.deprecatedJobs}var c=a.prototype;c.loadAndRunJobFromId=function(a){var b=this.activeJobs.get(a);if(b!=null)return b;b=this.$2(a);this.activeJobs.set(a,b);return b};c.$2=function(a){var c,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:c=this.initialJobsPromise,e=this.accessors;g.next=3;return b("regeneratorRuntime").awrap(c);case 3:g.next=5;return b("regeneratorRuntime").awrap(e.readPersistedJob(a));case 5:f=g.sent;if(f){g.next=10;break}d("WALogger").DEV(H(),a);d("WALogger").WARN(G());return g.abrupt("return",null);case 10:return g.abrupt("return",this.$1(f,!1));case 11:case"end":return g.stop()}},null,this)};c.$3=function(a){var b=this.implementations,c=this.implementationLoaders,d=b.get(a);if(d)return d;d=c.get(a);if(!d)return null;c=d();b.set(a,c);return c};c.$4=function(a,c){if(c==null||c.length===0)return(h||(h=b("Promise"))).resolve();var e=this.stepBlockers,f=e.get(c);f==null&&(f=d("WAJobRequirement").joinRequirements(c.map(function(a){return a()}),T),e.set(c,f));return f(a)};c.$5=function(a,b,c,e){var f=this;c===void 0&&(c=!1);var g=a.step,h=b.findIndex(function(a){return a.stepName===g}),i=b[h].info(a.current,a.original,U(a,c)),j=i.requirements,k=i.code;i=this.$4(a,j);e&&(i=i.then(e));return i.then(function(){d("WALogger").LOG(F(),S(a));return k(a.current,a.original,U(a,c))}).then(function(e){if(e instanceof N){d("WALogger").LOG(E(),S(a));return e.result}var g=h+1;if(g>=b.length)return e;g=b[g];a.step=g.stepName;a.current=e;a.stepHardStartCountAfterTimeout=0;a.stepFirstStartTime=d("WATimeUtils").unixTime();a.stepUnexpectedErrorCount=0;a.waitUntil=null;a.backedOffCount=0;return f.accessors.updatePersistedJob(a).then(function(){return f.$5(a,b,c)})})};c.$1=function(a,c){var e,f=this,g,i,j,k,l,m,n,E,F,G,H,I,J,N,R,T;return b("regeneratorRuntime").async(function(V){while(1)switch(V.prev=V.next){case 0:g=this.accessors,i=this.activeJobs,j=this.deprecatedJobs,k=this.listeners,l=k.onJobFinished,m=k.onJobStarted;V.next=3;return b("regeneratorRuntime").awrap(this.$3(a.type));case 3:n=V.sent;E=j[a.type];if(n){V.next=21;break}if(E){V.next=13;break}d("WALogger").ERROR(D(),a.type).sendLogs("missing-job-implementation");V.next=10;return b("regeneratorRuntime").awrap(g.deletePersistedJob(a.jobId));case 10:return V.abrupt("return",null);case 13:if(!(E==="NOOP")){V.next=18;break}d("WALogger").WARN(C(),a.type);V.next=17;return b("regeneratorRuntime").awrap(g.deletePersistedJob(a.jobId));case 17:return V.abrupt("return",null);case 18:V.next=20;return b("regeneratorRuntime").awrap(E());case 20:n=V.sent;case 21:F=n;E&&d("WALogger").LOG(B(),a.type);G=(e=a.stepFirstStartTime)!=null?e:d("WATimeUtils").unixTime();a.stepFirstStartTime=G;a.stepUnexpectedErrorCount=a.stepUnexpectedErrorCount||0;a.backedOffCount=a.backedOffCount||0;if(!(a.step===P)){V.next=44;break}H=a.waitUntil;I=d("WATimeUtils").secondsUntil(G);if(!(H!=null&&d("WATimeUtils").isInFuture(H)&&I>0)){V.next=38;break}d("WALogger").LOG(A(),Q(a));H=d("WATimeUtils").castToUnixTime(H-I);if(!d("WATimeUtils").isInFuture(H)){V.next=38;break}a.stepFirstStartTime=d("WATimeUtils").castToUnixTime(G-I);a.waitUntil=H;V.next=38;return b("regeneratorRuntime").awrap(this.accessors.updatePersistedJob(a));case 38:if(!(H==null||!d("WATimeUtils").isInFuture(H))){V.next=42;break}d("WALogger").LOG(z(),Q(a));V.next=42;return b("regeneratorRuntime").awrap(g.deletePersistedJob(a.jobId));case 42:i["delete"](a.jobId);return V.abrupt("return",a.current);case 44:J=a.step!==O?n.find(function(b){return b.stepName===a.step}):n[0];if(J){V.next=50;break}d("WALogger").ERROR(y(),a.type,a.step).sendLogs("missing-job-step");V.next=49;return b("regeneratorRuntime").awrap(g.deletePersistedJob(a.jobId));case 49:return V.abrupt("return",null);case 50:a.step=J.stepName;N=function e(){var g=a.waitUntil,i=(h||(h=b("Promise"))).resolve();if(g!=null){var j=d("WATimeUtils").futureUnixTime(d("WATimeUtils").DAY_SECONDS);g>j?(d("WALogger").LOG(x(),S(a),g,j),a.waitUntil=j,i=f.accessors.updatePersistedJob(a).then(function(){return d("WATimeUtils").delayUntil(j)})):(d("WALogger").LOG(w(),S(a),g),i=d("WATimeUtils").delayUntil(g))}return i.then(function(){var g=function(){a.waitUntil=null;d("WATimeUtils").happenedWithin(G,d("WATimeUtils").DAY_SECONDS)||a.stepHardStartCountAfterTimeout++;return f.accessors.updatePersistedJob(a)};return f.$5(a,F,c,g)["catch"](function(c){if(c instanceof L){d("WALogger").LOG(v(),S(a));a.stepHardStartCountAfterTimeout>0&&(--a.stepHardStartCountAfterTimeout,f.accessors.updatePersistedJob(a));return new(h||(h=b("Promise")))(function(){})}else if(c instanceof M){d("WALogger").LOG(u(),S(a));var g=d("WAPromiseBackoffs").getDelay(++a.backedOffCount,c.backoffOptions);a.waitUntil=d("WATimeUtils").futureUnixTime(Math.ceil(g/1e3));a.stepHardStartCountAfterTimeout>0&&--a.stepHardStartCountAfterTimeout;return f.accessors.updatePersistedJob(a).then(e)}else if(a.stepUnexpectedErrorCount<K){d("WALogger").WARN(t(),S(a),a.stepUnexpectedErrorCount);a.stepUnexpectedErrorCount++;return f.accessors.updatePersistedJob(a).then(e)}throw c})})};R=N();T=R.then(function(c){var e;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:d("WALogger").LOG(s(),S(a));e=null;try{e=l(a.jobId,a.type,a.original,c)}catch(b){d("WALogger").ERROR(r(),a.type,b).sendLogs("onJobFinished-threw")}if(!(e!=null&&e>0)){h.next=12;break}a.waitUntil=d("WATimeUtils").futureUnixTime(Math.ceil(e/1e3));a.step=P;a.current=c;a.stepFirstStartTime=d("WATimeUtils").unixTime();h.next=10;return b("regeneratorRuntime").awrap(f.accessors.updatePersistedJob(a));case 10:h.next=15;break;case 12:h.next=14;return b("regeneratorRuntime").awrap(g.deletePersistedJob(a.jobId));case 14:i["delete"](a.jobId);case 15:case"end":return h.stop()}},null,this)},function(e){var f,h;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:d("WALogger").ERROR(q(),a.type,e).sendLogs("job-threw-exception-"+a.type);f=F.find(function(b){return b.stepName===a.step});if(f){j.next=6;break}d("WALogger").ERROR(p(),a.type,a.step);j.next=10;break;case 6:h=f.info(a.current,a.original,U(a,c));if(!(h.stopRetryIf!=null)){j.next=10;break}j.next=10;return b("regeneratorRuntime").awrap(h.stopRetryIf.onStopRetry(a.current,a.original,U(a,c)));case 10:j.next=12;return b("regeneratorRuntime").awrap(g.deletePersistedJob(a.jobId));case 12:i["delete"](a.jobId);case 13:case"end":return j.stop()}},null,this)});try{m(a.jobId,a.type,a.original)}catch(b){d("WALogger").ERROR(o(),a.type,b).sendLogs("onJobStarted-threw")}return V.abrupt("return",T.then(function(){return R}));case 56:case"end":return V.stop()}},null,this)};c.addPersistedJobImplementation=function(a,b){var c=this.implementationLoaders,e=this.deprecatedJobs;if(c.has(a)){d("WALogger").ERROR(n(),a).sendLogs("repeat-job-loader");return}e&&e[a]&&d("WALogger").DEV(m(),a);c.set(a,b)};c.fireAndForget=function(a){var b=this;this.accessors.maybeCreateJob(a).then(function(a){a=a.id;return b.loadAndRunJobFromId(a)})};c.waitUntilPersisted=function(a){var b=this;return this.accessors.maybeCreateJob(a).then(function(a){a=a.id;b.loadAndRunJobFromId(a)})};c.waitUntilCompleted=function(a){var b=this;return this.accessors.maybeCreateJob(a).then(function(a){a=a.id;return b.loadAndRunJobFromId(a)})};c.fireAndForgetNonPersisted=function(a){d("WALogger").LOG(l())};c.waitUntilCompletedNonPersisted=function(a){return(h||(h=b("Promise"))).resolve(function(){return d("WALogger").LOG(k())})};return a}();function Q(a){return"Job["+a.jobId+"] ("+a.type+")"}function R(a){return"[Job "+a.type+"] "}function S(a){return"Job["+a.jobId+"] ("+a.type+"."+a.step+")"}function T(a,b,c){a==="unsatisfiable"?d("WALogger").LOG(j(),S(c),b):a==="unsatisfied"?d("WALogger").LOG(i(),S(c),b):a}function U(a,b){b===void 0&&(b=!1);return{jobStartTime:a.startTime,afterCrash:b,interruptJob:V}}function V(a){return new N(a)}g.RequiresPage=L;g.RetryOnBackoff=M;g.InterruptJob=N;g.UNSTARTED_JOB=O;g.FINISHED_JOB=P;g.PersistedJobManager=c}),98);
__d("WASmaxInDevicesIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQErrorResponseMixin=a}),98);
__d("WASmaxInDevicesIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","bad-request");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",400);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorBadRequestMixin=a}),98);
__d("WASmaxInDevicesIQErrorItemNotFoundMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","item-not-found");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",404);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorItemNotFoundMixin=a}),98);
__d("WASmaxInDevicesIQErrorInternalServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","internal-server-error");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",500);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorInternalServerErrorMixin=a}),98);
__d("WASmaxInDevicesIQErrorServiceUnavailableMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","service-unavailable");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",503);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorServiceUnavailableMixin=a}),98);
__d("WASmaxInDevicesIQErrorInternalServerErrorOrServiceUnavailableMixinGroup",["WAResultOrError","WASmaxInDevicesIQErrorInternalServerErrorMixin","WASmaxInDevicesIQErrorServiceUnavailableMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInDevicesIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorInternalServerError",value:b.value});var c=d("WASmaxInDevicesIQErrorServiceUnavailableMixin").parseIQErrorServiceUnavailableMixin(a);return c.success?d("WAResultOrError").makeResult({name:"IQErrorServiceUnavailable",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorInternalServerError","IQErrorServiceUnavailable"],[b,c])}g.parseIQErrorInternalServerErrorOrServiceUnavailableMixinGroup=a}),98);
__d("WASmaxInDevicesRetryableIQErrorMixin",["WAResultOrError","WASmaxInDevicesIQErrorInternalServerErrorOrServiceUnavailableMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"backoff",0,86400);if(!b.success)return b;a=d("WASmaxInDevicesIQErrorInternalServerErrorOrServiceUnavailableMixinGroup").parseIQErrorInternalServerErrorOrServiceUnavailableMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({backoff:b.value,iQErrorInternalServerErrorOrServiceUnavailableMixinGroup:a.value})}g.parseRetryableIQErrorMixin=a}),98);
__d("WASmaxInDevicesIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQResultResponseMixin=a}),98);
__d("WAJobBuilder",["Promise","WAPersistedJobManager","WATimeUtils"],(function(a,b,c,d,e,f,g){var h,i=function(){function a(a){this.steps=a}var b=a.prototype;b.step=function(a,b){return this.$1(a,typeof b==="function"?{code:b}:b)};b.$1=function(b,c){var e=c.stopRetryIf,f=c.requirements;c=c.code;f=k(f,c,e);if(e){var g=e.timePassedSeconds;c=e.appCrashed;var h=e.onStopRetry;h=k(null,l(h),e);g!=null&&(f=j(function(a,b,c){a=c.jobStartTime;return d("WATimeUtils").happenedWithin(a,g)},f,h));c&&(f=j(function(a,b,c){a=c.afterCrash;return!a},f,h))}return new a([].concat(this.steps,[{stepName:b,info:f}]))};b.finalStep=function(a,b){var c=this.step(a,b);return{end:function(){return c.steps}}};return a}();function a(){return new i([])}function j(a,b,c){return function(d,e,f){return a(d,e,f)?b(d,e,f):c(d,e,f)}}function k(a,b,c){var d={requirements:a,code:b,stopRetryIf:c};return function(){return d}}function l(a){return function(c,e,f){return(h||(h=b("Promise"))).resolve(a(c,e,f)).then(function(a){return a instanceof d("WAPersistedJobManager").InterruptJob?a:new(d("WAPersistedJobManager").InterruptJob)(a)})}}g.JobBuilder=i;g.definePersistedJob=a}),98);
__d("WAArrayChunk",[],(function(a,b,c,d,e,f){function a(a,b,c,d){c===void 0&&(c=!1);var e=0,f=[];while(e<a.length){var g=[],h=0;while(e<a.length){var i=a[e],j=d?d(i):1;if(!c&&h===0||h+j<=b)h+=j,g.push(i),e++;else{c&&j>b&&e++;break}}g.length>0&&f.push(g)}return f}f.chunk=a}),66);
__d("WAGetDevices",["Promise","WAJobs","WALogger","WAStateMachines"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["fetchAndSaveDevices: ",""]);i=function(){return a};return a}function j(a,c,e){e===void 0&&(e=!1);d("WALogger").LOG(i(),c);var f=d("WAStateMachines").getStateMachine("devicesStateMachine");return(h||(h=b("Promise"))).resolve().then(function(){if(e)return f.reset(Array.from(a))}).then(function(){return d("WAStateMachines").getStateMachine("devicesStateMachine").waitForUserDevices(Array.from(a),e)})}a=d("WAJobs").getPersistedJobsApi().definePersistedJob().finalStep("getDevices",function(a){var b=a.users,c=a.reason;a=a.ignoreDhash;return j(b,c,a)}).end();g.fetchAndSaveDevices=j;g.getDevices=a}),98);
__d("WASmaxInGroupsEnums",[],(function(a,b,c,d,e,f){a={304:"304",419:"419"};b={403:"403",404:"404",406:"406",419:"419"};c={404:"404",406:"406"};d={404:"404",419:"419"};e={406:"406",500:"500"};var g={accept:"accept",auto_add:"auto_add",default_sub_group_admin_add:"default_sub_group_admin_add",general_chat_auto_add:"general_chat_auto_add",invite:"invite",invite_auto_add:"invite_auto_add",linked_group_join:"linked_group_join",sub_group_suggestion_approved:"sub_group_suggestion_approved"},h={accept:"accept",default_sub_group_promote:"default_sub_group_promote",invite:"invite",invite_auto_add:"invite_auto_add",linked_group_join:"linked_group_join"},i={account_setting:"account_setting",bulk_change:"bulk_change",chat_setting:"chat_setting"},j={admin:"admin",creator:"creator"},k={admin:"admin",superadmin:"superadmin"},l={approved:"approved",cancelled:"cancelled",rejected:"rejected"},m={delete_parent:"delete_parent",integrity_delete_parent:"integrity_delete_parent"},n={delete_parent:"delete_parent",integrity_delete_parent:"integrity_delete_parent",unlink_group:"unlink_group"},o={e2ee_migration:"e2ee_migration",regular:"regular",rtc:"rtc"},p={"false":"false","true":"true"},q={image:"image",preview:"preview"},r={invite_link:"invite_link",linked_group_join:"linked_group_join",non_admin_add:"non_admin_add"},s={lid:"lid",pn:"pn"},t={parent_group:"parent_group",sibling_group:"sibling_group",sub_group:"sub_group"};f.ENUM_304_419=a;f.ENUM_403_404_406_419=b;f.ENUM_404_406=c;f.ENUM_404_419=d;f.ENUM_406_500=e;f.ENUM_ACCEPT_AUTOADD_DEFAULTSUBGROUPADMINADD_GENERALCHATAUTOADD_INVITE_INVITEAUTOADD_LINKEDGROUPJOIN_SUBGROUPSUGGESTIONAPPROVED=g;f.ENUM_ACCEPT_DEFAULTSUBGROUPPROMOTE_INVITE_INVITEAUTOADD_LINKEDGROUPJOIN=h;f.ENUM_ACCOUNTSETTING_BULKCHANGE_CHATSETTING=i;f.ENUM_ADMIN_CREATOR=j;f.ENUM_ADMIN_SUPERADMIN=k;f.ENUM_APPROVED_CANCELLED_REJECTED=l;f.ENUM_DELETEPARENT_INTEGRITYDELETEPARENT=m;f.ENUM_DELETEPARENT_INTEGRITYDELETEPARENT_UNLINKGROUP=n;f.ENUM_E2EEMIGRATION_REGULAR_RTC=o;f.ENUM_FALSE_TRUE=p;f.ENUM_IMAGE_PREVIEW=q;f.ENUM_INVITELINK_LINKEDGROUPJOIN_NONADMINADD=r;f.ENUM_LID_PN=s;f.ENUM_PARENTGROUP_SIBLINGGROUP_SUBGROUP=t}),66);
__d("WASmaxInGroupsParticipantNotAddressableMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"addressable","false");return!b.success?b:d("WAResultOrError").makeResult({addressable:b.value})}g.parseParticipantNotAddressableMixin=a}),98);
__d("WASmaxInGroupsPhoneNumberMixin",["WAResultOrError","WASmaxParseJid"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseJid").attrUserJid(a,"phone_number");return!a.success?a:d("WAResultOrError").makeResult({phoneNumber:a.value})}g.parsePhoneNumberMixin=a}),98);
__d("WASmaxInGroupsGroupAddressingModeMixin",["WAResultOrError","WASmaxInGroupsEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrStringEnum(a,"addressing_mode",d("WASmaxInGroupsEnums").ENUM_LID_PN);return!a.success?a:d("WAResultOrError").makeResult({addressingMode:a.value})}g.parseGroupAddressingModeMixin=a}),98);
__d("WASmaxInDevicesNonRetryableIQErrorMixin",["WASmaxInDevicesIQErrorBadRequestMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxInDevicesIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(a);return!b.success?b:b}g.parseNonRetryableIQErrorMixin=a}),98);
__d("WASmaxInDevicesRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup",["WAResultOrError","WASmaxInDevicesNonRetryableIQErrorMixin","WASmaxInDevicesRetryableIQErrorMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInDevicesRetryableIQErrorMixin").parseRetryableIQErrorMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"RetryableIQError",value:b.value});var c=d("WASmaxInDevicesNonRetryableIQErrorMixin").parseNonRetryableIQErrorMixin(a);return c.success?d("WAResultOrError").makeResult({name:"NonRetryableIQError",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["RetryableIQError","NonRetryableIQError"],[b,c])}g.parseRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup=a}),98);
__d("WASmaxInDevicesKeyDataMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").contentBytesRange(a,32,32);return!a.success?a:d("WAResultOrError").makeResult({elementValue:a.value})}g.parseKeyDataMixin=a}),98);
__d("WASmaxInDevicesIdentityKeyMixin",["WASmaxInDevicesKeyDataMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"identity");if(!a.success)return a;a=d("WASmaxInDevicesKeyDataMixin").parseKeyDataMixin(a.value);return!a.success?a:a}g.parseIdentityKeyMixin=a}),98);
__d("WASmaxOutDevicesBaseIQGetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{id:d("WAWap").generateId(),type:"get"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseIQGetRequestMixin=a}),98);
__d("WAParseMessageTransport",["decodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return{version:"v3",type:"error",error:a}}function i(a,b){return a!=null&&(b.dsm==null||b.dsm.destinationJid==null||b.dsm.destinationJid!==a)}function a(a,b){var c=a.payload;a=a.protocol;if(c==null&&a==null)return h("There is no payload and protocol in the message transport");else if(a==null)return h("There is no protocol part in the message transport");var e=a.integral;if(e==null)return h("There is no integral part in the message transport");else if(e.padding==null)return h("There is no padding in the message transport");else if(i(b,e))return h("The recipient does not match the device sent message recipient");else if(d("decodeProtobuf").getUnknownFields(e)!=null)return babelHelpers["extends"]({},h("There are unknown fields in the integral"),{futureProof:c==null?void 0:c.futureProof});if(c!=null){b=c.applicationPayload;return b==null?h("There is no applicationPayload payload in the message transport"):{type:"applicationPayload",applicationPayload:b,skdm:j(a.ancillary),icdc:k(a.ancillary)}}e=j(a.ancillary);return e!=null?{type:"skdm",skdm:e,icdc:k(a.ancillary)}:{type:"unknown"}}function j(a){return a==null?null:a.skdm}function k(a){return a==null?null:a.icdc}g.parseMessageTransport=a}),98);
__d("WADecodeIncomingMsg",["WALogger","WALongInt","WAMsgApplication.pb","WAMsgTransport.pb","WAParseMessageApplication","WAParseMessageTransport","WATimeUtils","decodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["decodeIncomingMsg called with unexpected encoding version: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["instamadillo decodeIncomingMsg called with null applicationPayload"]);i=function(){return a};return a}function j(a,b){return a.futureProof?{version:"v3",type:"futureProof",futureProof:a.futureProof,protobuf:b,subtype:null}:{version:"v3",type:"error",error:a.error}}function a(a,b,c,e){if(b==="v2")return{version:"v2",encoded:a};else if(b==="v3"){var f=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAMsgTransport.pb").MessageTransportSpec,a);f=d("WAParseMessageTransport").parseMessageTransport(f,c);if(f.type==="error")return j(f,a);if(f.type==="skdm")return k(f.skdm,f.icdc);else if(f.type==="applicationPayload"){if(e===!0){if(f.applicationPayload.payload==null){d("WALogger").DEV(i());return{version:"v3",type:"error",error:"unhandled proto"}}return{version:"v3",type:"instamadillo",applicationPayload:new Uint8Array(f.applicationPayload.payload)}}c=l(f.applicationPayload,a,f.icdc);if(f.skdm!=null){e=k(f.skdm,f.icdc);return{version:"v3",type:"msgWithSKDM",msg:c,skdm:e}}return c}else{f.type;return{version:"v3",type:"error",error:"unhandled proto"}}}else{d("WALogger").DEV(h(),b);return{type:"error",version:"v3",error:"decodeIncomingMsg called with unexpected encoding version: "+b}}}function k(a,b){var c=a.axolotlSenderKeyDistributionMessage;a=a.groupId;if(c==null)return{type:"error",version:"v3",error:"parseSKDM called with null axolotlSenderKeyDistributionMessage"};else if(a==null)return{type:"error",version:"v3",error:"parseSKDM called with null groupId"};return{version:"v3",type:"skdm",msg:{senderKey:c,groupId:a},icdc:b}}function l(a,b,c){var e=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAMsgApplication.pb").MessageApplicationSpec,a.payload);if(e.payload==null)return m(e.metadata);var f=d("WAParseMessageApplication").parseMessageApplication(e);return f.type==="error"?j(f,b):{version:"v3",type:"subprotocol",metadata:(e=e.metadata)!=null?e:null,subprotocolType:f.subprotocolType,subprotocol:f.payload,protobuf:b,frankingContent:a.payload,icdc:c}}function m(a){a=a==null?void 0:a.chatEphemeralSetting;if(a!=null){var b=a.ephemeralExpiration,c=a.ephemeralSettingTimestamp;if(b==null)return{version:"v3",type:"error",error:"Ephemeral setting without expiration"};try{c=c!=null?d("WATimeUtils").castToUnixTime(d("WALongInt").numberOrThrowIfTooLarge(c)/1e3):d("WATimeUtils").DEFAULT_UNIXTIME;return{version:"v3",type:"ephemeral",ephemeralExpirationInSec:b,ephemeralLastUpdatedOrSetTimestamp:c,isEphemeralSettingReset:(c=a.isEphemeralSettingReset)!=null?c:!1}}catch(e){return{version:"v3",type:"ephemeral",ephemeralExpirationInSec:b,ephemeralLastUpdatedOrSetTimestamp:d("WATimeUtils").DEFAULT_UNIXTIME,isEphemeralSettingReset:(c=a.isEphemeralSettingReset)!=null?c:!1}}}else return{version:"v3",type:"error",error:"MessageApplication has no payload and is not ephemeral"}}g.decodeIncomingMsg=a}),98);
__d("WACreateRetrier",["WAGetMediaRoute","WAMediaOperationsRetrier","WAResultOrError","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,c){var e,f,g,h,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:c==null?void 0:c.addPoint("get_media_route_start");k.next=3;return b("regeneratorRuntime").awrap(d("WAGetMediaRoute").getMediaRoute({operation:"upload",serverMediaType:a},c));case 3:e=k.sent;c==null?void 0:c.addPoint("get_media_route_finish");if(e.success){k.next=7;break}return k.abrupt("return",e);case 7:f=e.value,g=f.selectedHost,h=f.fallbackHost,i=f.authToken;j=new(d("WAMediaOperationsRetrier").MediaOperationsRetrier)("upload",{host:{domain:g.domain,"class":g["class"]},fallbackHost:h&&{domain:h.domain,"class":h["class"]},authToken:i,timeElapsed:null});return k.abrupt("return",d("WAResultOrError").makeResult(j));case 10:case"end":return k.stop()}},null,this)}g.createUploadRetrier=a}),98);
__d("WAHttpRegularUploadMedia",["WAErr","WALogger","WAResultOrError","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["HttpRegularUploadMedia: fail to parse request body ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Fetch Media HTTP status ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["HttpRegularUploadMedia: fail to initiate fetch ",""]);j=function(){return a};return a}function a(a,e){var f,g,k;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:l.prev=0;l.next=3;return b("regeneratorRuntime").awrap(fetch(a,{method:"POST",mode:"cors",cache:"no-store",headers:{"Content-Type":"text/plain"},body:new Blob([e])}));case 3:f=l.sent;l.next=10;break;case 6:l.prev=6;l.t0=l["catch"](0);d("WALogger").ERROR(j(),l.t0);throw l.t0;case 10:g=f,k=g.status;d("WALogger").LOG(i(),k);l.t1=k;l.next=l.t1===200?15:l.t1===408?16:l.t1===413?17:l.t1===415?18:l.t1===429?19:l.t1===507?19:20;break;case 15:return l.abrupt("return",f.json().then(function(a){if(!Object.prototype.hasOwnProperty.call(a,"direct_path"))throw c("WAErr")("direct_path not available in wa upload http response");if(typeof a.direct_path!=="string")throw c("WAErr")('directPath: "'+a.direct_path+'" is not a string');if(a.object_id&&typeof a.object_id!=="string")throw c("WAErr")('objectId: "'+a.object_id+'" is not a string');if(a.handle&&typeof a.handle!=="string")throw c("WAErr")('handle: "'+a.handle+'" is not a string');a={directPath:a.direct_path,objectId:a.object_id,handle:a.handle};return d("WAResultOrError").makeResult(a)})["catch"](function(a){d("WALogger").ERROR(h(),a);return d("WAResultOrError").makeError("body-network-error")}));case 16:return l.abrupt("return",d("WAResultOrError").makeError("server-timeout"));case 17:return l.abrupt("return",d("WAResultOrError").makeError("payload-too-large"));case 18:return l.abrupt("return",d("WAResultOrError").makeError("invalid-media"));case 19:return l.abrupt("return",d("WAResultOrError").makeError("upload-throttled"));case 20:if(!(k>=400&&k<500)){l.next=22;break}return l.abrupt("return",d("WAResultOrError").makeError("request-error"));case 22:return l.abrupt("return",d("WAResultOrError").makeError("unspecified-http-error"));case 23:case"end":return l.stop()}},null,this,[[0,6]])}g.httpRegularUploadMedia=a}),98);
__d("WAHttpResumeCheck",["WALogger","WAResultOrError","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["HttpResumeCheck: fail to parse request body ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["HttpResumeCheck: resume is NaN: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["HttpResumeCheck: object_id is missing"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["HttpResumeCheck: direct_path is missing"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["HttpResumeCheck: response status ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["HttpResumeCheck: fail to initiate fetch ",""]);m=function(){return a};return a}function a(a){var c,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:g.prev=0;g.next=3;return b("regeneratorRuntime").awrap(fetch(a,{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"text/plain"}}));case 3:c=g.sent;g.next=10;break;case 6:g.prev=6;g.t0=g["catch"](0);d("WALogger").ERROR(m(),g.t0);throw g.t0;case 10:e=c,f=e.status;d("WALogger").LOG(l(),f);g.t1=f;g.next=g.t1===200?15:g.t1===404?16:g.t1===408?17:g.t1===429?18:g.t1===507?18:19;break;case 15:return g.abrupt("return",c.json().then(function(a){var b=a.resume,c=a.direct_path;a=a.object_id;if(b==="complete"){if(c==null){d("WALogger").ERROR(k());return d("WAResultOrError").makeResult({type:"media-not-found"})}if(a==null){d("WALogger").ERROR(j());return d("WAResultOrError").makeResult({type:"media-not-found"})}return d("WAResultOrError").makeResult({type:"media-found",directPath:c,objectId:a})}c=parseInt(b,10);if(c===0)return d("WAResultOrError").makeResult({type:"media-not-found"});if(Number.isNaN(c)){d("WALogger").ERROR(i(),b);return d("WAResultOrError").makeResult({type:"media-not-found"})}return d("WAResultOrError").makeResult({type:"media-partial-found",resumeFromBytes:c})})["catch"](function(a){d("WALogger").ERROR(h(),a);return d("WAResultOrError").makeError("body-network-error")}));case 16:return g.abrupt("return",d("WAResultOrError").makeResult({type:"media-not-found"}));case 17:return g.abrupt("return",d("WAResultOrError").makeError("server-timeout"));case 18:return g.abrupt("return",d("WAResultOrError").makeError("upload-throttled"));case 19:if(!(f>=400&&f<500)){g.next=21;break}return g.abrupt("return",d("WAResultOrError").makeError("request-error"));case 21:return g.abrupt("return",d("WAResultOrError").makeError("unspecified-http-error"));case 22:case"end":return g.stop()}},null,this,[[0,6]])}g.httpResumeCheck=a}),98);
__d("WAEncryptAndUploadPlaintext",["WABase64","WAGlobals","WAHttpRegularUploadMedia","WAHttpResumeCheck","WALogger","WAMediaCrypto","WAMediaUrl","WAMediaUtils","WAProgressiveJpegGetPJpegDetails","WAResultOrError","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext: upload success "," ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext given up"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext error: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext error: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext: start upload media to ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext: error during retrier ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext: Found valid progressiveJpeg details. Adding to media entry."]);n=function(){return a};return a}function a(a){var c,e,f,g,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R;return b("regeneratorRuntime").async(function(S){while(1)switch(S.prev=S.next){case 0:c=a.mediaTypeDetails,e=a.plaintextHash,f=a.plaintext,g=a.mediaKey,o=a.mediaKeyTimestamp,p=a.uploadToken,a._size,q=a.uploadRetrier,r=a.updateMediaEntry,s=a.mediaUploadQplFlow,t=a.filename,u=a.fromOffset,v=u===void 0?0:u;if(!(c.type==="preview")){S.next=11;break}S.next=4;return b("regeneratorRuntime").awrap(d("WAMediaCrypto").computeMediaKeysForPreview(g));case 4:A=S.sent;w=A.iv;x=A.cipherKey;y=A.hmacKey;z="preview";S.next=18;break;case 11:S.next=13;return b("regeneratorRuntime").awrap(d("WAMediaCrypto").computeMediaKeys(g,c.mediaType));case 13:B=S.sent,w=B.iv,x=B.cipherKey,y=B.hmacKey,z=c.mediaType;case 18:S.next=20;return b("regeneratorRuntime").awrap(d("WAMediaCrypto").encryptAndHmac(x,w,y,f,z));case 20:C=S.sent;D=C.ciphertext;E=C.ciphertextHash;F=C.sidecar;G=C.ivCiphertext;H=null;if(!(z==="image"&&d("WAGlobals").getConfig().isProgressiveJpegSendReceiveEnabled())){S.next=41;break}S.t0=b("regeneratorRuntime");S.t1=d("WAProgressiveJpegGetPJpegDetails").getProgressiveJpegDetails;S.t2=Uint8Array;S.next=32;return b("regeneratorRuntime").awrap(d("WAMediaUtils").blobToArrayBuffer(f));case 32:S.t3=S.sent;S.t4=new S.t2(S.t3);S.t5=G;S.t6=y;S.t7=S.t1(S.t4,S.t5,S.t6);S.next=39;return S.t0.awrap.call(S.t0,S.t7);case 39:I=S.sent,d("WAProgressiveJpegGetPJpegDetails").isValidProgressiveJpegDetails(I)&&(d("WALogger").LOG(n()),H=I);case 41:J={fileSha256:d("WABase64").decodeB64UrlSafe(e),fileEncSha256:E,mediaKey:g,mediaKeyTimestamp:o,serverMediaType:z,uploadToken:p,sidecar:F,filename:t,progressiveJpegDetails:H};S.next=44;return b("regeneratorRuntime").awrap(r(J));case 44:S.next=46;return b("regeneratorRuntime").awrap(q.run(function(a,c,e){var f,g,h,i,n,o;return b("regeneratorRuntime").async(function(q){while(1)switch(q.prev=q.next){case 0:f=a.domain;g=v;if(!(e>0)){q.next=19;break}q.prev=3;h=d("WAMediaUrl").buildUploadUrl(z,p,E,f,c,!0);q.next=7;return b("regeneratorRuntime").awrap(d("WAHttpResumeCheck").httpResumeCheck(h));case 7:i=q.sent;if(!i.success){q.next=14;break}n=i.value;if(!(n.type==="media-found")){q.next=13;break}s==null?void 0:s.addAnnotations({bool:{existingMediaFound:!0}});return q.abrupt("return",d("WAResultOrError").makeResult(d("WAResultOrError").makeResult({directPath:n.directPath,objectId:null,handle:null})));case 13:n.type==="media-partial-found"&&(g=n.resumeFromBytes);case 14:q.next=19;break;case 16:q.prev=16,q.t0=q["catch"](3),d("WALogger").ERROR(m(),q.t0);case 19:g>0&&g<D.byteLength?(s==null?void 0:s.addAnnotations({"int":{fromOffset:g},bool:{continuedFromOffset:!0}}),K=D.subarray(g)):K=D;o=d("WAMediaUrl").buildUploadUrl(z,p,E,f,c,!1,g);d("WALogger").LOG(l(),o);return q.abrupt("return",d("WAHttpRegularUploadMedia").httpRegularUploadMedia(o,K).then(function(a){if(a.success){s==null?void 0:s.addPoint("upload_finish",{"int":{byteLength:K.byteLength,attempt:e}});return d("WAResultOrError").makeResult(a)}else{a=a.error;d("WALogger").LOG(k(),a);switch(a){case"server-timeout":case"unspecified-http-error":return d("WAResultOrError").makeError({progressMade:!0});default:return d("WAResultOrError").makeResult(d("WAResultOrError").makeError(a))}}})["catch"](function(a){d("WALogger").ERROR(j(),a);return d("WAResultOrError").makeError({progressMade:!1})}));case 23:case"end":return q.stop()}},null,this,[[3,16]])}));case 46:L=S.sent;if(!(L==null)){S.next=51;break}d("WALogger").WARN(i());s==null?void 0:s.endFail("maxAttemptsExceeded");return S.abrupt("return",d("WAResultOrError").makeError("max-attempts-exceeded"));case 51:if(!(L.success===!1)){S.next=54;break}s==null?void 0:s.endFail(L.error);return S.abrupt("return",L);case 54:M=L.value,N=M.directPath,O=M.objectId,P=M.handle;S.next=57;return b("regeneratorRuntime").awrap(d("WAGlobals").getDbImpls().getDownloadableThumbnailForMedia(e));case 57:Q=S.sent;if(!(O==null?void 0:O.length)){S.next=63;break}S.next=61;return b("regeneratorRuntime").awrap(r(babelHelpers["extends"]({},J,{directPath:N,downloadableThumbnail:Q,handle:P,objectId:O})));case 61:S.next=65;break;case 63:S.next=65;return b("regeneratorRuntime").awrap(r(babelHelpers["extends"]({},J,{directPath:N,downloadableThumbnail:Q,handle:P})));case 65:d("WALogger").LOG(h(),{directPath:N},{objectId:O});s==null?void 0:s.endSuccess();R={objectId:O};return S.abrupt("return",d("WAResultOrError").makeResult(R));case 69:case"end":return S.stop()}},null,this)}g.encryptAndUploadPlaintext=a}),98);
__d("WAMakeSignedPreKeyMixin",["WAWap"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b={idElementValue:d("WAWap").BIG_ENDIAN_CONTENT(a.id,3)},c={anyElementValue:a.keyPair.publicKey};a=a.signature;return{keyIDMixinArgs:b,keyDataMixinArgs:c,signatureElementValue:a}}g.makeSignedPreKeyMixin=a}),98);
__d("WASmaxInPreKeysSetVnameFailureBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","bad-request");return!b.success?b:d("WAResultOrError").makeResult({text:b.value})}g.parseSetVnameFailureBadRequestMixin=a}),98);
__d("WASmaxInPreKeysSetVnameFailureFallbackMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"text");return!b.success?b:d("WAResultOrError").makeResult({text:b.value})}g.parseSetVnameFailureFallbackMixin=a}),98);
__d("WASmaxInPreKeysSetVnameFailureInternalServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","internal-server-error");return!b.success?b:d("WAResultOrError").makeResult({text:b.value})}g.parseSetVnameFailureInternalServerErrorMixin=a}),98);
__d("WASmaxInPreKeysSetVnameFailureNotAcceptableMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"violation");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","not-acceptable");if(!a.success)return a;var c=d("WASmaxParseUtils").attrString(b.value,"reason");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrInt,b.value,"max");if(!e.success)return e;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrInt,b.value,"length");return!b.success?b:d("WAResultOrError").makeResult({text:a.value,violationReason:c.value,violationMax:e.value,violationLength:b.value})}g.parseSetVnameFailureNotAcceptableMixin=a}),98);
__d("WASmaxInPreKeysVnameFailures",["WAResultOrError","WASmaxInPreKeysSetVnameFailureBadRequestMixin","WASmaxInPreKeysSetVnameFailureFallbackMixin","WASmaxInPreKeysSetVnameFailureInternalServerErrorMixin","WASmaxInPreKeysSetVnameFailureNotAcceptableMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPreKeysSetVnameFailureNotAcceptableMixin").parseSetVnameFailureNotAcceptableMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"SetVnameFailureNotAcceptable",value:b.value});var c=d("WASmaxInPreKeysSetVnameFailureBadRequestMixin").parseSetVnameFailureBadRequestMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"SetVnameFailureBadRequest",value:c.value});var e=d("WASmaxInPreKeysSetVnameFailureInternalServerErrorMixin").parseSetVnameFailureInternalServerErrorMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"SetVnameFailureInternalServerError",value:e.value});var f=d("WASmaxInPreKeysSetVnameFailureFallbackMixin").parseSetVnameFailureFallbackMixin(a);return f.success?d("WAResultOrError").makeResult({name:"SetVnameFailureFallback",value:f.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["VnameFailureNotAcceptable","VnameFailureBadRequest","VnameFailureInternalServerError","VnameFailureFallback"],[b,c,e,f])}g.parseVnameFailures=a}),98);
__d("WASmaxInPreKeysSetResponsePreKeySuccessVnameFailure",["WAResultOrError","WASmaxInPreKeysIQErrorResponseMixin","WASmaxInPreKeysVnameFailures","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;var e=d("WASmaxParseUtils").flattenedChildWithTag(c.value,"error");if(!e.success)return e;var f=d("WASmaxParseUtils").attrString(c.value,"text");if(!f.success)return f;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,c.value,"code",207);if(!c.success)return c;var g=d("WASmaxParseUtils").attrIntRange(e.value,"code",400,599);if(!g.success)return g;a=d("WASmaxInPreKeysIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInPreKeysVnameFailures").parseVnameFailures(e.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({errorText:f.value,errorCode:c.value,errorErrorCode:g.value},a.value,{errorErrorVnameFailures:b.value}))}g.parseSetResponsePreKeySuccessVnameFailure=a}),98);
__d("WASmaxInPreKeysRequestErrors",["WAResultOrError","WASmaxInPreKeysIQErrorFallbackClientMixin","WASmaxInPreKeysIQErrorNotAcceptableMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPreKeysIQErrorNotAcceptableMixin").parseIQErrorNotAcceptableMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorNotAcceptable",value:b.value});var c=d("WASmaxInPreKeysIQErrorFallbackClientMixin").parseIQErrorFallbackClientMixin(a);return c.success?d("WAResultOrError").makeResult({name:"IQErrorFallbackClient",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorNotAcceptable","IQErrorFallbackClient"],[b,c])}g.parseRequestErrors=a}),98);
__d("WASmaxInPreKeysSetResponseRequestError",["WAResultOrError","WASmaxInPreKeysIQErrorResponseMixin","WASmaxInPreKeysRequestErrors","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInPreKeysIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInPreKeysRequestErrors").parseRequestErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorRequestErrors:b.value}))}g.parseSetResponseRequestError=a}),98);
__d("WASmaxInPreKeysSetResponseServerError",["WAResultOrError","WASmaxInPreKeysIQErrorResponseMixin","WASmaxInPreKeysServerErrors","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInPreKeysIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInPreKeysServerErrors").parseServerErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorServerErrors:b.value}))}g.parseSetResponseServerError=a}),98);
__d("WASmaxInPreKeysSetResponseSuccess",["WASmaxInPreKeysIQResultResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInPreKeysIQResultResponseMixin").parseIQResultResponseMixin(a,b);return!c.success?c:c}g.parseSetResponseSuccess=a}),98);
__d("WASmaxOutPreKeysKeyDataMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.anyElementValue;a=d("WASmaxJsx").smax("smax$any",null,a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeKeyDataMixin=a}),98);
__d("WASmaxOutPreKeysIdentityKeyMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutPreKeysKeyDataMixin"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxOutPreKeysKeyDataMixin").mergeKeyDataMixin(d("WASmaxJsx").smax("identity",null),a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIdentityKeyMixin=a}),98);
__d("WASmaxOutPreKeysKeyTypeMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("type",null,new Uint8Array([5])));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeKeyTypeMixin=a}),98);
__d("WASmaxOutPreKeysKeyIDMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.idElementValue;a=d("WASmaxJsx").smax("id",null,a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeKeyIDMixin=a}),98);
__d("WASmaxOutPreKeysPreKeyListMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutPreKeysKeyDataMixin","WASmaxOutPreKeysKeyIDMixin"],(function(a,b,c,d,e,f,g){function h(a){var b=a.keyIDMixinArgs;a=a.keyDataMixinArgs;b=d("WASmaxJsx").smax("key",null,d("WASmaxOutPreKeysKeyIDMixin").mergeKeyIDMixin(d("WASmaxJsx").smax("id",null),b),d("WASmaxOutPreKeysKeyDataMixin").mergeKeyDataMixin(d("WASmaxJsx").smax("value",null),a));return b}function i(a){a=a.keyArgs;a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("list",null,d("WASmaxChildren").REPEATED_CHILD(h,a,0,2e4)));return a}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makePreKeyListListKey=h;g.mergePreKeyListMixin=a}),98);
__d("WASmaxOutPreKeysRegistrationIDMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.registrationElementValue;a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("registration",null,a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeRegistrationIDMixin=a}),98);
__d("WASmaxOutPreKeysSignedPreKeyMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutPreKeysKeyDataMixin","WASmaxOutPreKeysKeyIDMixin"],(function(a,b,c,d,e,f,g){function h(a){var b,c=a.keyIDMixinArgs,e=a.keyDataMixinArgs;a=a.signatureElementValue;c=(b=d("WASmaxJsx")).smax("smax$any",null,b.smax("skey",null,d("WASmaxOutPreKeysKeyIDMixin").mergeKeyIDMixin(b.smax("id",null),c),d("WASmaxOutPreKeysKeyDataMixin").mergeKeyDataMixin(b.smax("value",null),e),b.smax("signature",null,a)));return c}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeSignedPreKeyMixin=a}),98);
__d("WASmaxOutPreKeysVerifiedNameMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.verifiedNameElementValue;a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("verified_name",null,a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeVerifiedNameMixin=a}),98);
__d("WASmaxOutPreKeysIdentityKeyBundleMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutPreKeysIdentityKeyMixin","WASmaxOutPreKeysKeyTypeMixin","WASmaxOutPreKeysPreKeyListMixin","WASmaxOutPreKeysRegistrationIDMixin","WASmaxOutPreKeysSignedPreKeyMixin","WASmaxOutPreKeysVerifiedNameMixin"],(function(a,b,c,d,e,f,g){function h(a){var b=a.verifiedNameMixinArgs;a=d("WASmaxMixins").optionalMerge(d("WASmaxOutPreKeysVerifiedNameMixin").mergeVerifiedNameMixin,d("WASmaxOutPreKeysKeyTypeMixin").mergeKeyTypeMixin(d("WASmaxOutPreKeysSignedPreKeyMixin").mergeSignedPreKeyMixin(d("WASmaxOutPreKeysPreKeyListMixin").mergePreKeyListMixin(d("WASmaxOutPreKeysIdentityKeyMixin").mergeIdentityKeyMixin(d("WASmaxOutPreKeysRegistrationIDMixin").mergeRegistrationIDMixin(d("WASmaxJsx").smax("smax$any",null),a),a),a),a)),b);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIdentityKeyBundleMixin=a}),98);
__d("WASmaxOutPreKeysSetRequest",["WASmaxJsx","WASmaxOutPreKeysClientRequestMixin","WASmaxOutPreKeysIdentityKeyBundleMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutPreKeysIdentityKeyBundleMixin").mergeIdentityKeyBundleMixin(d("WASmaxOutPreKeysClientRequestMixin").mergeClientRequestMixin(d("WASmaxJsx").smax("iq",{type:"set"})),a);return a}g.makeSetRequest=a}),98);
__d("WASmaxPreKeysSetRPC",["WAComms","WASmaxInPreKeysSetResponsePreKeySuccessVnameFailure","WASmaxInPreKeysSetResponseRequestError","WASmaxInPreKeysSetResponseServerError","WASmaxInPreKeysSetResponseSuccess","WASmaxOutPreKeysSetRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:e=d("WASmaxOutPreKeysSetRequest").makeSetRequest(a);k.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(e,c));case 3:f=k.sent;g=d("WASmaxInPreKeysSetResponseSuccess").parseSetResponseSuccess(f,e);if(!g.success){k.next=7;break}return k.abrupt("return",{name:"SetResponseSuccess",value:g.value});case 7:h=d("WASmaxInPreKeysSetResponsePreKeySuccessVnameFailure").parseSetResponsePreKeySuccessVnameFailure(f,e);if(!h.success){k.next=10;break}return k.abrupt("return",{name:"SetResponsePreKeySuccessVnameFailure",value:h.value});case 10:i=d("WASmaxInPreKeysSetResponseRequestError").parseSetResponseRequestError(f,e);if(!i.success){k.next=13;break}return k.abrupt("return",{name:"SetResponseRequestError",value:i.value});case 13:j=d("WASmaxInPreKeysSetResponseServerError").parseSetResponseServerError(f,e);if(!j.success){k.next=16;break}return k.abrupt("return",{name:"SetResponseServerError",value:j.value});case 16:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Set",{Success:g,PreKeySuccessVnameFailure:h,RequestError:i,ServerError:j}));case 17:case"end":return k.stop()}},null,this)}g.sendSetRPC=a}),98);
__d("WAGenerateAndUploadPreKeysProtocol",["WACryptoManager","WAGetKeysForUpload","WAGlobals","WAMakeSignedPreKeyMixin","WAPromiseRetryLoop","WAResultOrError","WARetryUtils","WASmaxPreKeysSetRPC","WATagsLogger","WAWap","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Got unexpected error: ",", will retry after backoff"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Got Malformed upload keys IQ on upload pre keys attempt"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Keys are successfully uploaded"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Attempt to upload keys"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to generate prekeys with error "," details: ","}"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["About to upload pre keys"]);m=function(){return a};return a}var n=d("WATagsLogger").TAGS(["generateAndUploadPreKeysProtocol"]);function a(){var a,c,e,f,g,p,q,r,s;return b("regeneratorRuntime").async(function(t){while(1)switch(t.prev=t.next){case 0:t.next=2;return b("regeneratorRuntime").awrap(d("WAGlobals").getWaOneQueue().enqueue(function(a){var c,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:c=a.cryptoManager;f.next=3;return b("regeneratorRuntime").awrap(d("WACryptoManager").generatePreKeys(c));case 3:e=f.sent;if(e.success){f.next=6;break}return f.abrupt("return",e);case 6:n.LOG(m()).devConsole("generation "+e.value);return f.abrupt("return",d("WAGetKeysForUpload").getKeysForUpload(c,e.value));case 8:case"end":return f.stop()}},null,this)},{operationType:"generate_prekeys",flush:!0,afterInit:!0}));case 2:a=t.sent;if(!(a.success===!1)){t.next=6;break}n.ERROR(l(),a.error,(c=(e=a.payload)==null?void 0:e.toString())!=null?c:"none");return t.abrupt("return",d("WAResultOrError").makeError("generate-prekey-error",a.payload));case 6:f=a.value,g=f.regInfo,p=f.preKeys,q=f.signedPreKey;r=babelHelpers["extends"]({registrationElementValue:d("WAWap").BIG_ENDIAN_CONTENT(g.regId),anyElementValue:g.staticKeyPair.publicKey,keyArgs:p.map(o)},d("WAMakeSignedPreKeyMixin").makeSignedPreKeyMixin(q));s=new(d("WAPromiseRetryLoop").PromiseRetryLoop)({name:"uploadKeys",timer:d("WARetryUtils").FIBONACCI_BACKOFF,code:function(a){var c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:n.LOG(k());e.next=3;return b("regeneratorRuntime").awrap(d("WASmaxPreKeysSetRPC").sendSetRPC(r));case 3:c=e.sent;e.t0=c.name;e.next=e.t0==="SetResponseSuccess"?7:e.t0==="SetResponseRequestError"?10:13;break;case 7:n.LOG(j());a(d("WAResultOrError").makeResult({preKeys:p}));return e.abrupt("return");case 10:n.WARN(i());a(d("WAResultOrError").makeError("request-error"));return e.abrupt("return");case 13:c.name,n.WARN(h(),c.name);case 15:case"end":return e.stop()}},null,this)}});s.start();return t.abrupt("return",s.promise());case 11:case"end":return t.stop()}},null,this)}function o(a){var b={idElementValue:d("WAWap").BIG_ENDIAN_CONTENT(a.id,3)};a={anyElementValue:a.keyPair.publicKey};return{keyIDMixinArgs:b,keyDataMixinArgs:a}}g.generateAndUploadPreKeysProtocol=a}),98);
__d("WADecryptPkmsgOrMsg",["WACryptoManagerUtils","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.from,c=a.ciphertext,e=a.encType,f=a.cb,g=a.ctx;return g.cryptoManager.storage.memoryLock(function(){return d("WACryptoManagerUtils").decryptMsg(e,b,c,g).then(function(a){if(a.success===!1)return f(a);return a.value!=null?f(d("WAResultOrError").makeResult({plaintext:a.value.plaintext,remoteIdentity:a.value.remoteIdentity})):f(d("WAResultOrError").makeError("missing-content"))})})}g.decryptPkmsgOrMsg=a}),98);
__d("WADecryptionChatQueue",["WAPromiseQueue"],(function(a,b,c,d,e,f,g){"use strict";a=new(d("WAPromiseQueue").PromiseQueueMap)();g.decryptionChatQueue=a}),98);
__d("WASendAggregatedDeliveryReceiptProtocol",["WAComms","WAGlobals","WAJids","WASmaxOutReceiptPublishDeliveryRequest","WASmaxOutReceiptPublishSenderRequest"],(function(a,b,c,d,e,f,g){function a(a){a=h(a);d("WAComms").castSmaxStanza(a)}function h(a){var b=a.from,c=a.chat,e=a.stanzaIdList;return d("WAJids").switchOnMsgrChatJidType(c,{group:function(a){var c=d("WAJids").extractUserJid(b);if(c===d("WAGlobals").getMyUserJid())return k({stanzaIdList:e,from:b,chat:a});else return l({from:b,stanzaIdList:e,chat:a})},user:function(a){a=d("WAJids").extractUserJid(b);if(a===d("WAGlobals").getMyUserJid())return j({from:b,stanzaIdList:e});else return i({stanzaIdList:e,from:b})}})}function i(a){var b=a.from;a=a.stanzaIdList;b={device:{deviceMixinsArgs:{individualDevice:{receiptTo:b}}}};a={senderAggregatedPublish:{itemArgs:a.slice(1).map(function(a){return{itemId:a}}),receiptId:a[0]}};a={senderAggregatedPublishOrSingleMixinGroupArgs:a,userOrDeviceOrInteropUserOrInteropDeviceMixinGroupArgs:b};return d("WASmaxOutReceiptPublishDeliveryRequest").makePublishDeliveryRequest(a)}function j(a){var b=a.from;a=a.stanzaIdList;b={publishSenderIndividualDeviceSenderType:{recipientOrPeerReceiptDeprecatedMixinGroupArgs:{recipient:{receiptRecipient:d("WAJids").extractUserJid(b)}},individualDeviceIndividualDeviceDeprecatedOrIndividualDeviceMixinGroupArgs:{individualDevice:{receiptTo:b}}}};a={senderAggregatedPublish:{itemArgs:a.slice(1).map(function(a){return{itemId:a}}),receiptId:a[0]}};a={senderAggregatedPublishOrSingleMixinGroupArgs:a,publishSenderGroupOrPublishSenderIndividualOrPublishSenderStatusOrPublishSenderBroadcastDeviceSenderTypeMixinGroupArgs:b};return d("WASmaxOutReceiptPublishSenderRequest").makePublishSenderRequest(a)}function k(a){var b=a.stanzaIdList,c=a.chat;a=a.from;c={publishSenderGroupDeviceSenderType:{groupDeviceGroupDeviceOrGroupDeviceDeprecatedMixinGroupArgs:{groupDevice:{receiptTo:c,receiptParticipant:a}}}};a={senderAggregatedPublish:{itemArgs:b.slice(1).map(function(a){return{itemId:a}}),receiptId:b[0]}};b={publishSenderGroupOrPublishSenderIndividualOrPublishSenderStatusOrPublishSenderBroadcastDeviceSenderTypeMixinGroupArgs:c,senderAggregatedPublishOrSingleMixinGroupArgs:a};return d("WASmaxOutReceiptPublishSenderRequest").makePublishSenderRequest(b)}function l(a){var b=a.stanzaIdList,c=a.chat;a=a.from;c={device:{deviceMixinsArgs:{groupDevice:{receiptTo:c,receiptParticipant:a}}}};a={senderAggregatedPublish:{itemArgs:b.slice(1).map(function(a){return{itemId:a}}),receiptId:b[0]}};b={senderAggregatedPublishOrSingleMixinGroupArgs:a,userOrDeviceOrInteropUserOrInteropDeviceMixinGroupArgs:c};return d("WASmaxOutReceiptPublishDeliveryRequest").makePublishDeliveryRequest(b)}g.sendAggregatedDeliveryReceipts=a;g.makeAggregatedDeliveryReceipts=h}),98);
__d("WASmaxInReceiptEnums",["WAJids"],(function(a,b,c,d,e,f,g){a={0:"0",1:"1",7:"7"};b={1002:"1002",1007:"1007",1008:"1008"};c={all:"all",none:"none"};e={"body-link":"body-link","cta-call":"cta-call","cta-url":"cta-url","media-doc":"media-doc","media-image":"media-image","media-video":"media-video","quick-reply":"quick-reply"};f={"cancellation-failed":"cancellation-failed","invalid-transition":"invalid-transition"};var h={CBP:"CBP",NBP:"NBP"},i={content:"content",title:"title"},j={delivery:"delivery",no_optimization:"no_optimization"},k={deliver:"deliver",delivery:"delivery"},l={"false":"false","true":"true"},m={"hsm-envelope-mismatch":"hsm-envelope-mismatch","structure-unavailable":"structure-unavailable"},n={validators:[(d=d("WAJids")).validateBroadcastJid,d.validateGroupJid],typeName:"BroadcastJid|GroupJid"},o={validators:[d.validateBroadcastJid,d.validateGroupJid,d.validateNewsletterJid,d.validateStatusJid],typeName:"BroadcastJid|GroupJid|NewsletterJid|StatusJid"},p={validators:[d.validateDeviceJid,d.validateBroadcastJid,d.validateDeviceJid,d.validateGroupJid],typeName:"DeviceJid|BroadcastJid|DeviceJid|GroupJid"},q={validators:[d.validateDeviceJid,d.validateBroadcastJid,d.validateDeviceJid,d.validateGroupJid,d.validateNewsletterJid,d.validateStatusJid],typeName:"DeviceJid|BroadcastJid|DeviceJid|GroupJid|NewsletterJid|StatusJid"},r={validators:[d.validateDeviceJid,d.validateDeviceJid],typeName:"DeviceJid|DeviceJid"};d={validators:[d.validateDeviceJid,d.validateUserJid,d.validateDeviceJid],typeName:"DeviceJid|UserJid|DeviceJid"};g.ENUM_0_1_7=a;g.ENUM_1002_1007_1008=b;g.ENUM_ALL_NONE=c;g.ENUM_BODYLINK_CTACALL_CTAURL_MEDIADOC_MEDIAIMAGE_MEDIAVIDEO_QUICKREPLY=e;g.ENUM_CANCELLATIONFAILED_INVALIDTRANSITION=f;g.ENUM_CBP_NBP=h;g.ENUM_CONTENT_TITLE=i;g.ENUM_DELIVERY_NOOPTIMIZATION=j;g.ENUM_DELIVER_DELIVERY=k;g.ENUM_FALSE_TRUE=l;g.ENUM_HSMENVELOPEMISMATCH_STRUCTUREUNAVAILABLE=m;g.BROADCASTJID_GROUPJID=n;g.BROADCASTJID_GROUPJID_NEWSLETTERJID_STATUSJID=o;g.DEVICEJID_BROADCASTJID_DEVICEJID_GROUPJID=p;g.DEVICEJID_BROADCASTJID_DEVICEJID_GROUPJID_NEWSLETTERJID_STATUSJID=q;g.DEVICEJID_DEVICEJID=r;g.DEVICEJID_USERJID_DEVICEJID=d}),98);
__d("WASmaxInReceiptDeprecatedEditMixin",["WAResultOrError","WASmaxInReceiptEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrStringEnum(a,"edit",d("WASmaxInReceiptEnums").ENUM_0_1_7);return!a.success?a:d("WAResultOrError").makeResult({edit:a.value})}g.parseDeprecatedEditMixin=a}),98);
__d("WASmaxInReceiptPublishSuccessMixin",["WAResultOrError","WASmaxInReceiptDeprecatedEditMixin","WASmaxInReceiptEnums","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"ack");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"class","receipt");if(!c.success)return c;var e=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!e.success)return e;e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",e.value);if(!e.success)return e;e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"t",0,void 0);if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"readreceipts",d("WASmaxInReceiptEnums").ENUM_ALL_NONE);if(!f.success)return f;b=d("WASmaxParseReference").attrStringFromReference(b,["type"]);if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type",b.value);if(!b.success)return b;b=d("WASmaxInReceiptDeprecatedEditMixin").parseDeprecatedEditMixin(a);return d("WAResultOrError").makeResult({"class":c.value,t:e.value,readreceipts:f.value,deprecatedEditMixin:b.success?b.value:null})}g.parsePublishSuccessMixin=a}),98);
__d("WASmaxInReceiptPublishRetryResponseSuccess",["WAResultOrError","WASmaxInReceiptPublishSuccessMixin","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"ack");if(!c.success)return c;c=d("WASmaxParseReference").optionalAttrStringFromReference(b,["participant"]);if(!c.success)return c;c=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,a,"participant",c.value);if(!c.success)return c;var e=d("WASmaxParseReference").optionalAttrStringFromReference(b,["recipient"]);if(!e.success)return e;e=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,a,"recipient",e.value);if(!e.success)return e;a=d("WASmaxInReceiptPublishSuccessMixin").parsePublishSuccessMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({hasParticipant:c.value!=null,hasRecipient:e.value!=null},a.value))}g.parsePublishRetryResponseSuccess=a}),98);
__d("WACastStanzas",["Promise","WAArrayUtils","WAComms","WADanglingQueue","WALogger","WASendAggregatedDeliveryReceiptProtocol","WASmaxInReceiptPublishRetryResponseSuccess","WAStanzaUtils","WAWap","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Passive: cast stanzas ",", ",""]);j=function(){return a};return a}function a(a){a.forEach(function(a){a!=="NO_ACK"&&a!=="CLOSE_SOCKET"&&d("WAComms").castSmaxStanza(a)})}function k(a,b,c){var e;((e=d("WAComms").getComms())==null?void 0:e.socketId)===b?d("WAComms").castSmaxStanza(a):c==null?void 0:c.addAnnotations({string:{omitCastStanza:"socketId"}})}function l(a,c,e){var f;if(((f=d("WAComms").getComms())==null?void 0:f.socketId)===c)return d("WAComms").sendSmaxStanza(a);else e==null?void 0:e.addAnnotations({string:{omitCastStanza:"socketId"}});return(h||(h=b("Promise"))).resolve()}function c(a,c){d("WALogger").LOG(j(),a.length,c);var e=[],f=[],g=[];a.forEach(function(a){var b=a.response,c=a.socketId;a=a.eventFlow;if(b==="NO_ACK"||b==="CLOSE_SOCKET")return;b;if(b.tag==="ack"){e.push({node:b,socketId:c,eventFlow:a});return}if(b.tag==="receipt"){if(b.attrs.type==="retry"){f.push({node:b,socketId:c,eventFlow:a});return}if(b.attrs.type==="delivery"||b.attrs.type==="sender"||b.attrs.type==null){g.push({node:b,socketId:c,eventFlow:a});return}}e.push({node:b,socketId:c,eventFlow:a})});e.forEach(function(a){var b=a.node,e=a.socketId;a=a.eventFlow;c.store&&d("WADanglingQueue").danglingQueueWrite({node:d("WAWap").encodeStanza(b)});c.send&&(k(b,e,a),a==null?void 0:a.endSuccess())});return(h||(h=b("Promise"))).allSettled([r(f,c),q(g,c)]).then(function(a){a=a.filter(function(a){return a.status==="rejected"}).map(function(a){return(a=a.reason)==null?void 0:a.toString()});if(a.length>0)return(h||(h=b("Promise"))).reject("Delivery or Retry receipt error: "+a.join(" | "))}).then(function(){})["finally"](function(){if(c.store)return d("WADanglingQueue").danglingQueueFlush()})}function m(a){return a.map(function(a){var b=a.node,c=a.socketId;a=a.eventFlow;return{stanzaId:d("WAStanzaUtils").toStanzaId(""+b.attrs.id),to:""+b.attrs.to,participant:b.attrs.participant?""+b.attrs.participant:""+b.attrs.to,socketId:c,eventFlow:a}})}function n(a){var b=new Map();a.forEach(function(a){var c=b.get(a.socketId);c||(c=new Map(),b.set(a.socketId,c));var d=c.get(a.to);d||(d=new Map(),c.set(a.to,d));c=d.get(a.participant);c||(c=[],d.set(a.participant,c));c.push([a.stanzaId,a.eventFlow])});return b}var o=255;function p(a,b){a=n(m(a));a.forEach(function(a,c){a.forEach(function(a,e){a.forEach(function(a,f){var g=function(){if(i){if(j>=h.length)return"break";l=h[j++]}else{j=h.next();if(j.done)return"break";l=j.value}var a=l,g=[],m=[];a.forEach(function(a){var b=a[0];a=a[1];g.push(b);m.push(a)});a=d("WASendAggregatedDeliveryReceiptProtocol").makeAggregatedDeliveryReceipts({from:f,chat:e,stanzaIdList:g});b.store&&d("WADanglingQueue").danglingQueueWrite({node:d("WAWap").encodeStanza(a)});b.send&&(k(a,c),m.forEach(function(a){var b;((b=d("WAComms").getComms())==null?void 0:b.socketId)!==c&&(a==null?void 0:a.addAnnotations({string:{omitCastStanza:"socketId"}}));a==null?void 0:a.endSuccess()}))};for(var h=d("WAArrayUtils").peekEvery(a,o),i=Array.isArray(h),j=0,h=i?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var l;a=g();if(a==="break")break}})})})}function q(a,b){if(a.length===0)return;if(a.length>1)return p(a,b);b.store&&d("WADanglingQueue").danglingQueueWrite({node:d("WAWap").encodeStanza(a[0].node)});b.send&&a.forEach(function(a){var b=a.node,c=a.socketId;a=a.eventFlow;k(b,c,a);a==null?void 0:a.endSuccess()})}function r(a,c){c.store&&a.forEach(function(a){a=a.node;d("WADanglingQueue").danglingQueueWrite({node:d("WAWap").encodeStanza(a)})});return c.send?(h||(h=b("Promise"))).allSettled(a.map(function(a){var c,e,f,g,h,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:c=a.node,e=a.socketId,f=a.eventFlow;k.next=3;return b("regeneratorRuntime").awrap(l(c,e));case 3:g=k.sent;if(!(g==null)){k.next=7;break}f==null?void 0:f.endSuccess();return k.abrupt("return");case 7:h=d("WASmaxInReceiptPublishRetryResponseSuccess").parsePublishRetryResponseSuccess(g,c);if(!h.success){k.next=11;break}f==null?void 0:f.endSuccess();return k.abrupt("return");case 11:j="Retry response doesn't match the original stanza",f==null?void 0:f.endFail(j),d("WALogger").ERROR(i(),j);case 14:case"end":return k.stop()}},null,this)})).then(function(a){if(a.some(function(a){a=a.status;return a==="rejected"}))return(h||(h=b("Promise"))).reject("Some retry receipts were not sent")}):(h||(h=b("Promise"))).resolve()}function e(){var a;return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(d("WADanglingQueue").danglingQueueRead());case 2:a=c.sent;c.next=5;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).allSettled(a.map(function(a){var c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(d("WAWap").decodeStanza(a.node,function(a){return(h||(h=b("Promise"))).resolve(a)}));case 2:c=e.sent;return e.abrupt("return",d("WAComms").castSmaxStanza(c));case 4:case"end":return e.stop()}},null,this)})).then(function(){}));case 5:c.next=7;return b("regeneratorRuntime").awrap(d("WADanglingQueue").danglingQueueClear());case 7:case"end":return c.stop()}},null,this)}g.castStanzas=a;g.castStanzasByCategories=c;g.castDanglingStanzas=e}),98);
__d("WAHandleServerPing",["Promise"],(function(a,b,c,d,e,f){"use strict";var g;a=function(a){a=a.makeResponse;return(g||(g=b("Promise"))).resolve(a())};f.handleServerPing=a}),66);
__d("WAHandleStreamError",["Promise","WABridge","WAHandleFailureUtils","WALogger","WAOdsEnums"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Stream error of type "," is causing a closed socket"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Code "," stream:error is received"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Conflict stream:error is received"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["bad-mac stream:error is received"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["xml-not-well-formed stream:error is received"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unacked ping id: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Client didn't send 'ack' back (type: ",", class: ","), closing socket. Unacked id: ",""]);o=function(){return a};return a}a=function(a){var b=a.ackClass,c=a.ackId;a=a.ackType;var e="ack";d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.STREAM_ERROR,key:e+"."+a+"."+b});d("WALogger").WARN(o(),a,b,c);return r(e)};c=function(a){a=a.pingId;var b="ping";d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.STREAM_ERROR,key:""+b});d("WALogger").WARN(n(),a);return r(b)};e=function(){var a="xml-not-well-formed";d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.STREAM_ERROR,key:""+a});d("WALogger").WARN(m());return r(a)};f=function(){var a="bad-mac";d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.STREAM_ERROR,key:""+a});d("WALogger").WARN(l());return r(a)};var p=function(a){var b,c=a.code;a=a.conflictReason;var e="conflict";d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.STREAM_ERROR,key:e+"."+((b=c)!=null?b:"undefined")+"."+((b=a)!=null?b:"undefined")});if(c===d("WAHandleFailureUtils").FAILURE_CODES.NOT_AUTHORIZED)return s();d("WALogger").WARN(k());return r(e)},q=function(a){a=a.code;var b="other";d("WALogger").WARN(j(),a);d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.STREAM_ERROR,key:b+"."+a});return a===d("WAHandleFailureUtils").FAILURE_CODES.NOT_AUTHORIZED?s():r(b)};function r(a){d("WALogger").WARN(i(),a);return(h||(h=b("Promise"))).resolve("CLOSE_SOCKET")}function s(){return(h||(h=b("Promise"))).resolve("NO_ACK")}g.handleAckKick=a;g.handlePingKick=c;g.handleXmlNotWellFormed=e;g.handleBadMac=f;g.handleConflict=p;g.handleStreamErrorCode=q}),98);
__d("WASyncdSyncAllCollections",["WABaseGlobals","WAJobs","WALogger","WASyncd","WASyncdConst"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: periodic sync for all collection"]);h=function(){return a};return a}a=d("WAJobs").getPersistedJobsApi().definePersistedJob().finalStep("syncAllCollections",function(){d("WALogger").LOG(h());return i()}).end();function i(){d("WABaseGlobals").getDbImpls().writeSyncdLog("","start periodic sync")["catch"](function(){});var a=Array.from(d("WASyncdConst").CollectionName.members());return d("WASyncd").markCollectionsForSync(a)}g.syncdSyncAllCollections=a;g.syncdSyncAllCollectionsFn=i}),98);
__d("WAHandleSyncdDirtyBit",["WASyncdDisabled","WASyncdSyncAllCollections","regeneratorRuntime"],(function(a,b,c,d,e,f,g){c={groups:"groups",account_sync:"account_sync",syncd_app_state:"syncd_app_state"};function a(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:if(d("WASyncdDisabled").isSyncdDisabled()){c.next=3;break}c.next=3;return b("regeneratorRuntime").awrap(d("WASyncdSyncAllCollections").syncdSyncAllCollectionsFn());case 3:return c.abrupt("return",a.cleanDirtyBits().then(function(){return"NO_ACK"}));case 4:case"end":return c.stop()}},null,this)}g.DIRTY_BIT_TYPES=c;g.handleSyncdDirtyBit=a}),98);
__d("WASmaxOutReceiptAppDataPeerCategoryMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("receipt",{category:"peer_appdata"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeAppDataPeerCategoryMixin=a}),98);
__d("WASmaxOutReceiptPublishAppDataPeerDeliveryRequest",["WASmaxJsx","WASmaxOutReceiptAppDataPeerCategoryMixin","WASmaxOutReceiptIndividualDeviceMixin","WASmaxOutReceiptSingleMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutReceiptAppDataPeerCategoryMixin").mergeAppDataPeerCategoryMixin(d("WASmaxOutReceiptSingleMixin").mergeSingleMixin(d("WASmaxOutReceiptIndividualDeviceMixin").mergeIndividualDeviceMixin(d("WASmaxJsx").smax("receipt",null),a),a));return a}g.makePublishAppDataPeerDeliveryRequest=a}),98);
__d("WASmaxReceiptPublishAppDataPeerDeliveryRPC",["WAComms","WASmaxOutReceiptPublishAppDataPeerDeliveryRequest","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){var c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:c=d("WASmaxOutReceiptPublishAppDataPeerDeliveryRequest").makePublishAppDataPeerDeliveryRequest(a);e.next=3;return b("regeneratorRuntime").awrap(d("WAComms").castSmaxStanza(c));case 3:case"end":return e.stop()}},null,this)}g.sendPublishAppDataPeerDeliveryRPC=a}),98);
__d("WASendAppdataDeliveryReceiptProtocol",["WASmaxReceiptPublishAppDataPeerDeliveryRPC"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){var b=a.stanzaId;a=a.from;return d("WASmaxReceiptPublishAppDataPeerDeliveryRPC").sendPublishAppDataPeerDeliveryRPC({receiptTo:a,receiptId:b})};g.sendAppdataDeliveryReceiptProtocol=a}),98);
__d("WASendAppdataRetryReceiptProtocol",["WAReceiptUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(a,b){var c=a.stanzaId,e=a.from,f=a.serverTs;a=a.retryCount;return d("WAReceiptUtils").sendRetryReceipt({category:"peer_appdata",deviceIdentity:null,externalId:c,from:{deviceJid:e,type:"device"},participant:null,recipient:null,retryCount:a,ts:f},b)};g.sendAppdataRetryReceiptProtocol=a}),98);
__d("WASmaxInAppdataDeliverDeviceIdentityMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"device-identity");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytes(a.value);return!a.success?a:d("WAResultOrError").makeResult({deviceIdentityElementValue:a.value})}g.parseDeviceIdentityMixin=a}),98);
__d("WASmaxInAppdataDeliverEncRetryMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"count",1,4);return!b.success?b:d("WAResultOrError").makeResult({count:b.value})}g.parseEncRetryMixin=a}),98);
__d("WASmaxInAppdataDeliverEncHideDecryptionPlaceholderMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"decrypt-fail","hide");return!b.success?b:d("WAResultOrError").makeResult({decryptFail:b.value})}g.parseEncHideDecryptionPlaceholderMixin=a}),98);
__d("WASmaxInAppdataDeliverEncPayloadMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").contentBytesRange(a,1,1048576);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}g.parseEncPayloadMixin=a}),98);
__d("WASmaxInAppdataDeliverEnums",["WAJids"],(function(a,b,c,d,e,f,g){a={high:"high",low:"low"};b={msg:"msg",pkmsg:"pkmsg"};c={validators:[d("WAJids").validateDeviceJid,d("WAJids").validateGroupJid],typeName:"DeviceJid|GroupJid"};g.ENUM_HIGH_LOW=a;g.ENUM_MSG_PKMSG=b;g.DEVICEJID_GROUPJID=c}),98);
__d("WASmaxInAppdataDeliverEncTypeIndividualMixin",["WAResultOrError","WASmaxInAppdataDeliverEncHideDecryptionPlaceholderMixin","WASmaxInAppdataDeliverEncPayloadMixin","WASmaxInAppdataDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"type",d("WASmaxInAppdataDeliverEnums").ENUM_MSG_PKMSG);if(!b.success)return b;var c=d("WASmaxInAppdataDeliverEncHideDecryptionPlaceholderMixin").parseEncHideDecryptionPlaceholderMixin(a);a=d("WASmaxInAppdataDeliverEncPayloadMixin").parseEncPayloadMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({type:b.value,encHideDecryptionPlaceholderMixin:c.success?c.value:null},a.value))}g.parseEncTypeIndividualMixin=a}),98);
__d("WASmaxInAppdataDeliverEncVersionFutureproofMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"v",3,void 0);return!b.success?b:d("WAResultOrError").makeResult({v:b.value})}g.parseEncVersionFutureproofMixin=a}),98);
__d("WASmaxInAppdataDeliverOfflineMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrIntRange(a,"offline",0,12);return!a.success?a:d("WAResultOrError").makeResult({offline:a.value})}g.parseOfflineMixin=a}),98);
__d("WASmaxInAppdataDeliverRegistrationIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"registration");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytesRange(a.value,4,4);return!a.success?a:d("WAResultOrError").makeResult({registrationElementValue:a.value})}g.parseRegistrationIDMixin=a}),98);
__d("WASmaxInAppdataDeliverPeerRequest",["WAResultOrError","WASmaxInAppdataDeliverDeviceIdentityMixin","WASmaxInAppdataDeliverEncRetryMixin","WASmaxInAppdataDeliverEncTypeIndividualMixin","WASmaxInAppdataDeliverEncVersionFutureproofMixin","WASmaxInAppdataDeliverEnums","WASmaxInAppdataDeliverOfflineMixin","WASmaxInAppdataDeliverRegistrationIDMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"appdata");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"enc");if(!b.success)return b;var c=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!c.success)return c;var e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"category","peer");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"push_priority",d("WASmaxInAppdataDeliverEnums").ENUM_HIGH_LOW);if(!f.success)return f;var g=d("WASmaxParseJid").attrDeviceJid(a,"from");if(!g.success)return g;var h=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!h.success)return h;var i=d("WASmaxInAppdataDeliverEncVersionFutureproofMixin").parseEncVersionFutureproofMixin(b.value);if(!i.success)return i;var j=d("WASmaxInAppdataDeliverEncRetryMixin").parseEncRetryMixin(b.value);b=d("WASmaxInAppdataDeliverEncTypeIndividualMixin").parseEncTypeIndividualMixin(b.value);if(!b.success)return b;var k=d("WASmaxInAppdataDeliverDeviceIdentityMixin").parseDeviceIdentityMixin(a),l=d("WASmaxInAppdataDeliverRegistrationIDMixin").parseRegistrationIDMixin(a);a=d("WASmaxInAppdataDeliverOfflineMixin").parseOfflineMixin(a);return d("WAResultOrError").makeResult({id:c.value,category:e.value,pushPriority:f.value,from:g.value,t:h.value,encEncVersionFutureproofMixin:i.value,encEncRetryMixin:j.success?j.value:null,encEncTypeIndividualMixin:b.value,deviceIdentityMixin:k.success?k.value:null,registrationIDMixin:l.success?l.value:null,offlineMixin:a.success?a.value:null})}g.parsePeerRequest=a}),98);
__d("WASmaxAppdataDeliverPeerRPC",["WASmaxInAppdataDeliverPeerRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInAppdataDeliverPeerRequest").parsePeerRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Peer",{Request:a}));return{parsedRequest:a.value}}g.receivePeerRPC=a}),98);
__d("WACreateHandleAppdata",["Promise","WAJids","WAResultOrError","WASendAppdataDeliveryReceiptProtocol","WASendAppdataRetryReceiptProtocol","WASmaxAppdataDeliverPeerRPC","WATagsLogger","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to send retry receipt due to ","}"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to send delivery receipt due to ","}"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["start handling..."]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["received appdata, but no handler is provied. Fallback to default ack."]);l=function(){return a};return a}var m=d("WATagsLogger").TAGS(["decision tree","handleAppdata"]);function a(a){return function(c,e,f){e=(e=a.appdataMessage)==null?void 0:e.handleAppdataMessage;if(e==null){m.ERROR(l());return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult("NO_ACK"))}m.DEV(k());c=d("WASmaxAppdataDeliverPeerRPC").receivePeerRPC(c);c=c.parsedRequest;var g=c.id,n=c.from,o=c.t,p=c.offlineMixin,q=c.encEncRetryMixin,r=c.encEncTypeIndividualMixin;c=c.encEncVersionFutureproofMixin;var s=d("WATimeUtils").castToUnixTime(o),t={from:n,author:d("WAJids").extractUserJid(n),retryCount:(o=q==null?void 0:q.count)!=null?o:0,ciphertext:r.elementValue,encVersion:String(c.v),encType:r.type,hideDecryptionFailure:((q=r.encHideDecryptionPlaceholderMixin)==null?void 0:q.decryptFail)==="hide",stanzaId:g};o=function(){return d("WASendAppdataDeliveryReceiptProtocol").sendAppdataDeliveryReceiptProtocol({from:n,stanzaId:g})["catch"](function(a){m.ERROR(j(),a);throw a})};c=function(){return d("WASendAppdataRetryReceiptProtocol").sendAppdataRetryReceiptProtocol({from:n,stanzaId:g,retryCount:t.retryCount,serverTs:s},{cryptoManager:f})["catch"](function(a){m.ERROR(i(),a);throw a})};return e({parsedAppdata:t,offline:p==null?void 0:p.offline,serverTs:s,sendDeliveryReceipt:o,sendRetryReceipt:c},{cryptoManager:f}).then(d("WAResultOrError").makeResult)}}g.createHandleAppdata=a}),98);
__d("WAHandleChatStateProtocol",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b;a.name==="Paused"?b="idle":(a.name,b=a.value.composingMedia==="audio"?"recording_audio":"typing");return b}f.parseChatStatus=a}),66);
__d("WASmaxInChatstateComposingMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"chatstate");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"composing");if(!b.success)return b;a=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,b.value,"media","audio");return!a.success?a:d("WAResultOrError").makeResult({composingMedia:a.value})}g.parseComposingMixin=a}),98);
__d("WASmaxInChatstatePausedMixin",["WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"chatstate");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"paused");return!b.success?b:d("WASmaxParseUtils").voidSuccess}g.parsePausedMixin=a}),98);
__d("WASmaxInChatstateComposingOrPausedMixinGroup",["WAResultOrError","WASmaxInChatstateComposingMixin","WASmaxInChatstatePausedMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInChatstateComposingMixin").parseComposingMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"Composing",value:b.value});var c=d("WASmaxInChatstatePausedMixin").parsePausedMixin(a);return c.success?d("WAResultOrError").makeResult({name:"Paused",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Composing","Paused"],[b,c])}g.parseComposingOrPausedMixinGroup=a}),98);
__d("WASmaxInChatstateFromGroupMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"chatstate");if(!b.success)return b;b=d("WASmaxParseJid").attrGroupJid(a,"from");if(!b.success)return b;var c=d("WASmaxParseJid").attrUserJid(a,"participant");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"participant_pn");return!a.success?a:d("WAResultOrError").makeResult({from:b.value,participant:c.value,participantPn:a.value})}g.parseFromGroupMixin=a}),98);
__d("WASmaxInChatstateFromUserMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"chatstate");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"from");return!b.success?b:d("WAResultOrError").makeResult({from:b.value})}g.parseFromUserMixin=a}),98);
__d("WASmaxInChatstateFromUserOrGroupMixinGroup",["WAResultOrError","WASmaxInChatstateFromGroupMixin","WASmaxInChatstateFromUserMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInChatstateFromUserMixin").parseFromUserMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"FromUser",value:b.value});var c=d("WASmaxInChatstateFromGroupMixin").parseFromGroupMixin(a);return c.success?d("WAResultOrError").makeResult({name:"FromGroup",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["FromUser","FromGroup"],[b,c])}g.parseFromUserOrGroupMixinGroup=a}),98);
__d("WASmaxInChatstateInternalTestMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"test");if(!a.success)return a;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a.value,"config");return!a.success?a:d("WAResultOrError").makeResult({testConfig:a.value})}g.parseInternalTestMixin=a}),98);
__d("WASmaxInChatstateThreadTypeVanishModeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"chatstate");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,b.value,"thread_type","vm");return!a.success?a:d("WAResultOrError").makeResult({metaThreadType:a.value})}g.parseThreadTypeVanishModeMixin=a}),98);
__d("WASmaxInChatstateServerNotificationRequest",["WAResultOrError","WASmaxInChatstateComposingOrPausedMixinGroup","WASmaxInChatstateFromUserOrGroupMixinGroup","WASmaxInChatstateInternalTestMixin","WASmaxInChatstateThreadTypeVanishModeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"chatstate");if(!b.success)return b;b=d("WASmaxInChatstateThreadTypeVanishModeMixin").parseThreadTypeVanishModeMixin(a);var c=d("WASmaxInChatstateInternalTestMixin").parseInternalTestMixin(a),e=d("WASmaxInChatstateFromUserOrGroupMixinGroup").parseFromUserOrGroupMixinGroup(a);if(!e.success)return e;a=d("WASmaxInChatstateComposingOrPausedMixinGroup").parseComposingOrPausedMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({threadTypeVanishModeMixin:b.success?b.value:null,internalTestMixin:c.success?c.value:null,fromUserOrGroupMixinGroup:e.value,composingOrPausedMixinGroup:a.value})}g.parseServerNotificationRequest=a}),98);
__d("WASmaxChatstateServerNotificationRPC",["WASmaxInChatstateServerNotificationRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInChatstateServerNotificationRequest").parseServerNotificationRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("ServerNotification",{Request:a}));return{parsedRequest:a.value}}g.receiveServerNotificationRPC=a}),98);
__d("WACreateHandleChatState",["Promise","WAHandleChatStateProtocol","WAResultOrError","WASmaxChatstateServerNotificationRPC"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||b("Promise")).resolve(d("WAResultOrError").makeResult("NO_ACK"));function a(a){var b,c=(b=a.individualMessage)==null?void 0:b.handleIndividualChatState,e=(b=a.groupMessage)==null?void 0:b.handleGroupChatState;return function(a){if(c==null&&e==null)return i;a=d("WASmaxChatstateServerNotificationRPC").receiveServerNotificationRPC(a);a=a.parsedRequest;var b=a.composingOrPausedMixinGroup;a=a.fromUserOrGroupMixinGroup;b=d("WAHandleChatStateProtocol").parseChatStatus(b);if(a.name==="FromUser"){var f;return(f=c==null?void 0:c({status:b,jid:a.value.from}).then(d("WAResultOrError").makeResult))!=null?f:i}else{a.name;return(f=e==null?void 0:e({status:b,jid:a.value.from,participant:a.value.participant,participantPn:a.value.participantPn}).then(d("WAResultOrError").makeResult))!=null?f:i}}}g.createHandleChatState=a}),98);
__d("WAHandleErrorStanzaProtocol",[],(function(a,b,c,d,e,f){"use strict";a=479;f.SMAX_INVALID_CODE=a}),66);
__d("WASmaxInSmaxInvalidErrorRequest",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"code","479");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","smax-invalid");return!a.success?a:d("WAResultOrError").makeResult({code:b.value,text:a.value})}g.parseErrorRequest=a}),98);
__d("WASmaxSmaxInvalidErrorRPC",["WASmaxInSmaxInvalidErrorRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInSmaxInvalidErrorRequest").parseErrorRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Error",{Request:a}));return{parsedRequest:a.value}}g.receiveErrorRPC=a}),98);
__d("WAUnknownStanzaError",["WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";a=d("WAResultOrError").makeError({type:"unknown-stanza"});g.unknownStanzaError=a}),98);
__d("WACreateHandleErrorStanza",["Promise","WAHandleErrorStanzaProtocol","WALogger","WAResultOrError","WASmaxParseUtils","WASmaxSmaxInvalidErrorRPC","WAUnknownStanzaError"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Receiced error from server: ",""]);i=function(){return a};return a}function a(a){var c=a.error;return function(a){var e=d("WASmaxParseUtils").attrInt(a,"code");if(!e.success)return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError);e=e.value;if((c==null?void 0:c.handleSmaxErrorStanza)!=null&&e===d("WAHandleErrorStanzaProtocol").SMAX_INVALID_CODE){var f=d("WASmaxSmaxInvalidErrorRPC").receiveErrorRPC(a);f=f.parsedRequest;return c.handleSmaxErrorStanza({code:d("WAHandleErrorStanzaProtocol").SMAX_INVALID_CODE,text:f.text}).then(d("WAResultOrError").makeResult)}if((c==null?void 0:c.handleErrorStanza)!=null)return c.handleErrorStanza({code:e}).then(d("WAResultOrError").makeResult);d("WALogger").ERROR(i(),a.toString());return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult("NO_ACK"))}}g.createHandleErrorStanza=a}),98);
__d("WASmaxInLoginEnums",[],(function(a,b,c,d,e,f){a={400:"400",401:"401",402:"402",403:"403",405:"405",406:"406",409:"409",412:"412",413:"413",414:"414",415:"415",416:"416",500:"500",501:"501",503:"503"};b={"false":"false","true":"true"};f.ENUM_400_401_402_403_405_406_409_412_413_414_415_416_500_501_503=a;f.ENUM_FALSE_TRUE=b}),66);
__d("WASmaxInLoginFailureRequest",["WAResultOrError","WASmaxInLoginEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"failure");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"reason",d("WASmaxInLoginEnums").ENUM_400_401_402_403_405_406_409_412_413_414_415_416_500_501_503);if(!b.success)return b;var c=d("WASmaxParseUtils").attrString(a,"location");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"code");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"expire",0,void 0);if(!f.success)return f;var g=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"retry",0,void 0);if(!g.success)return g;var h=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"t",0,void 0);if(!h.success)return h;var i=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"message");if(!i.success)return i;var j=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"vt",1,1e5);if(!j.success)return j;var k=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"has_offline",d("WASmaxInLoginEnums").ENUM_FALSE_TRUE);if(!k.success)return k;var l=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"url");if(!l.success)return l;var m=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"logout_message_header");if(!m.success)return m;var n=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"logout_message_subtext");if(!n.success)return n;var o=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"logout_message_locale");if(!o.success)return o;var p=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"logout_main_button_text");if(!p.success)return p;var q=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"logout_main_button_url");if(!q.success)return q;var r=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"logout_secondary_button_text");if(!r.success)return r;var s=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"logout_secondary_button_url");if(!s.success)return s;var t=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"logout_secondary_button_ch_entrypoint_id");if(!t.success)return t;var u=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"appeal_token");if(!u.success)return u;var v=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"violation_reason");if(!v.success)return v;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"source_acct",-1,2);return!a.success?a:d("WAResultOrError").makeResult({reason:b.value,location:c.value,code:e.value,expire:f.value,retry:g.value,t:h.value,message:i.value,vt:j.value,hasOffline:k.value,url:l.value,logoutMessageHeader:m.value,logoutMessageSubtext:n.value,logoutMessageLocale:o.value,logoutMainButtonText:p.value,logoutMainButtonUrl:q.value,logoutSecondaryButtonText:r.value,logoutSecondaryButtonUrl:s.value,logoutSecondaryButtonChEntrypointId:t.value,appealToken:u.value,violationReason:v.value,sourceAcct:a.value})}g.parseFailureRequest=a}),98);
__d("WASmaxLoginFailureRPC",["WASmaxInLoginFailureRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInLoginFailureRequest").parseFailureRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Failure",{Request:a}));return{parsedRequest:a.value}}g.receiveFailureRPC=a}),98);
__d("WACreateHandleFailure",["Promise","WAResultOrError","WASmaxLoginFailureRPC"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var c=(a=a.login)==null?void 0:a.handleLoginFailure;return function(a){if(c!=null){a=d("WASmaxLoginFailureRPC").receiveFailureRPC(a);a=a.parsedRequest;return c({reason:a.reason,location:a.location,expire:a.expire}).then(d("WAResultOrError").makeResult)}return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult("NO_ACK"))}}g.createHandleFailure=a}),98);
__d("WASmaxInDirtyBitsIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","bad-request");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",400);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorBadRequestMixin=a}),98);
__d("WASmaxInDirtyBitsIQErrorFeatureNotImplementedMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","feature-not-implemented");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",501);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorFeatureNotImplementedMixin=a}),98);
__d("WASmaxInDirtyBitsIQErrorInternalServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","internal-server-error");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",500);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorInternalServerErrorMixin=a}),98);
__d("WASmaxInDirtyBitsIQErrorServiceUnavailableMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","service-unavailable");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",503);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorServiceUnavailableMixin=a}),98);
__d("WASmaxInDirtyBitsIQErrorBadRequestOrFeatureNotImplementedOrServiceUnavailableOrInternalServerErrorMixinGroup",["WAResultOrError","WASmaxInDirtyBitsIQErrorBadRequestMixin","WASmaxInDirtyBitsIQErrorFeatureNotImplementedMixin","WASmaxInDirtyBitsIQErrorInternalServerErrorMixin","WASmaxInDirtyBitsIQErrorServiceUnavailableMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInDirtyBitsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:b.value});var c=d("WASmaxInDirtyBitsIQErrorFeatureNotImplementedMixin").parseIQErrorFeatureNotImplementedMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorFeatureNotImplemented",value:c.value});var e=d("WASmaxInDirtyBitsIQErrorServiceUnavailableMixin").parseIQErrorServiceUnavailableMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"IQErrorServiceUnavailable",value:e.value});var f=d("WASmaxInDirtyBitsIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(a);return f.success?d("WAResultOrError").makeResult({name:"IQErrorInternalServerError",value:f.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorBadRequest","IQErrorFeatureNotImplemented","IQErrorServiceUnavailable","IQErrorInternalServerError"],[b,c,e,f])}g.parseIQErrorBadRequestOrFeatureNotImplementedOrServiceUnavailableOrInternalServerErrorMixinGroup=a}),98);
__d("WASmaxInDirtyBitsIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQErrorResponseMixin=a}),98);
__d("WASmaxInDirtyBitsCleanResponseError",["WAResultOrError","WASmaxInDirtyBitsIQErrorBadRequestOrFeatureNotImplementedOrServiceUnavailableOrInternalServerErrorMixinGroup","WASmaxInDirtyBitsIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInDirtyBitsIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInDirtyBitsIQErrorBadRequestOrFeatureNotImplementedOrServiceUnavailableOrInternalServerErrorMixinGroup").parseIQErrorBadRequestOrFeatureNotImplementedOrServiceUnavailableOrInternalServerErrorMixinGroup(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorIQErrorBadRequestOrFeatureNotImplementedOrServiceUnavailableOrInternalServerErrorMixinGroup:b.value}))}g.parseCleanResponseError=a}),98);
__d("WASmaxInDirtyBitsIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQResultResponseMixin=a}),98);
__d("WASmaxInDirtyBitsCleanResponseSuccess",["WASmaxInDirtyBitsIQResultResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInDirtyBitsIQResultResponseMixin").parseIQResultResponseMixin(a,b);return!c.success?c:c}g.parseCleanResponseSuccess=a}),98);
__d("WASmaxOutDirtyBitsBaseIQSetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{id:d("WAWap").generateId(),type:"set"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseIQSetRequestMixin=a}),98);
__d("WASmaxOutDirtyBitsCleanTypeMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.cleanType;a=a.cleanTimestamp;b=d("WASmaxJsx").smax("clean",{type:d("WAWap").CUSTOM_STRING(b),timestamp:d("WASmaxAttrs").OPTIONAL(d("WAWap").INT,a)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeCleanTypeMixin=a}),98);
__d("WASmaxOutDirtyBitsCleanTypeWithTimestampMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.cleanTimestamp;a=d("WASmaxJsx").smax("clean",{type:"syncd_app_state",timestamp:d("WAWap").INT(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeCleanTypeWithTimestampMixin=a}),98);
__d("WASmaxOutDirtyBitsTypeCleanOrCleanWithTimestampMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutDirtyBitsCleanTypeMixin","WASmaxOutDirtyBitsCleanTypeWithTimestampMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.cleanType)return d("WASmaxOutDirtyBitsCleanTypeMixin").mergeCleanTypeMixin(a,b.cleanType);if(b.cleanTypeWithTimestamp)return d("WASmaxOutDirtyBitsCleanTypeWithTimestampMixin").mergeCleanTypeWithTimestampMixin(a,b.cleanTypeWithTimestamp);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeTypeCleanOrCleanWithTimestampMixinGroup=a}),98);
__d("WASmaxOutDirtyBitsCleanRequest",["WASmaxJsx","WASmaxOutDirtyBitsBaseIQSetRequestMixin","WASmaxOutDirtyBitsTypeCleanOrCleanWithTimestampMixinGroup","WAWap"],(function(a,b,c,d,e,f,g){function a(a){a=a.typeCleanOrCleanWithTimestampMixinGroupArgs;a=d("WASmaxOutDirtyBitsBaseIQSetRequestMixin").mergeBaseIQSetRequestMixin(d("WASmaxJsx").smax("iq",{to:d("WAWap").S_WHATSAPP_NET,xmlns:"urn:xmpp:whatsapp:dirty"},d("WASmaxOutDirtyBitsTypeCleanOrCleanWithTimestampMixinGroup").mergeTypeCleanOrCleanWithTimestampMixinGroup(d("WASmaxJsx").smax("clean",null),a)));return a}g.makeCleanRequest=a}),98);
__d("WASmaxDirtyBitsCleanRPC",["WAComms","WASmaxInDirtyBitsCleanResponseError","WASmaxInDirtyBitsCleanResponseSuccess","WASmaxOutDirtyBitsCleanRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:e=d("WASmaxOutDirtyBitsCleanRequest").makeCleanRequest(a);i.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(e,c));case 3:f=i.sent;g=d("WASmaxInDirtyBitsCleanResponseSuccess").parseCleanResponseSuccess(f,e);if(!g.success){i.next=7;break}return i.abrupt("return",{name:"CleanResponseSuccess",value:g.value});case 7:h=d("WASmaxInDirtyBitsCleanResponseError").parseCleanResponseError(f,e);if(!h.success){i.next=10;break}return i.abrupt("return",{name:"CleanResponseError",value:h.value});case 10:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Clean",{Success:g,Error:h}));case 11:case"end":return i.stop()}},null,this)}g.sendCleanRPC=a}),98);
__d("WACleanDirtyBitsProtocol",["WALogger","WASmaxDirtyBitsCleanRPC","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to clean dirty bits for type: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendCleanRPC error: ",""]);i=function(){return a};return a}function a(a){var c,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:a.type==="syncd_app_state"?c={cleanTypeWithTimestamp:{cleanTimestamp:a.timestamp}}:c={cleanType:{cleanTimestamp:a.timestamp,cleanType:a.type}};f.next=3;return b("regeneratorRuntime").awrap(d("WASmaxDirtyBitsCleanRPC").sendCleanRPC({typeCleanOrCleanWithTimestampMixinGroupArgs:c}));case 3:e=f.sent,e.name!=="CleanResponseSuccess"&&(d("WALogger").WARN(i(),e),d("WALogger").ERROR(h(),a.type));case 5:case"end":return f.stop()}},null,this)}g.cleanDirtyBitsProtocol=a}),98);
__d("WASmaxInDirtyBitsEnums",[],(function(a,b,c,d,e,f){a={account_sync:"account_sync",groups:"groups",newsletter_metadata:"newsletter_metadata",syncd_app_state:"syncd_app_state"};f.ENUM_ACCOUNTSYNC_GROUPS_NEWSLETTERMETADATA_SYNCDAPPSTATE=a}),66);
__d("WASmaxInDirtyBitsNotifyRequest",["WAResultOrError","WASmaxInDirtyBitsEnums","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ib");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"dirty");if(!b.success)return b;a=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!a.success)return a;var c=d("WASmaxParseUtils").attrIntRange(b.value,"timestamp",0,void 0);if(!c.success)return c;b=d("WASmaxParseUtils").attrStringEnum(b.value,"type",d("WASmaxInDirtyBitsEnums").ENUM_ACCOUNTSYNC_GROUPS_NEWSLETTERMETADATA_SYNCDAPPSTATE);return!b.success?b:d("WAResultOrError").makeResult({from:a.value,dirtyTimestamp:c.value,dirtyType:b.value})}g.parseNotifyRequest=a}),98);
__d("WASmaxDirtyBitsNotifyRPC",["WASmaxInDirtyBitsNotifyRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInDirtyBitsNotifyRequest").parseNotifyRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Notify",{Request:a}));return{parsedRequest:a.value}}g.receiveNotifyRPC=a}),98);
__d("WAHandleDirtyBitsProtocol",["WASmaxDirtyBitsNotifyRPC"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=d("WASmaxDirtyBitsNotifyRPC").receiveNotifyRPC(a);a=a.parsedRequest;var b=a.dirtyType;a=a.dirtyTimestamp;return{dirtyBitType:b,dirtyBitTimestamp:a}}g.parseDirtyBit=a}),98);
__d("WAHandleThreadMetadata",["WAGlobals","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:c=a.map(function(a){return a.from});e.next=3;return b("regeneratorRuntime").awrap(d("WAGlobals").getWaOneQueue().enqueue(function(a){a=a.cryptoManager;return a.storage.warmCache(c)},{operationType:"thread_metadata",flush:!1}));case 3:case"end":return e.stop()}},null,this)}g.handleThreadMetadata=a}),98);
__d("WASmaxDecisionTreeUtils",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").maybeChildren(a);if(!b.success)return b;b=b.value;return b==null||b.length===0?d("WASmaxParseUtils").errorMessage(a,"to have at least 1 child, but found 0"):d("WAResultOrError").makeResult(b[0])}g.firstChild=a}),98);
__d("WASmaxInEdgeEdgeRoutingRequest",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ib");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"edge_routing");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(b.value,"routing_info");if(!b.success)return b;a=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!a.success)return a;b=d("WASmaxParseUtils").contentBytesRange(b.value,1,1024);return!b.success?b:d("WAResultOrError").makeResult({from:a.value,edgeRoutingRoutingInfoElementValue:b.value})}g.parseEdgeRoutingRequest=a}),98);
__d("WASmaxEdgeEdgeRoutingRPC",["WASmaxInEdgeEdgeRoutingRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInEdgeEdgeRoutingRequest").parseEdgeRoutingRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("EdgeRouting",{Request:a}));return{parsedRequest:a.value}}g.receiveEdgeRoutingRPC=a}),98);
__d("WASmaxInMessageRequestEnums",["WAJids"],(function(a,b,c,d,e,f,g){a={complete:"complete","continue":"continue"};b={validators:[d("WAJids").validateGroupJid,d("WAJids").validateUserJid],typeName:"GroupJid|UserJid"};g.ENUM_COMPLETE_CONTINUE=a;g.GROUPJID_USERJID=b}),98);
__d("WASmaxInMessageRequestSpamMarkerRequest",["WAResultOrError","WASmaxInMessageRequestEnums","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ib");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"spam");if(!b.success)return b;a=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!a.success)return a;b=d("WASmaxParseUtils").attrStringEnum(b.value,"state",d("WASmaxInMessageRequestEnums").ENUM_COMPLETE_CONTINUE);return!b.success?b:d("WAResultOrError").makeResult({from:a.value,spamState:b.value})}g.parseSpamMarkerRequest=a}),98);
__d("WASmaxMessageRequestSpamMarkerRPC",["WASmaxInMessageRequestSpamMarkerRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInMessageRequestSpamMarkerRequest").parseSpamMarkerRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("SpamMarker",{Request:a}));return{parsedRequest:a.value}}g.receiveSpamMarkerRPC=a}),98);
__d("WASmaxInOfflineCompletionRequest",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ib");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"offline");if(!b.success)return b;a=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!a.success)return a;b=d("WASmaxParseUtils").attrIntRange(b.value,"count",0,void 0);return!b.success?b:d("WAResultOrError").makeResult({from:a.value,offlineCount:b.value})}g.parseCompletionRequest=a}),98);
__d("WASmaxOfflineCompletionRPC",["WASmaxInOfflineCompletionRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInOfflineCompletionRequest").parseCompletionRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Completion",{Request:a}));return{parsedRequest:a.value}}g.receiveCompletionRPC=a}),98);
__d("WASmaxInOfflinePreviewRequest",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ib");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"offline_preview");if(!b.success)return b;a=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!a.success)return a;var c=d("WASmaxParseUtils").attrIntRange(b.value,"count",0,void 0);if(!c.success)return c;var e=d("WASmaxParseUtils").attrIntRange(b.value,"message",0,void 0);if(!e.success)return e;var f=d("WASmaxParseUtils").attrIntRange(b.value,"receipt",0,void 0);if(!f.success)return f;var g=d("WASmaxParseUtils").attrIntRange(b.value,"notification",0,void 0);if(!g.success)return g;var h=d("WASmaxParseUtils").attrIntRange(b.value,"appdata",0,void 0);if(!h.success)return h;b=d("WASmaxParseUtils").attrIntRange(b.value,"call",0,void 0);return!b.success?b:d("WAResultOrError").makeResult({from:a.value,offlinePreviewCount:c.value,offlinePreviewMessage:e.value,offlinePreviewReceipt:f.value,offlinePreviewNotification:g.value,offlinePreviewAppdata:h.value,offlinePreviewCall:b.value})}g.parsePreviewRequest=a}),98);
__d("WASmaxOfflinePreviewRPC",["WASmaxInOfflinePreviewRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInOfflinePreviewRequest").parsePreviewRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Preview",{Request:a}));return{parsedRequest:a.value}}g.receivePreviewRPC=a}),98);
__d("WASmaxInOfflineEnums",["WAJids"],(function(a,b,c,d,e,f,g){b={validators:[(a=d("WAJids")).validateGroupJid,a.validateUserJid,a.validateUserJid,a.validateUserJid],typeName:"GroupJid|UserJid|UserJid|UserJid"};g.GROUPJID_USERJID_USERJID_USERJID=b}),98);
__d("WASmaxInOfflineThreadMetadataDelayedMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"item");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"from");return!b.success?b:d("WAResultOrError").makeResult({from:b.value})}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"status_msgs");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"count",0,void 0);if(!b.success)return b;a=d("WASmaxParseUtils").mapChildrenWithTag(a,"item",1,Infinity,h);return!a.success?a:d("WAResultOrError").makeResult({count:b.value,item:a.value})}function j(a){var b=d("WASmaxParseUtils").assertTag(a,"notifications");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"count",0,void 0);return!b.success?b:d("WAResultOrError").makeResult({count:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"thread_metadata");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"status_msgs",i);if(!b.success)return b;a=d("WASmaxParseUtils").optionalChildWithTag(a,"notifications",j);return!a.success?a:d("WAResultOrError").makeResult({statusMsgs:b.value,notifications:a.value})}g.parseThreadMetadataDelayedStatusMsgsItem=h;g.parseThreadMetadataDelayedStatusMsgs=i;g.parseThreadMetadataDelayedNotifications=j;g.parseThreadMetadataDelayedMixin=a}),98);
__d("WASmaxInOfflineThreadMetadataRequest",["WAResultOrError","WASmaxInOfflineEnums","WASmaxInOfflineThreadMetadataDelayedMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"item");if(!b.success)return b;b=d("WASmaxParseJid").attrJidEnum(a,"from",d("WASmaxInOfflineEnums").GROUPJID_USERJID_USERJID_USERJID);if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({from:b.value,t:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ib");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"thread_metadata");if(!b.success)return b;a=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!a.success)return a;var c=d("WASmaxInOfflineThreadMetadataDelayedMixin").parseThreadMetadataDelayedMixin(b.value);b=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"item",0,50,h);return!b.success?b:d("WAResultOrError").makeResult({from:a.value,threadMetadataThreadMetadataDelayedMixin:c.success?c.value:null,threadMetadataItem:b.value})}g.parseThreadMetadataRequestThreadMetadataItem=h;g.parseThreadMetadataRequest=a}),98);
__d("WASmaxOfflineThreadMetadataRPC",["WASmaxInOfflineThreadMetadataRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInOfflineThreadMetadataRequest").parseThreadMetadataRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("ThreadMetadata",{Request:a}));return{parsedRequest:a.value}}g.receiveThreadMetadataRPC=a}),98);
__d("WACreateHandleInfoBulletin",["Promise","WACleanDirtyBitsProtocol","WAHandleDirtyBitsProtocol","WAHandleThreadMetadata","WALogger","WAResultOrError","WASmaxDecisionTreeUtils","WASmaxEdgeEdgeRoutingRPC","WASmaxMessageRequestSpamMarkerRPC","WASmaxOfflineCompletionRPC","WASmaxOfflinePreviewRPC","WASmaxOfflineThreadMetadataRPC","WATimeUtils","WAUnknownStanzaError"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleInfoBulletin: unknown incoming <ib>: ",""]);i=function(){return a};return a}var j=(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult("NO_ACK"));function a(a){return function(c){var e=d("WASmaxDecisionTreeUtils").firstChild(c);if(e.success===!1)return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError);e=e.value.tag;switch(e){case"edge_routing":var f;e=d("WASmaxEdgeEdgeRoutingRPC").receiveEdgeRoutingRPC(c).parsedRequest;e=e.edgeRoutingRoutingInfoElementValue;return(f=(f=a.comms)==null?void 0:f.handleEdgeRoutingInfo({edgeInfo:e}).then(d("WAResultOrError").makeResult))!=null?f:j;case"offline_preview":e=d("WASmaxOfflinePreviewRPC").receivePreviewRPC(c).parsedRequest;f={count:e.offlinePreviewCount,message:e.offlinePreviewMessage,receipt:e.offlinePreviewReceipt,notification:e.offlinePreviewNotification,appdata:e.offlinePreviewAppdata};return(e=(e=a.offline)==null?void 0:e.handleOfflineStart(f).then(d("WAResultOrError").makeResult))!=null?e:j;case"offline":f=d("WASmaxOfflineCompletionRPC").receiveCompletionRPC(c).parsedRequest.offlineCount;return(e=(e=a.offline)==null?void 0:e.handleOfflineEnd({offlineCount:f}).then(d("WAResultOrError").makeResult))!=null?e:j;case"thread_metadata":var g=d("WASmaxOfflineThreadMetadataRPC").receiveThreadMetadataRPC(c).parsedRequest.threadMetadataItem.map(function(a){var b=a.from;a=a.t;return{from:b,t:d("WATimeUtils").castToUnixTime(a)}});return d("WAHandleThreadMetadata").handleThreadMetadata(g).then(function(){var b;return(b=(b=a.offline)==null?void 0:b.handleThreadMetadata(g).then(d("WAResultOrError").makeResult))!=null?b:j});case"spam":f=d("WASmaxMessageRequestSpamMarkerRPC").receiveSpamMarkerRPC(c).parsedRequest.spamState;return(e=(e=a.spam)==null?void 0:e.handleSpam({spamState:f}).then(d("WAResultOrError").makeResult))!=null?e:j;case"dirty":f=d("WAHandleDirtyBitsProtocol").parseDirtyBit(c);var k=f.dirtyBitTimestamp,l=f.dirtyBitType;e=function(){return d("WACleanDirtyBitsProtocol").cleanDirtyBitsProtocol({timestamp:k,type:l})};switch(l){case"groups":return(f=(f=a.groupMessage)==null?void 0:f.handleGroupDirtyBit==null?void 0:f.handleGroupDirtyBit({dirtyBitTimestamp:k,cleanDirtyBits:e}).then(d("WAResultOrError").makeResult))!=null?f:j;case"account_sync":return(f=(f=a.accountSync)==null?void 0:f.handleAccountSyncDirtyBit({dirtyBitTimestamp:k,cleanDirtyBits:e}).then(d("WAResultOrError").makeResult))!=null?f:j;case"newsletter_metadata":return(f=(f=a.newsletter)==null?void 0:f.handleNewsletterDirtyBit({dirtyBitTimestamp:k,cleanDirtyBits:e}).then(d("WAResultOrError").makeResult))!=null?f:j;default:l;return(f=(f=a.syncd)==null?void 0:f.handleSyncdDirtyBit({dirtyBitTimestamp:k,cleanDirtyBits:e}).then(d("WAResultOrError").makeResult))!=null?f:j}default:d("WALogger").WARN(i(),c.toString());return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError)}}}g.createHandleInfoBulletin=a}),98);
__d("WAAdv.pb",["$InternalEnum","WAProtoConst"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({E2EE:0,HOSTED:1});c={};e={};f={};b={};var h={};c.internalDefaults={accountType:a.E2EE};c.internalSpec={rawId:[1,(d=d("WAProtoConst")).TYPES.UINT32],timestamp:[2,d.TYPES.UINT64],currentIndex:[3,d.TYPES.UINT32],validIndexes:[4,d.FLAGS.REPEATED|d.FLAGS.PACKED|d.TYPES.UINT32],accountType:[5,d.TYPES.ENUM,a]};e.internalSpec={details:[1,d.TYPES.BYTES],accountSignature:[2,d.TYPES.BYTES],accountSignatureKey:[3,d.TYPES.BYTES]};f.internalDefaults={accountType:a.E2EE,deviceType:a.E2EE};f.internalSpec={rawId:[1,d.TYPES.UINT32],timestamp:[2,d.TYPES.UINT64],keyIndex:[3,d.TYPES.UINT32],accountType:[4,d.TYPES.ENUM,a],deviceType:[5,d.TYPES.ENUM,a]};b.internalSpec={details:[1,d.TYPES.BYTES],accountSignatureKey:[2,d.TYPES.BYTES],accountSignature:[3,d.TYPES.BYTES],deviceSignature:[4,d.TYPES.BYTES]};h.internalDefaults={accountType:a.E2EE};h.internalSpec={details:[1,d.TYPES.BYTES],hmac:[2,d.TYPES.BYTES],accountType:[3,d.TYPES.ENUM,a]};g.ADVEncryptionType=a;g.ADVKeyIndexListSpec=c;g.ADVSignedKeyIndexListSpec=e;g.ADVDeviceIdentitySpec=f;g.ADVSignedDeviceIdentitySpec=b;g.ADVSignedDeviceIdentityHMACSpec=h}),98);
__d("WAAdv",["WAAdv.pb","WABinary","WAByteArray","WACryptoDependencies","WACryptoHmac","WACryptoUtils","WAResultOrError","WASignalKeys","WASignalOther","WASignalSignatures","decodeProtobuf","encodeProtobuf","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h=new Uint8Array([6,0]),i=new Uint8Array([6,1]);function a(a){return a}function c(a){return a}function e(a){return a}function f(){var a=new Uint8Array(32);d("WACryptoDependencies").getCrypto().getRandomValues(a);return a}function j(a){var c,e,f,g,i,j,k,l,m,n,o,p,q;return b("regeneratorRuntime").async(function(r){while(1)switch(r.prev=r.next){case 0:c=a.advSignedDeviceIdentityHmacProtobuf,e=a.advSecretKey,f=a.identityPubKey;g=d("decodeProtobuf").decodeProtobuf(d("WAAdv.pb").ADVSignedDeviceIdentityHMACSpec,c);i=g.details;j=g.hmac;if(!(i==null)){r.next=6;break}return r.abrupt("return",d("WAResultOrError").makeError("missing-identity-hmac-details"));case 6:if(!(j==null)){r.next=8;break}return r.abrupt("return",d("WAResultOrError").makeError("missing-identity-hmac"));case 8:r.next=10;return b("regeneratorRuntime").awrap(d("WACryptoHmac").hmacSha256(e,i));case 10:k=r.sent;if(d("WACryptoUtils").arrayBuffersEqual(k,j)){r.next=13;break}return r.abrupt("return",d("WAResultOrError").makeError("hmac-mismatch"));case 13:l=d("decodeProtobuf").decodeProtobuf(d("WAAdv.pb").ADVSignedDeviceIdentitySpec,i);m=l.details;if(!(m==null)){r.next=17;break}return r.abrupt("return",d("WAResultOrError").makeError("missing-account-signature-details"));case 17:n=l.accountSignatureKey;if(!(n==null)){r.next=20;break}return r.abrupt("return",d("WAResultOrError").makeError("missing-account-signature-key"));case 20:o=l.accountSignature;if(!(o==null)){r.next=23;break}return r.abrupt("return",d("WAResultOrError").makeError("missing-account-signature"));case 23:p=d("WABinary").Binary.build(h,m,f).readByteArray();q=d("WASignalSignatures").verifyMsgSignalVariant(d("WASignalKeys").serializeIdentity(new Uint8Array(n)),p,d("WASignalOther").toBytes(o,64));if(q){r.next=27;break}return r.abrupt("return",d("WAResultOrError").makeError("signature-mismatch"));case 27:return r.abrupt("return",d("WAResultOrError").makeResult({advSignedDeviceIdentity:l}));case 28:case"end":return r.stop()}},null,this)}function k(a){var c,e,f,g,h,j,k,l,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:c=a.advSignedDeviceIdentity,e=a.identityKeyPair;f=c.details;g=d("decodeProtobuf").decodeProtobuf(d("WAAdv.pb").ADVDeviceIdentitySpec,f);h=g.keyIndex;if(!(h==null)){n.next=6;break}return n.abrupt("return",d("WAResultOrError").makeError("missing-key-index"));case 6:j=d("WABinary").Binary.build(i,f,e.publicKey,c.accountSignatureKey).readByteArray();n.next=9;return b("regeneratorRuntime").awrap(d("WASignalSignatures").signMsg(e,j));case 9:k=n.sent;l=babelHelpers["extends"]({},c);l.deviceSignature=d("WAByteArray").uint8ArrayToBuffer(k);l.accountSignatureKey=void 0;m=d("encodeProtobuf").encodeProtobuf(d("WAAdv.pb").ADVSignedDeviceIdentitySpec,l).readByteArray();return n.abrupt("return",d("WAResultOrError").makeResult({signedDeviceIdentityProtobuf:m,keyIndex:h}));case 15:case"end":return n.stop()}},null,this)}g.castToAdvSignedDeviceIdentityHmacProtobuf=a;g.castToAdvSecretKey=c;g.castToAdvSignedDeviceIdentityProtobuf=e;g.generateAdvSecretKey=f;g.verifyAdvSignedDeviceIdentity=j;g.addDeviceSignatureToProtobuf=k}),98);
__d("WASmaxInMdBaseIQSetRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"iq");if(!b.success)return b;b=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","set");return!a.success?a:d("WAResultOrError").makeResult({id:b.value,type:a.value})}g.parseBaseIQSetRequestMixin=a}),98);
__d("WASmaxInMdSetToCompanionRequest",["WAResultOrError","WASmaxInMdBaseIQSetRequestMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"ref");if(!b.success)return b;b=d("WASmaxParseUtils").contentBytes(a);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"iq");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"pair-device");if(!b.success)return b;var c=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!c.success)return c;var e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"xmlns","md");if(!e.success)return e;a=d("WASmaxInMdBaseIQSetRequestMixin").parseBaseIQSetRequestMixin(a);if(!a.success)return a;b=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"ref",6,6,h);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({from:c.value,xmlns:e.value},a.value,{pairDeviceRef:b.value}))}g.parseSetToCompanionRequestPairDeviceRef=h;g.parseSetToCompanionRequest=a}),98);
__d("WASmaxOutMdSetToCompanionResponseClientResponse",["WASmaxJsx","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrDomainJid,a,["from"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("iq",{id:d("WAWap").STANZA_ID(b.value),to:d("WAWap").DOMAIN_JID(a.value),type:"result"});return b}g.makeSetToCompanionResponseClientResponse=a}),98);
__d("WASmaxMdSetToCompanionRPC",["WASmaxInMdSetToCompanionRequest","WASmaxOutMdSetToCompanionResponseClientResponse","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMdSetToCompanionRequest").parseSetToCompanionRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("SetToCompanion",{Request:b}));return{parsedRequest:b.value,makeSetToCompanionResponseClientResponse:function(){return d("WASmaxOutMdSetToCompanionResponseClientResponse").makeSetToCompanionResponseClientResponse(a)}}}g.receiveSetToCompanionRPC=a}),98);
__d("WAHandlePairDeviceProtocol",["WABase64","WABinary","WAResultOrError","WASmaxMdSetToCompanionRPC"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=d("WASmaxMdSetToCompanionRPC").receiveSetToCompanionRPC(a);var b=a.makeSetToCompanionResponseClientResponse;a=a.parsedRequest;a=a.pairDeviceRef.map(function(a){a=a.elementValue;a=new(d("WABinary").Binary)(a);return a.readString(a.size())});return d("WAResultOrError").makeResult({refs:a,makeAck:b})}b=function(a){var b=a.ref,c=a.publicAuthKey,e=a.publicIdentityKey;a=a.advSecretKey;return b+","+d("WABase64").encodeB64(c)+","+d("WABase64").encodeB64(e)+","+d("WABase64").encodeB64(a)};g.parsePairDevice=a;g.generateRegistrationQrCodeString=b}),98);
__d("WASmaxInMdEnums",[],(function(a,b,c,d,e,f){a={"false":"false","true":"true"};f.ENUM_FALSE_TRUE=a}),66);
__d("WASmaxInMdSetRegRequest",["WAResultOrError","WASmaxInMdBaseIQSetRequestMixin","WASmaxInMdEnums","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"biz");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"name");return!b.success?b:d("WAResultOrError").makeResult({name:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"iq");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"pair-success");if(!b.success)return b;var c=d("WASmaxParseUtils").flattenedChildWithTag(b.value,"device-identity");if(!c.success)return c;var e=d("WASmaxParseUtils").flattenedChildWithTag(b.value,"device");if(!e.success)return e;var f=d("WASmaxParseUtils").flattenedChildWithTag(b.value,"platform");if(!f.success)return f;b=d("WASmaxParseUtils").optionalChildWithTag(b.value,"biz",h);if(!b.success)return b;var g=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!g.success)return g;var i=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"xmlns","md");if(!i.success)return i;c=d("WASmaxParseUtils").contentBytesRange(c.value,1,500);if(!c.success)return c;var j=d("WASmaxParseJid").attrDeviceJid(e.value,"jid");if(!j.success)return j;e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,e.value,"beta",d("WASmaxInMdEnums").ENUM_FALSE_TRUE);if(!e.success)return e;f=d("WASmaxParseUtils").attrString(f.value,"name");if(!f.success)return f;a=d("WASmaxInMdBaseIQSetRequestMixin").parseBaseIQSetRequestMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({from:g.value,xmlns:i.value,pairSuccessDeviceIdentityElementValue:c.value,pairSuccessDeviceJid:j.value,pairSuccessDeviceBeta:e.value,pairSuccessPlatformName:f.value},a.value,{pairSuccessBiz:b.value}))}g.parseSetRegRequestPairSuccessBiz=h;g.parseSetRegRequest=a}),98);
__d("WASmaxOutMdRegularCompanionSetRegResponseBundleMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.deviceIdentityKeyIndex;a=a.deviceIdentityElementValue;b=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("pair-device-sign",null,d("WASmaxJsx").smax("device-identity",{"key-index":d("WAWap").INT(b)},a)));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeRegularCompanionSetRegResponseBundleMixin=a}),98);
__d("WASmaxOutMdSetRegResponseClientResponse",["WASmaxJsx","WASmaxOutMdRegularCompanionSetRegResponseBundleMixin","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a,b){b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,b,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);b=d("WASmaxOutMdRegularCompanionSetRegResponseBundleMixin").mergeRegularCompanionSetRegResponseBundleMixin(d("WASmaxJsx").smax("iq",{id:d("WAWap").STANZA_ID(b.value),to:d("WAWap").S_WHATSAPP_NET,type:"result"}),a);return b}g.makeSetRegResponseClientResponse=a}),98);
__d("WASmaxOutMdIQErrorNotAuthorizedMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("error",{text:"not-authorized",code:d("WAWap").INT(401)});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIQErrorNotAuthorizedMixin=a}),98);
__d("WASmaxOutMdSetRegResponseError",["WASmaxJsx","WASmaxOutMdIQErrorNotAuthorizedMixin","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);a=d("WASmaxJsx").smax("iq",{id:d("WAWap").STANZA_ID(a.value),to:d("WAWap").S_WHATSAPP_NET,type:"error"},d("WASmaxOutMdIQErrorNotAuthorizedMixin").mergeIQErrorNotAuthorizedMixin(d("WASmaxJsx").smax("error",null)));return a}g.makeSetRegResponseError=a}),98);
__d("WASmaxOutMdHostedCompanionSetRegResponseBundleMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.deviceIdentityElementValue;a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("hosted-pair-set",null,d("WASmaxJsx").smax("device-identity",null,a)));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeHostedCompanionSetRegResponseBundleMixin=a}),98);
__d("WASmaxOutMdSetRegResponseHostedClientResponse",["WASmaxJsx","WASmaxOutMdHostedCompanionSetRegResponseBundleMixin","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a,b){b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,b,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);b=d("WASmaxOutMdHostedCompanionSetRegResponseBundleMixin").mergeHostedCompanionSetRegResponseBundleMixin(d("WASmaxJsx").smax("iq",{id:d("WAWap").STANZA_ID(b.value),to:d("WAWap").S_WHATSAPP_NET,type:"result"}),a);return b}g.makeSetRegResponseHostedClientResponse=a}),98);
__d("WASmaxMdSetRegRPC",["WASmaxInMdSetRegRequest","WASmaxOutMdSetRegResponseClientResponse","WASmaxOutMdSetRegResponseError","WASmaxOutMdSetRegResponseHostedClientResponse","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMdSetRegRequest").parseSetRegRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("SetReg",{Request:b}));return{parsedRequest:b.value,makeSetRegResponseClientResponse:function(b){return d("WASmaxOutMdSetRegResponseClientResponse").makeSetRegResponseClientResponse(b,a)},makeSetRegResponseHostedClientResponse:function(b){return d("WASmaxOutMdSetRegResponseHostedClientResponse").makeSetRegResponseHostedClientResponse(b,a)},makeSetRegResponseError:function(){return d("WASmaxOutMdSetRegResponseError").makeSetRegResponseError(a)}}}g.receiveSetRegRPC=a}),98);
__d("WAHandlePairSuccessProtocol",["WAAdv","WAResultOrError","WASmaxMdSetRegRPC"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=d("WASmaxMdSetRegRPC").receiveSetRegRPC(a);var b=a.makeSetRegResponseHostedClientResponse,c=a.makeSetRegResponseClientResponse,e=a.makeSetRegResponseError;a=a.parsedRequest;var f=a.pairSuccessDeviceIdentityElementValue,g=a.pairSuccessDeviceJid,h=a.pairSuccessPlatformName;a=a.pairSuccessBiz;return d("WAResultOrError").makeResult({bizName:a==null?void 0:a.name,platformName:h,deviceJid:g,advSignedDeviceIdentityHmacProtobuf:d("WAAdv").castToAdvSignedDeviceIdentityHmacProtobuf(f),makeSetRegResponseHostedClientResponse:b,makeSetRegResponseClientResponse:c,makeSetRegResponseError:e})}g.parsePairSuccess=a}),98);
__d("WASmaxInPingsServerPingRequest",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"iq");if(!b.success)return b;b=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!b.success)return b;var c=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!c.success)return c;var e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","get");if(!e.success)return e;var f=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"xmlns","urn:xmpp:ping");if(!f.success)return f;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStanzaId,a,"id");return!a.success?a:d("WAResultOrError").makeResult({from:b.value,t:c.value,type:e.value,xmlns:f.value,id:a.value})}g.parseServerPingRequest=a}),98);
__d("WASmaxOutPingsServerPingResponseClientResponse",["WASmaxAttrs","WASmaxJsx","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=a.hasIqXmlnsUrnx3Axmppx3Aping;a=a.iqTo;b=d("WASmaxJsx").smax("iq",{xmlns:d("WASmaxAttrs").OPTIONAL_LITERAL("urn:xmpp:ping",b),to:d("WAWap").JID(a),type:"result",id:d("WAWap").generateId()});return b}g.makeServerPingResponseClientResponse=a}),98);
__d("WASmaxOutPingsServerPingResponseClientResponseError",["WASmaxAttrs","WASmaxJsx","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b,c=a.iqTo,e=a.errorCode;a=a.errorText;c=d("WASmaxJsx").smax("iq",{to:(b=d("WAWap")).JID(c),type:"error",id:b.generateId()},d("WASmaxJsx").smax("error",{code:b.CUSTOM_STRING(e),text:d("WASmaxAttrs").OPTIONAL(b.CUSTOM_STRING,a)}));return c}g.makeServerPingResponseClientResponseError=a}),98);
__d("WASmaxPingsServerPingRPC",["WASmaxInPingsServerPingRequest","WASmaxOutPingsServerPingResponseClientResponse","WASmaxOutPingsServerPingResponseClientResponseError","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInPingsServerPingRequest").parseServerPingRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("ServerPing",{Request:a}));return{parsedRequest:a.value,makeServerPingResponseClientResponse:d("WASmaxOutPingsServerPingResponseClientResponse").makeServerPingResponseClientResponse,makeServerPingResponseClientResponseError:d("WASmaxOutPingsServerPingResponseClientResponseError").makeServerPingResponseClientResponseError}}g.receiveServerPingRPC=a}),98);
__d("WACreateHandleIq",["Promise","WAAdv","WAHandlePairDeviceProtocol","WAHandlePairSuccessProtocol","WAResultOrError","WASmaxParseUtils","WASmaxPingsServerPingRPC","WAUnknownStanzaError"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var c=a.md,e=a.comms;return function(a){var f=a.attrs;switch(f.xmlns){case"urn:xmpp:ping":f=e==null?void 0:e.handleServerPing;if(f!=null){var g=d("WASmaxPingsServerPingRPC").receiveServerPingRPC(a),i=g.parsedRequest.from,j=g.makeServerPingResponseClientResponse;return f({makeResponse:function(){return j({hasIqXmlnsUrnx3Axmppx3Aping:!1,iqTo:i})}}).then(d("WAResultOrError").makeResult)}break;case"md":g=d("WASmaxParseUtils").maybeChildren(a);if(g.success&&g.value!=null){f=g.value[0].tag;switch(f){case"pair-device":g=c==null?void 0:c.handlePairDevice;if(g!=null){f=d("WAHandlePairDeviceProtocol").parsePairDevice(a);f=f.value;var k=f.makeAck;f=f.refs;return g({generateRegistrationQrCodeString:d("WAHandlePairDeviceProtocol").generateRegistrationQrCodeString,makeAck:k,refs:f}).then(d("WAResultOrError").makeResult)}break;case"pair-success":g=c==null?void 0:c.handlePairSuccess;if(g!=null){k=d("WAHandlePairSuccessProtocol").parsePairSuccess(a);if(k.success)return g(babelHelpers["extends"]({},k.value,{addDeviceSignatureToProtobuf:d("WAAdv").addDeviceSignatureToProtobuf,verifyAdvSignedDeviceIdentity:d("WAAdv").verifyAdvSignedDeviceIdentity})).then(d("WAResultOrError").makeResult)}break}}}return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError)}}g.createHandleIq=a}),98);
__d("WACommonMessageBase",["WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.id,c=a.t,e=a.folderMixin,f=a.offlineMixin,g=a.metaHideDecryptionPlaceholderMixin,h=a.frankingMixin;return{stanzaId:b,serverTs:d("WATimeUtils").castToUnixTime(c),offline:f==null?void 0:f.offline,fbFolderId:e==null?void 0:e.folderId,hideDecryptionFailure:(g==null?void 0:g.metaDecryptFail)==="hide",frankingTag:h==null?void 0:(b=h.clientFrankingTagMixin)==null?void 0:b.frankingFrankingTagElementValue,reportingTag:h==null?void 0:h.frankingReportingTagElementValue,internalTestConfig:(c=a.internalTestMixin)==null?void 0:c.testConfig}}g.transformMessageParsedRequest=a}),98);
__d("WAE2E.pb",["$InternalEnum","WAAdv.pb","WAMmsRetry.pb","WAProtoConst","WAProtocol.pb"],(function(a,b,c,d,e,f,g){var h,i;c=(a=b("$InternalEnum"))({MASK_LINKED_DEVICES:0});e=a({UNKNOWN:0,AUDIO:1,VIDEO:2});f=a({CONNECTED:0,MISSED:1,FAILED:2,REJECTED:3,ACCEPTED_ELSEWHERE:4,ONGOING:5,SILENCED_BY_DND:6,SILENCED_UNKNOWN_CALLER:7});b=a({REGULAR:0,SCHEDULED_CALL:1,VOICE_CHAT:2});var aa=a({UNKNOWN:0,CANCEL:1}),ba=a({UNKNOWN:0,VOICE:1,VIDEO:2}),ca=a({UNKNOWN:0,GOING:1,NOT_GOING:2}),da=a({UNKNOWN_TYPE:0,PIN_FOR_ALL:1,UNPIN_FOR_ALL:2}),ea=a({UNKNOWN:0,DISPLAY_TEXT:1}),fa=a({UNKNOWN:0,RESPONSE:1,NATIVE_FLOW:2}),ga=a({UNKNOWN:0,EMPTY:1,TEXT:2,DOCUMENT:3,IMAGE:4,VIDEO:5,LOCATION:6}),ha=a({DEFAULT:0,PARENT:1}),j=a({DEFAULT:0,EXTENSIONS_1:1}),ia=a({UNKNOWN_SURFACE:0,FB:1,IG:2,WA:3}),ja=a({UNKNOWN:0,SINGLE_SELECT:1}),ka=a({UNKNOWN:0,SINGLE_SELECT:1,PRODUCT_LIST:2}),la=a({CATALOG:1}),ma=a({INQUIRY:1,ACCEPTED:2,DECLINED:3}),na=a({UNKNOWN:0,FBPAY:1,NOVI:2,UPI:3}),oa=a({GREGORIAN:1,SOLAR_HIJRI:2}),pa=a({MONDAY:1,TUESDAY:2,WEDNESDAY:3,THURSDAY:4,FRIDAY:5,SATURDAY:6,SUNDAY:7}),k=a({UPLOAD_STICKER:0,SEND_RECENT_STICKER_BOOTSTRAP:1,GENERATE_LINK_PREVIEW:2,HISTORY_SYNC_ON_DEMAND:3,PLACEHOLDER_MESSAGE_RESEND:4}),qa=a({INITIAL_BOOTSTRAP:0,INITIAL_STATUS_V3:1,FULL:2,RECENT:3,PUSH_NAME:4,NON_BLOCKING_DATA:5,ON_DEMAND:6}),ra=a({EMPTY:0,NON_EMPTY:1}),sa=a({REVOKE:0,EPHEMERAL_SETTING:3,EPHEMERAL_SYNC_RESPONSE:4,HISTORY_SYNC_NOTIFICATION:5,APP_STATE_SYNC_KEY_SHARE:6,APP_STATE_SYNC_KEY_REQUEST:7,MSG_FANOUT_BACKFILL_REQUEST:8,INITIAL_SECURITY_NOTIFICATION_SETTING_SYNC:9,APP_STATE_FATAL_EXCEPTION_NOTIFICATION:10,SHARE_PHONE_NUMBER:11,MESSAGE_EDIT:14,PEER_DATA_OPERATION_REQUEST_MESSAGE:16,PEER_DATA_OPERATION_REQUEST_RESPONSE_MESSAGE:17,REQUEST_WELCOME_MESSAGE:18,BOT_FEEDBACK_MESSAGE:19,MEDIA_NOTIFY_MESSAGE:20}),ta=a({BOT_FEEDBACK_MULTIPLE_POSITIVE_GENERIC:1}),ua=a({BOT_FEEDBACK_MULTIPLE_NEGATIVE_GENERIC:1,BOT_FEEDBACK_MULTIPLE_NEGATIVE_HELPFUL:2,BOT_FEEDBACK_MULTIPLE_NEGATIVE_INTERESTING:4,BOT_FEEDBACK_MULTIPLE_NEGATIVE_ACCURATE:8,BOT_FEEDBACK_MULTIPLE_NEGATIVE_SAFE:16,BOT_FEEDBACK_MULTIPLE_NEGATIVE_OTHER:32,BOT_FEEDBACK_MULTIPLE_NEGATIVE_REFUSED:64,BOT_FEEDBACK_MULTIPLE_NEGATIVE_NOT_VISUALLY_APPEALING:128,BOT_FEEDBACK_MULTIPLE_NEGATIVE_NOT_RELEVANT_TO_TEXT:256}),va=a({BOT_FEEDBACK_POSITIVE:0,BOT_FEEDBACK_NEGATIVE_GENERIC:1,BOT_FEEDBACK_NEGATIVE_HELPFUL:2,BOT_FEEDBACK_NEGATIVE_INTERESTING:3,BOT_FEEDBACK_NEGATIVE_ACCURATE:4,BOT_FEEDBACK_NEGATIVE_SAFE:5,BOT_FEEDBACK_NEGATIVE_OTHER:6,BOT_FEEDBACK_NEGATIVE_REFUSED:7,BOT_FEEDBACK_NEGATIVE_NOT_VISUALLY_APPEALING:8,BOT_FEEDBACK_NEGATIVE_NOT_RELEVANT_TO_TEXT:9}),wa=a({NONE:0,GIPHY:1,TENOR:2}),l=a({DEFAULT:0,PARENT:1,SUB:2,DEFAULT_SUB:3}),xa=a({NONE:0,VIDEO:1,PLACEHOLDER:4,IMAGE:5}),ya=a({SYSTEM:0,SYSTEM_TEXT:1,FB_SCRIPT:2,SYSTEM_BOLD:6,MORNINGBREEZE_REGULAR:7,CALISTOGA_REGULAR:8,EXO2_EXTRABOLD:9,COURIERPRIME_BOLD:10}),za=a({IMAGE:0,PDF:1}),Aa=a({UPDATE:1,UPDATE_CARD:2,LINK_CARD:3}),Ba=a({NONE:0,IMAGE:1,VIDEO:2}),Ca=a({NONE:0,IMAGE:1,VIDEO:2}),Da=a({REELS:1,SEARCH:2}),Ea=a({BING:1,GOOGLE:2}),Fa=a({FULL:1,TALL:2,COMPACT:3}),Ga=a({UNKNOWN:0,DEFAULT:1}),Ha=a({UNKNOWN:0,CHAT_SETTING:1,ACCOUNT_SETTING:2,BULK_CHANGE:3,TRIGGER_CHANGED_TO_COEX:4}),Ia=a({CHANGED_IN_CHAT:0,INITIATED_BY_ME:1,INITIATED_BY_OTHER:2,CHANGED_TO_COEX:3});a=a({UNKNOWN:0,KEEP_FOR_ALL:1,UNDO_KEEP_FOR_ALL:2});var m={},n={},o={},p={},q={},r={},s={},t={},u={},Ja={},v={},w={},x={},y={},Ka={},La={},Ma={},Na={},Oa={},Pa={},Qa={},z={},Ra={},Sa={},Ta={},Ua={},Va={},Wa={},Xa={},Ya={},A={},Za={},$a={},ab={},bb={},cb={},B={},C={},D={},E={},F={},db={},G={},H={},eb={},fb={},gb={},hb={},ib={},jb={},kb={},lb={},mb={},nb={},ob={},pb={},I={},qb={},rb={},sb={},tb={},J={},K={},ub={},L={},vb={},wb={},xb={},yb={},zb={},Ab={},M={},Bb={},Cb={},Db={},Eb={},Fb={},Gb={},Hb={},Ib={},Jb={},Kb={},Lb={},Mb={},Nb={},Ob={},Pb={},Qb={},Rb={},Sb={},Tb={},Ub={},Vb={},Wb={},N={},Xb={},Yb={},Zb={},$b={},ac={},bc={},cc={},O={},dc={},P={},Q={},R={},S={},ec={},T={},U={},V={},fc={},W={},gc={},hc={},ic={},jc={},kc={},lc={},mc={},nc={},oc={},X={},Y={},pc={},qc={},rc={},sc={},tc={},uc={},vc={},wc={},xc={},yc={},zc={},Z={},Ac={},$={},Bc={},Cc={},Dc={},Ec={};m.internalSpec={conversation:[1,(h=d("WAProtoConst")).TYPES.STRING],senderKeyDistributionMessage:[2,h.TYPES.MESSAGE,U],imageMessage:[3,h.TYPES.MESSAGE,T],contactMessage:[4,h.TYPES.MESSAGE,S],locationMessage:[5,h.TYPES.MESSAGE,R],extendedTextMessage:[6,h.TYPES.MESSAGE,Q],documentMessage:[7,h.TYPES.MESSAGE,P],audioMessage:[8,h.TYPES.MESSAGE,dc],videoMessage:[9,h.TYPES.MESSAGE,O],call:[10,h.TYPES.MESSAGE,cc],chat:[11,h.TYPES.MESSAGE,bc],protocolMessage:[12,h.TYPES.MESSAGE,$b],contactsArrayMessage:[13,h.TYPES.MESSAGE,Gb],highlyStructuredMessage:[14,h.TYPES.MESSAGE,M],fastRatchetKeySenderKeyDistributionMessage:[15,h.TYPES.MESSAGE,U],sendPaymentMessage:[16,h.TYPES.MESSAGE,Ab],liveLocationMessage:[18,h.TYPES.MESSAGE,vb],requestPaymentMessage:[22,h.TYPES.MESSAGE,zb],declinePaymentRequestMessage:[23,h.TYPES.MESSAGE,yb],cancelPaymentRequestMessage:[24,h.TYPES.MESSAGE,xb],templateMessage:[25,h.TYPES.MESSAGE,J],stickerMessage:[26,h.TYPES.MESSAGE,L],groupInviteMessage:[28,h.TYPES.MESSAGE,bb],templateButtonReplyMessage:[29,h.TYPES.MESSAGE,tb],productMessage:[30,h.TYPES.MESSAGE,qb],deviceSentMessage:[31,h.TYPES.MESSAGE,Za],messageContextInfo:[35,h.TYPES.MESSAGE,oc],listMessage:[36,h.TYPES.MESSAGE,jb],viewOnceMessage:[37,h.TYPES.MESSAGE,A],orderMessage:[38,h.TYPES.MESSAGE,I],listResponseMessage:[39,h.TYPES.MESSAGE,hb],ephemeralMessage:[40,h.TYPES.MESSAGE,A],invoiceMessage:[41,h.TYPES.MESSAGE,ec],buttonsMessage:[42,h.TYPES.MESSAGE,Va],buttonsResponseMessage:[43,h.TYPES.MESSAGE,Ua],paymentInviteMessage:[44,h.TYPES.MESSAGE,wb],interactiveMessage:[45,h.TYPES.MESSAGE,D],reactionMessage:[46,h.TYPES.MESSAGE,Ta],stickerSyncRmrMessage:[47,h.TYPES.MESSAGE,Sa],interactiveResponseMessage:[48,h.TYPES.MESSAGE,cb],pollCreationMessage:[49,h.TYPES.MESSAGE,z],pollUpdateMessage:[50,h.TYPES.MESSAGE,Qa],keepInChatMessage:[51,h.TYPES.MESSAGE,Ma],documentWithCaptionMessage:[53,h.TYPES.MESSAGE,A],requestPhoneNumberMessage:[54,h.TYPES.MESSAGE,$a],viewOnceMessageV2:[55,h.TYPES.MESSAGE,A],encReactionMessage:[56,h.TYPES.MESSAGE,Ka],editedMessage:[58,h.TYPES.MESSAGE,A],viewOnceMessageV2Extension:[59,h.TYPES.MESSAGE,A],pollCreationMessageV2:[60,h.TYPES.MESSAGE,z],scheduledCallCreationMessage:[61,h.TYPES.MESSAGE,u],groupMentionedMessage:[62,h.TYPES.MESSAGE,A],pinInChatMessage:[63,h.TYPES.MESSAGE,La],pollCreationMessageV3:[64,h.TYPES.MESSAGE,z],scheduledCallEditMessage:[65,h.TYPES.MESSAGE,t],ptvMessage:[66,h.TYPES.MESSAGE,O],botInvokeMessage:[67,h.TYPES.MESSAGE,A],callLogMesssage:[69,h.TYPES.MESSAGE,r],messageHistoryBundle:[70,h.TYPES.MESSAGE,q],encCommentMessage:[71,h.TYPES.MESSAGE,y],bcallMessage:[72,h.TYPES.MESSAGE,p],lottieStickerMessage:[74,h.TYPES.MESSAGE,A],eventMessage:[75,h.TYPES.MESSAGE,w],encEventResponseMessage:[76,h.TYPES.MESSAGE,v],commentMessage:[77,h.TYPES.MESSAGE,x],newsletterAdminInviteMessage:[78,h.TYPES.MESSAGE,ab],extendedTextMessageWithParentKey:[79,h.TYPES.MESSAGE,o],placeholderMessage:[80,h.TYPES.MESSAGE,n]};n.internalSpec={type:[1,h.TYPES.ENUM,c]};o.internalSpec={key:[1,h.TYPES.MESSAGE,(i=d("WAProtocol.pb")).MessageKeySpec],linkMessage:[2,h.TYPES.MESSAGE,Q]};p.internalSpec={sessionId:[1,h.TYPES.STRING],mediaType:[2,h.TYPES.ENUM,e],masterKey:[3,h.TYPES.BYTES],caption:[4,h.TYPES.STRING]};q.internalSpec={mimetype:[2,h.TYPES.STRING],fileSha256:[3,h.TYPES.BYTES],mediaKey:[5,h.TYPES.BYTES],fileEncSha256:[6,h.TYPES.BYTES],directPath:[7,h.TYPES.STRING],mediaKeyTimestamp:[8,h.TYPES.INT64],contextInfo:[9,h.TYPES.MESSAGE,V],participants:[10,h.FLAGS.REPEATED|h.TYPES.STRING]};r.internalSpec={isVideo:[1,h.TYPES.BOOL],callOutcome:[2,h.TYPES.ENUM,f],durationSecs:[3,h.TYPES.INT64],callType:[4,h.TYPES.ENUM,b],participants:[5,h.FLAGS.REPEATED|h.TYPES.MESSAGE,s]};s.internalSpec={jid:[1,h.TYPES.STRING],callOutcome:[2,h.TYPES.ENUM,f]};t.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec],editType:[2,h.TYPES.ENUM,aa]};u.internalSpec={scheduledTimestampMs:[1,h.TYPES.INT64],callType:[2,h.TYPES.ENUM,ba],title:[3,h.TYPES.STRING]};Ja.internalSpec={response:[1,h.TYPES.ENUM,ca],timestampMs:[2,h.TYPES.INT64]};v.internalSpec={eventCreationMessageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],encPayload:[2,h.TYPES.BYTES],encIv:[3,h.TYPES.BYTES]};w.internalSpec={contextInfo:[1,h.TYPES.MESSAGE,V],isCanceled:[2,h.TYPES.BOOL],name:[3,h.TYPES.STRING],description:[4,h.TYPES.STRING],location:[5,h.TYPES.MESSAGE,R],joinLink:[6,h.TYPES.STRING],startTime:[7,h.TYPES.INT64]};x.internalSpec={message:[1,h.TYPES.MESSAGE,m],targetMessageKey:[2,h.TYPES.MESSAGE,i.MessageKeySpec]};y.internalSpec={targetMessageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],encPayload:[2,h.TYPES.BYTES],encIv:[3,h.TYPES.BYTES]};Ka.internalSpec={targetMessageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],encPayload:[2,h.TYPES.BYTES],encIv:[3,h.TYPES.BYTES]};La.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec],type:[2,h.TYPES.ENUM,da],senderTimestampMs:[3,h.TYPES.INT64]};Ma.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec],keepType:[2,h.TYPES.ENUM,a],timestampMs:[3,h.TYPES.INT64]};Na.internalSpec={selectedOptions:[1,h.FLAGS.REPEATED|h.TYPES.BYTES]};Oa.internalSpec={encPayload:[1,h.TYPES.BYTES],encIv:[2,h.TYPES.BYTES]};Pa.internalSpec={};Qa.internalSpec={pollCreationMessageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],vote:[2,h.TYPES.MESSAGE,Oa],metadata:[3,h.TYPES.MESSAGE,Pa],senderTimestampMs:[4,h.TYPES.INT64]};z.internalSpec={encKey:[1,h.TYPES.BYTES],name:[2,h.TYPES.STRING],options:[3,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Ra],selectableOptionsCount:[4,h.TYPES.UINT32],contextInfo:[5,h.TYPES.MESSAGE,V]};Ra.internalSpec={optionName:[1,h.TYPES.STRING]};Sa.internalSpec={filehash:[1,h.FLAGS.REPEATED|h.TYPES.STRING],rmrSource:[2,h.TYPES.STRING],requestTimestamp:[3,h.TYPES.INT64]};Ta.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec],text:[2,h.TYPES.STRING],groupingKey:[3,h.TYPES.STRING],senderTimestampMs:[4,h.TYPES.INT64]};Ua.internalSpec={selectedButtonId:[1,h.TYPES.STRING],selectedDisplayText:[2,h.TYPES.STRING],contextInfo:[3,h.TYPES.MESSAGE,V],type:[4,h.TYPES.ENUM,ea],__oneofs__:{response:["selectedDisplayText"]}};Va.internalSpec={text:[1,h.TYPES.STRING],documentMessage:[2,h.TYPES.MESSAGE,P],imageMessage:[3,h.TYPES.MESSAGE,T],videoMessage:[4,h.TYPES.MESSAGE,O],locationMessage:[5,h.TYPES.MESSAGE,R],contentText:[6,h.TYPES.STRING],footerText:[7,h.TYPES.STRING],contextInfo:[8,h.TYPES.MESSAGE,V],buttons:[9,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Wa],headerType:[10,h.TYPES.ENUM,ga],__oneofs__:{header:["text","documentMessage","imageMessage","videoMessage","locationMessage"]}};Wa.internalSpec={buttonId:[1,h.TYPES.STRING],buttonText:[2,h.TYPES.MESSAGE,Ya],type:[3,h.TYPES.ENUM,fa],nativeFlowInfo:[4,h.TYPES.MESSAGE,Xa]};Xa.internalSpec={name:[1,h.TYPES.STRING],paramsJson:[2,h.TYPES.STRING]};Ya.internalSpec={displayText:[1,h.TYPES.STRING]};A.internalSpec={message:[1,h.TYPES.MESSAGE,m]};Za.internalSpec={destinationJid:[1,h.TYPES.STRING],message:[2,h.TYPES.MESSAGE,m],phash:[3,h.TYPES.STRING]};$a.internalSpec={contextInfo:[1,h.TYPES.MESSAGE,V]};ab.internalSpec={newsletterJid:[1,h.TYPES.STRING],newsletterName:[2,h.TYPES.STRING],jpegThumbnail:[3,h.TYPES.BYTES],caption:[4,h.TYPES.STRING],inviteExpiration:[5,h.TYPES.INT64]};bb.internalSpec={groupJid:[1,h.TYPES.STRING],inviteCode:[2,h.TYPES.STRING],inviteExpiration:[3,h.TYPES.INT64],groupName:[4,h.TYPES.STRING],jpegThumbnail:[5,h.TYPES.BYTES],caption:[6,h.TYPES.STRING],contextInfo:[7,h.TYPES.MESSAGE,V],groupType:[8,h.TYPES.ENUM,ha]};cb.internalSpec={body:[1,h.TYPES.MESSAGE,C],nativeFlowResponseMessage:[2,h.TYPES.MESSAGE,B],contextInfo:[15,h.TYPES.MESSAGE,V],__oneofs__:{interactiveResponseMessage:["nativeFlowResponseMessage"]}};B.internalDefaults={version:1};B.internalSpec={name:[1,h.TYPES.STRING],paramsJson:[2,h.TYPES.STRING],version:[3,h.TYPES.INT32]};C.internalDefaults={format:j.DEFAULT};C.internalSpec={text:[1,h.TYPES.STRING],format:[2,h.TYPES.ENUM,j]};D.internalSpec={header:[1,h.TYPES.MESSAGE,gb],body:[2,h.TYPES.MESSAGE,fb],footer:[3,h.TYPES.MESSAGE,eb],shopStorefrontMessage:[4,h.TYPES.MESSAGE,H],collectionMessage:[5,h.TYPES.MESSAGE,G],nativeFlowMessage:[6,h.TYPES.MESSAGE,F],carouselMessage:[7,h.TYPES.MESSAGE,E],contextInfo:[15,h.TYPES.MESSAGE,V],__oneofs__:{interactiveMessage:["shopStorefrontMessage","collectionMessage","nativeFlowMessage","carouselMessage"]}};E.internalDefaults={messageVersion:1};E.internalSpec={cards:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,D],messageVersion:[2,h.TYPES.INT32]};F.internalDefaults={messageVersion:1};F.internalSpec={buttons:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,db],messageParamsJson:[2,h.TYPES.STRING],messageVersion:[3,h.TYPES.INT32]};db.internalSpec={name:[1,h.TYPES.STRING],buttonParamsJson:[2,h.TYPES.STRING]};G.internalDefaults={messageVersion:1};G.internalSpec={bizJid:[1,h.TYPES.STRING],id:[2,h.TYPES.STRING],messageVersion:[3,h.TYPES.INT32]};H.internalDefaults={messageVersion:1};H.internalSpec={id:[1,h.TYPES.STRING],surface:[2,h.TYPES.ENUM,ia],messageVersion:[3,h.TYPES.INT32]};eb.internalSpec={text:[1,h.TYPES.STRING]};fb.internalSpec={text:[1,h.TYPES.STRING]};gb.internalSpec={title:[1,h.TYPES.STRING],subtitle:[2,h.TYPES.STRING],documentMessage:[3,h.TYPES.MESSAGE,P],imageMessage:[4,h.TYPES.MESSAGE,T],jpegThumbnail:[6,h.TYPES.BYTES],videoMessage:[7,h.TYPES.MESSAGE,O],locationMessage:[8,h.TYPES.MESSAGE,R],hasMediaAttachment:[5,h.TYPES.BOOL],__oneofs__:{media:["documentMessage","imageMessage","jpegThumbnail","videoMessage","locationMessage"]}};hb.internalSpec={title:[1,h.TYPES.STRING],listType:[2,h.TYPES.ENUM,ja],singleSelectReply:[3,h.TYPES.MESSAGE,ib],contextInfo:[4,h.TYPES.MESSAGE,V],description:[5,h.TYPES.STRING]};ib.internalSpec={selectedRowId:[1,h.TYPES.STRING]};jb.internalSpec={title:[1,h.TYPES.STRING],description:[2,h.TYPES.STRING],buttonText:[3,h.TYPES.STRING],listType:[4,h.TYPES.ENUM,ka],sections:[5,h.FLAGS.REPEATED|h.TYPES.MESSAGE,ob],productListInfo:[6,h.TYPES.MESSAGE,kb],footerText:[7,h.TYPES.STRING],contextInfo:[8,h.TYPES.MESSAGE,V]};kb.internalSpec={productSections:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,mb],headerImage:[2,h.TYPES.MESSAGE,lb],businessOwnerJid:[3,h.TYPES.STRING]};lb.internalSpec={productId:[1,h.TYPES.STRING],jpegThumbnail:[2,h.TYPES.BYTES]};mb.internalSpec={title:[1,h.TYPES.STRING],products:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,nb]};nb.internalSpec={productId:[1,h.TYPES.STRING]};ob.internalSpec={title:[1,h.TYPES.STRING],rows:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,pb]};pb.internalSpec={title:[1,h.TYPES.STRING],description:[2,h.TYPES.STRING],rowId:[3,h.TYPES.STRING]};I.internalDefaults={messageVersion:1};I.internalSpec={orderId:[1,h.TYPES.STRING],thumbnail:[2,h.TYPES.BYTES],itemCount:[3,h.TYPES.INT32],status:[4,h.TYPES.ENUM,ma],surface:[5,h.TYPES.ENUM,la],message:[6,h.TYPES.STRING],orderTitle:[7,h.TYPES.STRING],sellerJid:[8,h.TYPES.STRING],token:[9,h.TYPES.STRING],totalAmount1000:[10,h.TYPES.INT64],totalCurrencyCode:[11,h.TYPES.STRING],contextInfo:[17,h.TYPES.MESSAGE,V],messageVersion:[12,h.TYPES.INT32],orderRequestMessageId:[13,h.TYPES.MESSAGE,i.MessageKeySpec]};qb.internalSpec={product:[1,h.TYPES.MESSAGE,rb],businessOwnerJid:[2,h.TYPES.STRING],catalog:[4,h.TYPES.MESSAGE,sb],body:[5,h.TYPES.STRING],footer:[6,h.TYPES.STRING],contextInfo:[17,h.TYPES.MESSAGE,V]};rb.internalSpec={productImage:[1,h.TYPES.MESSAGE,T],productId:[2,h.TYPES.STRING],title:[3,h.TYPES.STRING],description:[4,h.TYPES.STRING],currencyCode:[5,h.TYPES.STRING],priceAmount1000:[6,h.TYPES.INT64],retailerId:[7,h.TYPES.STRING],url:[8,h.TYPES.STRING],productImageCount:[9,h.TYPES.UINT32],firstImageId:[11,h.TYPES.STRING],salePriceAmount1000:[12,h.TYPES.INT64]};sb.internalSpec={catalogImage:[1,h.TYPES.MESSAGE,T],title:[2,h.TYPES.STRING],description:[3,h.TYPES.STRING]};tb.internalSpec={selectedId:[1,h.TYPES.STRING],selectedDisplayText:[2,h.TYPES.STRING],contextInfo:[3,h.TYPES.MESSAGE,V],selectedIndex:[4,h.TYPES.UINT32],selectedCarouselCardIndex:[5,h.TYPES.UINT32]};J.internalSpec={fourRowTemplate:[1,h.TYPES.MESSAGE,ub],hydratedFourRowTemplate:[2,h.TYPES.MESSAGE,K],interactiveMessageTemplate:[5,h.TYPES.MESSAGE,D],contextInfo:[3,h.TYPES.MESSAGE,V],hydratedTemplate:[4,h.TYPES.MESSAGE,K],templateId:[9,h.TYPES.STRING],__oneofs__:{format:["fourRowTemplate","hydratedFourRowTemplate","interactiveMessageTemplate"]}};K.internalSpec={documentMessage:[1,h.TYPES.MESSAGE,P],hydratedTitleText:[2,h.TYPES.STRING],imageMessage:[3,h.TYPES.MESSAGE,T],videoMessage:[4,h.TYPES.MESSAGE,O],locationMessage:[5,h.TYPES.MESSAGE,R],hydratedContentText:[6,h.TYPES.STRING],hydratedFooterText:[7,h.TYPES.STRING],hydratedButtons:[8,h.FLAGS.REPEATED|h.TYPES.MESSAGE,vc],templateId:[9,h.TYPES.STRING],maskLinkedDevices:[10,h.TYPES.BOOL],__oneofs__:{title:["documentMessage","hydratedTitleText","imageMessage","videoMessage","locationMessage"]}};ub.internalSpec={documentMessage:[1,h.TYPES.MESSAGE,P],highlyStructuredMessage:[2,h.TYPES.MESSAGE,M],imageMessage:[3,h.TYPES.MESSAGE,T],videoMessage:[4,h.TYPES.MESSAGE,O],locationMessage:[5,h.TYPES.MESSAGE,R],content:[6,h.TYPES.MESSAGE,M],footer:[7,h.TYPES.MESSAGE,M],buttons:[8,h.FLAGS.REPEATED|h.TYPES.MESSAGE,rc],__oneofs__:{title:["documentMessage","highlyStructuredMessage","imageMessage","videoMessage","locationMessage"]}};L.internalSpec={url:[1,h.TYPES.STRING],fileSha256:[2,h.TYPES.BYTES],fileEncSha256:[3,h.TYPES.BYTES],mediaKey:[4,h.TYPES.BYTES],mimetype:[5,h.TYPES.STRING],height:[6,h.TYPES.UINT32],width:[7,h.TYPES.UINT32],directPath:[8,h.TYPES.STRING],fileLength:[9,h.TYPES.UINT64],mediaKeyTimestamp:[10,h.TYPES.INT64],firstFrameLength:[11,h.TYPES.UINT32],firstFrameSidecar:[12,h.TYPES.BYTES],isAnimated:[13,h.TYPES.BOOL],pngThumbnail:[16,h.TYPES.BYTES],contextInfo:[17,h.TYPES.MESSAGE,V],stickerSentTs:[18,h.TYPES.INT64],isAvatar:[19,h.TYPES.BOOL],isAiSticker:[20,h.TYPES.BOOL],isLottie:[21,h.TYPES.BOOL]};vb.internalSpec={degreesLatitude:[1,h.TYPES.DOUBLE],degreesLongitude:[2,h.TYPES.DOUBLE],accuracyInMeters:[3,h.TYPES.UINT32],speedInMps:[4,h.TYPES.FLOAT],degreesClockwiseFromMagneticNorth:[5,h.TYPES.UINT32],caption:[6,h.TYPES.STRING],sequenceNumber:[7,h.TYPES.INT64],timeOffset:[8,h.TYPES.UINT32],jpegThumbnail:[16,h.TYPES.BYTES],contextInfo:[17,h.TYPES.MESSAGE,V]};wb.internalSpec={serviceType:[1,h.TYPES.ENUM,na],expiryTimestamp:[2,h.TYPES.INT64]};xb.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec]};yb.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec]};zb.internalSpec={noteMessage:[4,h.TYPES.MESSAGE,m],currencyCodeIso4217:[1,h.TYPES.STRING],amount1000:[2,h.TYPES.UINT64],requestFrom:[3,h.TYPES.STRING],expiryTimestamp:[5,h.TYPES.INT64],amount:[6,h.TYPES.MESSAGE,zc],background:[7,h.TYPES.MESSAGE,Z]};Ab.internalSpec={noteMessage:[2,h.TYPES.MESSAGE,m],requestMessageKey:[3,h.TYPES.MESSAGE,i.MessageKeySpec],background:[4,h.TYPES.MESSAGE,Z]};M.internalSpec={namespace:[1,h.TYPES.STRING],elementName:[2,h.TYPES.STRING],params:[3,h.FLAGS.REPEATED|h.TYPES.STRING],fallbackLg:[4,h.TYPES.STRING],fallbackLc:[5,h.TYPES.STRING],localizableParams:[6,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Bb],deterministicLg:[7,h.TYPES.STRING],deterministicLc:[8,h.TYPES.STRING],hydratedHsm:[9,h.TYPES.MESSAGE,J]};Bb.internalSpec={"default":[1,h.TYPES.STRING],currency:[2,h.TYPES.MESSAGE,Fb],dateTime:[3,h.TYPES.MESSAGE,Cb],__oneofs__:{paramOneof:["currency","dateTime"]}};Cb.internalSpec={component:[1,h.TYPES.MESSAGE,Eb],unixEpoch:[2,h.TYPES.MESSAGE,Db],__oneofs__:{datetimeOneof:["component","unixEpoch"]}};Db.internalSpec={timestamp:[1,h.TYPES.INT64]};Eb.internalSpec={dayOfWeek:[1,h.TYPES.ENUM,pa],year:[2,h.TYPES.UINT32],month:[3,h.TYPES.UINT32],dayOfMonth:[4,h.TYPES.UINT32],hour:[5,h.TYPES.UINT32],minute:[6,h.TYPES.UINT32],calendar:[7,h.TYPES.ENUM,oa]};Fb.internalSpec={currencyCode:[1,h.TYPES.STRING],amount1000:[2,h.TYPES.INT64]};Gb.internalSpec={displayName:[1,h.TYPES.STRING],contacts:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,S],contextInfo:[17,h.TYPES.MESSAGE,V]};Hb.internalSpec={securityNotificationEnabled:[1,h.TYPES.BOOL]};Ib.internalSpec={peerDataOperationRequestType:[1,h.TYPES.ENUM,k],stanzaId:[2,h.TYPES.STRING],peerDataOperationResult:[3,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Jb]};Jb.internalSpec={mediaUploadResult:[1,h.TYPES.ENUM,d("WAMmsRetry.pb").MediaRetryNotification$ResultType],stickerMessage:[2,h.TYPES.MESSAGE,L],linkPreviewResponse:[3,h.TYPES.MESSAGE,Lb],placeholderMessageResendResponse:[4,h.TYPES.MESSAGE,Kb]};Kb.internalSpec={webMessageInfoBytes:[1,h.TYPES.BYTES]};Lb.internalSpec={url:[1,h.TYPES.STRING],title:[2,h.TYPES.STRING],description:[3,h.TYPES.STRING],thumbData:[4,h.TYPES.BYTES],canonicalUrl:[5,h.TYPES.STRING],matchText:[6,h.TYPES.STRING],previewType:[7,h.TYPES.STRING],hqThumbnail:[8,h.TYPES.MESSAGE,Mb]};Mb.internalSpec={directPath:[1,h.TYPES.STRING],thumbHash:[2,h.TYPES.STRING],encThumbHash:[3,h.TYPES.STRING],mediaKey:[4,h.TYPES.BYTES],mediaKeyTimestampMs:[5,h.TYPES.INT64],thumbWidth:[6,h.TYPES.INT32],thumbHeight:[7,h.TYPES.INT32]};Nb.internalSpec={peerDataOperationRequestType:[1,h.TYPES.ENUM,k],requestStickerReupload:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Rb],requestUrlPreview:[3,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Qb],historySyncOnDemandRequest:[4,h.TYPES.MESSAGE,Pb],placeholderMessageResendRequest:[5,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Ob]};Ob.internalSpec={messageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec]};Pb.internalSpec={chatJid:[1,h.TYPES.STRING],oldestMsgId:[2,h.TYPES.STRING],oldestMsgFromMe:[3,h.TYPES.BOOL],onDemandMsgCount:[4,h.TYPES.INT32],oldestMsgTimestampMs:[5,h.TYPES.INT64]};Qb.internalSpec={url:[1,h.TYPES.STRING],includeHqThumbnail:[2,h.TYPES.BOOL]};Rb.internalSpec={fileSha256:[1,h.TYPES.STRING]};Sb.internalSpec={collectionNames:[1,h.FLAGS.REPEATED|h.TYPES.STRING],timestamp:[2,h.TYPES.INT64]};Tb.internalSpec={keyIds:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,N]};Ub.internalSpec={keys:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Xb]};Vb.internalSpec={keyData:[1,h.TYPES.BYTES],fingerprint:[2,h.TYPES.MESSAGE,Wb],timestamp:[3,h.TYPES.INT64]};Wb.internalSpec={rawId:[1,h.TYPES.UINT32],currentIndex:[2,h.TYPES.UINT32],deviceIndexes:[3,h.FLAGS.REPEATED|h.FLAGS.PACKED|h.TYPES.UINT32]};N.internalSpec={keyId:[1,h.TYPES.BYTES]};Xb.internalSpec={keyId:[1,h.TYPES.MESSAGE,N],keyData:[2,h.TYPES.MESSAGE,Vb]};Yb.internalSpec={fileSha256:[1,h.TYPES.BYTES],fileLength:[2,h.TYPES.UINT64],mediaKey:[3,h.TYPES.BYTES],fileEncSha256:[4,h.TYPES.BYTES],directPath:[5,h.TYPES.STRING],syncType:[6,h.TYPES.ENUM,qa],chunkOrder:[7,h.TYPES.UINT32],originalMessageId:[8,h.TYPES.STRING],progress:[9,h.TYPES.UINT32],oldestMsgInChunkTimestampSec:[10,h.TYPES.INT64],initialHistBootstrapInlinePayload:[11,h.TYPES.BYTES],peerDataRequestSessionId:[12,h.TYPES.STRING]};Zb.internalSpec={localChatState:[1,h.TYPES.ENUM,ra]};$b.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec],type:[2,h.TYPES.ENUM,sa],ephemeralExpiration:[4,h.TYPES.UINT32],ephemeralSettingTimestamp:[5,h.TYPES.INT64],historySyncNotification:[6,h.TYPES.MESSAGE,Yb],appStateSyncKeyShare:[7,h.TYPES.MESSAGE,Ub],appStateSyncKeyRequest:[8,h.TYPES.MESSAGE,Tb],initialSecurityNotificationSettingSync:[9,h.TYPES.MESSAGE,Hb],appStateFatalExceptionNotification:[10,h.TYPES.MESSAGE,Sb],disappearingMode:[11,h.TYPES.MESSAGE,$],editedMessage:[14,h.TYPES.MESSAGE,m],timestampMs:[15,h.TYPES.INT64],peerDataOperationRequestMessage:[16,h.TYPES.MESSAGE,Nb],peerDataOperationRequestResponseMessage:[17,h.TYPES.MESSAGE,Ib],botFeedbackMessage:[18,h.TYPES.MESSAGE,ac],invokerJid:[19,h.TYPES.STRING],requestWelcomeMessageMetadata:[20,h.TYPES.MESSAGE,Zb],mediaNotifyMessage:[21,h.TYPES.MESSAGE,Ec]};ac.internalSpec={messageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],kind:[2,h.TYPES.ENUM,va],text:[3,h.TYPES.STRING],kindNegative:[4,h.TYPES.UINT64],kindPositive:[5,h.TYPES.UINT64]};bc.internalSpec={displayName:[1,h.TYPES.STRING],id:[2,h.TYPES.STRING]};cc.internalSpec={callKey:[1,h.TYPES.BYTES],conversionSource:[2,h.TYPES.STRING],conversionData:[3,h.TYPES.BYTES],conversionDelaySeconds:[4,h.TYPES.UINT32]};O.internalSpec={url:[1,h.TYPES.STRING],mimetype:[2,h.TYPES.STRING],fileSha256:[3,h.TYPES.BYTES],fileLength:[4,h.TYPES.UINT64],seconds:[5,h.TYPES.UINT32],mediaKey:[6,h.TYPES.BYTES],caption:[7,h.TYPES.STRING],gifPlayback:[8,h.TYPES.BOOL],height:[9,h.TYPES.UINT32],width:[10,h.TYPES.UINT32],fileEncSha256:[11,h.TYPES.BYTES],interactiveAnnotations:[12,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Y],directPath:[13,h.TYPES.STRING],mediaKeyTimestamp:[14,h.TYPES.INT64],jpegThumbnail:[16,h.TYPES.BYTES],contextInfo:[17,h.TYPES.MESSAGE,V],streamingSidecar:[18,h.TYPES.BYTES],gifAttribution:[19,h.TYPES.ENUM,wa],viewOnce:[20,h.TYPES.BOOL],thumbnailDirectPath:[21,h.TYPES.STRING],thumbnailSha256:[22,h.TYPES.BYTES],thumbnailEncSha256:[23,h.TYPES.BYTES],staticUrl:[24,h.TYPES.STRING],annotations:[25,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Y]};dc.internalSpec={url:[1,h.TYPES.STRING],mimetype:[2,h.TYPES.STRING],fileSha256:[3,h.TYPES.BYTES],fileLength:[4,h.TYPES.UINT64],seconds:[5,h.TYPES.UINT32],ptt:[6,h.TYPES.BOOL],mediaKey:[7,h.TYPES.BYTES],fileEncSha256:[8,h.TYPES.BYTES],directPath:[9,h.TYPES.STRING],mediaKeyTimestamp:[10,h.TYPES.INT64],contextInfo:[17,h.TYPES.MESSAGE,V],streamingSidecar:[18,h.TYPES.BYTES],waveform:[19,h.TYPES.BYTES],backgroundArgb:[20,h.TYPES.FIXED32],viewOnce:[21,h.TYPES.BOOL]};P.internalSpec={url:[1,h.TYPES.STRING],mimetype:[2,h.TYPES.STRING],title:[3,h.TYPES.STRING],fileSha256:[4,h.TYPES.BYTES],fileLength:[5,h.TYPES.UINT64],pageCount:[6,h.TYPES.UINT32],mediaKey:[7,h.TYPES.BYTES],fileName:[8,h.TYPES.STRING],fileEncSha256:[9,h.TYPES.BYTES],directPath:[10,h.TYPES.STRING],mediaKeyTimestamp:[11,h.TYPES.INT64],contactVcard:[12,h.TYPES.BOOL],thumbnailDirectPath:[13,h.TYPES.STRING],thumbnailSha256:[14,h.TYPES.BYTES],thumbnailEncSha256:[15,h.TYPES.BYTES],jpegThumbnail:[16,h.TYPES.BYTES],contextInfo:[17,h.TYPES.MESSAGE,V],thumbnailHeight:[18,h.TYPES.UINT32],thumbnailWidth:[19,h.TYPES.UINT32],caption:[20,h.TYPES.STRING]};Q.internalSpec={text:[1,h.TYPES.STRING],matchedText:[2,h.TYPES.STRING],canonicalUrl:[4,h.TYPES.STRING],description:[5,h.TYPES.STRING],title:[6,h.TYPES.STRING],textArgb:[7,h.TYPES.FIXED32],backgroundArgb:[8,h.TYPES.FIXED32],font:[9,h.TYPES.ENUM,ya],previewType:[10,h.TYPES.ENUM,xa],jpegThumbnail:[16,h.TYPES.BYTES],contextInfo:[17,h.TYPES.MESSAGE,V],doNotPlayInline:[18,h.TYPES.BOOL],thumbnailDirectPath:[19,h.TYPES.STRING],thumbnailSha256:[20,h.TYPES.BYTES],thumbnailEncSha256:[21,h.TYPES.BYTES],mediaKey:[22,h.TYPES.BYTES],mediaKeyTimestamp:[23,h.TYPES.INT64],thumbnailHeight:[24,h.TYPES.UINT32],thumbnailWidth:[25,h.TYPES.UINT32],inviteLinkGroupType:[26,h.TYPES.ENUM,l],inviteLinkParentGroupSubjectV2:[27,h.TYPES.STRING],inviteLinkParentGroupThumbnailV2:[28,h.TYPES.BYTES],inviteLinkGroupTypeV2:[29,h.TYPES.ENUM,l],viewOnce:[30,h.TYPES.BOOL]};R.internalSpec={degreesLatitude:[1,h.TYPES.DOUBLE],degreesLongitude:[2,h.TYPES.DOUBLE],name:[3,h.TYPES.STRING],address:[4,h.TYPES.STRING],url:[5,h.TYPES.STRING],isLive:[6,h.TYPES.BOOL],accuracyInMeters:[7,h.TYPES.UINT32],speedInMps:[8,h.TYPES.FLOAT],degreesClockwiseFromMagneticNorth:[9,h.TYPES.UINT32],comment:[11,h.TYPES.STRING],jpegThumbnail:[16,h.TYPES.BYTES],contextInfo:[17,h.TYPES.MESSAGE,V]};S.internalSpec={displayName:[1,h.TYPES.STRING],vcard:[16,h.TYPES.STRING],contextInfo:[17,h.TYPES.MESSAGE,V]};ec.internalSpec={note:[1,h.TYPES.STRING],token:[2,h.TYPES.STRING],attachmentType:[3,h.TYPES.ENUM,za],attachmentMimetype:[4,h.TYPES.STRING],attachmentMediaKey:[5,h.TYPES.BYTES],attachmentMediaKeyTimestamp:[6,h.TYPES.INT64],attachmentFileSha256:[7,h.TYPES.BYTES],attachmentFileEncSha256:[8,h.TYPES.BYTES],attachmentDirectPath:[9,h.TYPES.STRING],attachmentJpegThumbnail:[10,h.TYPES.BYTES]};T.internalSpec={url:[1,h.TYPES.STRING],mimetype:[2,h.TYPES.STRING],caption:[3,h.TYPES.STRING],fileSha256:[4,h.TYPES.BYTES],fileLength:[5,h.TYPES.UINT64],height:[6,h.TYPES.UINT32],width:[7,h.TYPES.UINT32],mediaKey:[8,h.TYPES.BYTES],fileEncSha256:[9,h.TYPES.BYTES],interactiveAnnotations:[10,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Y],directPath:[11,h.TYPES.STRING],mediaKeyTimestamp:[12,h.TYPES.INT64],jpegThumbnail:[16,h.TYPES.BYTES],contextInfo:[17,h.TYPES.MESSAGE,V],firstScanSidecar:[18,h.TYPES.BYTES],firstScanLength:[19,h.TYPES.UINT32],experimentGroupId:[20,h.TYPES.UINT32],scansSidecar:[21,h.TYPES.BYTES],scanLengths:[22,h.FLAGS.REPEATED|h.TYPES.UINT32],midQualityFileSha256:[23,h.TYPES.BYTES],midQualityFileEncSha256:[24,h.TYPES.BYTES],viewOnce:[25,h.TYPES.BOOL],thumbnailDirectPath:[26,h.TYPES.STRING],thumbnailSha256:[27,h.TYPES.BYTES],thumbnailEncSha256:[28,h.TYPES.BYTES],staticUrl:[29,h.TYPES.STRING],annotations:[30,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Y]};U.internalSpec={groupId:[1,h.TYPES.STRING],axolotlSenderKeyDistributionMessage:[2,h.TYPES.BYTES]};V.internalSpec={stanzaId:[1,h.TYPES.STRING],participant:[2,h.TYPES.STRING],quotedMessage:[3,h.TYPES.MESSAGE,m],remoteJid:[4,h.TYPES.STRING],mentionedJid:[15,h.FLAGS.REPEATED|h.TYPES.STRING],conversionSource:[18,h.TYPES.STRING],conversionData:[19,h.TYPES.BYTES],conversionDelaySeconds:[20,h.TYPES.UINT32],forwardingScore:[21,h.TYPES.UINT32],isForwarded:[22,h.TYPES.BOOL],quotedAd:[23,h.TYPES.MESSAGE,ic],placeholderKey:[24,h.TYPES.MESSAGE,i.MessageKeySpec],expiration:[25,h.TYPES.UINT32],ephemeralSettingTimestamp:[26,h.TYPES.INT64],ephemeralSharedSecret:[27,h.TYPES.BYTES],externalAdReply:[28,h.TYPES.MESSAGE,hc],entryPointConversionSource:[29,h.TYPES.STRING],entryPointConversionApp:[30,h.TYPES.STRING],entryPointConversionDelaySeconds:[31,h.TYPES.UINT32],disappearingMode:[32,h.TYPES.MESSAGE,$],actionLink:[33,h.TYPES.MESSAGE,Bc],groupSubject:[34,h.TYPES.STRING],parentGroupJid:[35,h.TYPES.STRING],trustBannerType:[37,h.TYPES.STRING],trustBannerAction:[38,h.TYPES.UINT32],isSampled:[39,h.TYPES.BOOL],groupMentions:[40,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Cc],utm:[41,h.TYPES.MESSAGE,gc],forwardedNewsletterMessageInfo:[43,h.TYPES.MESSAGE,W],businessMessageForwardInfo:[44,h.TYPES.MESSAGE,jc],smbClientCampaignId:[45,h.TYPES.STRING],smbServerCampaignId:[46,h.TYPES.STRING],dataSharingContext:[47,h.TYPES.MESSAGE,fc]};fc.internalSpec={showMmDisclosure:[1,h.TYPES.BOOL]};W.internalSpec={newsletterJid:[1,h.TYPES.STRING],serverMessageId:[2,h.TYPES.INT32],newsletterName:[3,h.TYPES.STRING],contentType:[4,h.TYPES.ENUM,Aa],accessibilityText:[5,h.TYPES.STRING]};gc.internalSpec={utmSource:[1,h.TYPES.STRING],utmCampaign:[2,h.TYPES.STRING]};hc.internalSpec={title:[1,h.TYPES.STRING],body:[2,h.TYPES.STRING],mediaType:[3,h.TYPES.ENUM,Ba],thumbnailUrl:[4,h.TYPES.STRING],mediaUrl:[5,h.TYPES.STRING],thumbnail:[6,h.TYPES.BYTES],sourceType:[7,h.TYPES.STRING],sourceId:[8,h.TYPES.STRING],sourceUrl:[9,h.TYPES.STRING],containsAutoReply:[10,h.TYPES.BOOL],renderLargerThumbnail:[11,h.TYPES.BOOL],showAdAttribution:[12,h.TYPES.BOOL],ctwaClid:[13,h.TYPES.STRING],ref:[14,h.TYPES.STRING]};ic.internalSpec={advertiserName:[1,h.TYPES.STRING],mediaType:[2,h.TYPES.ENUM,Ca],jpegThumbnail:[16,h.TYPES.BYTES],caption:[17,h.TYPES.STRING]};jc.internalSpec={businessOwnerJid:[1,h.TYPES.STRING]};kc.internalSpec={sentiment:[1,h.TYPES.UINT32],behaviorGraph:[2,h.TYPES.STRING],action:[3,h.TYPES.UINT32],intensity:[4,h.TYPES.UINT32],wordCount:[5,h.TYPES.UINT32]};lc.internalSpec={provider:[1,h.TYPES.ENUM,Ea],pluginType:[2,h.TYPES.ENUM,Da],thumbnailCdnUrl:[3,h.TYPES.STRING],profilePhotoCdnUrl:[4,h.TYPES.STRING],searchProviderUrl:[5,h.TYPES.STRING],referenceIndex:[6,h.TYPES.UINT32],expectedLinksCount:[7,h.TYPES.UINT32],pluginVersion:[8,h.TYPES.UINT32]};mc.internalSpec={suggestedPrompts:[1,h.FLAGS.REPEATED|h.TYPES.STRING],selectedPromptIndex:[2,h.TYPES.UINT32]};nc.internalSpec={avatarMetadata:[1,h.TYPES.MESSAGE,kc],personaId:[2,h.TYPES.STRING],pluginMetadata:[3,h.TYPES.MESSAGE,lc],suggestedPromptMetadata:[4,h.TYPES.MESSAGE,mc],invokerJid:[5,h.TYPES.STRING]};oc.internalSpec={deviceListMetadata:[1,h.TYPES.MESSAGE,X],deviceListMetadataVersion:[2,h.TYPES.INT32],messageSecret:[3,h.TYPES.BYTES],paddingBytes:[4,h.TYPES.BYTES],messageAddOnDurationInSecs:[5,h.TYPES.UINT32],botMessageSecret:[6,h.TYPES.BYTES],botMetadata:[7,h.TYPES.MESSAGE,nc],reportingTokenVersion:[8,h.TYPES.INT32]};X.internalDefaults={senderAccountType:(i=d("WAAdv.pb")).ADVEncryptionType.E2EE,receiverAccountType:i.ADVEncryptionType.E2EE};X.internalSpec={senderKeyHash:[1,h.TYPES.BYTES],senderTimestamp:[2,h.TYPES.UINT64],senderKeyIndexes:[3,h.FLAGS.REPEATED|h.FLAGS.PACKED|h.TYPES.UINT32],senderAccountType:[4,h.TYPES.ENUM,i.ADVEncryptionType],receiverAccountType:[5,h.TYPES.ENUM,i.ADVEncryptionType],recipientKeyHash:[8,h.TYPES.BYTES],recipientTimestamp:[9,h.TYPES.UINT64],recipientKeyIndexes:[10,h.FLAGS.REPEATED|h.FLAGS.PACKED|h.TYPES.UINT32]};Y.internalSpec={polygonVertices:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,pc],location:[2,h.TYPES.MESSAGE,qc],newsletter:[3,h.TYPES.MESSAGE,W],shouldSkipConfirmation:[4,h.TYPES.BOOL],__oneofs__:{action:["location","newsletter"]}};pc.internalSpec={xDeprecated:[1,h.TYPES.INT32],yDeprecated:[2,h.TYPES.INT32],x:[3,h.TYPES.DOUBLE],y:[4,h.TYPES.DOUBLE]};qc.internalSpec={degreesLatitude:[1,h.TYPES.DOUBLE],degreesLongitude:[2,h.TYPES.DOUBLE],name:[3,h.TYPES.STRING]};rc.internalSpec={quickReplyButton:[1,h.TYPES.MESSAGE,uc],urlButton:[2,h.TYPES.MESSAGE,tc],callButton:[3,h.TYPES.MESSAGE,sc],index:[4,h.TYPES.UINT32],__oneofs__:{button:["quickReplyButton","urlButton","callButton"]}};sc.internalSpec={displayText:[1,h.TYPES.MESSAGE,M],phoneNumber:[2,h.TYPES.MESSAGE,M]};tc.internalSpec={displayText:[1,h.TYPES.MESSAGE,M],url:[2,h.TYPES.MESSAGE,M]};uc.internalSpec={displayText:[1,h.TYPES.MESSAGE,M],id:[2,h.TYPES.STRING]};vc.internalSpec={quickReplyButton:[1,h.TYPES.MESSAGE,yc],urlButton:[2,h.TYPES.MESSAGE,xc],callButton:[3,h.TYPES.MESSAGE,wc],index:[4,h.TYPES.UINT32],__oneofs__:{hydratedButton:["quickReplyButton","urlButton","callButton"]}};wc.internalSpec={displayText:[1,h.TYPES.STRING],phoneNumber:[2,h.TYPES.STRING]};xc.internalSpec={displayText:[1,h.TYPES.STRING],url:[2,h.TYPES.STRING],consentedUsersUrl:[3,h.TYPES.STRING],webviewPresentation:[4,h.TYPES.ENUM,Fa]};yc.internalSpec={displayText:[1,h.TYPES.STRING],id:[2,h.TYPES.STRING]};zc.internalSpec={value:[1,h.TYPES.INT64],offset:[2,h.TYPES.UINT32],currencyCode:[3,h.TYPES.STRING]};Z.internalSpec={id:[1,h.TYPES.STRING],fileLength:[2,h.TYPES.UINT64],width:[3,h.TYPES.UINT32],height:[4,h.TYPES.UINT32],mimetype:[5,h.TYPES.STRING],placeholderArgb:[6,h.TYPES.FIXED32],textArgb:[7,h.TYPES.FIXED32],subtextArgb:[8,h.TYPES.FIXED32],mediaData:[9,h.TYPES.MESSAGE,Ac],type:[10,h.TYPES.ENUM,Ga]};Ac.internalSpec={mediaKey:[1,h.TYPES.BYTES],mediaKeyTimestamp:[2,h.TYPES.INT64],fileSha256:[3,h.TYPES.BYTES],fileEncSha256:[4,h.TYPES.BYTES],directPath:[5,h.TYPES.STRING]};$.internalSpec={initiator:[1,h.TYPES.ENUM,Ia],trigger:[2,h.TYPES.ENUM,Ha],initiatorDeviceJid:[3,h.TYPES.STRING],initiatedByMe:[4,h.TYPES.BOOL]};Bc.internalSpec={url:[1,h.TYPES.STRING],buttonTitle:[2,h.TYPES.STRING]};Cc.internalSpec={groupJid:[1,h.TYPES.STRING],groupSubject:[2,h.TYPES.STRING]};Dc.internalSpec={version:[1,h.TYPES.SFIXED32],encIv:[2,h.TYPES.BYTES],encPayload:[3,h.TYPES.BYTES]};Ec.internalSpec={expressPathUrl:[1,h.TYPES.STRING],fileEncSha256:[2,h.TYPES.BYTES],fileLength:[3,h.TYPES.UINT64]};g.Message$PlaceholderMessage$PlaceholderType=c;g.Message$BCallMessage$MediaType=e;g.Message$CallLogMessage$CallOutcome=f;g.Message$CallLogMessage$CallType=b;g.Message$ScheduledCallEditMessage$EditType=aa;g.Message$ScheduledCallCreationMessage$CallType=ba;g.Message$EventResponseMessage$EventResponseType=ca;g.Message$PinInChatMessage$Type=da;g.Message$ButtonsResponseMessage$Type=ea;g.Message$ButtonsMessage$Button$Type=fa;g.Message$ButtonsMessage$HeaderType=ga;g.Message$GroupInviteMessage$GroupType=ha;g.Message$InteractiveResponseMessage$Body$Format=j;g.Message$InteractiveMessage$ShopMessage$Surface=ia;g.Message$ListResponseMessage$ListType=ja;g.Message$ListMessage$ListType=ka;g.Message$OrderMessage$OrderSurface=la;g.Message$OrderMessage$OrderStatus=ma;g.Message$PaymentInviteMessage$ServiceType=na;g.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMDateTime$HSMDateTimeComponent$CalendarType=oa;g.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMDateTime$HSMDateTimeComponent$DayOfWeekType=pa;g.Message$PeerDataOperationRequestType=k;g.Message$HistorySyncNotification$HistorySyncType=qa;g.Message$RequestWelcomeMessageMetadata$LocalChatState=ra;g.Message$ProtocolMessage$Type=sa;g.Message$BotFeedbackMessage$BotFeedbackKindMultiplePositive=ta;g.Message$BotFeedbackMessage$BotFeedbackKindMultipleNegative=ua;g.Message$BotFeedbackMessage$BotFeedbackKind=va;g.Message$VideoMessage$Attribution=wa;g.Message$ExtendedTextMessage$InviteLinkGroupType=l;g.Message$ExtendedTextMessage$PreviewType=xa;g.Message$ExtendedTextMessage$FontType=ya;g.Message$InvoiceMessage$AttachmentType=za;g.ContextInfo$ForwardedNewsletterMessageInfo$ContentType=Aa;g.ContextInfo$ExternalAdReplyInfo$MediaType=Ba;g.ContextInfo$AdReplyInfo$MediaType=Ca;g.BotPluginMetadata$PluginType=Da;g.BotPluginMetadata$SearchProvider=Ea;g.HydratedTemplateButton$HydratedURLButton$WebviewPresentationType=Fa;g.PaymentBackground$Type=Ga;g.DisappearingMode$Trigger=Ha;g.DisappearingMode$Initiator=Ia;g.KeepType=a;g.MessageSpec=m;g.Message$PlaceholderMessageSpec=n;g.Message$ExtendedTextMessageWithParentKeySpec=o;g.Message$BCallMessageSpec=p;g.Message$MessageHistoryBundleSpec=q;g.Message$CallLogMessageSpec=r;g.Message$CallLogMessage$CallParticipantSpec=s;g.Message$ScheduledCallEditMessageSpec=t;g.Message$ScheduledCallCreationMessageSpec=u;g.Message$EventResponseMessageSpec=Ja;g.Message$EncEventResponseMessageSpec=v;g.Message$EventMessageSpec=w;g.Message$CommentMessageSpec=x;g.Message$EncCommentMessageSpec=y;g.Message$EncReactionMessageSpec=Ka;g.Message$PinInChatMessageSpec=La;g.Message$KeepInChatMessageSpec=Ma;g.Message$PollVoteMessageSpec=Na;g.Message$PollEncValueSpec=Oa;g.Message$PollUpdateMessageMetadataSpec=Pa;g.Message$PollUpdateMessageSpec=Qa;g.Message$PollCreationMessageSpec=z;g.Message$PollCreationMessage$OptionSpec=Ra;g.Message$StickerSyncRMRMessageSpec=Sa;g.Message$ReactionMessageSpec=Ta;g.Message$ButtonsResponseMessageSpec=Ua;g.Message$ButtonsMessageSpec=Va;g.Message$ButtonsMessage$ButtonSpec=Wa;g.Message$ButtonsMessage$Button$NativeFlowInfoSpec=Xa;g.Message$ButtonsMessage$Button$ButtonTextSpec=Ya;g.Message$FutureProofMessageSpec=A;g.Message$DeviceSentMessageSpec=Za;g.Message$RequestPhoneNumberMessageSpec=$a;g.Message$NewsletterAdminInviteMessageSpec=ab;g.Message$GroupInviteMessageSpec=bb;g.Message$InteractiveResponseMessageSpec=cb;g.Message$InteractiveResponseMessage$NativeFlowResponseMessageSpec=B;g.Message$InteractiveResponseMessage$BodySpec=C;g.Message$InteractiveMessageSpec=D;g.Message$InteractiveMessage$CarouselMessageSpec=E;g.Message$InteractiveMessage$NativeFlowMessageSpec=F;g.Message$InteractiveMessage$NativeFlowMessage$NativeFlowButtonSpec=db;g.Message$InteractiveMessage$CollectionMessageSpec=G;g.Message$InteractiveMessage$ShopMessageSpec=H;g.Message$InteractiveMessage$FooterSpec=eb;g.Message$InteractiveMessage$BodySpec=fb;g.Message$InteractiveMessage$HeaderSpec=gb;g.Message$ListResponseMessageSpec=hb;g.Message$ListResponseMessage$SingleSelectReplySpec=ib;g.Message$ListMessageSpec=jb;g.Message$ListMessage$ProductListInfoSpec=kb;g.Message$ListMessage$ProductListHeaderImageSpec=lb;g.Message$ListMessage$ProductSectionSpec=mb;g.Message$ListMessage$ProductSpec=nb;g.Message$ListMessage$SectionSpec=ob;g.Message$ListMessage$RowSpec=pb;g.Message$OrderMessageSpec=I;g.Message$ProductMessageSpec=qb;g.Message$ProductMessage$ProductSnapshotSpec=rb;g.Message$ProductMessage$CatalogSnapshotSpec=sb;g.Message$TemplateButtonReplyMessageSpec=tb;g.Message$TemplateMessageSpec=J;g.Message$TemplateMessage$HydratedFourRowTemplateSpec=K;g.Message$TemplateMessage$FourRowTemplateSpec=ub;g.Message$StickerMessageSpec=L;g.Message$LiveLocationMessageSpec=vb;g.Message$PaymentInviteMessageSpec=wb;g.Message$CancelPaymentRequestMessageSpec=xb;g.Message$DeclinePaymentRequestMessageSpec=yb;g.Message$RequestPaymentMessageSpec=zb;g.Message$SendPaymentMessageSpec=Ab;g.Message$HighlyStructuredMessageSpec=M;g.Message$HighlyStructuredMessage$HSMLocalizableParameterSpec=Bb;g.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMDateTimeSpec=Cb;g.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMDateTime$HSMDateTimeUnixEpochSpec=Db;g.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMDateTime$HSMDateTimeComponentSpec=Eb;g.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMCurrencySpec=Fb;g.Message$ContactsArrayMessageSpec=Gb;g.Message$InitialSecurityNotificationSettingSyncSpec=Hb;g.Message$PeerDataOperationRequestResponseMessageSpec=Ib;g.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResultSpec=Jb;g.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$PlaceholderMessageResendResponseSpec=Kb;g.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$LinkPreviewResponseSpec=Lb;g.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$LinkPreviewResponse$LinkPreviewHighQualityThumbnailSpec=Mb;g.Message$PeerDataOperationRequestMessageSpec=Nb;g.Message$PeerDataOperationRequestMessage$PlaceholderMessageResendRequestSpec=Ob;g.Message$PeerDataOperationRequestMessage$HistorySyncOnDemandRequestSpec=Pb;g.Message$PeerDataOperationRequestMessage$RequestUrlPreviewSpec=Qb;g.Message$PeerDataOperationRequestMessage$RequestStickerReuploadSpec=Rb;g.Message$AppStateFatalExceptionNotificationSpec=Sb;g.Message$AppStateSyncKeyRequestSpec=Tb;g.Message$AppStateSyncKeyShareSpec=Ub;g.Message$AppStateSyncKeyDataSpec=Vb;g.Message$AppStateSyncKeyFingerprintSpec=Wb;g.Message$AppStateSyncKeyIdSpec=N;g.Message$AppStateSyncKeySpec=Xb;g.Message$HistorySyncNotificationSpec=Yb;g.Message$RequestWelcomeMessageMetadataSpec=Zb;g.Message$ProtocolMessageSpec=$b;g.Message$BotFeedbackMessageSpec=ac;g.Message$ChatSpec=bc;g.Message$CallSpec=cc;g.Message$VideoMessageSpec=O;g.Message$AudioMessageSpec=dc;g.Message$DocumentMessageSpec=P;g.Message$ExtendedTextMessageSpec=Q;g.Message$LocationMessageSpec=R;g.Message$ContactMessageSpec=S;g.Message$InvoiceMessageSpec=ec;g.Message$ImageMessageSpec=T;g.Message$SenderKeyDistributionMessageSpec=U;g.ContextInfoSpec=V;g.ContextInfo$DataSharingContextSpec=fc;g.ContextInfo$ForwardedNewsletterMessageInfoSpec=W;g.ContextInfo$UTMInfoSpec=gc;g.ContextInfo$ExternalAdReplyInfoSpec=hc;g.ContextInfo$AdReplyInfoSpec=ic;g.ContextInfo$BusinessMessageForwardInfoSpec=jc;g.BotAvatarMetadataSpec=kc;g.BotPluginMetadataSpec=lc;g.BotSuggestedPromptMetadataSpec=mc;g.BotMetadataSpec=nc;g.MessageContextInfoSpec=oc;g.DeviceListMetadataSpec=X;g.InteractiveAnnotationSpec=Y;g.PointSpec=pc;g.LocationSpec=qc;g.TemplateButtonSpec=rc;g.TemplateButton$CallButtonSpec=sc;g.TemplateButton$URLButtonSpec=tc;g.TemplateButton$QuickReplyButtonSpec=uc;g.HydratedTemplateButtonSpec=vc;g.HydratedTemplateButton$HydratedCallButtonSpec=wc;g.HydratedTemplateButton$HydratedURLButtonSpec=xc;g.HydratedTemplateButton$HydratedQuickReplyButtonSpec=yc;g.MoneySpec=zc;g.PaymentBackgroundSpec=Z;g.PaymentBackground$MediaDataSpec=Ac;g.DisappearingModeSpec=$;g.ActionLinkSpec=Bc;g.GroupMentionSpec=Cc;g.MessageSecretMessageSpec=Dc;g.MediaNotifyMessageSpec=Ec}),98);
__d("WAHandleGroupMessageProtocol",["Promise","WACryptoManagerUtils","WACryptoPkcs7","WADecryptionChatQueue","WAE2E.pb","WAGlobals","WAJids","WALogger","WAReceiptUtils","WAResultOrError","decodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["decryptGroupMessage error: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Fail to save senderKeySession ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["missing sender key in dual enc message"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["enc version "," is not supported."]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unknown message content type: ",""]);m=function(){return a};return a}function n(a){return a.name==="GroupDualEncMedia"?"ContentTypeMedia":a.value.contentDualMixins.name}function o(a){switch(a){case"ContentTypeText":return"text";case"ContentTypeLiveLocationSingle":return"live_location";case"ContentTypeMedia":return"media";case"ContentTypeMediaSingle":return"media";case"ContentTypePayGroup":return"pay";case"ContentTypeReaction":return"reaction";case"ContentTypeProductList":return"product_list";case"ContentTypePollCreation":return"poll_creation";case"ContentTypePollVote":return"poll_vote";case"ContentTypeScheduledCall":return"scheduled_call";default:a;d("WALogger").ERROR(m(),a);return"text"}}function a(a){var b=a.from,c=a.participant;a=a.groupDualOrSingleEncMixinGroup;var e=d("WAJids").extractUserJid(c);b={chat:b,author:e===d("WAGlobals").getMyUserJid()?"@me":e,from:c};switch(a.name){case"GroupSingleEnc":e=a.value;c=e.groupRetryOrBotResponseMessageOrGroupRegularMixinGroup;e=e.contentSingleMixins;return babelHelpers["extends"]({},b,{enc:p(c),contentType:o(e.name),type:"SingleEnc"});default:a.name;c=a.value.groupDualEncGroupDualEncMediaOrGroupDualEncNonMediaMediaMixinGroup;e=n(c);return babelHelpers["extends"]({},b,q(c),{type:"DualEnc",contentType:o(e)})}}function p(a){switch(a.name){case"GroupRetry":return{encVersion:a.value.encEncVersion2Or3OrFutureproofMixinGroup.value.v,ciphertext:a.value.encEncTypeIndividualMixin.elementValue,encType:a.value.encEncTypeIndividualMixin.type,retryCount:a.value.encEncRetryMixin.count};case"GroupRegular":a.name;return r(a.value.encEncVersion2Or3OrFutureproofMixinGroup.value,a.value.encEncTypeIndividualOrSenderKeyMixinGroup.value);default:a.name;return{ciphertext:a.value.encEncTypeMessageSecretMessageMixin.elementValue,encVersion:a.value.encEncVersion2OrFutureproofMixinGroup.value.v,encType:a.value.encEncTypeMessageSecretMessageMixin.type}}}function q(a){switch(a.name){case"GroupDualEncNonMedia":var b=a.value.enc,c=b[0];b=b[1];return{senderKeyDistributionEnc:r(c.encVersion2Or3OrFutureproofMixinGroup.value,c.encTypeSenderKeyOrIndividualMixinGroup.value),senderKeyMessageEnc:r(b.encVersion2Or3OrFutureproofMixinGroup.value,b.encTypeSenderKeyOrIndividualMixinGroup.value)};default:a.name;c=a.value.enc;b=c[0];a=c[1];return{senderKeyDistributionEnc:r(b.encVersion2Or3OrFutureproofMixinGroup.value,b.encTypeSenderKeyAndGroupMediaOrIndividualMixinGroup.value),senderKeyMessageEnc:r(a.encVersion2Or3OrFutureproofMixinGroup.value,a.encTypeSenderKeyAndGroupMediaOrIndividualMixinGroup.value)}}}function r(a,b){return{encVersion:a.v,ciphertext:b.elementValue,encType:b.type}}function c(a,b){return d("WADecryptionChatQueue").decryptionChatQueue.enqueue(a.chat,function(){return s(a,b)})}function s(a,b){switch(a.type){case"DualEnc":var c=a.senderKeyDistributionEnc,e=a.senderKeyMessageEnc,f=a.from,g=a.chat,h=a.author;return t(c,f,g,b).then(function(a){if(!a.success)return a;if(c.encVersion!=="2"){d("WALogger").WARN(l(),c.encVersion);return d("WAResultOrError").makeError("unknown-sender-key-distribution-plaintext")}a=a.value.plaintext;a=d("WACryptoPkcs7").unpadPkcs7(a);a=d("decodeProtobuf").decodeProtobuf(d("WAE2E.pb").MessageSpec,a);a=(a=a.senderKeyDistributionMessage)==null?void 0:a.axolotlSenderKeyDistributionMessage;if(a==null){d("WALogger").ERROR(k());return d("WAResultOrError").makeError("group-decrypt-error")}return d("WACryptoManagerUtils").saveSenderKeySession(g,f,new Uint8Array(a),b).then(function(a){if(!a.success){d("WALogger").ERROR(j(),a.error);return d("WAResultOrError").makeError("group-decrypt-error")}return t(e,f,g,b)})}).then(function(a){return!a.success?{from:f,chat:g,author:h,retryCount:0,error:a.error,encVersion:e.encVersion,type:"Undecrypted"}:{from:f,chat:g,author:h,encVersion:e.encVersion,plaintext:a.value.plaintext,type:"Decrypted"}});default:a.type;var i=a.enc,m=a.from,n=a.chat,o=a.author;return t(i,m,n,b).then(function(a){if(!a.success){var b;return{from:m,chat:n,author:o,retryCount:(b=i.retryCount)!=null?b:0,error:a.error,encVersion:i.encVersion,type:"Undecrypted"}}return{from:m,chat:n,author:o,encVersion:i.encVersion,plaintext:a.value.plaintext,type:"Decrypted"}})}}function t(a,c,e,f){var g;a.encType==="msg"||a.encType==="pkmsg"?g=d("WACryptoManagerUtils").decryptMsg(a.encType,c,a.ciphertext,f):a.encType==="skmsg"?(a.encType,g=d("WACryptoManagerUtils").decryptGroupMsg(e,c,a.ciphertext,f)):(a.encType,g=(h||(h=b("Promise"))).resolve({}));return g.then(function(a){if(!a.success){d("WALogger").ERROR(i(),a.error);return d("WAResultOrError").makeError("group-decrypt-error")}return a.value==null?d("WAResultOrError").makeError("missing-content"):d("WAResultOrError").makeResult({plaintext:a.value.plaintext,remoteIdentity:a.value.remoteIdentity})})}e=function(a,b){var c=a.stanzaId,e=a.serverTs,f=a.retryCount,g=a.from,h=a.author,i=a.chat;a=a.deviceIdentity;h=h==="@me";return d("WAReceiptUtils").makeRetryReceipt({category:null,externalId:c,from:{groupJid:i,type:"group"},participant:g,recipient:h?d("WAJids").extractUserJid(g):null,retryCount:f,ts:e,deviceIdentity:a},b)};g.parseGroupMessage=a;g.decryptGroupMessage=c;g.makeGrouplMessageRetryReceipt=e}),98);
__d("WACreateHandleGroupMessageBranch",["WAHandleGroupMessageProtocol","WAResultOrError","WASendDeliveryReceiptProtocol"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return function(b){var c=b.groupMixin,e=b.commonMessageBase,f=b.makeAck;b=b.ctx;c=d("WAHandleGroupMessageProtocol").parseGroupMessage(c);return a(babelHelpers["extends"]({},e,{parsedMessage:c,makeAck:f,makeDeliveryReceipt:d("WASendDeliveryReceiptProtocol").makeDeliveryReceipt,makeRetryReceipt:d("WAHandleGroupMessageProtocol").makeGrouplMessageRetryReceipt}),b).then(d("WAResultOrError").makeResult)}}g.createHandleGroupMessageBranch=a}),98);
__d("WAParseProtocol",["WAAckLevel","WAAssertUnreachable","WAE2E.pb","WAErr","WAGlobals","WAHex","WAJids","WALogger","WALongInt","WAMedia","WAMediaUtils","WAMsgMap","WAMsgType","WASortedLists","WAStanzaUtils","WATimeUtils"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["cannot compose mediaEntry with the media message"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["protobuf msg with too large size ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["protobuf msg with bad size ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["protobuf msg with no plaintext hash"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["received protocol message with unknown type ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["received unsupported protocol message with type ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["received invalid revoke key"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["received a non supported revoke"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Received extendedTextMsg with no text content"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["There are no admin made reactions"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["We dont support this message type yet"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["interpretProto msg came with tags "," and ",""]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["Received a quote of a type that is not yet supported: ",""]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["Received quote invalid author ",""]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["Received quote with missing data in the protobuf"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["Received quote from a type that us not supported ",""]);w=function(){return a};return a}var x={};function y(){return{unstoredMsg:null,unstoredMedia:null,unstoredQuotedMedia:null}}function z(a){var b=a.unstoredMsg,c=a.unstoredMedia;c=c===void 0?null:c;a=a.unstoredQuotedMedia;a=a===void 0?null:a;if(b==null&&c==null)return y();else return{unstoredMsg:b,unstoredMedia:c,unstoredQuotedMedia:a}}function a(a){var b=F(a.proto);if(!b)return y();var e=C(a,b),f=A(a,b),g=f.quote;f=f.quotedMedia;switch(b.type){case"conversation":var h;h=babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.TEXT,msgContent:{content:b.value},quote:(h=g)!=null?h:void 0},e);return z({unstoredMsg:h,unstoredQuotedMedia:f});case"imageMessage":h=b.value;f=G(h,e.ts);h=babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.IMAGE,mediaId:f==null?void 0:f.plaintextHash,quote:(h=g)!=null?h:void 0},e);return z({unstoredMsg:h,unstoredMedia:f});case"videoMessage":h=b.value;f=H(h,e.ts);h=babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.VIDEO,mediaId:f==null?void 0:f.plaintextHash,quote:(h=g)!=null?h:void 0},e);return z({unstoredMsg:h,unstoredMedia:f});case"audioMessage":h=b.value;f=I(h,e.ts);h=babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.PTT,mediaId:f==null?void 0:f.plaintextHash},e);return z({unstoredMsg:h,unstoredMedia:f});case"documentMessage":h=b.value;f=N(h,e.ts);h=babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.DOCUMENT_FILE,mediaId:f==null?void 0:f.plaintextHash,quote:(h=g)!=null?h:void 0},e);return z({unstoredMsg:h,unstoredMedia:f});case"futureproof":h={type:d("WAMsgType").MSG_TYPE.FUTUREPROOF,msgContent:{protobuf:d("WAHex").bytesToBuffer(a.bytes),subtype:x[b.type]||null},id:e.id,ts:e.ts,sentTs:e.sentTs,serverTs:e.serverTs,ack:e.ack,reportingMeta:e.reportingMeta};return z({unstoredMsg:h});case"reactionMessage":f=b.value;a=J(f,e);return z({unstoredMsg:a});case"protocolMessage":h=M(b.value,e);return z({unstoredMsg:h});case"extendedTextMessage":return K(b.value,e,g);default:return c("WAAssertUnreachable")(b.type)}}function A(a,b){b=D(b);var c=b==null?void 0:b.quotedMessage;if(b==null||c==null)return{quote:null,quotedMedia:null};var e=F(c);if(e==null){d("WALogger").ERROR(w(),c);return{quote:null,quotedMedia:null}}c=b.stanzaId;b=b.participant;if(c==null||b==null){d("WALogger").ERROR(v());return{quote:null,quotedMedia:null}}b=b?d("WAJids").validateUserJid(b):d("WAJids").interpretAsUserJid(a.jid);if(b==null){d("WALogger").ERROR(u(),b);return{quote:null,quotedMedia:null}}c={externalId:d("WAStanzaUtils").toStanzaId(c),ts:null,author:b,serverTs:a.ts};switch(e.type){case"conversation":b=babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.TEXT,msgContent:{content:e.value}},c);return{quote:{content:b,remoteJid:null},quotedMedia:null};case"imageMessage":b=e.value;b=G(b,a.ts);a=babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.IMAGE,mediaId:b==null?void 0:b.plaintextHash},c);return{quote:{content:a,remoteJid:null},quotedMedia:b};default:d("WALogger").ERROR(t(),e.type);return{quote:null,quotedMedia:null}}}var B=["conversation","imageMessage","videoMessage","audioMessage","reactionMessage","protocolMessage","extendedTextMessage","documentMessage"];function C(a,b){var c=D(b);return{id:{externalId:a.externalId,author:a.author,chat:a.jid},ts:a.ts,ack:d("WAAckLevel").ACK.RECEIVED,serverTs:a.ts,forwardingScore:E(b,c)}}function D(a){switch(a.type){case"imageMessage":case"videoMessage":case"extendedTextMessage":case"audioMessage":case"documentMessage":return a.value.contextInfo;default:a.type;return null}}function E(a,b){if(a.type==="futureproof")return 0;return(b==null?void 0:b.forwardingScore)!=null?b==null?void 0:b.forwardingScore:(b==null?void 0:b.isForwarded)===!0?1:0}function F(a){var b=null;for(var e=0;e<B.length;e++)if(a[B[e]]!=null){if(b){d("WALogger").ERROR(s(),b,B[e]);return null}b=B[e]}if(b==null){d("WALogger").ERROR(r()).devConsole(a);return{type:"futureproof"}}switch(b){case"audioMessage":return a.audioMessage!=null?{type:"audioMessage",value:a.audioMessage}:null;case"videoMessage":return a.videoMessage!=null?{type:"videoMessage",value:a.videoMessage}:null;case"imageMessage":return a.imageMessage!=null?{type:"imageMessage",value:a.imageMessage}:null;case"documentMessage":return a.documentMessage!=null?{type:"documentMessage",value:a.documentMessage}:null;case"conversation":return a.conversation!=null?{type:"conversation",value:a.conversation}:null;case"protocolMessage":return a.protocolMessage!=null?{type:"protocolMessage",value:a.protocolMessage}:null;case"extendedTextMessage":return a.extendedTextMessage!=null?{type:"extendedTextMessage",value:a.extendedTextMessage}:null;case"reactionMessage":return a.reactionMessage!=null?{type:"reactionMessage",value:a.reactionMessage}:null;default:c("WAAssertUnreachable")(b)}}function G(a,b){var c=P(a,"image");if(!c)return null;c=O(c,b);return babelHelpers["extends"]({},c,{mediaType:d("WAMedia").IMAGE,validatedVideoInfo:null,validatedImageInfo:{width:a.width,height:a.height,jpegThumbnail:a.jpegThumbnail},validatedAudioInfo:null,validatedDocumentFileInfo:null})}function H(a,b){var c=P(a,"video");if(!c)return null;c=O(c,b);return babelHelpers["extends"]({},c,{mediaType:d("WAMedia").VIDEO,validatedVideoInfo:{duration:a.seconds!=null&&a.seconds>1?a.seconds:1,width:a.width,height:a.height,mimetype:a.mimetype,jpegThumbnail:a.jpegThumbnail},validatedImageInfo:null,validatedAudioInfo:null,validatedDocumentFileInfo:null})}function I(a,b){var c=P(a,"ptt");if(!c)return null;c=O(c,b);return babelHelpers["extends"]({},c,{mediaType:d("WAMedia").PTT,validatedVideoInfo:null,validatedImageInfo:null,validatedAudioInfo:{duration:a.seconds!=null&&a.seconds>1?a.seconds:1,mimetype:a.mimetype,played:!1},validatedDocumentFileInfo:null})}function J(a,b){var c;c=(c=a.key)==null?void 0:c.id;var e=b.id.author;if(d("WAJids").isAuthorSystem(e)){d("WALogger").ERROR(q());return null}return c==null?null:{type:d("WAMsgType").MSG_TYPE.REACTION,reactToAuthor:e,reaction:a.text,reactToExternalId:d("WAStanzaUtils").toStanzaId(c),groupingKey:a.groupingKey,id:b.id,ts:b.ts,ack:d("WAAckLevel").ACK.RECEIVED,serverTs:b.ts}}function K(a,b,c){var e=a.text;if(e==null){d("WALogger").ERROR(p());return y()}a=L((a=a.contextInfo)==null?void 0:a.mentionedJid,e);e=babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.TEXT,msgContent:{content:e,mentionedJids:(e=a)!=null?e:void 0},quote:(a=c)!=null?a:void 0},b);return z({unstoredMsg:e})}function L(a,b){b=b;if(a==null||b==null)return null;var c=[];for(var e=0;e<a.length;e++){var f=d("WAJids").interpretAndValidateJid(a[e]);f.jidType==="phoneUser"&&b.includes("@"+d("WAJids").phoneNumberFromJid(f.userJid))&&c.push(f.userJid)}return c.length?d("WASortedLists").sortAndDedupe(c):void 0}function M(a,b){var e=b.id.author,f=a.type;if(d("WAJids").isAuthorSystem(e))throw c("WAErr")("There are no admin made reactions");else if(f==null)throw c("WAErr")("Received invalid protocol message with no type");switch(f){case d("WAE2E.pb").Message$ProtocolMessage$Type.REVOKE:a=a.key;var g=b.id.chat;if(a&&(a.remoteJid===d("WAGlobals").getMyUserJid()?e===g:a.remoteJid===g)&&a.id!=null){e=a.fromMe;g=a.id;e=(e=e)!=null?e:!1;if(e)return{id:b.id,ts:b.ts,sentTs:b.sentTs,serverTs:b.serverTs,ack:b.ack,reportingMeta:b.reportingMeta,type:d("WAMsgType").MSG_TYPE.REVOKED,revokedExternalId:d("WAStanzaUtils").toStanzaId(g),unsendMsgContentDeleteTs:null,msgContent:null};else{d("WALogger").ERROR(o());return null}}else{d("WALogger").ERROR(n()).devConsole(a,b);return null}case d("WAE2E.pb").Message$ProtocolMessage$Type.EPHEMERAL_SETTING:case d("WAE2E.pb").Message$ProtocolMessage$Type.EPHEMERAL_SYNC_RESPONSE:case d("WAE2E.pb").Message$ProtocolMessage$Type.APP_STATE_SYNC_KEY_REQUEST:d("WALogger").ERROR(m(),f);return null;default:d("WALogger").ERROR(l(),f);return null}}function N(a,b){var c=P(a,"document");if(!c)return null;c=O(c,b);return babelHelpers["extends"]({},c,{mediaType:d("WAMedia").DOCUMENT_FILE,validatedVideoInfo:null,validatedImageInfo:null,validatedAudioInfo:null,validatedDocumentFileInfo:{filename:a.fileName,mimetype:a.mimetype}})}function O(a,b){return{mediaEntry:a.mediaEntry,plaintextHash:a.plaintextHash,size:a.size,msgIds:[],mediaEntries:new(d("WAMsgMap").MsgMap)(),ts:b}}function P(a,b){var c=a.fileSha256;if(!c){d("WALogger").ERROR(k());return null}var e=a.fileLength;if(e==null||e===0){d("WALogger").ERROR(j(),e);return null}try{e=d("WALongInt").numberOrThrowIfTooLarge(e)}catch(a){d("WALogger").ERROR(i(),e);return null}if(a.fileSha256==null||a.fileEncSha256==null||a.mediaKey==null||a.directPath==null||a.mediaKeyTimestamp==null){d("WALogger").ERROR(h());return null}a=d("WAMediaUtils").rawDataToMediaEntry(a.fileSha256,a.fileEncSha256,a.mediaKey,a.directPath,d("WATimeUtils").castLongIntToUnixTime(a.mediaKeyTimestamp),b);return{size:e,plaintextHash:d("WAMediaUtils").toPlaintextHash(new Uint8Array(c)),mediaEntry:a}}g.FUTUREPROOF_TYPES=x;g.parseProtocol=a;g.interpretMsg=F}),98);
__d("WATransformRetryOrIndividualRegularMixinGroup",[],(function(a,b,c,d,e,f){"use strict";function a(a){return{retryCount:a.name==="Retry"?a.value.encEncRetryMixin.count:0,ciphertext:a.value.encEncTypeIndividualMixin.elementValue,encVersion:String(a.value.encEncVersion2Or3OrFutureproofMixinGroup.value.v),encType:a.value.encEncTypeIndividualMixin.type}}f.transformRetryOrIndividualRegularMixinGroup=a}),66);
__d("WAHandleIndividualMessageProtocol",["WACryptoPkcs7","WADecodeIncomingMsg","WAE2E.pb","WAErr","WAJids","WALogger","WAParseProtocol","WAParseV3Protocol","WAReceiptUtils","WAResultOrError","WATransformRetryOrIndividualRegularMixinGroup","decodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["enc version "," is not supported."]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unknown message content type: ",""]);i=function(){return a};return a}var j=d("WAParseV3Protocol").createV3ProtocolParser();function k(a){switch(a){case"ContentTypeText":return"text";case"ContentTypeLiveLocationSingle":return"live_location";case"ContentTypeMedia":return"media";case"ContentTypeMedianotify":case"ContentTypeMediaSingle":return"media";case"ContentTypePayIndividual":return"pay";case"ContentTypeReaction":return"reaction";case"ContentTypeList":return"product_list";case"ContentTypePollCreation":return"poll_creation";case"ContentTypePollVote":return"poll_vote";default:a;d("WALogger").ERROR(i(),a);return"text"}}function a(a){var b=a.from,e=a.recipientMixin;a=a.availableOrUnavailableMixinGroup;var f=d("WAJids").extractUserJid(b),g=e==null?f:e.recipient;f=e==null?f:"@me";if(a.name==="Unavailable")return{type:"Unavailable",author:f,chat:g,from:b,recipient:e==null?void 0:e.recipient,contentType:k(a.value.contentUnavailableMixins.name)};var h=a.value.retryOrIndividualRegularOrBotResponseMessageMixinGroup;if(h.name==="BotResponseMessage")throw c("WAErr")("BotResponseMessage is unsupported");return babelHelpers["extends"]({type:"Available",author:f,chat:g,from:b,recipient:e==null?void 0:e.recipient},d("WATransformRetryOrIndividualRegularMixinGroup").transformRetryOrIndividualRegularMixinGroup(h),{contentType:k(a.value.contentAvailableMixins.name)})}b=function(a){a=a.decryptedMessage;var b=a.plaintext,c=a.encVersion,e=a.author,f=a.chat,g=a.stanzaId;a=a.serverTs;if(c!=="2"&&c!=="3"){d("WALogger").WARN(h(),c);return d("WAResultOrError").makeError("unknown-plaintext")}var i=null;if(c==="2"){var k,l=d("WACryptoPkcs7").unpadPkcs7(b);l=d("decodeProtobuf").decodeProtobuf(d("WAE2E.pb").MessageSpec,l);if(l.deviceSentMessage!=null&&l.deviceSentMessage.destinationJid!==f)return d("WAResultOrError").makeError("invalid-device-sent-message");k=(k=l.deviceSentMessage)==null?void 0:k.message;k!=null&&(l=k);k={author:e,bytes:b,externalId:g,jid:f,proto:l,ts:a};i=d("WAParseProtocol").parseProtocol(k)}else{c;l=e==="@me"?f:null;k=d("WADecodeIncomingMsg").decodeIncomingMsg(b,"v3",l);if(k.version!=="v3"||k.type!=="subprotocol")return d("WAResultOrError").makeError("unknown-plaintext");i=j(k,f,g,e,a)}return d("WAResultOrError").makeResult(i)};e=function(a,b){var c=a.stanzaId,e=a.serverTs,f=a.retryCount,g=a.from,h=a.author,i=a.chat;a=a.deviceIdentity;h=h==="@me";return d("WAReceiptUtils").sendRetryReceipt({category:null,externalId:c,from:{deviceJid:g,type:"device"},participant:null,recipient:h?i:null,retryCount:f,ts:e,deviceIdentity:a},b)};f=function(a,b){var c=a.stanzaId,e=a.serverTs,f=a.retryCount,g=a.from,h=a.author,i=a.chat;a=a.deviceIdentity;h=h==="@me";return d("WAReceiptUtils").makeRetryReceipt({category:null,externalId:c,from:{deviceJid:g,type:"device"},participant:null,recipient:h?i:null,retryCount:f,ts:e,deviceIdentity:a},b)};g.parseIndividualMessage=a;g.decodeIndividualMessage=b;g.sendIndividualMessageRetryReceipt=e;g.makeIndividualMessageRetryReceipt=f}),98);
__d("WACreateHandleIndividualMessageBranch",["WAHandleIndividualMessageProtocol","WAResultOrError","WASendDeliveryReceiptProtocol","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["starting..."]);h=function(){return a};return a}var i=d("WATagsLogger").TAGS(["handleIndividualMessageBranch"]);function a(a){return function(b){var c,e=b.individualMixin,f=b.commonMessageBase,g=b.makeAck;b=b.ctx;i.DEV(h());e=(c=d("WAHandleIndividualMessageProtocol")).parseIndividualMessage(e);return a(babelHelpers["extends"]({},f,{parsedMessage:e,makeAck:g,sendRetryReceipt:c.sendIndividualMessageRetryReceipt,sendDeliveryReceipt:d("WASendDeliveryReceiptProtocol").sendIndividualMessageDeliveryReceipt,makeDeliveryReceipt:d("WASendDeliveryReceiptProtocol").makeDeliveryReceipt,makeRetryReceipt:c.makeIndividualMessageRetryReceipt,decodeMessage:c.decodeIndividualMessage}),b).then(d("WAResultOrError").makeResult)}}g.createHandleIndividualMessageBranch=a}),98);
__d("WASmaxInReceiptPublishPeerDeliveryResponseSuccess",["WASmaxInReceiptPublishSuccessMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"ack");if(!c.success)return c;c=d("WASmaxInReceiptPublishSuccessMixin").parsePublishSuccessMixin(a,b);return!c.success?c:c}g.parsePublishPeerDeliveryResponseSuccess=a}),98);
__d("WASmaxOutReceiptPeerMessageTypeMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("receipt",{type:"peer_msg"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePeerMessageTypeMixin=a}),98);
__d("WASmaxOutReceiptPublishPeerDeliveryRequest",["WASmaxJsx","WASmaxOutReceiptIndividualDeviceIndividualDeviceDeprecatedOrIndividualDeviceMixinGroup","WASmaxOutReceiptPeerMessageTypeMixin","WASmaxOutReceiptSingleMixin"],(function(a,b,c,d,e,f,g){function a(a){var b=a.individualDeviceIndividualDeviceDeprecatedOrIndividualDeviceMixinGroupArgs;a=d("WASmaxOutReceiptIndividualDeviceIndividualDeviceDeprecatedOrIndividualDeviceMixinGroup").mergeIndividualDeviceIndividualDeviceDeprecatedOrIndividualDeviceMixinGroup(d("WASmaxOutReceiptPeerMessageTypeMixin").mergePeerMessageTypeMixin(d("WASmaxOutReceiptSingleMixin").mergeSingleMixin(d("WASmaxJsx").smax("receipt",null),a)),b);return a}g.makePublishPeerDeliveryRequest=a}),98);
__d("WASmaxReceiptPublishPeerDeliveryRPC",["WAComms","WASmaxInReceiptPublishPeerDeliveryResponseSuccess","WASmaxOutReceiptPublishPeerDeliveryRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:e=d("WASmaxOutReceiptPublishPeerDeliveryRequest").makePublishPeerDeliveryRequest(a);h.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(e,c));case 3:f=h.sent;g=d("WASmaxInReceiptPublishPeerDeliveryResponseSuccess").parsePublishPeerDeliveryResponseSuccess(f,e);if(!g.success){h.next=7;break}return h.abrupt("return",{name:"PublishPeerDeliveryResponseSuccess",value:g.value});case 7:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("PublishPeerDelivery",{Success:g}));case 8:case"end":return h.stop()}},null,this)}g.sendPublishPeerDeliveryRPC=a}),98);
__d("WASmaxInReceiptPublishPeerReadResponseSuccess",["WASmaxInReceiptPublishSuccessMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"ack");if(!c.success)return c;c=d("WASmaxInReceiptPublishSuccessMixin").parsePublishSuccessMixin(a,b);return!c.success?c:c}g.parsePublishPeerReadResponseSuccess=a}),98);
__d("WASmaxOutReceiptHistorySyncTypeMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("receipt",{type:"hist_sync"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeHistorySyncTypeMixin=a}),98);
__d("WASmaxOutReceiptPublishPeerReadRequest",["WASmaxJsx","WASmaxOutReceiptHistorySyncTypeMixin","WASmaxOutReceiptIndividualDeviceIndividualDeviceDeprecatedOrIndividualDeviceMixinGroup","WASmaxOutReceiptSingleMixin"],(function(a,b,c,d,e,f,g){function a(a){var b=a.individualDeviceIndividualDeviceDeprecatedOrIndividualDeviceMixinGroupArgs;a=d("WASmaxOutReceiptIndividualDeviceIndividualDeviceDeprecatedOrIndividualDeviceMixinGroup").mergeIndividualDeviceIndividualDeviceDeprecatedOrIndividualDeviceMixinGroup(d("WASmaxOutReceiptHistorySyncTypeMixin").mergeHistorySyncTypeMixin(d("WASmaxOutReceiptSingleMixin").mergeSingleMixin(d("WASmaxJsx").smax("receipt",null),a)),b);return a}g.makePublishPeerReadRequest=a}),98);
__d("WASmaxReceiptPublishPeerReadRPC",["WAComms","WASmaxInReceiptPublishPeerReadResponseSuccess","WASmaxOutReceiptPublishPeerReadRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:e=d("WASmaxOutReceiptPublishPeerReadRequest").makePublishPeerReadRequest(a);h.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(e,c));case 3:f=h.sent;g=d("WASmaxInReceiptPublishPeerReadResponseSuccess").parsePublishPeerReadResponseSuccess(f,e);if(!g.success){h.next=7;break}return h.abrupt("return",{name:"PublishPeerReadResponseSuccess",value:g.value});case 7:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("PublishPeerRead",{Success:g}));case 8:case"end":return h.stop()}},null,this)}g.sendPublishPeerReadRPC=a}),98);
__d("WAHandlePeerMessageProtocol",["WACryptoManagerUtils","WACryptoPkcs7","WAE2E.pb","WALogger","WAReceiptUtils","WAResultOrError","WASmaxReceiptPublishPeerDeliveryRPC","WASmaxReceiptPublishPeerReadRPC","WATransformRetryOrIndividualRegularMixinGroup","decodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["decodePeerMessage: no protocolMessage."]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["decodePeerMessage: enc version "," is not supported."]);i=function(){return a};return a}function a(a){var b=a.from;a=a.retryOrIndividualRegularMixinGroup;return babelHelpers["extends"]({from:b},d("WATransformRetryOrIndividualRegularMixinGroup").transformRetryOrIndividualRegularMixinGroup(a))}function b(a,b){var c=a.from,e=a.ciphertext,f=a.encType,g=a.encVersion;return d("WACryptoManagerUtils").decryptMsg(f,c,e,b).then(function(a){if(!a.success)return a;return a.value==null?d("WAResultOrError").makeError("missing-content"):d("WAResultOrError").makeResult({encVersion:g,plaintext:a.value.plaintext,remoteIdentity:a.value.remoteIdentity})})}function c(a){a=a.decryptedMessage;var b=a.plaintext;a=a.encVersion;if(a!=="2"){d("WALogger").WARN(i(),a);return d("WAResultOrError").makeError("unknown-plaintext")}a=d("WACryptoPkcs7").unpadPkcs7(b);b=d("decodeProtobuf").decodeProtobuf(d("WAE2E.pb").MessageSpec,a);if(b.protocolMessage==null){d("WALogger").WARN(h());return d("WAResultOrError").makeError("missing-protocol-message")}return d("WAResultOrError").makeResult(b.protocolMessage)}function e(a){var b=a.stanzaId;a=a.to;return d("WASmaxReceiptPublishPeerDeliveryRPC").sendPublishPeerDeliveryRPC({receiptId:b,individualDeviceIndividualDeviceDeprecatedOrIndividualDeviceMixinGroupArgs:{individualDevice:{receiptTo:a}}}).then(function(){})}function f(a){var b=a.stanzaId;a=a.to;return d("WASmaxReceiptPublishPeerReadRPC").sendPublishPeerReadRPC({receiptId:b,individualDeviceIndividualDeviceDeprecatedOrIndividualDeviceMixinGroupArgs:{individualDevice:{receiptTo:a}}}).then(function(){})}function j(a,b){var c=a.stanzaId,e=a.serverTs,f=a.retryCount,g=a.from;a=a.deviceIdentity;return d("WAReceiptUtils").sendRetryReceipt({category:"peer",externalId:c,from:{deviceJid:g,type:"device"},participant:null,recipient:null,retryCount:f,ts:e,deviceIdentity:a},b)}g.parsePeerMessage=a;g.decryptPeerMessage=b;g.decodePeerMessage=c;g.sendPeerMessageReceipt=e;g.sendHistorySyncReceipt=f;g.sendPeerMessageRetryReceipt=j}),98);
__d("WASmaxInMessageDeliverContentTypeTextMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","text");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseContentTypeTextMixin=a}),98);
__d("WASmaxInMessageDeliverDeviceIdentityMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"device-identity");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytes(a.value);return!a.success?a:d("WAResultOrError").makeResult({deviceIdentityElementValue:a.value})}g.parseDeviceIdentityMixin=a}),98);
__d("WASmaxInMessageDeliverEnums",["WAJids"],(function(a,b,c,d,e,f,g){a={0:"0",1:"1"};b={1:"1",2:"2"};c={1:"1",3:"3"};e={ACCEPT:"ACCEPT",REJECT:"REJECT",UNKNOWN:"UNKNOWN"};f={address_message:"address_message",form_message:"form_message",galaxy_message:"galaxy_message",menu_options:"menu_options"};var h={address_message:"address_message",galaxy_message:"galaxy_message"},i={allowlist:"allowlist",contacts:"contacts",denylist:"denylist"},j={allow:"allow",bypass:"bypass",deny:"deny",error:"error"},k={ASPRESENTED:"ASPRESENTED",BIMONTHLY:"BIMONTHLY",DAILY:"DAILY",FORTNIGHTLY:"FORTNIGHTLY",HALFYEARLY:"HALFYEARLY",MONTHLY:"MONTHLY",ONETIME:"ONETIME",QUARTERLY:"QUARTERLY",UNKNOWN:"UNKNOWN",WEEKLY:"WEEKLY",YEARLY:"YEARLY"},l={audio:"audio",avatar_sticker:"avatar_sticker",buttons_response:"buttons_response",cataloglink:"cataloglink",contact:"contact",contact_array:"contact_array",document:"document",genai_sticker:"genai_sticker",gif:"gif",history:"history",image:"image",list_response:"list_response",location:"location",native_flow_response:"native_flow_response",order:"order",product:"product",productlink:"productlink",ptt:"ptt",ptv:"ptv",sticker:"sticker",url:"url",vcard:"vcard",video:"video",xma:"xma"},m={audio:"audio",avatar_sticker:"avatar_sticker",buttons_response:"buttons_response",cataloglink:"cataloglink",contact:"contact",contact_array:"contact_array",document:"document",gif:"gif",history:"history",image:"image",list_response:"list_response",location:"location",native_flow_response:"native_flow_response",order:"order",product:"product",productlink:"productlink",ptt:"ptt",ptv:"ptv",sticker:"sticker",url:"url",vcard:"vcard",video:"video",xma:"xma"},n={audio:"audio",avatar_sticker:"avatar_sticker",cataloglink:"cataloglink",document:"document",genai_sticker:"genai_sticker",gif:"gif",image:"image",productlink:"productlink",ptt:"ptt",sticker:"sticker",url:"url",vcard:"vcard",video:"video"},o={buyer:"buyer",seller:"seller"},p={card:"card","net-banking":"net-banking",upi:"upi",wallet:"wallet"},q={catalog_message:"catalog_message",laneline_call:"laneline_call",menu_options:"menu_options",novi_complete_transaction:"novi_complete_transaction",novi_hub:"novi_hub",novi_login:"novi_login",novi_report_transaction:"novi_report_transaction",novi_view_bank_detail:"novi_view_bank_detail",novi_view_card_detail:"novi_view_card_detail",novi_view_code:"novi_view_code",novi_view_transaction:"novi_view_transaction",order_details:"order_details",order_status:"order_status",otp:"otp",payment_method:"payment_method",payment_status:"payment_status",voice_call:"voice_call"},r={creation:"creation",edit:"edit"},s={creation:"creation",edit:"edit",response:"response"},t={ctwa:"ctwa",username:"username"},u={EXACT:"EXACT",MAX:"MAX"},v={FAILURE:"FAILURE",INIT:"INIT",SUCCESS:"SUCCESS"},w={"false":"false","true":"true"},x={FBPAY:"FBPAY",NOVI:"NOVI",P2M_LITE:"P2M_LITE",UPI:"UPI"},y={first:"first",full:"full",inner:"inner",last:"last"},z={FULL:"FULL",MISSING_FIELD_NOT_PARTIAL:"MISSING_FIELD_NOT_PARTIAL",PARTIAL:"PARTIAL"},A={high:"high",high_force:"high_force",low:"low"},B={high:"high",low:"low",unknown:"unknown"},C={HPP_PAYMENT_LINK:"HPP_PAYMENT_LINK",UPI:"UPI"},D={incentive:"incentive",p2m:"p2m",p2p:"p2p",payout:"payout"},E={lid:"lid",pn:"pn"},F={matched:"matched",unmatched:"unmatched"},G={msg:"msg",pkmsg:"pkmsg"},H={request:"request",send:"send"},I={validators:[(d=d("WAJids")).validateDeviceJid,d.validateBroadcastJid,d.validateDeviceJid,d.validateGroupJid,d.validateStatusJid],typeName:"DeviceJid|BroadcastJid|DeviceJid|GroupJid|StatusJid"},J={validators:[d.validateDeviceJid,d.validateDeviceJid],typeName:"DeviceJid|DeviceJid"},K={validators:[d.validateDeviceJid,d.validateDeviceJid,d.validateDeviceJid],typeName:"DeviceJid|DeviceJid|DeviceJid"};d={validators:[d.validateGroupJid,d.validateUserJid],typeName:"GroupJid|UserJid"};g.ENUM_0_1=a;g.ENUM_1_2=b;g.ENUM_1_3=c;g.ENUM_ACCEPT_REJECT_UNKNOWN=e;g.ENUM_ADDRESSMESSAGE_FORMMESSAGE_GALAXYMESSAGE_MENUOPTIONS=f;g.ENUM_ADDRESSMESSAGE_GALAXYMESSAGE=h;g.ENUM_ALLOWLIST_CONTACTS_DENYLIST=i;g.ENUM_ALLOW_BYPASS_DENY_ERROR=j;g.ENUM_ASPRESENTED_BIMONTHLY_DAILY_FORTNIGHTLY_HALFYEARLY_MONTHLY_ONETIME_QUARTERLY_UNKNOWN_WEEKLY_YEARLY=k;g.ENUM_AUDIO_AVATARSTICKER_BUTTONSRESPONSE_CATALOGLINK_CONTACT_CONTACTARRAY_DOCUMENT_GENAISTICKER_GIF_HISTORY_IMAGE_LISTRESPONSE_LOCATION_NATIVEFLOWRESPONSE_ORDER_PRODUCT_PRODUCTLINK_PTT_PTV_STICKER_URL_VCARD_VIDEO_XMA=l;g.ENUM_AUDIO_AVATARSTICKER_BUTTONSRESPONSE_CATALOGLINK_CONTACT_CONTACTARRAY_DOCUMENT_GIF_HISTORY_IMAGE_LISTRESPONSE_LOCATION_NATIVEFLOWRESPONSE_ORDER_PRODUCT_PRODUCTLINK_PTT_PTV_STICKER_URL_VCARD_VIDEO_XMA=m;g.ENUM_AUDIO_AVATARSTICKER_CATALOGLINK_DOCUMENT_GENAISTICKER_GIF_IMAGE_PRODUCTLINK_PTT_STICKER_URL_VCARD_VIDEO=n;g.ENUM_BUYER_SELLER=o;g.ENUM_CARD_NETBANKING_UPI_WALLET=p;g.ENUM_CATALOGMESSAGE_LANELINECALL_MENUOPTIONS_NOVICOMPLETETRANSACTION_NOVIHUB_NOVILOGIN_NOVIREPORTTRANSACTION_NOVIVIEWBANKDETAIL_NOVIVIEWCARDDETAIL_NOVIVIEWCODE_NOVIVIEWTRANSACTION_ORDERDETAILS_ORDERSTATUS_OTP_PAYMENTMETHOD_PAYMENTSTATUS_VOICECALL=q;g.ENUM_CREATION_EDIT=r;g.ENUM_CREATION_EDIT_RESPONSE=s;g.ENUM_CTWA_USERNAME=t;g.ENUM_EXACT_MAX=u;g.ENUM_FAILURE_INIT_SUCCESS=v;g.ENUM_FALSE_TRUE=w;g.ENUM_FBPAY_NOVI_P2MLITE_UPI=x;g.ENUM_FIRST_FULL_INNER_LAST=y;g.ENUM_FULL_MISSINGFIELDNOTPARTIAL_PARTIAL=z;g.ENUM_HIGH_HIGHFORCE_LOW=A;g.ENUM_HIGH_LOW_UNKNOWN=B;g.ENUM_HPPPAYMENTLINK_UPI=C;g.ENUM_INCENTIVE_P2M_P2P_PAYOUT=D;g.ENUM_LID_PN=E;g.ENUM_MATCHED_UNMATCHED=F;g.ENUM_MSG_PKMSG=G;g.ENUM_REQUEST_SEND=H;g.DEVICEJID_BROADCASTJID_DEVICEJID_GROUPJID_STATUSJID=I;g.DEVICEJID_DEVICEJID=J;g.DEVICEJID_DEVICEJID_DEVICEJID=K;g.GROUPJID_USERJID=d}),98);
__d("WASmaxInMessageDeliverRegistrationIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"registration");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytesRange(a.value,4,4);return!a.success?a:d("WAResultOrError").makeResult({registrationElementValue:a.value})}g.parseRegistrationIDMixin=a}),98);
__d("WASmaxInMessageDeliverEncHideDecryptionPlaceholderMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"decrypt-fail","hide");return!b.success?b:d("WAResultOrError").makeResult({decryptFail:b.value})}g.parseEncHideDecryptionPlaceholderMixin=a}),98);
__d("WASmaxInMessageDeliverEncPayloadMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").contentBytesRange(a,1,1048576);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}g.parseEncPayloadMixin=a}),98);
__d("WASmaxInMessageDeliverEncTypeIndividualMixin",["WAResultOrError","WASmaxInMessageDeliverEncHideDecryptionPlaceholderMixin","WASmaxInMessageDeliverEncPayloadMixin","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"type",d("WASmaxInMessageDeliverEnums").ENUM_MSG_PKMSG);if(!b.success)return b;var c=d("WASmaxInMessageDeliverEncHideDecryptionPlaceholderMixin").parseEncHideDecryptionPlaceholderMixin(a);a=d("WASmaxInMessageDeliverEncPayloadMixin").parseEncPayloadMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({type:b.value,encHideDecryptionPlaceholderMixin:c.success?c.value:null},a.value))}g.parseEncTypeIndividualMixin=a}),98);
__d("WASmaxInMessageDeliverEncVersion2Mixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"v","2");return!b.success?b:d("WAResultOrError").makeResult({v:b.value})}g.parseEncVersion2Mixin=a}),98);
__d("WASmaxInMessageDeliverEncVersion3Mixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"v","3");return!b.success?b:d("WAResultOrError").makeResult({v:b.value})}g.parseEncVersion3Mixin=a}),98);
__d("WASmaxInMessageDeliverEncVersionFutureproofMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"v",3,void 0);return!b.success?b:d("WAResultOrError").makeResult({v:b.value})}g.parseEncVersionFutureproofMixin=a}),98);
__d("WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup",["WAResultOrError","WASmaxInMessageDeliverEncVersion2Mixin","WASmaxInMessageDeliverEncVersion3Mixin","WASmaxInMessageDeliverEncVersionFutureproofMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverEncVersion2Mixin").parseEncVersion2Mixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"EncVersion2",value:b.value});var c=d("WASmaxInMessageDeliverEncVersion3Mixin").parseEncVersion3Mixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"EncVersion3",value:c.value});var e=d("WASmaxInMessageDeliverEncVersionFutureproofMixin").parseEncVersionFutureproofMixin(a);return e.success?d("WAResultOrError").makeResult({name:"EncVersionFutureproof",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["EncVersion2","EncVersion3","EncVersionFutureproof"],[b,c,e])}g.parseEncVersion2Or3OrFutureproofMixinGroup=a}),98);
__d("WASmaxInMessageDeliverIndividualRegularMixin",["WAResultOrError","WASmaxInMessageDeliverEncTypeIndividualMixin","WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"enc");if(!b.success)return b;a=d("WASmaxInMessageDeliverEncTypeIndividualMixin").parseEncTypeIndividualMixin(b.value);if(!a.success)return a;b=d("WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup").parseEncVersion2Or3OrFutureproofMixinGroup(b.value);return!b.success?b:d("WAResultOrError").makeResult({encEncTypeIndividualMixin:a.value,encEncVersion2Or3OrFutureproofMixinGroup:b.value})}g.parseIndividualRegularMixin=a}),98);
__d("WASmaxInMessageDeliverEncRetryMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"count",1,4);return!b.success?b:d("WAResultOrError").makeResult({count:b.value})}g.parseEncRetryMixin=a}),98);
__d("WASmaxInMessageDeliverRetryMixin",["WAResultOrError","WASmaxInMessageDeliverEncRetryMixin","WASmaxInMessageDeliverEncTypeIndividualMixin","WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"enc");if(!b.success)return b;a=d("WASmaxInMessageDeliverEncRetryMixin").parseEncRetryMixin(b.value);if(!a.success)return a;var c=d("WASmaxInMessageDeliverEncTypeIndividualMixin").parseEncTypeIndividualMixin(b.value);if(!c.success)return c;b=d("WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup").parseEncVersion2Or3OrFutureproofMixinGroup(b.value);return!b.success?b:d("WAResultOrError").makeResult({encEncRetryMixin:a.value,encEncTypeIndividualMixin:c.value,encEncVersion2Or3OrFutureproofMixinGroup:b.value})}g.parseRetryMixin=a}),98);
__d("WASmaxInMessageDeliverRetryOrIndividualRegularMixinGroup",["WAResultOrError","WASmaxInMessageDeliverIndividualRegularMixin","WASmaxInMessageDeliverRetryMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverRetryMixin").parseRetryMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"Retry",value:b.value});var c=d("WASmaxInMessageDeliverIndividualRegularMixin").parseIndividualRegularMixin(a);return c.success?d("WAResultOrError").makeResult({name:"IndividualRegular",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Retry","IndividualRegular"],[b,c])}g.parseRetryOrIndividualRegularMixinGroup=a}),98);
__d("WASmaxInMessageDeliverPeerRequest",["WAResultOrError","WASmaxInMessageDeliverContentTypeTextMixin","WASmaxInMessageDeliverDeviceIdentityMixin","WASmaxInMessageDeliverEnums","WASmaxInMessageDeliverRegistrationIDMixin","WASmaxInMessageDeliverRetryOrIndividualRegularMixinGroup","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"category","peer");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"push_priority",d("WASmaxInMessageDeliverEnums").ENUM_HIGH_HIGHFORCE_LOW);if(!e.success)return e;var f=d("WASmaxParseJid").attrDeviceJid(a,"from");if(!f.success)return f;var g=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!g.success)return g;var h=d("WASmaxInMessageDeliverContentTypeTextMixin").parseContentTypeTextMixin(a);if(!h.success)return h;var i=d("WASmaxInMessageDeliverRegistrationIDMixin").parseRegistrationIDMixin(a),j=d("WASmaxInMessageDeliverDeviceIdentityMixin").parseDeviceIdentityMixin(a);a=d("WASmaxInMessageDeliverRetryOrIndividualRegularMixinGroup").parseRetryOrIndividualRegularMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({id:b.value,category:c.value,pushPriority:e.value,from:f.value,t:g.value},h.value,{registrationIDMixin:i.success?i.value:null,deviceIdentityMixin:j.success?j.value:null,retryOrIndividualRegularMixinGroup:a.value}))}g.parsePeerRequest=a}),98);
__d("WASmaxOutMessageDeliverPeerResponseSuccess",["WASmaxJsx","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrDeviceJid,a,["from"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{to:d("WAWap").DEVICE_JID(b.value),"class":"message",id:d("WAWap").STANZA_ID(c.value),type:d("WAWap").CUSTOM_STRING(a.value)});return b}g.makePeerResponseSuccess=a}),98);
__d("WASmaxMessageDeliverPeerRPC",["WASmaxInMessageDeliverPeerRequest","WASmaxOutMessageDeliverPeerResponseSuccess","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverPeerRequest").parsePeerRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Peer",{Request:b}));return{parsedRequest:b.value,makePeerResponseSuccess:function(){return d("WASmaxOutMessageDeliverPeerResponseSuccess").makePeerResponseSuccess(a)}}}g.receivePeerRPC=a}),98);
__d("WACreateHandlePeerMessageBranch",["Promise","WAHandlePeerMessageProtocol","WAResultOrError","WASmaxMessageDeliverPeerRPC","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var c=a.peerMessage;return function(a,e){a=d("WASmaxMessageDeliverPeerRPC").receivePeerRPC(a);var f=a.makePeerResponseSuccess;a=a.parsedRequest;var g=a.id,i=a.from,j=a.retryOrIndividualRegularMixinGroup;a=a.t;if(c!=null){var k;return c.handlePeerMessage({from:i,parsedMessage:(k=d("WAHandlePeerMessageProtocol")).parsePeerMessage({from:i,retryOrIndividualRegularMixinGroup:j}),stanzaId:g,sendPeerMessageReceipt:k.sendPeerMessageReceipt,sendHistorySyncReceipt:k.sendHistorySyncReceipt,sendRetryReceipt:k.sendPeerMessageRetryReceipt,makeAck:f,decryptMessage:k.decryptPeerMessage,decodeMessage:k.decodePeerMessage,serverTs:d("WATimeUtils").castToUnixTime(a)},e).then(d("WAResultOrError").makeResult)}return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult(f()))}}g.createHandlePeerMessageBranch=a}),98);
__d("WASmaxInMessageDeliverAdminEditMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"edit","3");return!b.success?b:d("WAResultOrError").makeResult({edit:b.value})}g.parseAdminEditMixin=a}),98);
__d("WASmaxInMessageDeliverContentTypeMediaMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","media");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseContentTypeMediaMixin=a}),98);
__d("WASmaxInMessageDeliverPayloadMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"plaintext");if(!b.success)return b;b=d("WASmaxParseUtils").contentBytesRange(a,1,1048576);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}g.parsePayloadMixin=a}),98);
__d("WASmaxInMessageDeliverNewsletterMediaMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeMediaMixin","WASmaxInMessageDeliverEnums","WASmaxInMessageDeliverPayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"plaintext");if(!b.success)return b;var c=d("WASmaxParseUtils").attrStringEnum(b.value,"mediatype",d("WASmaxInMessageDeliverEnums").ENUM_AUDIO_AVATARSTICKER_CATALOGLINK_DOCUMENT_GENAISTICKER_GIF_IMAGE_PRODUCTLINK_PTT_STICKER_URL_VCARD_VIDEO);if(!c.success)return c;b=d("WASmaxInMessageDeliverPayloadMixin").parsePayloadMixin(b.value);if(!b.success)return b;a=d("WASmaxInMessageDeliverContentTypeMediaMixin").parseContentTypeMediaMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({plaintextMediatype:c.value,plaintextPayloadMixin:b.value},a.value))}g.parseNewsletterMediaMixin=a}),98);
__d("WASmaxInMessageDeliverNewsletterTextMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeTextMixin","WASmaxInMessageDeliverPayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"plaintext");if(!b.success)return b;b=d("WASmaxInMessageDeliverPayloadMixin").parsePayloadMixin(b.value);if(!b.success)return b;a=d("WASmaxInMessageDeliverContentTypeTextMixin").parseContentTypeTextMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({plaintextPayloadMixin:b.value},a.value))}g.parseNewsletterTextMixin=a}),98);
__d("WASmaxInMessageDeliverNewsletterTextOrMediaMixinGroup",["WAResultOrError","WASmaxInMessageDeliverNewsletterMediaMixin","WASmaxInMessageDeliverNewsletterTextMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverNewsletterTextMixin").parseNewsletterTextMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NewsletterText",value:b.value});var c=d("WASmaxInMessageDeliverNewsletterMediaMixin").parseNewsletterMediaMixin(a);return c.success?d("WAResultOrError").makeResult({name:"NewsletterMedia",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["NewsletterText","NewsletterMedia"],[b,c])}g.parseNewsletterTextOrMediaMixinGroup=a}),98);
__d("WASmaxInMessageDeliverNewsletterEditMixin",["WAResultOrError","WASmaxInMessageDeliverAdminEditMixin","WASmaxInMessageDeliverNewsletterTextOrMediaMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverAdminEditMixin").parseAdminEditMixin(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverNewsletterTextOrMediaMixinGroup").parseNewsletterTextOrMediaMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{newsletterTextOrMediaMixinGroup:a.value}))}g.parseNewsletterEditMixin=a}),98);
__d("WASmaxInMessageDeliverContentTypePollCreationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","poll");if(!a.success)return a;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,b.value,"polltype","creation");return!b.success?b:d("WAResultOrError").makeResult({type:a.value,metaPolltype:b.value})}g.parseContentTypePollCreationMixin=a}),98);
__d("WASmaxInMessageDeliverNewsletterPollCreationMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypePollCreationMixin","WASmaxInMessageDeliverPayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"plaintext");if(!b.success)return b;b=d("WASmaxInMessageDeliverPayloadMixin").parsePayloadMixin(b.value);if(!b.success)return b;a=d("WASmaxInMessageDeliverContentTypePollCreationMixin").parseContentTypePollCreationMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({plaintextPayloadMixin:b.value},a.value))}g.parseNewsletterPollCreationMixin=a}),98);
__d("WASmaxInMessageDeliverContentTypePollVoteMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","poll");if(!a.success)return a;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,b.value,"polltype","vote");return!b.success?b:d("WAResultOrError").makeResult({type:a.value,metaPolltype:b.value})}g.parseContentTypePollVoteMixin=a}),98);
__d("WASmaxInMessageDeliverNewsletterPollVoteMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypePollVoteMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"vote");if(!b.success)return b;b=d("WASmaxParseUtils").contentBytesRange(a,32,32);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"votes");if(!b.success)return b;a=d("WASmaxInMessageDeliverContentTypePollVoteMixin").parseContentTypePollVoteMixin(a);if(!a.success)return a;b=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"vote",0,1e3,h);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{votesVote:b.value}))}g.parseNewsletterPollVoteVotesVote=h;g.parseNewsletterPollVoteMixin=a}),98);
__d("WASmaxInMessageDeliverContentTypeReactionMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","reaction");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseContentTypeReactionMixin=a}),98);
__d("WASmaxInMessageDeliverNewsletterReactionMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeReactionMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"reaction");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(b.value,"code");if(!b.success)return b;a=d("WASmaxInMessageDeliverContentTypeReactionMixin").parseContentTypeReactionMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({reactionCode:b.value},a.value))}g.parseNewsletterReactionMixin=a}),98);
__d("WASmaxInMessageDeliverRevokeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"edit","7");return!b.success?b:d("WAResultOrError").makeResult({edit:b.value})}g.parseRevokeMixin=a}),98);
__d("WASmaxInMessageDeliverNewsletterReactionRevokeMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeReactionMixin","WASmaxInMessageDeliverRevokeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"reaction");if(!b.success)return b;b=d("WASmaxInMessageDeliverRevokeMixin").parseRevokeMixin(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverContentTypeReactionMixin").parseContentTypeReactionMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,a.value))}g.parseNewsletterReactionRevokeMixin=a}),98);
__d("WASmaxInMessageDeliverAdminRevokeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"edit","8");return!b.success?b:d("WAResultOrError").makeResult({edit:b.value})}g.parseAdminRevokeMixin=a}),98);
__d("WASmaxInMessageDeliverNewsletterRevokeMixin",["WAResultOrError","WASmaxInMessageDeliverAdminRevokeMixin","WASmaxInMessageDeliverContentTypeTextMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"plaintext");if(!b.success)return b;b=d("WASmaxInMessageDeliverAdminRevokeMixin").parseAdminRevokeMixin(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverContentTypeTextMixin").parseContentTypeTextMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,a.value))}g.parseNewsletterRevokeMixin=a}),98);
__d("WASmaxInMessageDeliverNewsletterMessageFanoutContent",["WAResultOrError","WASmaxInMessageDeliverNewsletterEditMixin","WASmaxInMessageDeliverNewsletterMediaMixin","WASmaxInMessageDeliverNewsletterPollCreationMixin","WASmaxInMessageDeliverNewsletterPollVoteMixin","WASmaxInMessageDeliverNewsletterReactionMixin","WASmaxInMessageDeliverNewsletterReactionRevokeMixin","WASmaxInMessageDeliverNewsletterRevokeMixin","WASmaxInMessageDeliverNewsletterTextMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverNewsletterEditMixin").parseNewsletterEditMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NewsletterEdit",value:b.value});var c=d("WASmaxInMessageDeliverNewsletterRevokeMixin").parseNewsletterRevokeMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"NewsletterRevoke",value:c.value});var e=d("WASmaxInMessageDeliverNewsletterTextMixin").parseNewsletterTextMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"NewsletterText",value:e.value});var f=d("WASmaxInMessageDeliverNewsletterMediaMixin").parseNewsletterMediaMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"NewsletterMedia",value:f.value});var g=d("WASmaxInMessageDeliverNewsletterReactionMixin").parseNewsletterReactionMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"NewsletterReaction",value:g.value});var h=d("WASmaxInMessageDeliverNewsletterReactionRevokeMixin").parseNewsletterReactionRevokeMixin(a);if(h.success)return d("WAResultOrError").makeResult({name:"NewsletterReactionRevoke",value:h.value});var i=d("WASmaxInMessageDeliverNewsletterPollCreationMixin").parseNewsletterPollCreationMixin(a);if(i.success)return d("WAResultOrError").makeResult({name:"NewsletterPollCreation",value:i.value});var j=d("WASmaxInMessageDeliverNewsletterPollVoteMixin").parseNewsletterPollVoteMixin(a);return j.success?d("WAResultOrError").makeResult({name:"NewsletterPollVote",value:j.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["NewsletterEdit","NewsletterRevoke","NewsletterText","NewsletterMedia","NewsletterReaction","NewsletterReactionRevoke","NewsletterPollCreation","NewsletterPollVote"],[b,c,e,f,g,h,i,j])}g.parseNewsletterMessageFanoutContent=a}),98);
__d("WASmaxInMessageDeliverNewsletterMessageLastEditTimestampMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,b.value,"msg_edit_t",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({metaMsgEditT:a.value})}g.parseNewsletterMessageLastEditTimestampMixin=a}),98);
__d("WASmaxInMessageDeliverNewsletterMessageOriginalTimestampMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,b.value,"original_msg_t",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({metaOriginalMsgT:a.value})}g.parseNewsletterMessageOriginalTimestampMixin=a}),98);
__d("WASmaxInMessageDeliverNewsletterMessageFanoutMixin",["WAResultOrError","WASmaxInMessageDeliverNewsletterMessageFanoutContent","WASmaxInMessageDeliverNewsletterMessageLastEditTimestampMixin","WASmaxInMessageDeliverNewsletterMessageOriginalTimestampMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!b.success)return b;var c=d("WASmaxParseUtils").attrIntRange(a,"server_id",99,2147476647);if(!c.success)return c;var e=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!e.success)return e;var f=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,a,"is_sender","true");if(!f.success)return f;var g=d("WASmaxInMessageDeliverNewsletterMessageOriginalTimestampMixin").parseNewsletterMessageOriginalTimestampMixin(a),h=d("WASmaxInMessageDeliverNewsletterMessageLastEditTimestampMixin").parseNewsletterMessageLastEditTimestampMixin(a);a=d("WASmaxInMessageDeliverNewsletterMessageFanoutContent").parseNewsletterMessageFanoutContent(a);return!a.success?a:d("WAResultOrError").makeResult({id:b.value,serverId:c.value,t:e.value,isSender:f.value,newsletterMessageOriginalTimestampMixin:g.success?g.value:null,newsletterMessageLastEditTimestampMixin:h.success?h.value:null,newsletterMessageFanoutContent:a.value})}g.parseNewsletterMessageFanoutMixin=a}),98);
__d("WASmaxInMessageDeliverOfflineMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrIntRange(a,"offline",0,12);return!a.success?a:d("WAResultOrError").makeResult({offline:a.value})}g.parseOfflineMixin=a}),98);
__d("WASmaxInMessageDeliverNewsletterMessageWithJIDMixin",["WAResultOrError","WASmaxInMessageDeliverNewsletterMessageFanoutMixin","WASmaxInMessageDeliverOfflineMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseJid").attrNewsletterJid(a,"from");if(!b.success)return b;var c=d("WASmaxInMessageDeliverNewsletterMessageFanoutMixin").parseNewsletterMessageFanoutMixin(a);if(!c.success)return c;a=d("WASmaxInMessageDeliverOfflineMixin").parseOfflineMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({from:b.value},c.value,{offlineMixin:a.success?a.value:null}))}g.parseNewsletterMessageWithJIDMixin=a}),98);
__d("WASmaxInMessageDeliverNewsletterRequest",["WASmaxInMessageDeliverNewsletterMessageWithJIDMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverNewsletterMessageWithJIDMixin").parseNewsletterMessageWithJIDMixin(a);return!b.success?b:b}g.parseNewsletterRequest=a}),98);
__d("WASmaxOutMessageDeliverCommonAckMixin",["WASmaxJsx","WASmaxMixins","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrNewsletterJid,a,["from"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{to:d("WAWap").JID(b.value),"class":"message",id:d("WAWap").STANZA_ID(c.value),type:d("WAWap").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeCommonAckMixin=a}),98);
__d("WASmaxOutMessageDeliverNewsletterResponseError",["WASmaxJsx","WASmaxOutMessageDeliverCommonAckMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutMessageDeliverCommonAckMixin").mergeCommonAckMixin(d("WASmaxJsx").smax("ack",{error:"406"}),a);return a}g.makeNewsletterResponseError=a}),98);
__d("WASmaxOutMessageDeliverNewsletterResponseSuccess",["WASmaxJsx","WASmaxOutMessageDeliverCommonAckMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutMessageDeliverCommonAckMixin").mergeCommonAckMixin(d("WASmaxJsx").smax("ack",null),a);return a}g.makeNewsletterResponseSuccess=a}),98);
__d("WASmaxMessageDeliverNewsletterRPC",["WASmaxInMessageDeliverNewsletterRequest","WASmaxOutMessageDeliverNewsletterResponseError","WASmaxOutMessageDeliverNewsletterResponseSuccess","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverNewsletterRequest").parseNewsletterRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Newsletter",{Request:b}));return{parsedRequest:b.value,makeNewsletterResponseError:function(){return d("WASmaxOutMessageDeliverNewsletterResponseError").makeNewsletterResponseError(a)},makeNewsletterResponseSuccess:function(){return d("WASmaxOutMessageDeliverNewsletterResponseSuccess").makeNewsletterResponseSuccess(a)}}}g.receiveNewsletterRPC=a}),98);
__d("WASmaxInMessageDeliverAutomatedMixin",["WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"automated");return!b.success?b:d("WASmaxParseUtils").voidSuccess}g.parseAutomatedMixin=a}),98);
__d("WASmaxInMessageDeliverBizAcceptTsMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(b.value,"accept_ts",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({bizAcceptTs:a.value})}g.parseBizAcceptTsMixin=a}),98);
__d("WASmaxInMessageDeliverBizROIMetricsGatingFlagsMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxParseUtils").attrStringEnum(b.value,"roi_enabled",d("WASmaxInMessageDeliverEnums").ENUM_0_1);return!a.success?a:d("WAResultOrError").makeResult({bizRoiEnabled:a.value})}g.parseBizROIMetricsGatingFlagsMixin=a}),98);
__d("WASmaxInMessageDeliverBizRolesMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(b.value,"host_storage",1,100);if(!a.success)return a;var c=d("WASmaxParseUtils").attrIntRange(b.value,"actual_actors",1,100);if(!c.success)return c;b=d("WASmaxParseUtils").attrIntRange(b.value,"privacy_mode_ts",0,void 0);return!b.success?b:d("WAResultOrError").makeResult({bizHostStorage:a.value,bizActualActors:c.value,bizPrivacyModeTs:b.value})}g.parseBizRolesMixin=a}),98);
__d("WASmaxInMessageDeliverBusinessBotGatingMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxParseUtils").flattenedChildWithTag(b.value,"gating");if(!a.success)return a;b=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"bot");if(!b.success)return b;a=d("WASmaxParseUtils").attrStringEnum(b.value,"state",d("WASmaxInMessageDeliverEnums").ENUM_ALLOW_BYPASS_DENY_ERROR);if(!a.success)return a;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,b.value,"v",1,void 0);return!b.success?b:d("WAResultOrError").makeResult({bizGatingBotState:a.value,bizGatingBotV:b.value})}g.parseBusinessBotGatingMixin=a}),98);
__d("WASmaxInMessageDeliverConversionRecipientStatusMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"conversion");if(!b.success)return b;a=d("WASmaxParseUtils").attrStringEnum(b.value,"recipient_status",d("WASmaxInMessageDeliverEnums").ENUM_MATCHED_UNMATCHED);return!a.success?a:d("WAResultOrError").makeResult({conversionRecipientStatus:a.value})}g.parseConversionRecipientStatusMixin=a}),98);
__d("WASmaxInMessageDeliverClickToWhatsAppTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"source_url");if(!b.success)return b;b=d("WASmaxParseUtils").contentString(a);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ctwa");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"source_url",h);if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"conversion_source");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"conversion_data");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"source_type");if(!f.success)return f;var g=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"entry_point_conversion_source");if(!g.success)return g;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"entry_point_conversion_app");return!a.success?a:d("WAResultOrError").makeResult({conversionSource:c.value,conversionData:e.value,sourceType:f.value,entryPointConversionSource:g.value,entryPointConversionApp:a.value,sourceUrl:b.value})}g.parseClickToWhatsAppTypeSourceUrl=h;g.parseClickToWhatsAppTypeMixin=a}),98);
__d("WASmaxInMessageDeliverCtwaConversionMixin",["WAResultOrError","WASmaxInMessageDeliverClickToWhatsAppTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"ctwa");if(!b.success)return b;b=d("WASmaxInMessageDeliverClickToWhatsAppTypeMixin").parseClickToWhatsAppTypeMixin(a);return!b.success?b:b}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"ctwa",h);return!b.success?b:d("WAResultOrError").makeResult({ctwa:b.value})}g.parseCtwaConversionCtwa=h;g.parseCtwaConversionMixin=a}),98);
__d("WASmaxInMessageDeliverButtonsMixin",["WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxParseUtils").flattenedChildWithTag(b.value,"buttons");return!a.success?a:d("WASmaxParseUtils").voidSuccess}g.parseButtonsMixin=a}),98);
__d("WASmaxInMessageDeliverHSMReviewMetadataMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"category");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"tag");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"id");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"sub_tag");if(!f.success)return f;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"mask_linked_devices",d("WASmaxInMessageDeliverEnums").ENUM_FALSE_TRUE);return!a.success?a:d("WAResultOrError").makeResult({category:b.value,tag:c.value,id:e.value,subTag:f.value,maskLinkedDevices:a.value})}g.parseHSMReviewMetadataMixin=a}),98);
__d("WASmaxInMessageDeliverHsmMixin",["WASmaxInMessageDeliverHSMReviewMetadataMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"hsm");if(!b.success)return b;a=d("WASmaxInMessageDeliverHSMReviewMetadataMixin").parseHSMReviewMetadataMixin(b.value);return!a.success?a:a}g.parseHsmMixin=a}),98);
__d("WASmaxInMessageDeliverExtensionsMetadataMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"capability");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"name");return!b.success?b:d("WAResultOrError").makeResult({name:b.value})}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"capabilities");if(!b.success)return b;b=d("WASmaxParseUtils").mapChildrenWithTag(a,"capability",1,50,h);return!b.success?b:d("WAResultOrError").makeResult({capability:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"native_flow");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"extensions_metadata");if(!b.success)return b;a=d("WASmaxParseUtils").optionalChildWithTag(b.value,"capabilities",i);if(!a.success)return a;var c=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,b.value,"well_version",1,void 0);if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,b.value,"data_api_version",1,void 0);if(!e.success)return e;b=d("WASmaxParseUtils").attrIntRange(b.value,"flow_message_version",1,void 0);return!b.success?b:d("WAResultOrError").makeResult({extensionsMetadataWellVersion:c.value,extensionsMetadataDataApiVersion:e.value,extensionsMetadataFlowMessageVersion:b.value,extensionsMetadataCapabilities:a.value})}g.parseExtensionsMetadataExtensionsMetadataCapabilitiesCapability=h;g.parseExtensionsMetadataExtensionsMetadataCapabilities=i;g.parseExtensionsMetadataMixin=a}),98);
__d("WASmaxInMessageDeliverNativeFlowMessageTypeMixin",["WAResultOrError","WASmaxInMessageDeliverExtensionsMetadataMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"interactive");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"native_flow");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","native_flow");if(!a.success)return a;var c=d("WASmaxParseUtils").attrString(b.value,"name");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,b.value,"v",1,void 0);if(!e.success)return e;b=d("WASmaxInMessageDeliverExtensionsMetadataMixin").parseExtensionsMetadataMixin(b.value);return d("WAResultOrError").makeResult({type:a.value,nativeFlowName:c.value,nativeFlowV:e.value,nativeFlowExtensionsMetadataMixin:b.success?b.value:null})}g.parseNativeFlowMessageTypeMixin=a}),98);
__d("WASmaxInMessageDeliverInteractiveMixin",["WAResultOrError","WASmaxInMessageDeliverNativeFlowMessageTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxParseUtils").flattenedChildWithTag(b.value,"interactive");if(!a.success)return a;b=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,a.value,"v","1");if(!b.success)return b;a=d("WASmaxInMessageDeliverNativeFlowMessageTypeMixin").parseNativeFlowMessageTypeMixin(a.value);return!a.success?a:d("WAResultOrError").makeResult({bizInteractiveV:b.value,bizInteractiveNativeFlowMessageTypeMixin:a.value})}g.parseInteractiveMixin=a}),98);
__d("WASmaxInMessageDeliverNativeFlowMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxParseUtils").attrStringEnum(b.value,"native_flow_name",d("WASmaxInMessageDeliverEnums").ENUM_CATALOGMESSAGE_LANELINECALL_MENUOPTIONS_NOVICOMPLETETRANSACTION_NOVIHUB_NOVILOGIN_NOVIREPORTTRANSACTION_NOVIVIEWBANKDETAIL_NOVIVIEWCARDDETAIL_NOVIVIEWCODE_NOVIVIEWTRANSACTION_ORDERDETAILS_ORDERSTATUS_OTP_PAYMENTMETHOD_PAYMENTSTATUS_VOICECALL);if(!a.success)return a;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,b.value,"native_flow_version",1,void 0);return!b.success?b:d("WAResultOrError").makeResult({bizNativeFlowName:a.value,bizNativeFlowVersion:b.value})}g.parseNativeFlowMixin=a}),98);
__d("WASmaxInMessageDeliverProductListMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxParseUtils").flattenedChildWithTag(b.value,"list");if(!a.success)return a;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a.value,"type","product_list");return!b.success?b:d("WAResultOrError").makeResult({bizListType:b.value})}g.parseProductListMixin=a}),98);
__d("WASmaxInMessageDeliverHsmOrButtonsOrNativeFlowOrInteractiveOrProductListMixinGroup",["WAResultOrError","WASmaxInMessageDeliverButtonsMixin","WASmaxInMessageDeliverHsmMixin","WASmaxInMessageDeliverInteractiveMixin","WASmaxInMessageDeliverNativeFlowMixin","WASmaxInMessageDeliverProductListMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverHsmMixin").parseHsmMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"Hsm",value:b.value});var c=d("WASmaxInMessageDeliverButtonsMixin").parseButtonsMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"Buttons",value:c.value});var e=d("WASmaxInMessageDeliverNativeFlowMixin").parseNativeFlowMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"NativeFlow",value:e.value});var f=d("WASmaxInMessageDeliverInteractiveMixin").parseInteractiveMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"Interactive",value:f.value});var g=d("WASmaxInMessageDeliverProductListMixin").parseProductListMixin(a);return g.success?d("WAResultOrError").makeResult({name:"ProductList",value:g.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Hsm","Buttons","NativeFlow","Interactive","ProductList"],[b,c,e,f,g])}g.parseHsmOrButtonsOrNativeFlowOrInteractiveOrProductListMixinGroup=a}),98);
__d("WASmaxInMessageDeliverBizOriginalEnvelopeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"biz");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"original_envelope");if(!b.success)return b;a=d("WASmaxParseUtils").contentBytesRange(b.value,1,102400);return!a.success?a:d("WAResultOrError").makeResult({originalEnvelopeElementValue:a.value})}g.parseBizOriginalEnvelopeMixin=a}),98);
__d("WASmaxInMessageDeliverOriginalEnvelopeMixin",["WASmaxInMessageDeliverBizOriginalEnvelopeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxInMessageDeliverBizOriginalEnvelopeMixin").parseBizOriginalEnvelopeMixin(b.value);return!a.success?a:a}g.parseOriginalEnvelopeMixin=a}),98);
__d("WASmaxInMessageDeliverBizMixin",["WAResultOrError","WASmaxInMessageDeliverBizAcceptTsMixin","WASmaxInMessageDeliverBizROIMetricsGatingFlagsMixin","WASmaxInMessageDeliverBizRolesMixin","WASmaxInMessageDeliverBusinessBotGatingMixin","WASmaxInMessageDeliverConversionRecipientStatusMixin","WASmaxInMessageDeliverCtwaConversionMixin","WASmaxInMessageDeliverHsmOrButtonsOrNativeFlowOrInteractiveOrProductListMixinGroup","WASmaxInMessageDeliverOriginalEnvelopeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverBizRolesMixin").parseBizRolesMixin(a);var c=d("WASmaxInMessageDeliverBizAcceptTsMixin").parseBizAcceptTsMixin(a),e=d("WASmaxInMessageDeliverBizROIMetricsGatingFlagsMixin").parseBizROIMetricsGatingFlagsMixin(a),f=d("WASmaxInMessageDeliverOriginalEnvelopeMixin").parseOriginalEnvelopeMixin(a),g=d("WASmaxInMessageDeliverConversionRecipientStatusMixin").parseConversionRecipientStatusMixin(a),h=d("WASmaxInMessageDeliverCtwaConversionMixin").parseCtwaConversionMixin(a),i=d("WASmaxInMessageDeliverBusinessBotGatingMixin").parseBusinessBotGatingMixin(a);a=d("WASmaxInMessageDeliverHsmOrButtonsOrNativeFlowOrInteractiveOrProductListMixinGroup").parseHsmOrButtonsOrNativeFlowOrInteractiveOrProductListMixinGroup(a);return d("WAResultOrError").makeResult({bizRolesMixin:b.success?b.value:null,bizAcceptTsMixin:c.success?c.value:null,bizROIMetricsGatingFlagsMixin:e.success?e.value:null,originalEnvelopeMixin:f.success?f.value:null,conversionRecipientStatusMixin:g.success?g.value:null,ctwaConversionMixin:h.success?h.value:null,businessBotGatingMixin:i.success?i.value:null,hsmOrButtonsOrNativeFlowOrInteractiveOrProductListMixinGroup:a.success?a.value:null})}g.parseBizMixin=a}),98);
__d("WASmaxInMessageDeliverDHashMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"dhash");return!b.success?b:d("WAResultOrError").makeResult({dhash:b.value})}g.parseDHashMixin=a}),98);
__d("WASmaxInMessageDeliverFolderIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrInt(a,"folder_id");return!a.success?a:d("WAResultOrError").makeResult({folderId:a.value})}g.parseFolderIDMixin=a}),98);
__d("WASmaxInMessageDeliverFolderMixin",["WASmaxInMessageDeliverFolderIDMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxInMessageDeliverFolderIDMixin").parseFolderIDMixin(b.value);return!a.success?a:a}g.parseFolderMixin=a}),98);
__d("WASmaxInMessageDeliverClientFrankingTagMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"franking");if(!a.success)return a;a=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"franking_tag");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytesRange(a.value,32,128);return!a.success?a:d("WAResultOrError").makeResult({frankingFrankingTagElementValue:a.value})}g.parseClientFrankingTagMixin=a}),98);
__d("WASmaxInMessageDeliverServerFrankingTagMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"franking");if(!a.success)return a;a=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"reporting_tag");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytesRange(a.value,16,128);return!a.success?a:d("WAResultOrError").makeResult({frankingReportingTagElementValue:a.value})}g.parseServerFrankingTagMixin=a}),98);
__d("WASmaxInMessageDeliverFrankingMixin",["WAResultOrError","WASmaxInMessageDeliverClientFrankingTagMixin","WASmaxInMessageDeliverServerFrankingTagMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverClientFrankingTagMixin").parseClientFrankingTagMixin(a);a=d("WASmaxInMessageDeliverServerFrankingTagMixin").parseServerFrankingTagMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({clientFrankingTagMixin:b.success?b.value:null},a.value))}g.parseFrankingMixin=a}),98);
__d("WASmaxInMessageDeliverInternalTestMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"test");if(!a.success)return a;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a.value,"config");return!a.success?a:d("WAResultOrError").makeResult({testConfig:a.value})}g.parseInternalTestMixin=a}),98);
__d("WASmaxInMessageDeliverMetaHideDecryptionPlaceholderMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!a.success)return a;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a.value,"decrypt-fail","hide");return!a.success?a:d("WAResultOrError").makeResult({metaDecryptFail:a.value})}g.parseMetaHideDecryptionPlaceholderMixin=a}),98);
__d("WASmaxInMessageDeliverMulticastMixin",["WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"multicast");return!b.success?b:d("WASmaxParseUtils").voidSuccess}g.parseMulticastMixin=a}),98);
__d("WASmaxInMessageDeliverPaddingMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"padding");if(!b.success)return b;a=d("WASmaxParseUtils").contentBytesRange(b.value,0,128);return!a.success?a:d("WAResultOrError").makeResult({paddingElementValue:a.value})}g.parsePaddingMixin=a}),98);
__d("WASmaxInMessageDeliverPreFilledNumberMixin",["WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"url_number");return!b.success?b:d("WASmaxParseUtils").voidSuccess}g.parsePreFilledNumberMixin=a}),98);
__d("WASmaxInMessageDeliverPreFilledTextMixin",["WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"url_text");return!b.success?b:d("WASmaxParseUtils").voidSuccess}g.parsePreFilledTextMixin=a}),98);
__d("WASmaxInMessageDeliverPushNameMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"notify");return!b.success?b:d("WAResultOrError").makeResult({notify:b.value})}g.parsePushNameMixin=a}),98);
__d("WASmaxInMessageDeliverRequestIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"trace");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"request_id");if(!b.success)return b;a=d("WASmaxParseUtils").contentBytesRange(b.value,1,16);return!a.success?a:d("WAResultOrError").makeResult({requestIdElementValue:a.value})}g.parseRequestIDMixin=a}),98);
__d("WASmaxInMessageDeliverTraceIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"edge_id");if(!b.success)return b;b=d("WASmaxParseUtils").contentBytesRange(a,1,8);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"trace");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"trace_id");if(!b.success)return b;a=d("WASmaxParseUtils").optionalChildWithTag(a,"edge_id",h);if(!a.success)return a;b=d("WASmaxParseUtils").contentBytesRange(b.value,1,8);return!b.success?b:d("WAResultOrError").makeResult({traceIdElementValue:b.value,edgeId:a.value})}g.parseTraceIDEdgeId=h;g.parseTraceIDMixin=a}),98);
__d("WASmaxInMessageDeliverRequestOrTraceIDMixinGroup",["WAResultOrError","WASmaxInMessageDeliverRequestIDMixin","WASmaxInMessageDeliverTraceIDMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverRequestIDMixin").parseRequestIDMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"RequestID",value:b.value});var c=d("WASmaxInMessageDeliverTraceIDMixin").parseTraceIDMixin(a);return c.success?d("WAResultOrError").makeResult({name:"TraceID",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["RequestID","TraceID"],[b,c])}g.parseRequestOrTraceIDMixinGroup=a}),98);
__d("WASmaxInMessageDeliverTraceContextMixin",["WAResultOrError","WASmaxInMessageDeliverRequestOrTraceIDMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"trace");if(!a.success)return a;a=d("WASmaxInMessageDeliverRequestOrTraceIDMixinGroup").parseRequestOrTraceIDMixinGroup(a.value);return!a.success?a:d("WAResultOrError").makeResult({traceRequestOrTraceIDMixinGroup:a.value})}g.parseTraceContextMixin=a}),98);
__d("WASmaxInMessageDeliverTriggerBlockMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"tb_cooldown",0,void 0);if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(a,"tb_expiration_ts",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({tbCooldown:b.value,tbExpirationTs:a.value})}g.parseTriggerBlockMixin=a}),98);
__d("WASmaxInMessageDeliverTriggerMessageCSATAttributesMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").attrIntRange(a,"tm_csat_cooldown",0,void 0);if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(a,"tm_csat_exp_ts",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({tmCsatCooldown:b.value,tmCsatExpTs:a.value})}g.parseTriggerMessageCSATAttributesMixin=a}),98);
__d("WASmaxInMessageDeliverTriggerMessageCSATMixin",["WASmaxInMessageDeliverTriggerMessageCSATAttributesMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxInMessageDeliverTriggerMessageCSATAttributesMixin").parseTriggerMessageCSATAttributesMixin(b.value);return!a.success?a:a}g.parseTriggerMessageCSATMixin=a}),98);
__d("WASmaxInMessageDeliverVerifiedNameCertificateMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"verified_name");if(!b.success)return b;a=d("WASmaxParseUtils").attrInt(b.value,"v");if(!a.success)return a;var c=d("WASmaxParseUtils").attrStringEnum(b.value,"verified_level",d("WASmaxInMessageDeliverEnums").ENUM_HIGH_LOW_UNKNOWN);if(!c.success)return c;b=d("WASmaxParseUtils").contentBytesRange(b.value,1,1024);return!b.success?b:d("WAResultOrError").makeResult({verifiedNameV:a.value,verifiedNameVerifiedLevel:c.value,verifiedNameElementValue:b.value})}g.parseVerifiedNameCertificateMixin=a}),98);
__d("WASmaxInMessageDeliverVerifiedNameLevelMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"verified_level",d("WASmaxInMessageDeliverEnums").ENUM_HIGH_LOW_UNKNOWN);return!b.success?b:d("WAResultOrError").makeResult({verifiedLevel:b.value})}g.parseVerifiedNameLevelMixin=a}),98);
__d("WASmaxInMessageDeliverVerifiedNameNameMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"verified_name");return!b.success?b:d("WAResultOrError").makeResult({verifiedName:b.value})}g.parseVerifiedNameNameMixin=a}),98);
__d("WASmaxInMessageDeliverVerifiedNameMixin",["WAResultOrError","WASmaxInMessageDeliverVerifiedNameCertificateMixin","WASmaxInMessageDeliverVerifiedNameLevelMixin","WASmaxInMessageDeliverVerifiedNameNameMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverVerifiedNameNameMixin").parseVerifiedNameNameMixin(a);if(!b.success)return b;var c=d("WASmaxInMessageDeliverVerifiedNameLevelMixin").parseVerifiedNameLevelMixin(a);if(!c.success)return c;a=d("WASmaxInMessageDeliverVerifiedNameCertificateMixin").parseVerifiedNameCertificateMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,c.value,{verifiedNameCertificateMixin:a.success?a.value:null}))}g.parseVerifiedNameMixin=a}),98);
__d("WASmaxInMessageDeliverClientReportingTokenMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"reporting");if(!a.success)return a;a=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"reporting_token");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytesRange(a.value,32,128);return!a.success?a:d("WAResultOrError").makeResult({reportingReportingTokenElementValue:a.value})}g.parseClientReportingTokenMixin=a}),98);
__d("WASmaxInMessageDeliverServerReportingTokenMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"reporting");if(!a.success)return a;a=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"reporting_tag");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytesRange(a.value,16,128);return!a.success?a:d("WAResultOrError").makeResult({reportingReportingTagElementValue:a.value})}g.parseServerReportingTokenMixin=a}),98);
__d("WASmaxInMessageDeliverWaReportingMixin",["WAResultOrError","WASmaxInMessageDeliverClientReportingTokenMixin","WASmaxInMessageDeliverServerReportingTokenMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverClientReportingTokenMixin").parseClientReportingTokenMixin(a);a=d("WASmaxInMessageDeliverServerReportingTokenMixin").parseServerReportingTokenMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({clientReportingTokenMixin:b.success?b.value:null},a.value))}g.parseWaReportingMixin=a}),98);
__d("WASmaxInMessageDeliverBaseMixin",["WAResultOrError","WASmaxInMessageDeliverAutomatedMixin","WASmaxInMessageDeliverBizMixin","WASmaxInMessageDeliverDHashMixin","WASmaxInMessageDeliverDeviceIdentityMixin","WASmaxInMessageDeliverFolderMixin","WASmaxInMessageDeliverFrankingMixin","WASmaxInMessageDeliverInternalTestMixin","WASmaxInMessageDeliverMetaHideDecryptionPlaceholderMixin","WASmaxInMessageDeliverMulticastMixin","WASmaxInMessageDeliverOfflineMixin","WASmaxInMessageDeliverPaddingMixin","WASmaxInMessageDeliverPreFilledNumberMixin","WASmaxInMessageDeliverPreFilledTextMixin","WASmaxInMessageDeliverPushNameMixin","WASmaxInMessageDeliverRegistrationIDMixin","WASmaxInMessageDeliverTraceContextMixin","WASmaxInMessageDeliverTriggerBlockMixin","WASmaxInMessageDeliverTriggerMessageCSATMixin","WASmaxInMessageDeliverVerifiedNameMixin","WASmaxInMessageDeliverWaReportingMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverTriggerBlockMixin").parseTriggerBlockMixin(a);var c=d("WASmaxInMessageDeliverTriggerMessageCSATMixin").parseTriggerMessageCSATMixin(a),e=d("WASmaxInMessageDeliverOfflineMixin").parseOfflineMixin(a),f=d("WASmaxInMessageDeliverPushNameMixin").parsePushNameMixin(a),g=d("WASmaxInMessageDeliverDeviceIdentityMixin").parseDeviceIdentityMixin(a),h=d("WASmaxInMessageDeliverVerifiedNameMixin").parseVerifiedNameMixin(a),i=d("WASmaxInMessageDeliverBizMixin").parseBizMixin(a),j=d("WASmaxInMessageDeliverMulticastMixin").parseMulticastMixin(a),k=d("WASmaxInMessageDeliverPreFilledTextMixin").parsePreFilledTextMixin(a),l=d("WASmaxInMessageDeliverPreFilledNumberMixin").parsePreFilledNumberMixin(a),m=d("WASmaxInMessageDeliverAutomatedMixin").parseAutomatedMixin(a),n=d("WASmaxInMessageDeliverDHashMixin").parseDHashMixin(a),o=d("WASmaxInMessageDeliverRegistrationIDMixin").parseRegistrationIDMixin(a),p=d("WASmaxInMessageDeliverFolderMixin").parseFolderMixin(a),q=d("WASmaxInMessageDeliverFrankingMixin").parseFrankingMixin(a),r=d("WASmaxInMessageDeliverWaReportingMixin").parseWaReportingMixin(a),s=d("WASmaxInMessageDeliverInternalTestMixin").parseInternalTestMixin(a),t=d("WASmaxInMessageDeliverMetaHideDecryptionPlaceholderMixin").parseMetaHideDecryptionPlaceholderMixin(a),u=d("WASmaxInMessageDeliverTraceContextMixin").parseTraceContextMixin(a);a=d("WASmaxInMessageDeliverPaddingMixin").parsePaddingMixin(a);return d("WAResultOrError").makeResult({triggerBlockMixin:b.success?b.value:null,triggerMessageCSATMixin:c.success?c.value:null,offlineMixin:e.success?e.value:null,pushNameMixin:f.success?f.value:null,deviceIdentityMixin:g.success?g.value:null,verifiedNameMixin:h.success?h.value:null,bizMixin:i.success?i.value:null,hasMulticastMixin:j.success,hasPreFilledTextMixin:k.success,hasPreFilledNumberMixin:l.success,hasAutomatedMixin:m.success,dHashMixin:n.success?n.value:null,registrationIDMixin:o.success?o.value:null,folderMixin:p.success?p.value:null,frankingMixin:q.success?q.value:null,waReportingMixin:r.success?r.value:null,internalTestMixin:s.success?s.value:null,metaHideDecryptionPlaceholderMixin:t.success?t.value:null,traceContextMixin:u.success?u.value:null,paddingMixin:a.success?a.value:null})}g.parseBaseMixin=a}),98);
__d("WASmaxInMessageDeliverEncMediaTypeFutureproofMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"mediatype");return!b.success?b:d("WAResultOrError").makeResult({mediatype:b.value})}g.parseEncMediaTypeFutureproofMixin=a}),98);
__d("WASmaxInMessageDeliverAvatarStickerTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"sticker_type","avatar");return!b.success?b:d("WAResultOrError").makeResult({stickerType:b.value})}g.parseAvatarStickerTypeMixin=a}),98);
__d("WASmaxInMessageDeliverMediaTypeMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"mediatype",d("WASmaxInMessageDeliverEnums").ENUM_AUDIO_AVATARSTICKER_BUTTONSRESPONSE_CATALOGLINK_CONTACT_CONTACTARRAY_DOCUMENT_GENAISTICKER_GIF_HISTORY_IMAGE_LISTRESPONSE_LOCATION_NATIVEFLOWRESPONSE_ORDER_PRODUCT_PRODUCTLINK_PTT_PTV_STICKER_URL_VCARD_VIDEO_XMA);return!b.success?b:d("WAResultOrError").makeResult({mediatype:b.value})}g.parseMediaTypeMixin=a}),98);
__d("WASmaxInMessageDeliverEncMediaTypeMixin",["WAResultOrError","WASmaxInMessageDeliverAvatarStickerTypeMixin","WASmaxInMessageDeliverEnums","WASmaxInMessageDeliverMediaTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"native_flow_name",d("WASmaxInMessageDeliverEnums").ENUM_ADDRESSMESSAGE_FORMMESSAGE_GALAXYMESSAGE_MENUOPTIONS);if(!b.success)return b;var c=d("WASmaxInMessageDeliverMediaTypeMixin").parseMediaTypeMixin(a);if(!c.success)return c;a=d("WASmaxInMessageDeliverAvatarStickerTypeMixin").parseAvatarStickerTypeMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({nativeFlowName:b.value},c.value,{avatarStickerTypeMixin:a.success?a.value:null}))}g.parseEncMediaTypeMixin=a}),98);
__d("WASmaxInMessageDeliverEncMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup",["WAResultOrError","WASmaxInMessageDeliverEncMediaTypeFutureproofMixin","WASmaxInMessageDeliverEncMediaTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverEncMediaTypeMixin").parseEncMediaTypeMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"EncMediaType",value:b.value});var c=d("WASmaxInMessageDeliverEncMediaTypeFutureproofMixin").parseEncMediaTypeFutureproofMixin(a);return c.success?d("WAResultOrError").makeResult({name:"EncMediaTypeFutureproof",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["EncMediaType","EncMediaTypeFutureproof"],[b,c])}g.parseEncMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup=a}),98);
__d("WASmaxInMessageDeliverEncTypeSenderKeyMixin",["WAResultOrError","WASmaxInMessageDeliverEncHideDecryptionPlaceholderMixin","WASmaxInMessageDeliverEncPayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","skmsg");if(!b.success)return b;var c=d("WASmaxInMessageDeliverEncHideDecryptionPlaceholderMixin").parseEncHideDecryptionPlaceholderMixin(a);a=d("WASmaxInMessageDeliverEncPayloadMixin").parseEncPayloadMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({type:b.value,encHideDecryptionPlaceholderMixin:c.success?c.value:null},a.value))}g.parseEncTypeSenderKeyMixin=a}),98);
__d("WASmaxInMessageDeliverEncTypeSenderKeyAndBroadcastMediaMixin",["WAResultOrError","WASmaxInMessageDeliverEncMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup","WASmaxInMessageDeliverEncTypeSenderKeyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxInMessageDeliverEncTypeSenderKeyMixin").parseEncTypeSenderKeyMixin(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverEncMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup").parseEncMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{encMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup:a.value}))}g.parseEncTypeSenderKeyAndBroadcastMediaMixin=a}),98);
__d("WASmaxInMessageDeliverEncTypeSenderKeyAndBroadcastMediaOrIndividualMixinGroup",["WAResultOrError","WASmaxInMessageDeliverEncTypeIndividualMixin","WASmaxInMessageDeliverEncTypeSenderKeyAndBroadcastMediaMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverEncTypeSenderKeyAndBroadcastMediaMixin").parseEncTypeSenderKeyAndBroadcastMediaMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"EncTypeSenderKeyAndBroadcastMedia",value:b.value});var c=d("WASmaxInMessageDeliverEncTypeIndividualMixin").parseEncTypeIndividualMixin(a);return c.success?d("WAResultOrError").makeResult({name:"EncTypeIndividual",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["EncTypeSenderKeyAndBroadcastMedia","EncTypeIndividual"],[b,c])}g.parseEncTypeSenderKeyAndBroadcastMediaOrIndividualMixinGroup=a}),98);
__d("WASmaxInMessageDeliverBroadcastDualEncMediaMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeMediaMixin","WASmaxInMessageDeliverEncTypeSenderKeyAndBroadcastMediaOrIndividualMixinGroup","WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup").parseEncVersion2Or3OrFutureproofMixinGroup(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverEncTypeSenderKeyAndBroadcastMediaOrIndividualMixinGroup").parseEncTypeSenderKeyAndBroadcastMediaOrIndividualMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({encVersion2Or3OrFutureproofMixinGroup:b.value,encTypeSenderKeyAndBroadcastMediaOrIndividualMixinGroup:a.value})}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"rcat");if(!b.success)return b;b=d("WASmaxParseUtils").contentBytes(a);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"rcat",i);if(!b.success)return b;var c=d("WASmaxInMessageDeliverContentTypeMediaMixin").parseContentTypeMediaMixin(a);if(!c.success)return c;a=d("WASmaxParseUtils").mapChildrenWithTag(a,"enc",2,2,h);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},c.value,{rcat:b.value,enc:a.value}))}g.parseBroadcastDualEncMediaEnc=h;g.parseBroadcastDualEncMediaRcat=i;g.parseBroadcastDualEncMediaMixin=a}),98);
__d("WASmaxInMessageDeliverEncTypeSenderKeyOrIndividualMixinGroup",["WAResultOrError","WASmaxInMessageDeliverEncTypeIndividualMixin","WASmaxInMessageDeliverEncTypeSenderKeyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverEncTypeSenderKeyMixin").parseEncTypeSenderKeyMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"EncTypeSenderKey",value:b.value});var c=d("WASmaxInMessageDeliverEncTypeIndividualMixin").parseEncTypeIndividualMixin(a);return c.success?d("WAResultOrError").makeResult({name:"EncTypeIndividual",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["EncTypeSenderKey","EncTypeIndividual"],[b,c])}g.parseEncTypeSenderKeyOrIndividualMixinGroup=a}),98);
__d("WASmaxInMessageDeliverBroadcastDualEncNonMediaMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeTextMixin","WASmaxInMessageDeliverEncTypeSenderKeyOrIndividualMixinGroup","WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup").parseEncVersion2Or3OrFutureproofMixinGroup(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverEncTypeSenderKeyOrIndividualMixinGroup").parseEncTypeSenderKeyOrIndividualMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({encVersion2Or3OrFutureproofMixinGroup:b.value,encTypeSenderKeyOrIndividualMixinGroup:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverContentTypeTextMixin").parseContentTypeTextMixin(a);if(!b.success)return b;a=d("WASmaxParseUtils").mapChildrenWithTag(a,"enc",2,2,h);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{enc:a.value}))}g.parseBroadcastDualEncNonMediaEnc=h;g.parseBroadcastDualEncNonMediaMixin=a}),98);
__d("WASmaxInMessageDeliverBroadcastDualEncBroadcastDualEncMediaOrBroadcastDualEncNonMediaMediaMixinGroup",["WAResultOrError","WASmaxInMessageDeliverBroadcastDualEncMediaMixin","WASmaxInMessageDeliverBroadcastDualEncNonMediaMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverBroadcastDualEncMediaMixin").parseBroadcastDualEncMediaMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"BroadcastDualEncMedia",value:b.value});var c=d("WASmaxInMessageDeliverBroadcastDualEncNonMediaMixin").parseBroadcastDualEncNonMediaMixin(a);return c.success?d("WAResultOrError").makeResult({name:"BroadcastDualEncNonMedia",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["BroadcastDualEncMedia","BroadcastDualEncNonMedia"],[b,c])}g.parseBroadcastDualEncBroadcastDualEncMediaOrBroadcastDualEncNonMediaMediaMixinGroup=a}),98);
__d("WASmaxInMessageDeliverBroadcastEphemeralMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrString(a,"eph_setting");return!a.success?a:d("WAResultOrError").makeResult({ephSetting:a.value})}g.parseBroadcastEphemeralMixin=a}),98);
__d("WASmaxInMessageDeliverToUserMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"to");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"jid");return!b.success?b:d("WAResultOrError").makeResult({jid:b.value})}g.parseToUserMixin=a}),98);
__d("WASmaxInMessageDeliverBroadcastParticipantsMixin",["WAResultOrError","WASmaxInMessageDeliverBroadcastEphemeralMixin","WASmaxInMessageDeliverToUserMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"to");if(!b.success)return b;b=d("WASmaxInMessageDeliverToUserMixin").parseToUserMixin(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverBroadcastEphemeralMixin").parseBroadcastEphemeralMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{broadcastEphemeralMixin:a.success?a.value:null}))}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"participants");if(!b.success)return b;a=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"to",0,256,h);return!a.success?a:d("WAResultOrError").makeResult({participantsTo:a.value})}g.parseBroadcastParticipantsParticipantsTo=h;g.parseBroadcastParticipantsMixin=a}),98);
__d("WASmaxInMessageDeliverBroadcastDualEncMixin",["WAResultOrError","WASmaxInMessageDeliverBroadcastDualEncBroadcastDualEncMediaOrBroadcastDualEncNonMediaMediaMixinGroup","WASmaxInMessageDeliverBroadcastParticipantsMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverBroadcastParticipantsMixin").parseBroadcastParticipantsMixin(a);a=d("WASmaxInMessageDeliverBroadcastDualEncBroadcastDualEncMediaOrBroadcastDualEncNonMediaMediaMixinGroup").parseBroadcastDualEncBroadcastDualEncMediaOrBroadcastDualEncNonMediaMediaMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({broadcastParticipantsMixin:b.success?b.value:null,broadcastDualEncBroadcastDualEncMediaOrBroadcastDualEncNonMediaMediaMixinGroup:a.value})}g.parseBroadcastDualEncMixin=a}),98);
__d("WASmaxInMessageDeliverContentTypeMedianotifyMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","medianotify");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseContentTypeMedianotifyMixin=a}),98);
__d("WASmaxInMessageDeliverContentTypeMediaOrMedianotifyMixinGroup",["WAResultOrError","WASmaxInMessageDeliverContentTypeMediaMixin","WASmaxInMessageDeliverContentTypeMedianotifyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverContentTypeMediaMixin").parseContentTypeMediaMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"ContentTypeMedia",value:b.value});var c=d("WASmaxInMessageDeliverContentTypeMedianotifyMixin").parseContentTypeMedianotifyMixin(a);return c.success?d("WAResultOrError").makeResult({name:"ContentTypeMedianotify",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ContentTypeMedia","ContentTypeMedianotify"],[b,c])}g.parseContentTypeMediaOrMedianotifyMixinGroup=a}),98);
__d("WASmaxInMessageDeliverContentTypeMediaSingleMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeMediaOrMedianotifyMixinGroup","WASmaxInMessageDeliverEncMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"rcat");if(!b.success)return b;b=d("WASmaxParseUtils").contentBytes(a);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"enc");if(!b.success)return b;var c=d("WASmaxParseUtils").optionalChildWithTag(a,"rcat",h);if(!c.success)return c;b=d("WASmaxInMessageDeliverEncMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup").parseEncMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup(b.value);if(!b.success)return b;a=d("WASmaxInMessageDeliverContentTypeMediaOrMedianotifyMixinGroup").parseContentTypeMediaOrMedianotifyMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({encEncMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup:b.value,contentTypeMediaOrMedianotifyMixinGroup:a.value,rcat:c.value})}g.parseContentTypeMediaSingleRcat=h;g.parseContentTypeMediaSingleMixin=a}),98);
__d("WASmaxInMessageDeliverContentTypeTextOrMediaSingleMixinGroup",["WAResultOrError","WASmaxInMessageDeliverContentTypeMediaSingleMixin","WASmaxInMessageDeliverContentTypeTextMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverContentTypeTextMixin").parseContentTypeTextMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"ContentTypeText",value:b.value});var c=d("WASmaxInMessageDeliverContentTypeMediaSingleMixin").parseContentTypeMediaSingleMixin(a);return c.success?d("WAResultOrError").makeResult({name:"ContentTypeMediaSingle",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ContentTypeText","ContentTypeMediaSingle"],[b,c])}g.parseContentTypeTextOrMediaSingleMixinGroup=a}),98);
__d("WASmaxInMessageDeliverEncTypeIndividualOrSenderKeyMixinGroup",["WAResultOrError","WASmaxInMessageDeliverEncTypeIndividualMixin","WASmaxInMessageDeliverEncTypeSenderKeyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverEncTypeIndividualMixin").parseEncTypeIndividualMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"EncTypeIndividual",value:b.value});var c=d("WASmaxInMessageDeliverEncTypeSenderKeyMixin").parseEncTypeSenderKeyMixin(a);return c.success?d("WAResultOrError").makeResult({name:"EncTypeSenderKey",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["EncTypeIndividual","EncTypeSenderKey"],[b,c])}g.parseEncTypeIndividualOrSenderKeyMixinGroup=a}),98);
__d("WASmaxInMessageDeliverBroadcastRegularMixin",["WAResultOrError","WASmaxInMessageDeliverBroadcastParticipantsMixin","WASmaxInMessageDeliverEncTypeIndividualOrSenderKeyMixinGroup","WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"enc");if(!b.success)return b;a=d("WASmaxInMessageDeliverBroadcastParticipantsMixin").parseBroadcastParticipantsMixin(a);var c=d("WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup").parseEncVersion2Or3OrFutureproofMixinGroup(b.value);if(!c.success)return c;b=d("WASmaxInMessageDeliverEncTypeIndividualOrSenderKeyMixinGroup").parseEncTypeIndividualOrSenderKeyMixinGroup(b.value);return!b.success?b:d("WAResultOrError").makeResult({broadcastParticipantsMixin:a.success?a.value:null,encEncVersion2Or3OrFutureproofMixinGroup:c.value,encEncTypeIndividualOrSenderKeyMixinGroup:b.value})}g.parseBroadcastRegularMixin=a}),98);
__d("WASmaxInMessageDeliverRetryOrBroadcastRegularMixinGroup",["WAResultOrError","WASmaxInMessageDeliverBroadcastRegularMixin","WASmaxInMessageDeliverRetryMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverRetryMixin").parseRetryMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"Retry",value:b.value});var c=d("WASmaxInMessageDeliverBroadcastRegularMixin").parseBroadcastRegularMixin(a);return c.success?d("WAResultOrError").makeResult({name:"BroadcastRegular",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Retry","BroadcastRegular"],[b,c])}g.parseRetryOrBroadcastRegularMixinGroup=a}),98);
__d("WASmaxInMessageDeliverBroadcastSingleEncMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeTextOrMediaSingleMixinGroup","WASmaxInMessageDeliverRetryOrBroadcastRegularMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverContentTypeTextOrMediaSingleMixinGroup").parseContentTypeTextOrMediaSingleMixinGroup(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverRetryOrBroadcastRegularMixinGroup").parseRetryOrBroadcastRegularMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({contentTypeTextOrMediaSingleMixinGroup:b.value,retryOrBroadcastRegularMixinGroup:a.value})}g.parseBroadcastSingleEncMixin=a}),98);
__d("WASmaxInMessageDeliverBroadcastDualOrSingleEncMixinGroup",["WAResultOrError","WASmaxInMessageDeliverBroadcastDualEncMixin","WASmaxInMessageDeliverBroadcastSingleEncMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverBroadcastDualEncMixin").parseBroadcastDualEncMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"BroadcastDualEnc",value:b.value});var c=d("WASmaxInMessageDeliverBroadcastSingleEncMixin").parseBroadcastSingleEncMixin(a);return c.success?d("WAResultOrError").makeResult({name:"BroadcastSingleEnc",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["BroadcastDualEnc","BroadcastSingleEnc"],[b,c])}g.parseBroadcastDualOrSingleEncMixinGroup=a}),98);
__d("WASmaxInMessageDeliverFanoutCountMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrInt(a,"count");return!a.success?a:d("WAResultOrError").makeResult({count:a.value})}g.parseFanoutCountMixin=a}),98);
__d("WASmaxInMessageDeliverMessageEditMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"edit","1");return!b.success?b:d("WAResultOrError").makeResult({edit:b.value})}g.parseMessageEditMixin=a}),98);
__d("WASmaxInMessageDeliverMessageEditOrRevokeOrBroadcastEphemeralMixinGroup",["WAResultOrError","WASmaxInMessageDeliverBroadcastEphemeralMixin","WASmaxInMessageDeliverMessageEditMixin","WASmaxInMessageDeliverRevokeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverMessageEditMixin").parseMessageEditMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"MessageEdit",value:b.value});var c=d("WASmaxInMessageDeliverRevokeMixin").parseRevokeMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"Revoke",value:c.value});var e=d("WASmaxInMessageDeliverBroadcastEphemeralMixin").parseBroadcastEphemeralMixin(a);return e.success?d("WAResultOrError").makeResult({name:"BroadcastEphemeral",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["MessageEdit","Revoke","BroadcastEphemeral"],[b,c,e])}g.parseMessageEditOrRevokeOrBroadcastEphemeralMixinGroup=a}),98);
__d("WASmaxInMessageDeliverSMBBroadcastSourceMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,b.value,"biz_source","smb_promo");return!a.success?a:d("WAResultOrError").makeResult({metaBizSource:a.value})}g.parseSMBBroadcastSourceMixin=a}),98);
__d("WASmaxInMessageDeliverSMBBroadcastSourceWithCampaignMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!a.success)return a;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,b.value,"biz_source","smb_promo");if(!b.success)return b;a=d("WASmaxParseUtils").attrString(a.value,"campaign_id");return!a.success?a:d("WAResultOrError").makeResult({metaBizSource:b.value,bizCampaignId:a.value})}g.parseSMBBroadcastSourceWithCampaignMixin=a}),98);
__d("WASmaxInMessageDeliverBroadcastMixin",["WAResultOrError","WASmaxInMessageDeliverBroadcastDualOrSingleEncMixinGroup","WASmaxInMessageDeliverEnums","WASmaxInMessageDeliverFanoutCountMixin","WASmaxInMessageDeliverMessageEditOrRevokeOrBroadcastEphemeralMixinGroup","WASmaxInMessageDeliverSMBBroadcastSourceMixin","WASmaxInMessageDeliverSMBBroadcastSourceWithCampaignMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseJid").attrBroadcastJid(a,"from");if(!b.success)return b;var c=d("WASmaxParseJid").attrJidEnum(a,"participant",d("WASmaxInMessageDeliverEnums").DEVICEJID_DEVICEJID);if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"participant_pn");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"participant_lid");if(!f.success)return f;var g=d("WASmaxInMessageDeliverFanoutCountMixin").parseFanoutCountMixin(a),h=d("WASmaxInMessageDeliverSMBBroadcastSourceMixin").parseSMBBroadcastSourceMixin(a),i=d("WASmaxInMessageDeliverSMBBroadcastSourceWithCampaignMixin").parseSMBBroadcastSourceWithCampaignMixin(a),j=d("WASmaxInMessageDeliverBroadcastDualOrSingleEncMixinGroup").parseBroadcastDualOrSingleEncMixinGroup(a);if(!j.success)return j;a=d("WASmaxInMessageDeliverMessageEditOrRevokeOrBroadcastEphemeralMixinGroup").parseMessageEditOrRevokeOrBroadcastEphemeralMixinGroup(a);return d("WAResultOrError").makeResult({from:b.value,participant:c.value,participantPn:e.value,participantLid:f.value,fanoutCountMixin:g.success?g.value:null,sMBBroadcastSourceMixin:h.success?h.value:null,sMBBroadcastSourceWithCampaignMixin:i.success?i.value:null,broadcastDualOrSingleEncMixinGroup:j.value,messageEditOrRevokeOrBroadcastEphemeralMixinGroup:a.success?a.value:null})}g.parseBroadcastMixin=a}),98);
__d("WASmaxInMessageDeliverBotThreadIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"thread_id");return!b.success?b:d("WAResultOrError").makeResult({threadId:b.value})}g.parseBotThreadIDMixin=a}),98);
__d("WASmaxInMessageDeliverDisplayNameMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrString(a,"display_name");return!a.success?a:d("WAResultOrError").makeResult({displayName:a.value})}g.parseDisplayNameMixin=a}),98);
__d("WASmaxInMessageDeliverGroupAddressingModeMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrStringEnum(a,"addressing_mode",d("WASmaxInMessageDeliverEnums").ENUM_LID_PN);return!a.success?a:d("WAResultOrError").makeResult({addressingMode:a.value})}g.parseGroupAddressingModeMixin=a}),98);
__d("WASmaxInMessageDeliverEncListMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"mediatype","list");return!b.success?b:d("WAResultOrError").makeResult({mediatype:b.value})}g.parseEncListMixin=a}),98);
__d("WASmaxInMessageDeliverEncLiveLocationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"mediatype","livelocation");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(a,"duration",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({mediatype:b.value,duration:a.value})}g.parseEncLiveLocationMixin=a}),98);
__d("WASmaxInMessageDeliverEncLiveLocationOrListOrMediaTypeOrMediaTypeFutureproofMixinGroup",["WAResultOrError","WASmaxInMessageDeliverEncListMixin","WASmaxInMessageDeliverEncLiveLocationMixin","WASmaxInMessageDeliverEncMediaTypeFutureproofMixin","WASmaxInMessageDeliverEncMediaTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverEncLiveLocationMixin").parseEncLiveLocationMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"EncLiveLocation",value:b.value});var c=d("WASmaxInMessageDeliverEncListMixin").parseEncListMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"EncList",value:c.value});var e=d("WASmaxInMessageDeliverEncMediaTypeMixin").parseEncMediaTypeMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"EncMediaType",value:e.value});var f=d("WASmaxInMessageDeliverEncMediaTypeFutureproofMixin").parseEncMediaTypeFutureproofMixin(a);return f.success?d("WAResultOrError").makeResult({name:"EncMediaTypeFutureproof",value:f.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["EncLiveLocation","EncList","EncMediaType","EncMediaTypeFutureproof"],[b,c,e,f])}g.parseEncLiveLocationOrListOrMediaTypeOrMediaTypeFutureproofMixinGroup=a}),98);
__d("WASmaxInMessageDeliverEncTypeSenderKeyAndGroupMediaMixin",["WAResultOrError","WASmaxInMessageDeliverEncLiveLocationOrListOrMediaTypeOrMediaTypeFutureproofMixinGroup","WASmaxInMessageDeliverEncTypeSenderKeyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxInMessageDeliverEncTypeSenderKeyMixin").parseEncTypeSenderKeyMixin(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverEncLiveLocationOrListOrMediaTypeOrMediaTypeFutureproofMixinGroup").parseEncLiveLocationOrListOrMediaTypeOrMediaTypeFutureproofMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{encLiveLocationOrListOrMediaTypeOrMediaTypeFutureproofMixinGroup:a.value}))}g.parseEncTypeSenderKeyAndGroupMediaMixin=a}),98);
__d("WASmaxInMessageDeliverEncTypeSenderKeyAndGroupMediaOrIndividualMixinGroup",["WAResultOrError","WASmaxInMessageDeliverEncTypeIndividualMixin","WASmaxInMessageDeliverEncTypeSenderKeyAndGroupMediaMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverEncTypeSenderKeyAndGroupMediaMixin").parseEncTypeSenderKeyAndGroupMediaMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"EncTypeSenderKeyAndGroupMedia",value:b.value});var c=d("WASmaxInMessageDeliverEncTypeIndividualMixin").parseEncTypeIndividualMixin(a);return c.success?d("WAResultOrError").makeResult({name:"EncTypeIndividual",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["EncTypeSenderKeyAndGroupMedia","EncTypeIndividual"],[b,c])}g.parseEncTypeSenderKeyAndGroupMediaOrIndividualMixinGroup=a}),98);
__d("WASmaxInMessageDeliverGroupDualEncMediaMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeMediaMixin","WASmaxInMessageDeliverEncTypeSenderKeyAndGroupMediaOrIndividualMixinGroup","WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup").parseEncVersion2Or3OrFutureproofMixinGroup(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverEncTypeSenderKeyAndGroupMediaOrIndividualMixinGroup").parseEncTypeSenderKeyAndGroupMediaOrIndividualMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({encVersion2Or3OrFutureproofMixinGroup:b.value,encTypeSenderKeyAndGroupMediaOrIndividualMixinGroup:a.value})}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"rcat");if(!b.success)return b;b=d("WASmaxParseUtils").contentBytes(a);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"rcat",i);if(!b.success)return b;var c=d("WASmaxInMessageDeliverContentTypeMediaMixin").parseContentTypeMediaMixin(a);if(!c.success)return c;a=d("WASmaxParseUtils").mapChildrenWithTag(a,"enc",2,2,h);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},c.value,{rcat:b.value,enc:a.value}))}g.parseGroupDualEncMediaEnc=h;g.parseGroupDualEncMediaRcat=i;g.parseGroupDualEncMediaMixin=a}),98);
__d("WASmaxInMessageDeliverContentTypeEventMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","event");if(!a.success)return a;b=d("WASmaxParseUtils").attrStringEnum(b.value,"event_type",d("WASmaxInMessageDeliverEnums").ENUM_CREATION_EDIT_RESPONSE);return!b.success?b:d("WAResultOrError").makeResult({type:a.value,metaEventType:b.value})}g.parseContentTypeEventMixin=a}),98);
__d("WASmaxInMessageDeliverDeprecatedPayTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"mediatype","pay");return!b.success?b:d("WAResultOrError").makeResult({mediatype:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").mapHomogeneousChildrenWithTag(a,"enc",h);return!b.success?b:d("WAResultOrError").makeResult({enc:b.value})}g.parseDeprecatedPayTypeEnc=h;g.parseDeprecatedPayTypeMixin=a}),98);
__d("WASmaxInMessageDeliverContentTypePayMixin",["WAResultOrError","WASmaxInMessageDeliverDeprecatedPayTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","pay");if(!b.success)return b;a=d("WASmaxInMessageDeliverDeprecatedPayTypeMixin").parseDeprecatedPayTypeMixin(a);return d("WAResultOrError").makeResult({type:b.value,deprecatedPayTypeMixin:a.success?a.value:null})}g.parseContentTypePayMixin=a}),98);
__d("WASmaxInMessageDeliverLegacyAmountMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"pay");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"currency");if(!b.success)return b;a=d("WASmaxParseUtils").attrString(a,"amount");return!a.success?a:d("WAResultOrError").makeResult({currency:b.value,amount:a.value})}g.parseLegacyAmountMixin=a}),98);
__d("WASmaxInMessageDeliverMoneyMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"money");if(!a.success)return a;var b=d("WASmaxParseUtils").attrString(a.value,"value");if(!b.success)return b;var c=d("WASmaxParseUtils").attrString(a.value,"offset");if(!c.success)return c;a=d("WASmaxParseUtils").attrString(a.value,"currency");return!a.success?a:d("WAResultOrError").makeResult({moneyValue:b.value,moneyOffset:c.value,moneyCurrency:a.value})}g.parseMoneyMixin=a}),98);
__d("WASmaxInMessageDeliverPayNodeTypeMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"pay");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"type",d("WASmaxInMessageDeliverEnums").ENUM_REQUEST_SEND);return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parsePayNodeTypeMixin=a}),98);
__d("WASmaxInMessageDeliverTransactionSyncStatusMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrStringEnum(a,"sync-status",d("WASmaxInMessageDeliverEnums").ENUM_FULL_MISSINGFIELDNOTPARTIAL_PARTIAL);return!a.success?a:d("WAResultOrError").makeResult({syncStatus:a.value})}g.parseTransactionSyncStatusMixin=a}),98);
__d("WASmaxInMessageDeliverGroupDeliverSendPayNodeMixin",["WAResultOrError","WASmaxInMessageDeliverLegacyAmountMixin","WASmaxInMessageDeliverMoneyMixin","WASmaxInMessageDeliverPayNodeTypeMixin","WASmaxInMessageDeliverTransactionSyncStatusMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"amount");if(!b.success)return b;b=d("WASmaxInMessageDeliverMoneyMixin").parseMoneyMixin(a);return!b.success?b:b}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"pay");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"amount",h);if(!b.success)return b;var c=d("WASmaxParseJid").attrUserJid(a,"receiver");if(!c.success)return c;var e=d("WASmaxParseUtils").attrString(a,"transaction-id");if(!e.success)return e;var f=d("WASmaxParseUtils").attrString(a,"id");if(!f.success)return f;var g=d("WASmaxParseJid").attrGroupJid(a,"group");if(!g.success)return g;var i=d("WASmaxInMessageDeliverPayNodeTypeMixin").parsePayNodeTypeMixin(a);if(!i.success)return i;var j=d("WASmaxInMessageDeliverTransactionSyncStatusMixin").parseTransactionSyncStatusMixin(a);if(!j.success)return j;a=d("WASmaxInMessageDeliverLegacyAmountMixin").parseLegacyAmountMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({receiver:c.value,transactionId:e.value,id:f.value,group:g.value},i.value,j.value,a.value,{amount:b.value}))}g.parseGroupDeliverSendPayNodeAmount=h;g.parseGroupDeliverSendPayNodeMixin=a}),98);
__d("WASmaxInMessageDeliverBasePayNodeMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxInMessageDeliverPayNodeTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"pay");if(!b.success)return b;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"country");if(!b.success)return b;var c=d("WASmaxParseUtils").attrIntRange(a,"version",0,void 0);if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"is_first_send",d("WASmaxInMessageDeliverEnums").ENUM_0_1);if(!e.success)return e;a=d("WASmaxInMessageDeliverPayNodeTypeMixin").parsePayNodeTypeMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({country:b.value,version:c.value,isFirstSend:e.value},a.value))}g.parseBasePayNodeMixin=a}),98);
__d("WASmaxInMessageDeliverIndividualRequestPayNodeMixin",["WAResultOrError","WASmaxInMessageDeliverBasePayNodeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"pay");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"expiry-ts");if(!b.success)return b;var c=d("WASmaxParseUtils").attrString(a,"request-id");if(!c.success)return c;a=d("WASmaxInMessageDeliverBasePayNodeMixin").parseBasePayNodeMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({expiryTs:b.value,requestId:c.value},a.value))}g.parseIndividualRequestPayNodeMixin=a}),98);
__d("WASmaxInMessageDeliverGroupRequestPayNodeMixin",["WAResultOrError","WASmaxInMessageDeliverIndividualRequestPayNodeMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"pay");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"sender");if(!b.success)return b;a=d("WASmaxInMessageDeliverIndividualRequestPayNodeMixin").parseIndividualRequestPayNodeMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({sender:b.value},a.value))}g.parseGroupRequestPayNodeMixin=a}),98);
__d("WASmaxInMessageDeliverGroupRequestOrDeliverSendPayNodeMixinGroup",["WAResultOrError","WASmaxInMessageDeliverGroupDeliverSendPayNodeMixin","WASmaxInMessageDeliverGroupRequestPayNodeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverGroupRequestPayNodeMixin").parseGroupRequestPayNodeMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"GroupRequestPayNode",value:b.value});var c=d("WASmaxInMessageDeliverGroupDeliverSendPayNodeMixin").parseGroupDeliverSendPayNodeMixin(a);return c.success?d("WAResultOrError").makeResult({name:"GroupDeliverSendPayNode",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["GroupRequestPayNode","GroupDeliverSendPayNode"],[b,c])}g.parseGroupRequestOrDeliverSendPayNodeMixinGroup=a}),98);
__d("WASmaxInMessageDeliverGroupDeliverPayNodeMixin",["WAResultOrError","WASmaxInMessageDeliverGroupRequestOrDeliverSendPayNodeMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"pay");if(!b.success)return b;b=d("WASmaxInMessageDeliverGroupRequestOrDeliverSendPayNodeMixinGroup").parseGroupRequestOrDeliverSendPayNodeMixinGroup(a);return!b.success?b:d("WAResultOrError").makeResult({groupRequestOrDeliverSendPayNodeMixinGroup:b.value})}g.parseGroupDeliverPayNodeMixin=a}),98);
__d("WASmaxInMessageDeliverGroupDeliverPayNodeMessageMixin",["WASmaxInMessageDeliverGroupDeliverPayNodeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"pay");if(!b.success)return b;a=d("WASmaxInMessageDeliverGroupDeliverPayNodeMixin").parseGroupDeliverPayNodeMixin(b.value);return!a.success?a:a}g.parseGroupDeliverPayNodeMessageMixin=a}),98);
__d("WASmaxInMessageDeliverIncentiveOfferClaimMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"offer_claim");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"offer_id",1,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"id",1,void 0);if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"incentive_payment_id");if(!e.success)return e;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"parent_transaction_id");return!a.success?a:d("WAResultOrError").makeResult({offerId:b.value,id:c.value,incentivePaymentId:e.value,parentTransactionId:a.value})}g.parseIncentiveOfferClaimMixin=a}),98);
__d("WASmaxInMessageDeliverInstallmentMixin",["WAResultOrError","WASmaxInMessageDeliverMoneyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"due_amount");if(!b.success)return b;b=d("WASmaxInMessageDeliverMoneyMixin").parseMoneyMixin(a);return!b.success?b:b}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"interest");if(!b.success)return b;b=d("WASmaxInMessageDeliverMoneyMixin").parseMoneyMixin(a);return!b.success?b:b}function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"installment");if(!a.success)return a;var b=d("WASmaxParseUtils").optionalChildWithTag(a.value,"due_amount",h);if(!b.success)return b;var c=d("WASmaxParseUtils").optionalChildWithTag(a.value,"interest",i);if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a.value,"max_count",1,50);if(!e.success)return e;a=d("WASmaxParseUtils").attrIntRange(a.value,"selected_count",1,50);return!a.success?a:d("WAResultOrError").makeResult({installmentMaxCount:e.value,installmentSelectedCount:a.value,installmentDueAmount:b.value,installmentInterest:c.value})}g.parseInstallmentInstallmentDueAmount=h;g.parseInstallmentInstallmentInterest=i;g.parseInstallmentMixin=a}),98);
__d("WASmaxInMessageDeliverBeneficiaryMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"beneficiary");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"name");if(!b.success)return b;var c=d("WASmaxParseUtils").attrString(a,"address_line1");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"address_line2");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"city");if(!f.success)return f;var g=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"state");if(!g.success)return g;var h=d("WASmaxParseUtils").attrString(a,"country");if(!h.success)return h;a=d("WASmaxParseUtils").attrString(a,"postal_code");return!a.success?a:d("WAResultOrError").makeResult({name:b.value,addressLine1:c.value,addressLine2:e.value,city:f.value,state:g.value,country:h.value,postalCode:a.value})}g.parseBeneficiaryMixin=a}),98);
__d("WASmaxInMessageDeliverBeneficiariesMixin",["WAResultOrError","WASmaxInMessageDeliverBeneficiaryMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"beneficiary");if(!b.success)return b;b=d("WASmaxInMessageDeliverBeneficiaryMixin").parseBeneficiaryMixin(a);return!b.success?b:b}function a(a){a=d("WASmaxParseUtils").mapChildrenWithTag(a,"beneficiary",1,5,h);return!a.success?a:d("WAResultOrError").makeResult({beneficiary:a.value})}g.parseBeneficiariesBeneficiary=h;g.parseBeneficiariesMixin=a}),98);
__d("WASmaxInMessageDeliverOrderInPaymentMixin",["WAResultOrError","WASmaxInMessageDeliverBeneficiariesMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"beneficiaries");if(!b.success)return b;b=d("WASmaxInMessageDeliverBeneficiariesMixin").parseBeneficiariesMixin(a);return!b.success?b:b}function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"order");if(!a.success)return a;var b=d("WASmaxParseUtils").optionalChildWithTag(a.value,"beneficiaries",h);if(!b.success)return b;var c=d("WASmaxParseUtils").attrString(a.value,"id");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStanzaId,a.value,"message_id");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a.value,"payment_config_id");if(!f.success)return f;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a.value,"type");return!a.success?a:d("WAResultOrError").makeResult({orderId:c.value,orderMessageId:e.value,orderPaymentConfigId:f.value,orderType:a.value,orderBeneficiaries:b.value})}g.parseOrderInPaymentOrderBeneficiaries=h;g.parseOrderInPaymentMixin=a}),98);
__d("WASmaxInMessageDeliverTransactionErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"error-code",1,1e7);if(!b.success)return b;a=d("WASmaxParseUtils").attrString(a,"error-text");return!a.success?a:d("WAResultOrError").makeResult({errorCode:b.value,errorText:a.value})}g.parseTransactionErrorMixin=a}),98);
__d("WASmaxInMessageDeliverTransactionTypeMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrStringEnum(a,"transaction-type",d("WASmaxInMessageDeliverEnums").ENUM_INCENTIVE_P2M_P2P_PAYOUT);return!a.success?a:d("WAResultOrError").makeResult({transactionType:a.value})}g.parseTransactionTypeMixin=a}),98);
__d("WASmaxInMessageDeliverFullTransactionBaseMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxInMessageDeliverIncentiveOfferClaimMixin","WASmaxInMessageDeliverInstallmentMixin","WASmaxInMessageDeliverMoneyMixin","WASmaxInMessageDeliverOrderInPaymentMixin","WASmaxInMessageDeliverTransactionErrorMixin","WASmaxInMessageDeliverTransactionSyncStatusMixin","WASmaxInMessageDeliverTransactionTypeMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"offer_claim");if(!b.success)return b;b=d("WASmaxInMessageDeliverIncentiveOfferClaimMixin").parseIncentiveOfferClaimMixin(a);return!b.success?b:b}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"amount");if(!b.success)return b;b=d("WASmaxInMessageDeliverMoneyMixin").parseMoneyMixin(a);return!b.success?b:b}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"offer_claim",h);if(!b.success)return b;var c=d("WASmaxParseUtils").optionalChildWithTag(a,"amount",i);if(!c.success)return c;var e=d("WASmaxParseUtils").attrString(a,"id");if(!e.success)return e;var f=d("WASmaxParseJid").attrUserJid(a,"sender");if(!f.success)return f;var g=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"sender-alias");if(!g.success)return g;var j=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"sender-name");if(!j.success)return j;var k=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"receiver-name");if(!k.success)return k;var l=d("WASmaxParseJid").attrUserJid(a,"receiver");if(!l.success)return l;var m=d("WASmaxParseUtils").attrString(a,"currency");if(!m.success)return m;var n=d("WASmaxParseUtils").attrString(a,"amount");if(!n.success)return n;var o=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"credential-id");if(!o.success)return o;var p=d("WASmaxParseUtils").attrIntRange(a,"ts",0,void 0);if(!p.success)return p;var q=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"created-ts",0,void 0);if(!q.success)return q;var r=d("WASmaxParseUtils").attrString(a,"status");if(!r.success)return r;var s=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStanzaId,a,"message-id");if(!s.success)return s;var t=d("WASmaxParseUtils").attrIntRange(a,"counter",0,void 0);if(!t.success)return t;var u=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"expiry-ts",0,void 0);if(!u.success)return u;var v=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrGroupJid,a,"group");if(!v.success)return v;var w=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"service",d("WASmaxInMessageDeliverEnums").ENUM_FBPAY_NOVI_P2MLITE_UPI);if(!w.success)return w;var x=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"merchant-name");if(!x.success)return x;var y=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"note");if(!y.success)return y;var z=d("WASmaxInMessageDeliverTransactionErrorMixin").parseTransactionErrorMixin(a),A=d("WASmaxInMessageDeliverTransactionTypeMixin").parseTransactionTypeMixin(a);if(!A.success)return A;var B=d("WASmaxInMessageDeliverTransactionSyncStatusMixin").parseTransactionSyncStatusMixin(a);if(!B.success)return B;var C=d("WASmaxInMessageDeliverOrderInPaymentMixin").parseOrderInPaymentMixin(a);a=d("WASmaxInMessageDeliverInstallmentMixin").parseInstallmentMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({id:e.value,sender:f.value,senderAlias:g.value,senderName:j.value,receiverName:k.value,receiver:l.value,currency:m.value,amount:n.value,credentialId:o.value,ts:p.value,createdTs:q.value,status:r.value,messageId:s.value,counter:t.value,expiryTs:u.value,group:v.value,service:w.value,merchantName:x.value,note:y.value,transactionErrorMixin:z.success?z.value:null},A.value,B.value,{orderInPaymentMixin:C.success?C.value:null,installmentMixin:a.success?a.value:null,offerClaim:b.value,childAmount:c.value}))}g.parseFullTransactionBaseOfferClaim=h;g.parseFullTransactionBaseAmount=i;g.parseFullTransactionBaseMixin=a}),98);
__d("WASmaxInMessageDeliverP2MTransactionProtocolMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"psp_transaction_id");return!b.success?b:d("WAResultOrError").makeResult({pspTransactionId:b.value})}g.parseP2MTransactionProtocolMixin=a}),98);
__d("WASmaxInMessageDeliverPaymentInitiatorMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrStringEnum(a,"payment_initiator",d("WASmaxInMessageDeliverEnums").ENUM_BUYER_SELLER);return!a.success?a:d("WAResultOrError").makeResult({paymentInitiator:a.value})}g.parsePaymentInitiatorMixin=a}),98);
__d("WASmaxInMessageDeliverTransactionNUXReceiverMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"is-nux-receiver",d("WASmaxInMessageDeliverEnums").ENUM_0_1);return!b.success?b:d("WAResultOrError").makeResult({isNuxReceiver:b.value})}g.parseTransactionNUXReceiverMixin=a}),98);
__d("WASmaxInMessageDeliverBRTransactionMixin",["WAResultOrError","WASmaxInMessageDeliverFullTransactionBaseMixin","WASmaxInMessageDeliverP2MTransactionProtocolMixin","WASmaxInMessageDeliverPaymentInitiatorMixin","WASmaxInMessageDeliverTransactionNUXReceiverMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxInMessageDeliverFullTransactionBaseMixin").parseFullTransactionBaseMixin(a);if(!b.success)return b;var c=d("WASmaxInMessageDeliverP2MTransactionProtocolMixin").parseP2MTransactionProtocolMixin(a),e=d("WASmaxInMessageDeliverTransactionNUXReceiverMixin").parseTransactionNUXReceiverMixin(a);if(!e.success)return e;a=d("WASmaxInMessageDeliverPaymentInitiatorMixin").parsePaymentInitiatorMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{p2MTransactionProtocolMixin:c.success?c.value:null},e.value,{paymentInitiatorMixin:a.success?a.value:null}))}g.parseBRTransactionMixin=a}),98);
__d("WASmaxInMessageDeliverCAPITransactionMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"id");if(!b.success)return b;var c=d("WASmaxParseJid").attrUserJid(a,"sender");if(!c.success)return c;a=d("WASmaxParseJid").attrUserJid(a,"receiver");return!a.success?a:d("WAResultOrError").makeResult({id:b.value,sender:c.value,receiver:a.value})}g.parseCAPITransactionMixin=a}),98);
__d("WASmaxInMessageDeliverIDTransactionGoPayMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"onboarding-provider","GO");if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"onboarding-provider-id","GO");if(!c.success)return c;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"onboarding-provider-name","GoPay");return!a.success?a:d("WAResultOrError").makeResult({onboardingProvider:b.value,onboardingProviderId:c.value,onboardingProviderName:a.value})}g.parseIDTransactionGoPayMixin=a}),98);
__d("WASmaxInMessageDeliverIDTransactionOttoCashMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"onboarding-provider","OTTO");if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"onboarding-provider-id","OTTO");if(!c.success)return c;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"onboarding-provider-name","OttoCash");return!a.success?a:d("WAResultOrError").makeResult({onboardingProvider:b.value,onboardingProviderId:c.value,onboardingProviderName:a.value})}g.parseIDTransactionOttoCashMixin=a}),98);
__d("WASmaxInMessageDeliverIDTransactionOvoMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"onboarding-provider","OVO");if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"onboarding-provider-id","OVO");if(!c.success)return c;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"onboarding-provider-name","OVO");return!a.success?a:d("WAResultOrError").makeResult({onboardingProvider:b.value,onboardingProviderId:c.value,onboardingProviderName:a.value})}g.parseIDTransactionOvoMixin=a}),98);
__d("WASmaxInMessageDeliverIDTransactionGoPayOrOttoCashOrOvoMixinGroup",["WAResultOrError","WASmaxInMessageDeliverIDTransactionGoPayMixin","WASmaxInMessageDeliverIDTransactionOttoCashMixin","WASmaxInMessageDeliverIDTransactionOvoMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverIDTransactionGoPayMixin").parseIDTransactionGoPayMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IDTransactionGoPay",value:b.value});var c=d("WASmaxInMessageDeliverIDTransactionOttoCashMixin").parseIDTransactionOttoCashMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IDTransactionOttoCash",value:c.value});var e=d("WASmaxInMessageDeliverIDTransactionOvoMixin").parseIDTransactionOvoMixin(a);return e.success?d("WAResultOrError").makeResult({name:"IDTransactionOvo",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IDTransactionGoPay","IDTransactionOttoCash","IDTransactionOvo"],[b,c,e])}g.parseIDTransactionGoPayOrOttoCashOrOvoMixinGroup=a}),98);
__d("WASmaxInMessageDeliverIDTransactionProtocolMixin",["WAResultOrError","WASmaxInMessageDeliverIDTransactionGoPayOrOttoCashOrOvoMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxInMessageDeliverIDTransactionGoPayOrOttoCashOrOvoMixinGroup").parseIDTransactionGoPayOrOttoCashOrOvoMixinGroup(a);return!b.success?b:d("WAResultOrError").makeResult({iDTransactionGoPayOrOttoCashOrOvoMixinGroup:b.value})}g.parseIDTransactionProtocolMixin=a}),98);
__d("WASmaxInMessageDeliverIDTransactionMixin",["WAResultOrError","WASmaxInMessageDeliverFullTransactionBaseMixin","WASmaxInMessageDeliverIDTransactionProtocolMixin","WASmaxInMessageDeliverTransactionNUXReceiverMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxInMessageDeliverFullTransactionBaseMixin").parseFullTransactionBaseMixin(a);if(!b.success)return b;var c=d("WASmaxInMessageDeliverIDTransactionProtocolMixin").parseIDTransactionProtocolMixin(a);if(!c.success)return c;a=d("WASmaxInMessageDeliverTransactionNUXReceiverMixin").parseTransactionNUXReceiverMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,c.value,a.value))}g.parseIDTransactionMixin=a}),98);
__d("WASmaxInMessageDeliverMXTransactionProtocolMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"bank-transaction-id");if(!b.success)return b;var c=d("WASmaxParseUtils").attrString(a,"spei-transaction-id");if(!c.success)return c;a=d("WASmaxParseUtils").attrIntRange(a,"spei-ref-num",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({bankTransactionId:b.value,speiTransactionId:c.value,speiRefNum:a.value})}g.parseMXTransactionProtocolMixin=a}),98);
__d("WASmaxInMessageDeliverMXTransactionMixin",["WAResultOrError","WASmaxInMessageDeliverFullTransactionBaseMixin","WASmaxInMessageDeliverMXTransactionProtocolMixin","WASmaxInMessageDeliverTransactionNUXReceiverMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxInMessageDeliverFullTransactionBaseMixin").parseFullTransactionBaseMixin(a);if(!b.success)return b;var c=d("WASmaxInMessageDeliverMXTransactionProtocolMixin").parseMXTransactionProtocolMixin(a);if(!c.success)return c;a=d("WASmaxInMessageDeliverTransactionNUXReceiverMixin").parseTransactionNUXReceiverMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,c.value,a.value))}g.parseMXTransactionMixin=a}),98);
__d("WASmaxInMessageDeliverP2MLiteTransactionProtocolMixin",["WAResultOrError","WASmaxInMessageDeliverP2MTransactionProtocolMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"psp_receipt_url");if(!b.success)return b;a=d("WASmaxInMessageDeliverP2MTransactionProtocolMixin").parseP2MTransactionProtocolMixin(a);return d("WAResultOrError").makeResult({pspReceiptUrl:b.value,p2MTransactionProtocolMixin:a.success?a.value:null})}g.parseP2MLiteTransactionProtocolMixin=a}),98);
__d("WASmaxInMessageDeliverP2MLiteTransactionMixin",["WAResultOrError","WASmaxInMessageDeliverFullTransactionBaseMixin","WASmaxInMessageDeliverP2MLiteTransactionProtocolMixin","WASmaxInMessageDeliverTransactionNUXReceiverMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxInMessageDeliverFullTransactionBaseMixin").parseFullTransactionBaseMixin(a);if(!b.success)return b;var c=d("WASmaxInMessageDeliverP2MLiteTransactionProtocolMixin").parseP2MLiteTransactionProtocolMixin(a);if(!c.success)return c;a=d("WASmaxInMessageDeliverTransactionNUXReceiverMixin").parseTransactionNUXReceiverMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,c.value,a.value))}g.parseP2MLiteTransactionMixin=a}),98);
__d("WASmaxInMessageDeliverUPIComplaintMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"complaint");if(!b.success)return b;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"complaint-status");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"created-ts",0,void 0);if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"updated-ts",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({complaintStatus:b.value,createdTs:c.value,updatedTs:a.value})}g.parseUPIComplaintMixin=a}),98);
__d("WASmaxInMessageDeliverUPIInternationalFxDetailMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"fx-detail");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"base-amount");if(!b.success)return b;var c=d("WASmaxParseUtils").attrString(a,"currency-fx");if(!c.success)return c;var e=d("WASmaxParseUtils").attrString(a,"currency-markup");if(!e.success)return e;a=d("WASmaxParseUtils").attrString(a,"base-currency");return!a.success?a:d("WAResultOrError").makeResult({baseAmount:b.value,currencyFx:c.value,currencyMarkup:e.value,baseCurrency:a.value})}g.parseUPIInternationalFxDetailMixin=a}),98);
__d("WASmaxInMessageDeliverUPIInternationalTransactionDetailMixin",["WAResultOrError","WASmaxInMessageDeliverUPIInternationalFxDetailMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"international-transaction-detail");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"fx-detail");if(!b.success)return b;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"invoice-number");if(!a.success)return a;b=d("WASmaxInMessageDeliverUPIInternationalFxDetailMixin").parseUPIInternationalFxDetailMixin(b.value);return!b.success?b:d("WAResultOrError").makeResult({invoiceNumber:a.value,fxDetailUPIInternationalFxDetailMixin:b.value})}g.parseUPIInternationalTransactionDetailMixin=a}),98);
__d("WASmaxInMessageDeliverP2MHybridExternalPaymentMethodMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").attrStringEnum(a,"type",d("WASmaxInMessageDeliverEnums").ENUM_CARD_NETBANKING_UPI_WALLET);if(!b.success)return b;a=d("WASmaxParseUtils").attrString(a,"name");return!a.success?a:d("WAResultOrError").makeResult({type:b.value,name:a.value})}g.parseP2MHybridExternalPaymentMethodMixin=a}),98);
__d("WASmaxInMessageDeliverUPITransactionProtocolWithP2MHybridMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxInMessageDeliverMoneyMixin","WASmaxInMessageDeliverP2MHybridExternalPaymentMethodMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"offer");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"id");return!b.success?b:d("WAResultOrError").makeResult({id:b.value})}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"external_payment_method");if(!b.success)return b;b=d("WASmaxInMessageDeliverP2MHybridExternalPaymentMethodMixin").parseP2MHybridExternalPaymentMethodMixin(a);return!b.success?b:b}function j(a){var b=d("WASmaxParseUtils").assertTag(a,"offer_amount");if(!b.success)return b;b=d("WASmaxInMessageDeliverMoneyMixin").parseMoneyMixin(a);return!b.success?b:b}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"external_payment_method",i);if(!b.success)return b;var c=d("WASmaxParseUtils").optionalChildWithTag(a,"offer_amount",j);if(!c.success)return c;var e=d("WASmaxParseUtils").attrStringEnum(a,"is_p2m_hybrid",d("WASmaxInMessageDeliverEnums").ENUM_0_1);if(!e.success)return e;var f=d("WASmaxParseUtils").attrStringEnum(a,"payment_instrument_type",d("WASmaxInMessageDeliverEnums").ENUM_HPPPAYMENTLINK_UPI);if(!f.success)return f;a=d("WASmaxParseUtils").mapChildrenWithTag(a,"offer",0,Infinity,h);return!a.success?a:d("WAResultOrError").makeResult({isP2mHybrid:e.value,paymentInstrumentType:f.value,externalPaymentMethod:b.value,offerAmount:c.value,offer:a.value})}g.parseUPITransactionProtocolWithP2MHybridOffer=h;g.parseUPITransactionProtocolWithP2MHybridExternalPaymentMethod=i;g.parseUPITransactionProtocolWithP2MHybridOfferAmount=j;g.parseUPITransactionProtocolWithP2MHybridMixin=a}),98);
__d("WASmaxInMessageDeliverFrequencyRuleMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrStringEnum(a,"frequency-rule",d("WASmaxInMessageDeliverEnums").ENUM_ASPRESENTED_BIMONTHLY_DAILY_FORTNIGHTLY_HALFYEARLY_MONTHLY_ONETIME_QUARTERLY_UNKNOWN_WEEKLY_YEARLY);return!a.success?a:d("WAResultOrError").makeResult({frequencyRule:a.value})}g.parseFrequencyRuleMixin=a}),98);
__d("WASmaxInMessageDeliverUPIMandateBaseMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxInMessageDeliverFrequencyRuleMixin","WASmaxInMessageDeliverMoneyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"mandate");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"original-amount");if(!b.success)return b;var c=d("WASmaxParseUtils").attrString(a,"mandate-no");if(!c.success)return c;var e=d("WASmaxParseUtils").attrStringEnum(a,"amount-rule",d("WASmaxInMessageDeliverEnums").ENUM_EXACT_MAX);if(!e.success)return e;var f=d("WASmaxParseUtils").attrIntRange(a,"start-ts",0,void 0);if(!f.success)return f;var g=d("WASmaxParseUtils").attrIntRange(a,"end-ts",0,void 0);if(!g.success)return g;var h=d("WASmaxParseUtils").attrStringEnum(a,"is-revocable",d("WASmaxInMessageDeliverEnums").ENUM_0_1);if(!h.success)return h;var i=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"purpose-code");if(!i.success)return i;var j=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"mandate-name");if(!j.success)return j;var k=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"error-code",1,1e7);if(!k.success)return k;b=d("WASmaxInMessageDeliverMoneyMixin").parseMoneyMixin(b.value);if(!b.success)return b;a=d("WASmaxInMessageDeliverFrequencyRuleMixin").parseFrequencyRuleMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({mandateNo:c.value,amountRule:e.value,startTs:f.value,endTs:g.value,isRevocable:h.value,purposeCode:i.value,mandateName:j.value,errorCode:k.value,originalAmountMoneyMixin:b.value},a.value))}g.parseUPIMandateBaseMixin=a}),98);
__d("WASmaxInMessageDeliverUPIMandateUpdateBaseMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxInMessageDeliverMoneyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"mandate-update");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"amount");if(!b.success)return b;var c=d("WASmaxParseUtils").attrIntRange(a,"end-ts",0,void 0);if(!c.success)return c;var e=d("WASmaxParseUtils").attrString(a,"seq-no");if(!e.success)return e;var f=d("WASmaxParseUtils").attrString(a,"mandate-update-info");if(!f.success)return f;var g=d("WASmaxParseUtils").attrStringEnum(a,"status",d("WASmaxInMessageDeliverEnums").ENUM_FAILURE_INIT_SUCCESS);if(!g.success)return g;var h=d("WASmaxParseUtils").attrStringEnum(a,"action",d("WASmaxInMessageDeliverEnums").ENUM_ACCEPT_REJECT_UNKNOWN);if(!h.success)return h;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"error-code",1,1e7);if(!a.success)return a;b=d("WASmaxInMessageDeliverMoneyMixin").parseMoneyMixin(b.value);return!b.success?b:d("WAResultOrError").makeResult({endTs:c.value,seqNo:e.value,mandateUpdateInfo:f.value,status:g.value,action:h.value,errorCode:a.value,amountMoneyMixin:b.value})}g.parseUPIMandateUpdateBaseMixin=a}),98);
__d("WASmaxInMessageDeliverUPIMandateWithUpdateMixin",["WASmaxInMessageDeliverUPIMandateUpdateBaseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"mandate");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"mandate-update");if(!b.success)return b;a=d("WASmaxInMessageDeliverUPIMandateUpdateBaseMixin").parseUPIMandateUpdateBaseMixin(b.value);return!a.success?a:a}g.parseUPIMandateWithUpdateMixin=a}),98);
__d("WASmaxInMessageDeliverUPITransactionWithMandateMixin",["WAResultOrError","WASmaxInMessageDeliverUPIMandateBaseMixin","WASmaxInMessageDeliverUPIMandateWithUpdateMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"mandate");if(!b.success)return b;a=d("WASmaxInMessageDeliverUPIMandateBaseMixin").parseUPIMandateBaseMixin(b.value);if(!a.success)return a;b=d("WASmaxInMessageDeliverUPIMandateWithUpdateMixin").parseUPIMandateWithUpdateMixin(b.value);return d("WAResultOrError").makeResult({mandateUPIMandateBaseMixin:a.value,mandateUPIMandateWithUpdateMixin:b.success?b.value:null})}g.parseUPITransactionWithMandateMixin=a}),98);
__d("WASmaxInMessageDeliverUPITransactionProtocolMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxInMessageDeliverUPIComplaintMixin","WASmaxInMessageDeliverUPIInternationalTransactionDetailMixin","WASmaxInMessageDeliverUPITransactionProtocolWithP2MHybridMixin","WASmaxInMessageDeliverUPITransactionWithMandateMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"complaint");if(!b.success)return b;b=d("WASmaxInMessageDeliverUPIComplaintMixin").parseUPIComplaintMixin(a);return!b.success?b:b}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"international-transaction-detail");if(!b.success)return b;b=d("WASmaxInMessageDeliverUPIInternationalTransactionDetailMixin").parseUPIInternationalTransactionDetailMixin(a);return!b.success?b:b}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"complaint",h);if(!b.success)return b;var c=d("WASmaxParseUtils").optionalChildWithTag(a,"international-transaction-detail",i);if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"sender-alias");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"receiver-alias");if(!f.success)return f;var g=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"receiver-name");if(!g.success)return g;var j=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"bank-transaction-id");if(!j.success)return j;var k=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"seq-no");if(!k.success)return k;var l=d("WASmaxParseUtils").attrStringEnum(a,"is_vpa",d("WASmaxInMessageDeliverEnums").ENUM_0_1);if(!l.success)return l;var m=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"ref-url");if(!m.success)return m;var n=d("WASmaxParseUtils").attrStringEnum(a,"is-mandate",d("WASmaxInMessageDeliverEnums").ENUM_0_1);if(!n.success)return n;var o=d("WASmaxParseUtils").attrStringEnum(a,"is-collect",d("WASmaxInMessageDeliverEnums").ENUM_0_1);if(!o.success)return o;var p=d("WASmaxParseUtils").attrStringEnum(a,"nodal",d("WASmaxInMessageDeliverEnums").ENUM_0_1);if(!p.success)return p;var q=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"is-complaint-eligible",d("WASmaxInMessageDeliverEnums").ENUM_0_1);if(!q.success)return q;var r=d("WASmaxInMessageDeliverUPITransactionWithMandateMixin").parseUPITransactionWithMandateMixin(a);a=d("WASmaxInMessageDeliverUPITransactionProtocolWithP2MHybridMixin").parseUPITransactionProtocolWithP2MHybridMixin(a);return d("WAResultOrError").makeResult({senderAlias:e.value,receiverAlias:f.value,receiverName:g.value,bankTransactionId:j.value,seqNo:k.value,isVpa:l.value,refUrl:m.value,isMandate:n.value,isCollect:o.value,nodal:p.value,isComplaintEligible:q.value,uPITransactionWithMandateMixin:r.success?r.value:null,uPITransactionProtocolWithP2MHybridMixin:a.success?a.value:null,complaint:b.value,internationalTransactionDetail:c.value})}g.parseUPITransactionProtocolComplaint=h;g.parseUPITransactionProtocolInternationalTransactionDetail=i;g.parseUPITransactionProtocolMixin=a}),98);
__d("WASmaxInMessageDeliverUPITransactionMixin",["WAResultOrError","WASmaxInMessageDeliverFullTransactionBaseMixin","WASmaxInMessageDeliverUPITransactionProtocolMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxInMessageDeliverFullTransactionBaseMixin").parseFullTransactionBaseMixin(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverUPITransactionProtocolMixin").parseUPITransactionProtocolMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,a.value))}g.parseUPITransactionMixin=a}),98);
__d("WASmaxInMessageDeliverPayTransactions",["WAResultOrError","WASmaxInMessageDeliverBRTransactionMixin","WASmaxInMessageDeliverCAPITransactionMixin","WASmaxInMessageDeliverIDTransactionMixin","WASmaxInMessageDeliverMXTransactionMixin","WASmaxInMessageDeliverP2MLiteTransactionMixin","WASmaxInMessageDeliverUPITransactionMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverUPITransactionMixin").parseUPITransactionMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"UPITransaction",value:b.value});var c=d("WASmaxInMessageDeliverMXTransactionMixin").parseMXTransactionMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"MXTransaction",value:c.value});var e=d("WASmaxInMessageDeliverIDTransactionMixin").parseIDTransactionMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"IDTransaction",value:e.value});var f=d("WASmaxInMessageDeliverP2MLiteTransactionMixin").parseP2MLiteTransactionMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"P2MLiteTransaction",value:f.value});var g=d("WASmaxInMessageDeliverBRTransactionMixin").parseBRTransactionMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"BRTransaction",value:g.value});var h=d("WASmaxInMessageDeliverCAPITransactionMixin").parseCAPITransactionMixin(a);return h.success?d("WAResultOrError").makeResult({name:"CAPITransaction",value:h.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["UPITransaction","MXTransaction","IDTransaction","P2MLiteTransaction","BRTransaction","CAPITransaction"],[b,c,e,f,g,h])}g.parsePayTransactions=a}),98);
__d("WASmaxInMessageDeliverPayTransactionAnyMixin",["WAResultOrError","WASmaxInMessageDeliverPayTransactions","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"transaction");if(!b.success)return b;b=d("WASmaxInMessageDeliverPayTransactions").parsePayTransactions(a);return!b.success?b:d("WAResultOrError").makeResult({payTransactions:b.value})}g.parsePayTransactionAnyMixin=a}),98);
__d("WASmaxInMessageDeliverPayTransactionMessageMixin",["WASmaxInMessageDeliverPayTransactionAnyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"transaction");if(!b.success)return b;a=d("WASmaxInMessageDeliverPayTransactionAnyMixin").parsePayTransactionAnyMixin(b.value);return!a.success?a:a}g.parsePayTransactionMessageMixin=a}),98);
__d("WASmaxInMessageDeliverGroupDeliverPayNodeOrPayTransactionMessageMixinGroup",["WAResultOrError","WASmaxInMessageDeliverGroupDeliverPayNodeMessageMixin","WASmaxInMessageDeliverPayTransactionMessageMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverGroupDeliverPayNodeMessageMixin").parseGroupDeliverPayNodeMessageMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"GroupDeliverPayNodeMessage",value:b.value});var c=d("WASmaxInMessageDeliverPayTransactionMessageMixin").parsePayTransactionMessageMixin(a);return c.success?d("WAResultOrError").makeResult({name:"PayTransactionMessage",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["GroupDeliverPayNodeMessage","PayTransactionMessage"],[b,c])}g.parseGroupDeliverPayNodeOrPayTransactionMessageMixinGroup=a}),98);
__d("WASmaxInMessageDeliverContentTypePayGroupMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypePayMixin","WASmaxInMessageDeliverGroupDeliverPayNodeOrPayTransactionMessageMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverContentTypePayMixin").parseContentTypePayMixin(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverGroupDeliverPayNodeOrPayTransactionMessageMixinGroup").parseGroupDeliverPayNodeOrPayTransactionMessageMixinGroup(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{groupDeliverPayNodeOrPayTransactionMessageMixinGroup:a.success?a.value:null}))}g.parseContentTypePayGroupMixin=a}),98);
__d("WASmaxInMessageDeliverContentTypeScheduledCallMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","scheduled-call");if(!a.success)return a;b=d("WASmaxParseUtils").attrStringEnum(b.value,"scheduled_call_type",d("WASmaxInMessageDeliverEnums").ENUM_CREATION_EDIT);return!b.success?b:d("WAResultOrError").makeResult({type:a.value,metaScheduledCallType:b.value})}g.parseContentTypeScheduledCallMixin=a}),98);
__d("WASmaxInMessageDeliverContentDualMixins",["WAResultOrError","WASmaxInMessageDeliverContentTypeEventMixin","WASmaxInMessageDeliverContentTypePayGroupMixin","WASmaxInMessageDeliverContentTypePollCreationMixin","WASmaxInMessageDeliverContentTypePollVoteMixin","WASmaxInMessageDeliverContentTypeReactionMixin","WASmaxInMessageDeliverContentTypeScheduledCallMixin","WASmaxInMessageDeliverContentTypeTextMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverContentTypeTextMixin").parseContentTypeTextMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"ContentTypeText",value:b.value});var c=d("WASmaxInMessageDeliverContentTypePayGroupMixin").parseContentTypePayGroupMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"ContentTypePayGroup",value:c.value});var e=d("WASmaxInMessageDeliverContentTypeReactionMixin").parseContentTypeReactionMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"ContentTypeReaction",value:e.value});var f=d("WASmaxInMessageDeliverContentTypePollCreationMixin").parseContentTypePollCreationMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"ContentTypePollCreation",value:f.value});var g=d("WASmaxInMessageDeliverContentTypePollVoteMixin").parseContentTypePollVoteMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"ContentTypePollVote",value:g.value});var h=d("WASmaxInMessageDeliverContentTypeScheduledCallMixin").parseContentTypeScheduledCallMixin(a);if(h.success)return d("WAResultOrError").makeResult({name:"ContentTypeScheduledCall",value:h.value});var i=d("WASmaxInMessageDeliverContentTypeEventMixin").parseContentTypeEventMixin(a);return i.success?d("WAResultOrError").makeResult({name:"ContentTypeEvent",value:i.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ContentTypeText","ContentTypePayGroup","ContentTypeReaction","ContentTypePollCreation","ContentTypePollVote","ContentTypeScheduledCall","ContentTypeEvent"],[b,c,e,f,g,h,i])}g.parseContentDualMixins=a}),98);
__d("WASmaxInMessageDeliverGroupDualEncNonMediaMixin",["WAResultOrError","WASmaxInMessageDeliverContentDualMixins","WASmaxInMessageDeliverEncTypeSenderKeyOrIndividualMixinGroup","WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup").parseEncVersion2Or3OrFutureproofMixinGroup(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverEncTypeSenderKeyOrIndividualMixinGroup").parseEncTypeSenderKeyOrIndividualMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({encVersion2Or3OrFutureproofMixinGroup:b.value,encTypeSenderKeyOrIndividualMixinGroup:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverContentDualMixins").parseContentDualMixins(a);if(!b.success)return b;a=d("WASmaxParseUtils").mapChildrenWithTag(a,"enc",2,2,h);return!a.success?a:d("WAResultOrError").makeResult({contentDualMixins:b.value,enc:a.value})}g.parseGroupDualEncNonMediaEnc=h;g.parseGroupDualEncNonMediaMixin=a}),98);
__d("WASmaxInMessageDeliverGroupDualEncGroupDualEncMediaOrGroupDualEncNonMediaMediaMixinGroup",["WAResultOrError","WASmaxInMessageDeliverGroupDualEncMediaMixin","WASmaxInMessageDeliverGroupDualEncNonMediaMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverGroupDualEncMediaMixin").parseGroupDualEncMediaMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"GroupDualEncMedia",value:b.value});var c=d("WASmaxInMessageDeliverGroupDualEncNonMediaMixin").parseGroupDualEncNonMediaMixin(a);return c.success?d("WAResultOrError").makeResult({name:"GroupDualEncNonMedia",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["GroupDualEncMedia","GroupDualEncNonMedia"],[b,c])}g.parseGroupDualEncGroupDualEncMediaOrGroupDualEncNonMediaMediaMixinGroup=a}),98);
__d("WASmaxInMessageDeliverGroupDualEncMixin",["WAResultOrError","WASmaxInMessageDeliverGroupDualEncGroupDualEncMediaOrGroupDualEncNonMediaMediaMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverGroupDualEncGroupDualEncMediaOrGroupDualEncNonMediaMediaMixinGroup").parseGroupDualEncGroupDualEncMediaOrGroupDualEncNonMediaMediaMixinGroup(a);return!b.success?b:d("WAResultOrError").makeResult({groupDualEncGroupDualEncMediaOrGroupDualEncNonMediaMediaMixinGroup:b.value})}g.parseGroupDualEncMixin=a}),98);
__d("WASmaxInMessageDeliverEncLiveLocationDeprecatedMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"mediatype","livelocation");if(!b.success)return b;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"duration",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({mediatype:b.value,duration:a.value})}g.parseEncLiveLocationDeprecatedMixin=a}),98);
__d("WASmaxInMessageDeliverEncLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroup",["WAResultOrError","WASmaxInMessageDeliverEncLiveLocationDeprecatedMixin","WASmaxInMessageDeliverEncLiveLocationMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverEncLiveLocationMixin").parseEncLiveLocationMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"EncLiveLocation",value:b.value});var c=d("WASmaxInMessageDeliverEncLiveLocationDeprecatedMixin").parseEncLiveLocationDeprecatedMixin(a);return c.success?d("WAResultOrError").makeResult({name:"EncLiveLocationDeprecated",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["EncLiveLocation","EncLiveLocationDeprecated"],[b,c])}g.parseEncLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroup=a}),98);
__d("WASmaxInMessageDeliverLiveLocationModeMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").attrStringEnum(b.value,"liveloc_mode",d("WASmaxInMessageDeliverEnums").ENUM_LID_PN);return!a.success?a:d("WAResultOrError").makeResult({metaLivelocMode:a.value})}g.parseLiveLocationModeMixin=a}),98);
__d("WASmaxInMessageDeliverContentTypeLiveLocationSingleMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeMediaMixin","WASmaxInMessageDeliverEncLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroup","WASmaxInMessageDeliverLiveLocationModeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"enc");if(!b.success)return b;var c=d("WASmaxInMessageDeliverContentTypeMediaMixin").parseContentTypeMediaMixin(a);if(!c.success)return c;a=d("WASmaxInMessageDeliverLiveLocationModeMixin").parseLiveLocationModeMixin(a);b=d("WASmaxInMessageDeliverEncLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroup").parseEncLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroup(b.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},c.value,{liveLocationModeMixin:a.success?a.value:null,encEncLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroup:b.value}))}g.parseContentTypeLiveLocationSingleMixin=a}),98);
__d("WASmaxInMessageDeliverContentTypeProductListMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeMediaMixin","WASmaxInMessageDeliverEncListMixin","WASmaxInMessageDeliverProductListMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"enc");if(!b.success)return b;b=d("WASmaxInMessageDeliverEncListMixin").parseEncListMixin(b.value);if(!b.success)return b;var c=d("WASmaxInMessageDeliverContentTypeMediaMixin").parseContentTypeMediaMixin(a);if(!c.success)return c;a=d("WASmaxInMessageDeliverProductListMixin").parseProductListMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({encEncListMixin:b.value},c.value,a.value))}g.parseContentTypeProductListMixin=a}),98);
__d("WASmaxInMessageDeliverContentSingleMixins",["WAResultOrError","WASmaxInMessageDeliverContentTypeEventMixin","WASmaxInMessageDeliverContentTypeLiveLocationSingleMixin","WASmaxInMessageDeliverContentTypeMediaSingleMixin","WASmaxInMessageDeliverContentTypePayGroupMixin","WASmaxInMessageDeliverContentTypePollCreationMixin","WASmaxInMessageDeliverContentTypePollVoteMixin","WASmaxInMessageDeliverContentTypeProductListMixin","WASmaxInMessageDeliverContentTypeReactionMixin","WASmaxInMessageDeliverContentTypeScheduledCallMixin","WASmaxInMessageDeliverContentTypeTextMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverContentTypeTextMixin").parseContentTypeTextMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"ContentTypeText",value:b.value});var c=d("WASmaxInMessageDeliverContentTypeLiveLocationSingleMixin").parseContentTypeLiveLocationSingleMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"ContentTypeLiveLocationSingle",value:c.value});var e=d("WASmaxInMessageDeliverContentTypeMediaSingleMixin").parseContentTypeMediaSingleMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"ContentTypeMediaSingle",value:e.value});var f=d("WASmaxInMessageDeliverContentTypePayGroupMixin").parseContentTypePayGroupMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"ContentTypePayGroup",value:f.value});var g=d("WASmaxInMessageDeliverContentTypeReactionMixin").parseContentTypeReactionMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"ContentTypeReaction",value:g.value});var h=d("WASmaxInMessageDeliverContentTypeProductListMixin").parseContentTypeProductListMixin(a);if(h.success)return d("WAResultOrError").makeResult({name:"ContentTypeProductList",value:h.value});var i=d("WASmaxInMessageDeliverContentTypePollCreationMixin").parseContentTypePollCreationMixin(a);if(i.success)return d("WAResultOrError").makeResult({name:"ContentTypePollCreation",value:i.value});var j=d("WASmaxInMessageDeliverContentTypePollVoteMixin").parseContentTypePollVoteMixin(a);if(j.success)return d("WAResultOrError").makeResult({name:"ContentTypePollVote",value:j.value});var k=d("WASmaxInMessageDeliverContentTypeScheduledCallMixin").parseContentTypeScheduledCallMixin(a);if(k.success)return d("WAResultOrError").makeResult({name:"ContentTypeScheduledCall",value:k.value});var l=d("WASmaxInMessageDeliverContentTypeEventMixin").parseContentTypeEventMixin(a);return l.success?d("WAResultOrError").makeResult({name:"ContentTypeEvent",value:l.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ContentTypeText","ContentTypeLiveLocationSingle","ContentTypeMediaSingle","ContentTypePayGroup","ContentTypeReaction","ContentTypeProductList","ContentTypePollCreation","ContentTypePollVote","ContentTypeScheduledCall","ContentTypeEvent"],[b,c,e,f,g,h,i,j,k,l])}g.parseContentSingleMixins=a}),98);
__d("WASmaxInMessageDeliverBotResponseMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"bot");if(!b.success)return b;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStanzaId,a,"edit_target_id");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"sender_timestamp_ms",0,void 0);if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"edit",d("WASmaxInMessageDeliverEnums").ENUM_FIRST_FULL_INNER_LAST);return!a.success?a:d("WAResultOrError").makeResult({editTargetId:b.value,senderTimestampMs:c.value,edit:a.value})}g.parseBotResponseMixin=a}),98);
__d("WASmaxInMessageDeliverEmptyBizMixin",["WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");return!b.success?b:d("WASmaxParseUtils").voidSuccess}g.parseEmptyBizMixin=a}),98);
__d("WASmaxInMessageDeliverEncTypeMessageSecretMessageMixin",["WAResultOrError","WASmaxInMessageDeliverEncPayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","msmsg");if(!b.success)return b;a=d("WASmaxInMessageDeliverEncPayloadMixin").parseEncPayloadMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({type:b.value},a.value))}g.parseEncTypeMessageSecretMessageMixin=a}),98);
__d("WASmaxInMessageDeliverEncVersion2OrFutureproofMixinGroup",["WAResultOrError","WASmaxInMessageDeliverEncVersion2Mixin","WASmaxInMessageDeliverEncVersionFutureproofMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverEncVersion2Mixin").parseEncVersion2Mixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"EncVersion2",value:b.value});var c=d("WASmaxInMessageDeliverEncVersionFutureproofMixin").parseEncVersionFutureproofMixin(a);return c.success?d("WAResultOrError").makeResult({name:"EncVersionFutureproof",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["EncVersion2","EncVersionFutureproof"],[b,c])}g.parseEncVersion2OrFutureproofMixinGroup=a}),98);
__d("WASmaxInMessageDeliverMessageTargetMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"meta");if(!b.success)return b;b=d("WASmaxParseUtils").attrStanzaId(a,"target_id");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"target_sender_jid");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrJidEnum,a,"target_chat_jid",d("WASmaxInMessageDeliverEnums").GROUPJID_USERJID);return!a.success?a:d("WAResultOrError").makeResult({targetId:b.value,targetSenderJid:c.value,targetChatJid:a.value})}g.parseMessageTargetMixin=a}),98);
__d("WASmaxInMessageDeliverBotResponseMessageMixin",["WAResultOrError","WASmaxInMessageDeliverBotResponseMixin","WASmaxInMessageDeliverEmptyBizMixin","WASmaxInMessageDeliverEncTypeMessageSecretMessageMixin","WASmaxInMessageDeliverEncVersion2OrFutureproofMixinGroup","WASmaxInMessageDeliverMessageTargetMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"bot");if(!b.success)return b;var c=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!c.success)return c;var e=d("WASmaxParseUtils").flattenedChildWithTag(a,"enc");if(!e.success)return e;b=d("WASmaxInMessageDeliverBotResponseMixin").parseBotResponseMixin(b.value);if(!b.success)return b;c=d("WASmaxInMessageDeliverMessageTargetMixin").parseMessageTargetMixin(c.value);if(!c.success)return c;var f=d("WASmaxInMessageDeliverEncTypeMessageSecretMessageMixin").parseEncTypeMessageSecretMessageMixin(e.value);if(!f.success)return f;a=d("WASmaxInMessageDeliverEmptyBizMixin").parseEmptyBizMixin(a);e=d("WASmaxInMessageDeliverEncVersion2OrFutureproofMixinGroup").parseEncVersion2OrFutureproofMixinGroup(e.value);return!e.success?e:d("WAResultOrError").makeResult({botBotResponseMixin:b.value,metaMessageTargetMixin:c.value,encEncTypeMessageSecretMessageMixin:f.value,hasEmptyBizMixin:a.success,encEncVersion2OrFutureproofMixinGroup:e.value})}g.parseBotResponseMessageMixin=a}),98);
__d("WASmaxInMessageDeliverEncMediaTypeDeprecatedMixin",["WAResultOrError","WASmaxInMessageDeliverAvatarStickerTypeMixin","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"enc");if(!b.success)return b;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"mediatype",d("WASmaxInMessageDeliverEnums").ENUM_AUDIO_AVATARSTICKER_BUTTONSRESPONSE_CATALOGLINK_CONTACT_CONTACTARRAY_DOCUMENT_GIF_HISTORY_IMAGE_LISTRESPONSE_LOCATION_NATIVEFLOWRESPONSE_ORDER_PRODUCT_PRODUCTLINK_PTT_PTV_STICKER_URL_VCARD_VIDEO_XMA);if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"native_flow_name",d("WASmaxInMessageDeliverEnums").ENUM_ADDRESSMESSAGE_GALAXYMESSAGE);if(!c.success)return c;a=d("WASmaxInMessageDeliverAvatarStickerTypeMixin").parseAvatarStickerTypeMixin(a);return d("WAResultOrError").makeResult({mediatype:b.value,nativeFlowName:c.value,avatarStickerTypeMixin:a.success?a.value:null})}g.parseEncMediaTypeDeprecatedMixin=a}),98);
__d("WASmaxInMessageDeliverGroupRegularMixin",["WAResultOrError","WASmaxInMessageDeliverEncMediaTypeDeprecatedMixin","WASmaxInMessageDeliverEncTypeIndividualOrSenderKeyMixinGroup","WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"enc");if(!b.success)return b;a=d("WASmaxInMessageDeliverEncMediaTypeDeprecatedMixin").parseEncMediaTypeDeprecatedMixin(b.value);var c=d("WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup").parseEncVersion2Or3OrFutureproofMixinGroup(b.value);if(!c.success)return c;b=d("WASmaxInMessageDeliverEncTypeIndividualOrSenderKeyMixinGroup").parseEncTypeIndividualOrSenderKeyMixinGroup(b.value);return!b.success?b:d("WAResultOrError").makeResult({encEncMediaTypeDeprecatedMixin:a.success?a.value:null,encEncVersion2Or3OrFutureproofMixinGroup:c.value,encEncTypeIndividualOrSenderKeyMixinGroup:b.value})}g.parseGroupRegularMixin=a}),98);
__d("WASmaxInMessageDeliverBypassedMixin",["WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"bypassed");return!b.success?b:d("WASmaxParseUtils").voidSuccess}g.parseBypassedMixin=a}),98);
__d("WASmaxInMessageDeliverGroupRetryMixin",["WAResultOrError","WASmaxInMessageDeliverBypassedMixin","WASmaxInMessageDeliverRetryMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverRetryMixin").parseRetryMixin(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverBypassedMixin").parseBypassedMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{hasBypassedMixin:a.success}))}g.parseGroupRetryMixin=a}),98);
__d("WASmaxInMessageDeliverGroupRetryOrBotResponseMessageOrGroupRegularMixinGroup",["WAResultOrError","WASmaxInMessageDeliverBotResponseMessageMixin","WASmaxInMessageDeliverGroupRegularMixin","WASmaxInMessageDeliverGroupRetryMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverGroupRetryMixin").parseGroupRetryMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"GroupRetry",value:b.value});var c=d("WASmaxInMessageDeliverBotResponseMessageMixin").parseBotResponseMessageMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"BotResponseMessage",value:c.value});var e=d("WASmaxInMessageDeliverGroupRegularMixin").parseGroupRegularMixin(a);return e.success?d("WAResultOrError").makeResult({name:"GroupRegular",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["GroupRetry","BotResponseMessage","GroupRegular"],[b,c,e])}g.parseGroupRetryOrBotResponseMessageOrGroupRegularMixinGroup=a}),98);
__d("WASmaxInMessageDeliverGroupSingleEncMixin",["WAResultOrError","WASmaxInMessageDeliverContentSingleMixins","WASmaxInMessageDeliverGroupRetryOrBotResponseMessageOrGroupRegularMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverContentSingleMixins").parseContentSingleMixins(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverGroupRetryOrBotResponseMessageOrGroupRegularMixinGroup").parseGroupRetryOrBotResponseMessageOrGroupRegularMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({contentSingleMixins:b.value,groupRetryOrBotResponseMessageOrGroupRegularMixinGroup:a.value})}g.parseGroupSingleEncMixin=a}),98);
__d("WASmaxInMessageDeliverGroupDualOrSingleEncMixinGroup",["WAResultOrError","WASmaxInMessageDeliverGroupDualEncMixin","WASmaxInMessageDeliverGroupSingleEncMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverGroupDualEncMixin").parseGroupDualEncMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"GroupDualEnc",value:b.value});var c=d("WASmaxInMessageDeliverGroupSingleEncMixin").parseGroupSingleEncMixin(a);return c.success?d("WAResultOrError").makeResult({name:"GroupSingleEnc",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["GroupDualEnc","GroupSingleEnc"],[b,c])}g.parseGroupDualOrSingleEncMixinGroup=a}),98);
__d("WASmaxInMessageDeliverGroupEphemeralMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"expiration",0,2147483647);return!b.success?b:d("WAResultOrError").makeResult({expiration:b.value})}g.parseGroupEphemeralMixin=a}),98);
__d("WASmaxInMessageDeliverMessagePinMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"edit","2");return!b.success?b:d("WAResultOrError").makeResult({edit:b.value})}g.parseMessagePinMixin=a}),98);
__d("WASmaxInMessageDeliverMessageEditOrMessagePinOrRevokeOrAdminRevokeOrGroupEphemeralMixinGroup",["WAResultOrError","WASmaxInMessageDeliverAdminRevokeMixin","WASmaxInMessageDeliverGroupEphemeralMixin","WASmaxInMessageDeliverMessageEditMixin","WASmaxInMessageDeliverMessagePinMixin","WASmaxInMessageDeliverRevokeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverMessageEditMixin").parseMessageEditMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"MessageEdit",value:b.value});var c=d("WASmaxInMessageDeliverMessagePinMixin").parseMessagePinMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"MessagePin",value:c.value});var e=d("WASmaxInMessageDeliverRevokeMixin").parseRevokeMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"Revoke",value:e.value});var f=d("WASmaxInMessageDeliverAdminRevokeMixin").parseAdminRevokeMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"AdminRevoke",value:f.value});var g=d("WASmaxInMessageDeliverGroupEphemeralMixin").parseGroupEphemeralMixin(a);return g.success?d("WAResultOrError").makeResult({name:"GroupEphemeral",value:g.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["MessageEdit","MessagePin","Revoke","AdminRevoke","GroupEphemeral"],[b,c,e,f,g])}g.parseMessageEditOrMessagePinOrRevokeOrAdminRevokeOrGroupEphemeralMixinGroup=a}),98);
__d("WASmaxInMessageDeliverParticipantLIDMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"participant_lid");return!b.success?b:d("WAResultOrError").makeResult({participantLid:b.value})}g.parseParticipantLIDMixin=a}),98);
__d("WASmaxInMessageDeliverThreadMsgMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").attrStanzaId(b.value,"thread_msg_id");if(!a.success)return a;b=d("WASmaxParseJid").attrUserJid(b.value,"thread_msg_sender_jid");return!b.success?b:d("WAResultOrError").makeResult({metaThreadMsgId:a.value,metaThreadMsgSenderJid:b.value})}g.parseThreadMsgMixin=a}),98);
__d("WASmaxInMessageDeliverToProxyAccountMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"actual_to");return!b.success?b:d("WAResultOrError").makeResult({actualTo:b.value})}g.parseToProxyAccountMixin=a}),98);
__d("WASmaxInMessageDeliverGroupMixin",["WAResultOrError","WASmaxInMessageDeliverBotThreadIDMixin","WASmaxInMessageDeliverDisplayNameMixin","WASmaxInMessageDeliverEnums","WASmaxInMessageDeliverFanoutCountMixin","WASmaxInMessageDeliverGroupAddressingModeMixin","WASmaxInMessageDeliverGroupDualOrSingleEncMixinGroup","WASmaxInMessageDeliverMessageEditOrMessagePinOrRevokeOrAdminRevokeOrGroupEphemeralMixinGroup","WASmaxInMessageDeliverParticipantLIDMixin","WASmaxInMessageDeliverThreadMsgMixin","WASmaxInMessageDeliverToProxyAccountMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseJid").attrGroupJid(a,"from");if(!b.success)return b;var c=d("WASmaxParseJid").attrJidEnum(a,"participant",d("WASmaxInMessageDeliverEnums").DEVICEJID_DEVICEJID);if(!c.success)return c;var e=d("WASmaxInMessageDeliverFanoutCountMixin").parseFanoutCountMixin(a),f=d("WASmaxInMessageDeliverParticipantLIDMixin").parseParticipantLIDMixin(a),g=d("WASmaxInMessageDeliverDisplayNameMixin").parseDisplayNameMixin(a),h=d("WASmaxInMessageDeliverGroupAddressingModeMixin").parseGroupAddressingModeMixin(a),i=d("WASmaxInMessageDeliverToProxyAccountMixin").parseToProxyAccountMixin(a),j=d("WASmaxInMessageDeliverBotThreadIDMixin").parseBotThreadIDMixin(a),k=d("WASmaxInMessageDeliverThreadMsgMixin").parseThreadMsgMixin(a),l=d("WASmaxInMessageDeliverGroupDualOrSingleEncMixinGroup").parseGroupDualOrSingleEncMixinGroup(a);if(!l.success)return l;a=d("WASmaxInMessageDeliverMessageEditOrMessagePinOrRevokeOrAdminRevokeOrGroupEphemeralMixinGroup").parseMessageEditOrMessagePinOrRevokeOrAdminRevokeOrGroupEphemeralMixinGroup(a);return d("WAResultOrError").makeResult({from:b.value,participant:c.value,fanoutCountMixin:e.success?e.value:null,participantLIDMixin:f.success?f.value:null,displayNameMixin:g.success?g.value:null,groupAddressingModeMixin:h.success?h.value:null,toProxyAccountMixin:i.success?i.value:null,botThreadIDMixin:j.success?j.value:null,threadMsgMixin:k.success?k.value:null,groupDualOrSingleEncMixinGroup:l.value,messageEditOrMessagePinOrRevokeOrAdminRevokeOrGroupEphemeralMixinGroup:a.success?a.value:null})}g.parseGroupMixin=a}),98);
__d("WASmaxInMessageDeliverBusinessBotMessageMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"bot");if(!b.success)return b;a=d("WASmaxParseUtils").attrStringEnum(b.value,"biz_bot",d("WASmaxInMessageDeliverEnums").ENUM_1_3);return!a.success?a:d("WAResultOrError").makeResult({botBizBot:a.value})}g.parseBusinessBotMessageMixin=a}),98);
__d("WASmaxInMessageDeliverSingleSelectListMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxParseUtils").flattenedChildWithTag(b.value,"list");if(!a.success)return a;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a.value,"type","single_select");if(!b.success)return b;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a.value,"v",d("WASmaxInMessageDeliverEnums").ENUM_1_2);return!a.success?a:d("WAResultOrError").makeResult({bizListType:b.value,bizListV:a.value})}g.parseSingleSelectListMixin=a}),98);
__d("WASmaxInMessageDeliverSingleSelectOrProductListMixinGroup",["WAResultOrError","WASmaxInMessageDeliverProductListMixin","WASmaxInMessageDeliverSingleSelectListMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverSingleSelectListMixin").parseSingleSelectListMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"SingleSelectList",value:b.value});var c=d("WASmaxInMessageDeliverProductListMixin").parseProductListMixin(a);return c.success?d("WAResultOrError").makeResult({name:"ProductList",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["SingleSelectList","ProductList"],[b,c])}g.parseSingleSelectOrProductListMixinGroup=a}),98);
__d("WASmaxInMessageDeliverContentTypeListMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeMediaMixin","WASmaxInMessageDeliverEncListMixin","WASmaxInMessageDeliverSingleSelectOrProductListMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"enc");if(!b.success)return b;b=d("WASmaxInMessageDeliverEncListMixin").parseEncListMixin(b.value);if(!b.success)return b;var c=d("WASmaxInMessageDeliverContentTypeMediaMixin").parseContentTypeMediaMixin(a);if(!c.success)return c;a=d("WASmaxInMessageDeliverSingleSelectOrProductListMixinGroup").parseSingleSelectOrProductListMixinGroup(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({encEncListMixin:b.value},c.value,{singleSelectOrProductListMixinGroup:a.success?a.value:null}))}g.parseContentTypeListMixin=a}),98);
__d("WASmaxInMessageDeliverIndividualDeliverPayNodeMixin",["WASmaxInMessageDeliverIndividualRequestPayNodeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"pay");if(!b.success)return b;b=d("WASmaxInMessageDeliverIndividualRequestPayNodeMixin").parseIndividualRequestPayNodeMixin(a);return!b.success?b:b}g.parseIndividualDeliverPayNodeMixin=a}),98);
__d("WASmaxInMessageDeliverIndividualDeliverPayNodeMessageMixin",["WASmaxInMessageDeliverIndividualDeliverPayNodeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"pay");if(!b.success)return b;a=d("WASmaxInMessageDeliverIndividualDeliverPayNodeMixin").parseIndividualDeliverPayNodeMixin(b.value);return!a.success?a:a}g.parseIndividualDeliverPayNodeMessageMixin=a}),98);
__d("WASmaxInMessageDeliverIndividualDeliverPayNodeOrPayTransactionMessageMixinGroup",["WAResultOrError","WASmaxInMessageDeliverIndividualDeliverPayNodeMessageMixin","WASmaxInMessageDeliverPayTransactionMessageMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverIndividualDeliverPayNodeMessageMixin").parseIndividualDeliverPayNodeMessageMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IndividualDeliverPayNodeMessage",value:b.value});var c=d("WASmaxInMessageDeliverPayTransactionMessageMixin").parsePayTransactionMessageMixin(a);return c.success?d("WAResultOrError").makeResult({name:"PayTransactionMessage",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IndividualDeliverPayNodeMessage","PayTransactionMessage"],[b,c])}g.parseIndividualDeliverPayNodeOrPayTransactionMessageMixinGroup=a}),98);
__d("WASmaxInMessageDeliverContentTypePayIndividualMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypePayMixin","WASmaxInMessageDeliverIndividualDeliverPayNodeOrPayTransactionMessageMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverContentTypePayMixin").parseContentTypePayMixin(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverIndividualDeliverPayNodeOrPayTransactionMessageMixinGroup").parseIndividualDeliverPayNodeOrPayTransactionMessageMixinGroup(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{individualDeliverPayNodeOrPayTransactionMessageMixinGroup:a.success?a.value:null}))}g.parseContentTypePayIndividualMixin=a}),98);
__d("WASmaxInMessageDeliverContentAvailableMixins",["WAResultOrError","WASmaxInMessageDeliverContentTypeListMixin","WASmaxInMessageDeliverContentTypeLiveLocationSingleMixin","WASmaxInMessageDeliverContentTypeMediaSingleMixin","WASmaxInMessageDeliverContentTypeMedianotifyMixin","WASmaxInMessageDeliverContentTypePayIndividualMixin","WASmaxInMessageDeliverContentTypePollCreationMixin","WASmaxInMessageDeliverContentTypePollVoteMixin","WASmaxInMessageDeliverContentTypeReactionMixin","WASmaxInMessageDeliverContentTypeTextMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverContentTypeTextMixin").parseContentTypeTextMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"ContentTypeText",value:b.value});var c=d("WASmaxInMessageDeliverContentTypeListMixin").parseContentTypeListMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"ContentTypeList",value:c.value});var e=d("WASmaxInMessageDeliverContentTypeLiveLocationSingleMixin").parseContentTypeLiveLocationSingleMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"ContentTypeLiveLocationSingle",value:e.value});var f=d("WASmaxInMessageDeliverContentTypeMediaSingleMixin").parseContentTypeMediaSingleMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"ContentTypeMediaSingle",value:f.value});var g=d("WASmaxInMessageDeliverContentTypePayIndividualMixin").parseContentTypePayIndividualMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"ContentTypePayIndividual",value:g.value});var h=d("WASmaxInMessageDeliverContentTypeReactionMixin").parseContentTypeReactionMixin(a);if(h.success)return d("WAResultOrError").makeResult({name:"ContentTypeReaction",value:h.value});var i=d("WASmaxInMessageDeliverContentTypePollCreationMixin").parseContentTypePollCreationMixin(a);if(i.success)return d("WAResultOrError").makeResult({name:"ContentTypePollCreation",value:i.value});var j=d("WASmaxInMessageDeliverContentTypePollVoteMixin").parseContentTypePollVoteMixin(a);if(j.success)return d("WAResultOrError").makeResult({name:"ContentTypePollVote",value:j.value});var k=d("WASmaxInMessageDeliverContentTypeMedianotifyMixin").parseContentTypeMedianotifyMixin(a);return k.success?d("WAResultOrError").makeResult({name:"ContentTypeMedianotify",value:k.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ContentTypeText","ContentTypeList","ContentTypeLiveLocationSingle","ContentTypeMediaSingle","ContentTypePayIndividual","ContentTypeReaction","ContentTypePollCreation","ContentTypePollVote","ContentTypeMedianotify"],[b,c,e,f,g,h,i,j,k])}g.parseContentAvailableMixins=a}),98);
__d("WASmaxInMessageDeliverRetryOrIndividualRegularOrBotResponseMessageMixinGroup",["WAResultOrError","WASmaxInMessageDeliverBotResponseMessageMixin","WASmaxInMessageDeliverIndividualRegularMixin","WASmaxInMessageDeliverRetryMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverRetryMixin").parseRetryMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"Retry",value:b.value});var c=d("WASmaxInMessageDeliverIndividualRegularMixin").parseIndividualRegularMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IndividualRegular",value:c.value});var e=d("WASmaxInMessageDeliverBotResponseMessageMixin").parseBotResponseMessageMixin(a);return e.success?d("WAResultOrError").makeResult({name:"BotResponseMessage",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Retry","IndividualRegular","BotResponseMessage"],[b,c,e])}g.parseRetryOrIndividualRegularOrBotResponseMessageMixinGroup=a}),98);
__d("WASmaxInMessageDeliverAvailableMixin",["WAResultOrError","WASmaxInMessageDeliverBusinessBotMessageMixin","WASmaxInMessageDeliverContentAvailableMixins","WASmaxInMessageDeliverRetryOrIndividualRegularOrBotResponseMessageMixinGroup","WASmaxInMessageDeliverRevokeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"enc");if(!b.success)return b;b=d("WASmaxInMessageDeliverRevokeMixin").parseRevokeMixin(a);var c=d("WASmaxInMessageDeliverBusinessBotMessageMixin").parseBusinessBotMessageMixin(a),e=d("WASmaxInMessageDeliverRetryOrIndividualRegularOrBotResponseMessageMixinGroup").parseRetryOrIndividualRegularOrBotResponseMessageMixinGroup(a);if(!e.success)return e;a=d("WASmaxInMessageDeliverContentAvailableMixins").parseContentAvailableMixins(a);return!a.success?a:d("WAResultOrError").makeResult({revokeMixin:b.success?b.value:null,businessBotMessageMixin:c.success?c.value:null,retryOrIndividualRegularOrBotResponseMessageMixinGroup:e.value,contentAvailableMixins:a.value})}g.parseAvailableMixin=a}),98);
__d("WASmaxInMessageDeliverContentUnavailableMixins",["WAResultOrError","WASmaxInMessageDeliverContentTypeMediaMixin","WASmaxInMessageDeliverContentTypePayIndividualMixin","WASmaxInMessageDeliverContentTypePollCreationMixin","WASmaxInMessageDeliverContentTypePollVoteMixin","WASmaxInMessageDeliverContentTypeReactionMixin","WASmaxInMessageDeliverContentTypeTextMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverContentTypeTextMixin").parseContentTypeTextMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"ContentTypeText",value:b.value});var c=d("WASmaxInMessageDeliverContentTypeMediaMixin").parseContentTypeMediaMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"ContentTypeMedia",value:c.value});var e=d("WASmaxInMessageDeliverContentTypePayIndividualMixin").parseContentTypePayIndividualMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"ContentTypePayIndividual",value:e.value});var f=d("WASmaxInMessageDeliverContentTypeReactionMixin").parseContentTypeReactionMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"ContentTypeReaction",value:f.value});var g=d("WASmaxInMessageDeliverContentTypePollCreationMixin").parseContentTypePollCreationMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"ContentTypePollCreation",value:g.value});var h=d("WASmaxInMessageDeliverContentTypePollVoteMixin").parseContentTypePollVoteMixin(a);return h.success?d("WAResultOrError").makeResult({name:"ContentTypePollVote",value:h.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ContentTypeText","ContentTypeMedia","ContentTypePayIndividual","ContentTypeReaction","ContentTypePollCreation","ContentTypePollVote"],[b,c,e,f,g,h])}g.parseContentUnavailableMixins=a}),98);
__d("WASmaxInMessageDeliverUnavailableMixin",["WAResultOrError","WASmaxInMessageDeliverContentUnavailableMixins","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"unavailable");if(!b.success)return b;b=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,b.value,"hosted","true");if(!b.success)return b;var c=d("WASmaxInMessageDeliverContentUnavailableMixins").parseContentUnavailableMixins(a);if(!c.success)return c;a=d("WASmaxParseUtils").countChildrenWithTag(a,"enc",0,Infinity,d("WAResultOrError").makeResult);return!a.success?a:d("WAResultOrError").makeResult({unavailableHosted:b.value,contentUnavailableMixins:c.value,countEnc:a.value})}g.parseUnavailableMixin=a}),98);
__d("WASmaxInMessageDeliverAvailableOrUnavailableMixinGroup",["WAResultOrError","WASmaxInMessageDeliverAvailableMixin","WASmaxInMessageDeliverUnavailableMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverAvailableMixin").parseAvailableMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"Available",value:b.value});var c=d("WASmaxInMessageDeliverUnavailableMixin").parseUnavailableMixin(a);return c.success?d("WAResultOrError").makeResult({name:"Unavailable",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Available","Unavailable"],[b,c])}g.parseAvailableOrUnavailableMixinGroup=a}),98);
__d("WASmaxInMessageDeliverGroupInviteTargetMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseJid").attrGroupJid(b.value,"group_invite");return!a.success?a:d("WAResultOrError").makeResult({metaGroupInvite:a.value})}g.parseGroupInviteTargetMixin=a}),98);
__d("WASmaxInMessageDeliverLidChatOriginMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").attrStringEnum(b.value,"origin",d("WASmaxInMessageDeliverEnums").ENUM_CTWA_USERNAME);if(!a.success)return a;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,b.value,"share_pn",d("WASmaxInMessageDeliverEnums").ENUM_FALSE_TRUE);return!b.success?b:d("WAResultOrError").makeResult({metaOrigin:a.value,metaSharePn:b.value})}g.parseLidChatOriginMixin=a}),98);
__d("WASmaxInMessageDeliverMessageEditOrMessagePinOrRevokeMixinGroup",["WAResultOrError","WASmaxInMessageDeliverMessageEditMixin","WASmaxInMessageDeliverMessagePinMixin","WASmaxInMessageDeliverRevokeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverMessageEditMixin").parseMessageEditMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"MessageEdit",value:b.value});var c=d("WASmaxInMessageDeliverMessagePinMixin").parseMessagePinMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"MessagePin",value:c.value});var e=d("WASmaxInMessageDeliverRevokeMixin").parseRevokeMixin(a);return e.success?d("WAResultOrError").makeResult({name:"Revoke",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["MessageEdit","MessagePin","Revoke"],[b,c,e])}g.parseMessageEditOrMessagePinOrRevokeMixinGroup=a}),98);
__d("WASmaxInMessageDeliverRecipientDisplayNameMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"recipient_display_name");return!b.success?b:d("WAResultOrError").makeResult({recipientDisplayName:b.value})}g.parseRecipientDisplayNameMixin=a}),98);
__d("WASmaxInMessageDeliverRecipientLIDMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"recipient_lid");return!b.success?b:d("WAResultOrError").makeResult({recipientLid:b.value})}g.parseRecipientLIDMixin=a}),98);
__d("WASmaxInMessageDeliverRecipientPNMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"recipient_pn");return!b.success?b:d("WAResultOrError").makeResult({recipientPn:b.value})}g.parseRecipientPNMixin=a}),98);
__d("WASmaxInMessageDeliverRecipientUsernameMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"recipient_username");return!b.success?b:d("WAResultOrError").makeResult({recipientUsername:b.value})}g.parseRecipientUsernameMixin=a}),98);
__d("WASmaxInMessageDeliverRecipientLIDOrPNOrDisplayNameOrUsernameMixinGroup",["WAResultOrError","WASmaxInMessageDeliverRecipientDisplayNameMixin","WASmaxInMessageDeliverRecipientLIDMixin","WASmaxInMessageDeliverRecipientPNMixin","WASmaxInMessageDeliverRecipientUsernameMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverRecipientLIDMixin").parseRecipientLIDMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"RecipientLID",value:b.value});var c=d("WASmaxInMessageDeliverRecipientPNMixin").parseRecipientPNMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"RecipientPN",value:c.value});var e=d("WASmaxInMessageDeliverRecipientDisplayNameMixin").parseRecipientDisplayNameMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"RecipientDisplayName",value:e.value});var f=d("WASmaxInMessageDeliverRecipientUsernameMixin").parseRecipientUsernameMixin(a);return f.success?d("WAResultOrError").makeResult({name:"RecipientUsername",value:f.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["RecipientLID","RecipientPN","RecipientDisplayName","RecipientUsername"],[b,c,e,f])}g.parseRecipientLIDOrPNOrDisplayNameOrUsernameMixinGroup=a}),98);
__d("WASmaxInMessageDeliverRecipientMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"recipient");return!b.success?b:d("WAResultOrError").makeResult({recipient:b.value})}g.parseRecipientMixin=a}),98);
__d("WASmaxInMessageDeliverSenderLIDMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"sender_lid");return!b.success?b:d("WAResultOrError").makeResult({senderLid:b.value})}g.parseSenderLIDMixin=a}),98);
__d("WASmaxInMessageDeliverSenderPNMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"sender_pn");return!b.success?b:d("WAResultOrError").makeResult({senderPn:b.value})}g.parseSenderPNMixin=a}),98);
__d("WASmaxInMessageDeliverSenderUsernameMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"username");return!b.success?b:d("WAResultOrError").makeResult({username:b.value})}g.parseSenderUsernameMixin=a}),98);
__d("WASmaxInMessageDeliverSenderPNOrLIDOrUsernameMixinGroup",["WAResultOrError","WASmaxInMessageDeliverSenderLIDMixin","WASmaxInMessageDeliverSenderPNMixin","WASmaxInMessageDeliverSenderUsernameMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverSenderPNMixin").parseSenderPNMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"SenderPN",value:b.value});var c=d("WASmaxInMessageDeliverSenderLIDMixin").parseSenderLIDMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"SenderLID",value:c.value});var e=d("WASmaxInMessageDeliverSenderUsernameMixin").parseSenderUsernameMixin(a);return e.success?d("WAResultOrError").makeResult({name:"SenderUsername",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["SenderPN","SenderLID","SenderUsername"],[b,c,e])}g.parseSenderPNOrLIDOrUsernameMixinGroup=a}),98);
__d("WASmaxInMessageDeliverThreadTypeTagEnumMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"meta");if(!b.success)return b;b=d("WASmaxParseUtils").attrInt(a,"thread_type");return!b.success?b:d("WAResultOrError").makeResult({threadType:b.value})}g.parseThreadTypeTagEnumMixin=a}),98);
__d("WASmaxInMessageDeliverThreadTypeTagLegacyMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"meta");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"thread_type");return!b.success?b:d("WAResultOrError").makeResult({threadType:b.value})}g.parseThreadTypeTagLegacyMixin=a}),98);
__d("WASmaxInMessageDeliverThreadTypeTagEnumOrLegacyMixinGroup",["WAResultOrError","WASmaxInMessageDeliverThreadTypeTagEnumMixin","WASmaxInMessageDeliverThreadTypeTagLegacyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverThreadTypeTagEnumMixin").parseThreadTypeTagEnumMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"ThreadTypeTagEnum",value:b.value});var c=d("WASmaxInMessageDeliverThreadTypeTagLegacyMixin").parseThreadTypeTagLegacyMixin(a);return c.success?d("WAResultOrError").makeResult({name:"ThreadTypeTagLegacy",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ThreadTypeTagEnum","ThreadTypeTagLegacy"],[b,c])}g.parseThreadTypeTagEnumOrLegacyMixinGroup=a}),98);
__d("WASmaxInMessageDeliverThreadTypeTagMixin",["WAResultOrError","WASmaxInMessageDeliverThreadTypeTagEnumOrLegacyMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxInMessageDeliverThreadTypeTagEnumOrLegacyMixinGroup").parseThreadTypeTagEnumOrLegacyMixinGroup(b.value);return!a.success?a:d("WAResultOrError").makeResult({metaThreadTypeTagEnumOrLegacyMixinGroup:a.value})}g.parseThreadTypeTagMixin=a}),98);
__d("WASmaxInMessageDeliverIndividualMixin",["WAResultOrError","WASmaxInMessageDeliverAvailableOrUnavailableMixinGroup","WASmaxInMessageDeliverBotThreadIDMixin","WASmaxInMessageDeliverDisplayNameMixin","WASmaxInMessageDeliverEnums","WASmaxInMessageDeliverGroupInviteTargetMixin","WASmaxInMessageDeliverLidChatOriginMixin","WASmaxInMessageDeliverMessageEditOrMessagePinOrRevokeMixinGroup","WASmaxInMessageDeliverRecipientLIDOrPNOrDisplayNameOrUsernameMixinGroup","WASmaxInMessageDeliverRecipientMixin","WASmaxInMessageDeliverSenderPNOrLIDOrUsernameMixinGroup","WASmaxInMessageDeliverThreadTypeTagMixin","WASmaxInMessageDeliverToProxyAccountMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseJid").attrJidEnum(a,"from",d("WASmaxInMessageDeliverEnums").DEVICEJID_DEVICEJID);if(!b.success)return b;var c=d("WASmaxInMessageDeliverRecipientMixin").parseRecipientMixin(a),e=d("WASmaxInMessageDeliverDisplayNameMixin").parseDisplayNameMixin(a),f=d("WASmaxInMessageDeliverGroupInviteTargetMixin").parseGroupInviteTargetMixin(a),g=d("WASmaxInMessageDeliverThreadTypeTagMixin").parseThreadTypeTagMixin(a),h=d("WASmaxInMessageDeliverToProxyAccountMixin").parseToProxyAccountMixin(a),i=d("WASmaxInMessageDeliverBotThreadIDMixin").parseBotThreadIDMixin(a),j=d("WASmaxInMessageDeliverLidChatOriginMixin").parseLidChatOriginMixin(a),k=d("WASmaxInMessageDeliverMessageEditOrMessagePinOrRevokeMixinGroup").parseMessageEditOrMessagePinOrRevokeMixinGroup(a),l=d("WASmaxInMessageDeliverAvailableOrUnavailableMixinGroup").parseAvailableOrUnavailableMixinGroup(a);if(!l.success)return l;var m=d("WASmaxInMessageDeliverSenderPNOrLIDOrUsernameMixinGroup").parseSenderPNOrLIDOrUsernameMixinGroup(a);a=d("WASmaxInMessageDeliverRecipientLIDOrPNOrDisplayNameOrUsernameMixinGroup").parseRecipientLIDOrPNOrDisplayNameOrUsernameMixinGroup(a);return d("WAResultOrError").makeResult({from:b.value,recipientMixin:c.success?c.value:null,displayNameMixin:e.success?e.value:null,groupInviteTargetMixin:f.success?f.value:null,threadTypeTagMixin:g.success?g.value:null,toProxyAccountMixin:h.success?h.value:null,botThreadIDMixin:i.success?i.value:null,lidChatOriginMixin:j.success?j.value:null,messageEditOrMessagePinOrRevokeMixinGroup:k.success?k.value:null,availableOrUnavailableMixinGroup:l.value,senderPNOrLIDOrUsernameMixinGroup:m.success?m.value:null,recipientLIDOrPNOrDisplayNameOrUsernameMixinGroup:a.success?a.value:null})}g.parseIndividualMixin=a}),98);
__d("WASmaxInMessageDeliverBroadcastDualEncBroadcastDualEncNonMediaOrBroadcastDualEncMediaMediaMixinGroup",["WAResultOrError","WASmaxInMessageDeliverBroadcastDualEncMediaMixin","WASmaxInMessageDeliverBroadcastDualEncNonMediaMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverBroadcastDualEncNonMediaMixin").parseBroadcastDualEncNonMediaMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"BroadcastDualEncNonMedia",value:b.value});var c=d("WASmaxInMessageDeliverBroadcastDualEncMediaMixin").parseBroadcastDualEncMediaMixin(a);return c.success?d("WAResultOrError").makeResult({name:"BroadcastDualEncMedia",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["BroadcastDualEncNonMedia","BroadcastDualEncMedia"],[b,c])}g.parseBroadcastDualEncBroadcastDualEncNonMediaOrBroadcastDualEncMediaMediaMixinGroup=a}),98);
__d("WASmaxInMessageDeliverStatusDualEncMixin",["WAResultOrError","WASmaxInMessageDeliverBroadcastDualEncBroadcastDualEncNonMediaOrBroadcastDualEncMediaMediaMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverBroadcastDualEncBroadcastDualEncNonMediaOrBroadcastDualEncMediaMediaMixinGroup").parseBroadcastDualEncBroadcastDualEncNonMediaOrBroadcastDualEncMediaMediaMixinGroup(a);return!b.success?b:d("WAResultOrError").makeResult({broadcastDualEncBroadcastDualEncNonMediaOrBroadcastDualEncMediaMediaMixinGroup:b.value})}g.parseStatusDualEncMixin=a}),98);
__d("WASmaxInMessageDeliverStatusSingleEncMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeTextOrMediaSingleMixinGroup","WASmaxInMessageDeliverRetryOrBroadcastRegularMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInMessageDeliverContentTypeTextOrMediaSingleMixinGroup").parseContentTypeTextOrMediaSingleMixinGroup(a);if(!b.success)return b;a=d("WASmaxInMessageDeliverRetryOrBroadcastRegularMixinGroup").parseRetryOrBroadcastRegularMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({contentTypeTextOrMediaSingleMixinGroup:b.value,retryOrBroadcastRegularMixinGroup:a.value})}g.parseStatusSingleEncMixin=a}),98);
__d("WASmaxInMessageDeliverStatusDualOrSingleEncMixinGroup",["WAResultOrError","WASmaxInMessageDeliverStatusDualEncMixin","WASmaxInMessageDeliverStatusSingleEncMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverStatusDualEncMixin").parseStatusDualEncMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"StatusDualEnc",value:b.value});var c=d("WASmaxInMessageDeliverStatusSingleEncMixin").parseStatusSingleEncMixin(a);return c.success?d("WAResultOrError").makeResult({name:"StatusSingleEnc",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["StatusDualEnc","StatusSingleEnc"],[b,c])}g.parseStatusDualOrSingleEncMixinGroup=a}),98);
__d("WASmaxInMessageDeliverStatusSettingMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").attrStringEnum(b.value,"status_setting",d("WASmaxInMessageDeliverEnums").ENUM_ALLOWLIST_CONTACTS_DENYLIST);return!a.success?a:d("WAResultOrError").makeResult({metaStatusSetting:a.value})}g.parseStatusSettingMixin=a}),98);
__d("WASmaxInMessageDeliverStatusMixin",["WAResultOrError","WASmaxInMessageDeliverFanoutCountMixin","WASmaxInMessageDeliverRevokeMixin","WASmaxInMessageDeliverStatusDualOrSingleEncMixinGroup","WASmaxInMessageDeliverStatusSettingMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrStatusJid,a,"from","status@broadcast");if(!b.success)return b;var c=d("WASmaxParseJid").attrDeviceJid(a,"participant");if(!c.success)return c;var e=d("WASmaxInMessageDeliverRevokeMixin").parseRevokeMixin(a),f=d("WASmaxInMessageDeliverFanoutCountMixin").parseFanoutCountMixin(a),g=d("WASmaxInMessageDeliverStatusSettingMixin").parseStatusSettingMixin(a);a=d("WASmaxInMessageDeliverStatusDualOrSingleEncMixinGroup").parseStatusDualOrSingleEncMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({from:b.value,participant:c.value,revokeMixin:e.success?e.value:null,fanoutCountMixin:f.success?f.value:null,statusSettingMixin:g.success?g.value:null,statusDualOrSingleEncMixinGroup:a.value})}g.parseStatusMixin=a}),98);
__d("WASmaxInMessageDeliverIndividualOrGroupOrStatusOrBroadcastMixinGroup",["WAResultOrError","WASmaxInMessageDeliverBroadcastMixin","WASmaxInMessageDeliverGroupMixin","WASmaxInMessageDeliverIndividualMixin","WASmaxInMessageDeliverStatusMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverIndividualMixin").parseIndividualMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"Individual",value:b.value});var c=d("WASmaxInMessageDeliverGroupMixin").parseGroupMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"Group",value:c.value});var e=d("WASmaxInMessageDeliverStatusMixin").parseStatusMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"Status",value:e.value});var f=d("WASmaxInMessageDeliverBroadcastMixin").parseBroadcastMixin(a);return f.success?d("WAResultOrError").makeResult({name:"Broadcast",value:f.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Individual","Group","Status","Broadcast"],[b,c,e,f])}g.parseIndividualOrGroupOrStatusOrBroadcastMixinGroup=a}),98);
__d("WASmaxInMessageDeliverRegularRequest",["WAResultOrError","WASmaxInMessageDeliverBaseMixin","WASmaxInMessageDeliverIndividualOrGroupOrStatusOrBroadcastMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!b.success)return b;var c=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!c.success)return c;var e=d("WASmaxInMessageDeliverBaseMixin").parseBaseMixin(a);if(!e.success)return e;a=d("WASmaxInMessageDeliverIndividualOrGroupOrStatusOrBroadcastMixinGroup").parseIndividualOrGroupOrStatusOrBroadcastMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({id:b.value,t:c.value},e.value,{individualOrGroupOrStatusOrBroadcastMixinGroup:a.value}))}g.parseRegularRequest=a}),98);
__d("WASmaxOutMessageDeliverAckMixin",["WASmaxAttrs","WASmaxInMessageDeliverEnums","WASmaxJsx","WASmaxMixins","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function h(a,b){a=a.ackRecipient;var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrJidEnum,b,["from"],d("WASmaxInMessageDeliverEnums").DEVICEJID_BROADCASTJID_DEVICEJID_GROUPJID_STATUSJID);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);var e=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,b,["id"]);if(!e.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(e.error);var f=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrString,b,["type"]);if(!f.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(f.error);var g=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrJidEnum,b,["participant"],d("WASmaxInMessageDeliverEnums").DEVICEJID_DEVICEJID_DEVICEJID);if(!g.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(g.error);b=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrUserJid,b,["actual_to"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);c=d("WASmaxJsx").smax("ack",{to:d("WAWap").JID(c.value),"class":"message",id:d("WAWap").STANZA_ID(e.value),type:d("WAWap").CUSTOM_STRING(f.value),participant:d("WASmaxAttrs").OPTIONAL(d("WAWap").JID,g.value),recipient:d("WASmaxAttrs").OPTIONAL(d("WAWap").USER_JID,a),actual_from:d("WASmaxAttrs").OPTIONAL(d("WAWap").JID,b.value)});return c}function a(a,b,c){b=h(b,c);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeAckMixin=a}),98);
__d("WASmaxOutMessageDeliverRegularResponseMissingPlaceholder",["WASmaxJsx","WASmaxOutMessageDeliverAckMixin"],(function(a,b,c,d,e,f,g){function a(a,b){a=d("WASmaxOutMessageDeliverAckMixin").mergeAckMixin(d("WASmaxJsx").smax("ack",{error:"404"}),a,b);return a}g.makeRegularResponseMissingPlaceholder=a}),98);
__d("WASmaxOutMessageDeliverRegularResponseSuccess",["WASmaxJsx","WASmaxOutMessageDeliverAckMixin"],(function(a,b,c,d,e,f,g){function a(a,b){a=d("WASmaxOutMessageDeliverAckMixin").mergeAckMixin(d("WASmaxJsx").smax("ack",null),a,b);return a}g.makeRegularResponseSuccess=a}),98);
__d("WASmaxMessageDeliverRegularRPC",["WASmaxInMessageDeliverRegularRequest","WASmaxOutMessageDeliverRegularResponseMissingPlaceholder","WASmaxOutMessageDeliverRegularResponseSuccess","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageDeliverRegularRequest").parseRegularRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Regular",{Request:b}));return{parsedRequest:b.value,makeRegularResponseMissingPlaceholder:function(b){return d("WASmaxOutMessageDeliverRegularResponseMissingPlaceholder").makeRegularResponseMissingPlaceholder(b,a)},makeRegularResponseSuccess:function(b){return d("WASmaxOutMessageDeliverRegularResponseSuccess").makeRegularResponseSuccess(b,a)}}}g.receiveRegularRPC=a}),98);
__d("WASmaxInMessageFallbackDeliverEncMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").countChildrenWithTag(a,"enc",1,Infinity,d("WAResultOrError").makeResult);return!b.success?b:d("WAResultOrError").makeResult({countEnc:b.value})}g.parseDeliverEncMixin=a}),98);
__d("WASmaxInMessageFallbackEnums",["WAJids"],(function(a,b,c,d,e,f,g){b={validators:[(a=d("WAJids")).validateBroadcastJid,a.validateCallJid,a.validateDeviceJid,a.validateDomainJid,a.validateGroupJid,a.validateStatusJid,a.validateUserJid],typeName:"BroadcastJid|CallJid|DeviceJid|DomainJid|GroupJid|StatusJid|UserJid"};g.BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID=b}),98);
__d("WASmaxInMessageFallbackDeliverRequest",["WAResultOrError","WASmaxInMessageFallbackDeliverEncMixin","WASmaxInMessageFallbackEnums","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!b.success)return b;var c=d("WASmaxParseJid").attrJidEnum(a,"from",d("WASmaxInMessageFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"type");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrJidEnum,a,"participant",d("WASmaxInMessageFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!f.success)return f;a=d("WASmaxInMessageFallbackDeliverEncMixin").parseDeliverEncMixin(a);return d("WAResultOrError").makeResult({id:b.value,from:c.value,type:e.value,participant:f.value,deliverEncMixin:a.success?a.value:null})}g.parseDeliverRequest=a}),98);
__d("WASmaxOutMessageFallbackDeliverResponseBadStanza",["WASmaxAttrs","WASmaxInMessageFallbackEnums","WASmaxJsx","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a,b){a=a.ackError;var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,b,["id"]);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);var e=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrJidEnum,b,["from"],d("WASmaxInMessageFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!e.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(e.error);var f=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrJidEnum,b,["participant"],d("WASmaxInMessageFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!f.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(f.error);b=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseUtils").attrString,b,["type"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);c=d("WASmaxJsx").smax("ack",{"class":"message",id:d("WAWap").STANZA_ID(c.value),to:d("WAWap").JID(e.value),participant:d("WASmaxAttrs").OPTIONAL(d("WAWap").JID,f.value),type:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,b.value),error:d("WAWap").INT(a)});return c}g.makeDeliverResponseBadStanza=a}),98);
__d("WASmaxOutMessageFallbackDeliverResponseDelivery",["WASmaxAttrs","WASmaxInMessageFallbackEnums","WASmaxJsx","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrJidEnum,a,["from"],d("WASmaxInMessageFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrJidEnum,a,["participant"],d("WASmaxInMessageFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("receipt",{id:d("WAWap").STANZA_ID(b.value),to:d("WAWap").JID(c.value),participant:d("WASmaxAttrs").OPTIONAL(d("WAWap").JID,a.value)});return b}g.makeDeliverResponseDelivery=a}),98);
__d("WASmaxOutMessageFallbackDeliverResponseNoEnc",["WASmaxAttrs","WASmaxInMessageFallbackEnums","WASmaxJsx","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrJidEnum,a,["from"],d("WASmaxInMessageFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);var e=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrJidEnum,a,["participant"],d("WASmaxInMessageFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!e.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(e.error);a=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{"class":"message",id:d("WAWap").STANZA_ID(b.value),from:d("WAWap").JID(c.value),participant:d("WASmaxAttrs").OPTIONAL(d("WAWap").JID,e.value),type:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a.value),error:"406"});return b}g.makeDeliverResponseNoEnc=a}),98);
__d("WASmaxMessageFallbackDeliverRPC",["WASmaxInMessageFallbackDeliverRequest","WASmaxOutMessageFallbackDeliverResponseBadStanza","WASmaxOutMessageFallbackDeliverResponseDelivery","WASmaxOutMessageFallbackDeliverResponseNoEnc","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageFallbackDeliverRequest").parseDeliverRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Deliver",{Request:b}));return{parsedRequest:b.value,makeDeliverResponseNoEnc:function(){return d("WASmaxOutMessageFallbackDeliverResponseNoEnc").makeDeliverResponseNoEnc(a)},makeDeliverResponseDelivery:function(){return d("WASmaxOutMessageFallbackDeliverResponseDelivery").makeDeliverResponseDelivery(a)},makeDeliverResponseBadStanza:function(b){return d("WASmaxOutMessageFallbackDeliverResponseBadStanza").makeDeliverResponseBadStanza(b,a)}}}g.receiveDeliverRPC=a}),98);
__d("WACreateHandleMessage",["Promise","WACommonMessageBase","WACreateHandleGroupMessageBranch","WACreateHandleIndividualMessageBranch","WACreateHandlePeerMessageBranch","WALogger","WAResultOrError","WASmaxMessageDeliverNewsletterRPC","WASmaxMessageDeliverRegularRPC","WASmaxMessageFallbackDeliverRPC","WASmaxParsingFailure"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleMessage receives an invalid stanza"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleMessage receives an invalid stanza: ",". Reason: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Ignore incoming <message /> because no handler is provided"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["DT: handleMessage start"]);l=function(){return a};return a}function a(a){var c=a.individualMessage,e=a.groupMessage,f=a.status,g=a.broadcast,m=d("WACreateHandlePeerMessageBranch").createHandlePeerMessageBranch(a),n=c&&d("WACreateHandleIndividualMessageBranch").createHandleIndividualMessageBranch(c.handleIndividualMessage),o=e&&d("WACreateHandleGroupMessageBranch").createHandleGroupMessageBranch(e.handleGroupMessage);return function(a,c,e){d("WALogger").LOG(l());try{if(((c=a.content)==null?void 0:(c=c[0])==null?void 0:c.tag)==="plaintext"){c=d("WASmaxMessageDeliverNewsletterRPC").receiveNewsletterRPC(a);c=c.makeNewsletterResponseSuccess;return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult(c()))}if(a.attrs.category==="peer")return m(a,{cryptoManager:e});c=d("WASmaxMessageDeliverRegularRPC").receiveRegularRPC(a);var p=c.parsedRequest,q=c.makeRegularResponseSuccess;c=p.individualOrGroupOrStatusOrBroadcastMixinGroup;p=d("WACommonMessageBase").transformMessageParsedRequest(p);switch(c.name){case"Individual":if(n!=null)return n({individualMixin:c.value,makeAck:function(){return q({})},commonMessageBase:p,ctx:{cryptoManager:e}});break;case"Group":if(o!=null)return o({groupMixin:c.value,makeAck:function(){return q({})},commonMessageBase:p,ctx:{cryptoManager:e}});break;case"Broadcast":if(g!=null)return g.handleBroadcastMessage({makeAck:function(){return q({})}}).then(d("WAResultOrError").makeResult);break;default:c.name;if(f!=null)return f.handleStatusMessage({makeAck:function(){return q({})}}).then(d("WAResultOrError").makeResult);break}d("WALogger").LOG(k());p=d("WASmaxMessageFallbackDeliverRPC").receiveDeliverRPC(a);e=p.makeDeliverResponseDelivery;return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult(e()))}catch(e){if(e instanceof d("WASmaxParsingFailure").SmaxParsingFailure){d("WALogger").WARN(j(),a.toString(),e.toString());d("WALogger").ERROR(i());c=d("WASmaxMessageFallbackDeliverRPC").receiveDeliverRPC(a);p=c.makeDeliverResponseBadStanza;return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult(p({ackError:487})))}return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeError({type:"runtime-error",error:e}))}}}g.createHandleMessage=a}),98);
__d("WASmaxInAccountSyncEnums",[],(function(a,b,c,d,e,f){a={approved:"approved",pending:"pending",rejected:"rejected"};b={block:"block",unblock:"unblock"};f.ENUM_APPROVED_PENDING_REJECTED=a;f.ENUM_BLOCK_UNBLOCK=b}),66);
__d("WASmaxInAccountSyncNotificationBlocklistMixin",["WAResultOrError","WASmaxInAccountSyncEnums","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"blocklist");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"item");if(!b.success)return b;var c=d("WASmaxParseUtils").attrString(a,"dhash");if(!c.success)return c;a=d("WASmaxParseUtils").attrString(a,"prev_dhash");if(!a.success)return a;var e=d("WASmaxParseUtils").attrStringEnum(b.value,"action",d("WASmaxInAccountSyncEnums").ENUM_BLOCK_UNBLOCK);if(!e.success)return e;b=d("WASmaxParseJid").attrUserJid(b.value,"jid");return!b.success?b:d("WAResultOrError").makeResult({dhash:c.value,prevDhash:a.value,itemAction:e.value,itemJid:b.value})}g.parseNotificationBlocklistMixin=a}),98);
__d("WASmaxInAccountSyncNotificationBlocklistNoPayloadMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"blocklist");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"action","modify");return!b.success?b:d("WAResultOrError").makeResult({action:b.value})}g.parseNotificationBlocklistNoPayloadMixin=a}),98);
__d("WASmaxInAccountSyncBlocklistNotificationType",["WAResultOrError","WASmaxInAccountSyncNotificationBlocklistMixin","WASmaxInAccountSyncNotificationBlocklistNoPayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInAccountSyncNotificationBlocklistMixin").parseNotificationBlocklistMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NotificationBlocklist",value:b.value});var c=d("WASmaxInAccountSyncNotificationBlocklistNoPayloadMixin").parseNotificationBlocklistNoPayloadMixin(a);return c.success?d("WAResultOrError").makeResult({name:"NotificationBlocklistNoPayload",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Blocklist","BlocklistNoPayload"],[b,c])}g.parseBlocklistNotificationType=a}),98);
__d("WASmaxInAccountSyncNotificationBlocklistNotificationMixin",["WAResultOrError","WASmaxInAccountSyncBlocklistNotificationType","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"blocklist");if(!b.success)return b;a=d("WASmaxInAccountSyncBlocklistNotificationType").parseBlocklistNotificationType(b.value);return!a.success?a:d("WAResultOrError").makeResult({blocklistBlocklistNotificationType:a.value})}g.parseNotificationBlocklistNotificationMixin=a}),98);
__d("WASmaxInAccountSyncNotificationDevicesMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"device");if(!b.success)return b;b=d("WASmaxParseJid").attrDeviceJid(a,"jid");if(!b.success)return b;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"key-index",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({jid:b.value,keyIndex:a.value})}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"key-index-list");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"ts",-1,void 0);if(!b.success)return b;a=d("WASmaxParseUtils").contentBytesRange(a,0,100);return!a.success?a:d("WAResultOrError").makeResult({ts:b.value,elementValue:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"devices");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"key-index-list",i);if(!b.success)return b;var c=d("WASmaxParseUtils").attrString(a,"dhash");if(!c.success)return c;a=d("WASmaxParseUtils").mapChildrenWithTag(a,"device",0,1e3,h);return!a.success?a:d("WAResultOrError").makeResult({dhash:c.value,keyIndexList:b.value,device:a.value})}g.parseNotificationDevicesDevice=h;g.parseNotificationDevicesKeyIndexList=i;g.parseNotificationDevicesMixin=a}),98);
__d("WASmaxInAccountSyncNotificationDevicesNoPayloadMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"devices");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"action","modify");return!b.success?b:d("WAResultOrError").makeResult({action:b.value})}g.parseNotificationDevicesNoPayloadMixin=a}),98);
__d("WASmaxInAccountSyncDevicesNotificationType",["WAResultOrError","WASmaxInAccountSyncNotificationDevicesMixin","WASmaxInAccountSyncNotificationDevicesNoPayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInAccountSyncNotificationDevicesMixin").parseNotificationDevicesMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NotificationDevices",value:b.value});var c=d("WASmaxInAccountSyncNotificationDevicesNoPayloadMixin").parseNotificationDevicesNoPayloadMixin(a);return c.success?d("WAResultOrError").makeResult({name:"NotificationDevicesNoPayload",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Devices","DevicesNoPayload"],[b,c])}g.parseDevicesNotificationType=a}),98);
__d("WASmaxInAccountSyncNotificationDevicesNotificationMixin",["WAResultOrError","WASmaxInAccountSyncDevicesNotificationType","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"devices");if(!b.success)return b;a=d("WASmaxInAccountSyncDevicesNotificationType").parseDevicesNotificationType(b.value);return!a.success?a:d("WAResultOrError").makeResult({devicesDevicesNotificationType:a.value})}g.parseNotificationDevicesNotificationMixin=a}),98);
__d("WASmaxInAccountSyncNotificationDisappearingModeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"disappearing_mode");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"duration",0,void 0);if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({duration:b.value,t:a.value})}g.parseNotificationDisappearingModeMixin=a}),98);
__d("WASmaxInAccountSyncNotificationDisappearingModeNoPayloadMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"disappearing_mode");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"action","modify");return!b.success?b:d("WAResultOrError").makeResult({action:b.value})}g.parseNotificationDisappearingModeNoPayloadMixin=a}),98);
__d("WASmaxInAccountSyncDisappearingModeNotificationType",["WAResultOrError","WASmaxInAccountSyncNotificationDisappearingModeMixin","WASmaxInAccountSyncNotificationDisappearingModeNoPayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInAccountSyncNotificationDisappearingModeMixin").parseNotificationDisappearingModeMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NotificationDisappearingMode",value:b.value});var c=d("WASmaxInAccountSyncNotificationDisappearingModeNoPayloadMixin").parseNotificationDisappearingModeNoPayloadMixin(a);return c.success?d("WAResultOrError").makeResult({name:"NotificationDisappearingModeNoPayload",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["DisappearingMode","DisappearingModeNoPayload"],[b,c])}g.parseDisappearingModeNotificationType=a}),98);
__d("WASmaxInAccountSyncNotificationDisappearingModeNotificationMixin",["WAResultOrError","WASmaxInAccountSyncDisappearingModeNotificationType","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"disappearing_mode");if(!b.success)return b;a=d("WASmaxInAccountSyncDisappearingModeNotificationType").parseDisappearingModeNotificationType(b.value);return!a.success?a:d("WAResultOrError").makeResult({disappearingModeDisappearingModeNotificationType:a.value})}g.parseNotificationDisappearingModeNotificationMixin=a}),98);
__d("WASmaxInAccountSyncNotificationNoticeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notice");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"id",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").attrIntRange(a,"stage",0,1e3);if(!c.success)return c;var e=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!e.success)return e;var f=d("WASmaxParseUtils").attrIntRange(a,"version",1,void 0);if(!f.success)return f;a=d("WASmaxParseUtils").attrIntRange(a,"type",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({id:b.value,stage:c.value,t:e.value,version:f.value,type:a.value})}g.parseNotificationNoticeMixin=a}),98);
__d("WASmaxInAccountSyncNotificationNoticeNoPayloadMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notice");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"action","modify");return!b.success?b:d("WAResultOrError").makeResult({action:b.value})}g.parseNotificationNoticeNoPayloadMixin=a}),98);
__d("WASmaxInAccountSyncNoticeNotificationType",["WAResultOrError","WASmaxInAccountSyncNotificationNoticeMixin","WASmaxInAccountSyncNotificationNoticeNoPayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInAccountSyncNotificationNoticeMixin").parseNotificationNoticeMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NotificationNotice",value:b.value});var c=d("WASmaxInAccountSyncNotificationNoticeNoPayloadMixin").parseNotificationNoticeNoPayloadMixin(a);return c.success?d("WAResultOrError").makeResult({name:"NotificationNoticeNoPayload",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Notice","NoticeNoPayload"],[b,c])}g.parseNoticeNotificationType=a}),98);
__d("WASmaxInAccountSyncNotificationNoticeNotificationMixin",["WAResultOrError","WASmaxInAccountSyncNoticeNotificationType","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"notice");if(!b.success)return b;a=d("WASmaxInAccountSyncNoticeNotificationType").parseNoticeNotificationType(b.value);return!a.success?a:d("WAResultOrError").makeResult({noticeNoticeNotificationType:a.value})}g.parseNotificationNoticeNotificationMixin=a}),98);
__d("WASmaxInAccountSyncNotificationPictureMixin",["WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"picture");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"delete");return!b.success?b:d("WASmaxParseUtils").voidSuccess}g.parseNotificationPictureMixin=a}),98);
__d("WASmaxInAccountSyncNotificationPictureNoPayloadMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"picture");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"action","modify");return!b.success?b:d("WAResultOrError").makeResult({action:b.value})}g.parseNotificationPictureNoPayloadMixin=a}),98);
__d("WASmaxInAccountSyncPictureNotificationType",["WAResultOrError","WASmaxInAccountSyncNotificationPictureMixin","WASmaxInAccountSyncNotificationPictureNoPayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInAccountSyncNotificationPictureMixin").parseNotificationPictureMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NotificationPicture",value:b.value});var c=d("WASmaxInAccountSyncNotificationPictureNoPayloadMixin").parseNotificationPictureNoPayloadMixin(a);return c.success?d("WAResultOrError").makeResult({name:"NotificationPictureNoPayload",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Picture","PictureNoPayload"],[b,c])}g.parsePictureNotificationType=a}),98);
__d("WASmaxInAccountSyncNotificationPictureNotificationMixin",["WAResultOrError","WASmaxInAccountSyncPictureNotificationType","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"picture");if(!b.success)return b;a=d("WASmaxInAccountSyncPictureNotificationType").parsePictureNotificationType(b.value);return!a.success?a:d("WAResultOrError").makeResult({picturePictureNotificationType:a.value})}g.parseNotificationPictureNotificationMixin=a}),98);
__d("WASmaxInAccountSyncNotificationContactBlacklistNoAdditionalDataMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"category");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"action","modify");return!b.success?b:d("WAResultOrError").makeResult({action:b.value})}g.parseNotificationContactBlacklistNoAdditionalDataMixin=a}),98);
__d("WASmaxInAccountSyncNotificationContactBlacklistWithAdditionalDataMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"action");if(!b.success)return b;a=d("WASmaxParseJid").attrUserJid(a,"jid");return!a.success?a:d("WAResultOrError").makeResult({action:b.value,jid:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"category");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"dhash");if(!b.success)return b;var c=d("WASmaxParseUtils").attrString(a,"prev_dhash");if(!c.success)return c;a=d("WASmaxParseUtils").mapChildrenWithTag(a,"user",0,1e3,h);return!a.success?a:d("WAResultOrError").makeResult({dhash:b.value,prevDhash:c.value,user:a.value})}g.parseNotificationContactBlacklistWithAdditionalDataUser=h;g.parseNotificationContactBlacklistWithAdditionalDataMixin=a}),98);
__d("WASmaxInAccountSyncContactBlacklistData",["WAResultOrError","WASmaxInAccountSyncNotificationContactBlacklistNoAdditionalDataMixin","WASmaxInAccountSyncNotificationContactBlacklistWithAdditionalDataMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInAccountSyncNotificationContactBlacklistWithAdditionalDataMixin").parseNotificationContactBlacklistWithAdditionalDataMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NotificationContactBlacklistWithAdditionalData",value:b.value});var c=d("WASmaxInAccountSyncNotificationContactBlacklistNoAdditionalDataMixin").parseNotificationContactBlacklistNoAdditionalDataMixin(a);return c.success?d("WAResultOrError").makeResult({name:"NotificationContactBlacklistNoAdditionalData",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ContactBlacklistWithAdditionalData","ContactBlacklistNoAdditionalData"],[b,c])}g.parseContactBlacklistData=a}),98);
__d("WASmaxInAccountSyncNotificationPrivacyMixin",["WAResultOrError","WASmaxInAccountSyncContactBlacklistData","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"category");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"name");if(!b.success)return b;var c=d("WASmaxParseUtils").attrString(a,"value");if(!c.success)return c;a=d("WASmaxInAccountSyncContactBlacklistData").parseContactBlacklistData(a);return d("WAResultOrError").makeResult({name:b.value,value:c.value,contactBlacklistData:a.success?a.value:null})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"privacy");if(!b.success)return b;b=d("WASmaxParseUtils").mapChildrenWithTag(a,"category",0,1e3,h);return!b.success?b:d("WAResultOrError").makeResult({category:b.value})}g.parseNotificationPrivacyCategory=h;g.parseNotificationPrivacyMixin=a}),98);
__d("WASmaxInAccountSyncNotificationPrivacyNoPayloadMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"privacy");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"action","modify");return!b.success?b:d("WAResultOrError").makeResult({action:b.value})}g.parseNotificationPrivacyNoPayloadMixin=a}),98);
__d("WASmaxInAccountSyncPrivacyNotificationType",["WAResultOrError","WASmaxInAccountSyncNotificationPrivacyMixin","WASmaxInAccountSyncNotificationPrivacyNoPayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInAccountSyncNotificationPrivacyNoPayloadMixin").parseNotificationPrivacyNoPayloadMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NotificationPrivacyNoPayload",value:b.value});var c=d("WASmaxInAccountSyncNotificationPrivacyMixin").parseNotificationPrivacyMixin(a);return c.success?d("WAResultOrError").makeResult({name:"NotificationPrivacy",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["PrivacyNoPayload","Privacy"],[b,c])}g.parsePrivacyNotificationType=a}),98);
__d("WASmaxInAccountSyncNotificationPrivacyNotificationMixin",["WAResultOrError","WASmaxInAccountSyncPrivacyNotificationType","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"privacy");if(!b.success)return b;a=d("WASmaxInAccountSyncPrivacyNotificationType").parsePrivacyNotificationType(b.value);return!a.success?a:d("WAResultOrError").makeResult({privacyPrivacyNotificationType:a.value})}g.parseNotificationPrivacyNotificationMixin=a}),98);
__d("WASmaxInAccountSyncNotificationStatusMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"status");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"dhash");if(!b.success)return b;a=d("WASmaxParseUtils").contentString(a);return!a.success?a:d("WAResultOrError").makeResult({dhash:b.value,elementValue:a.value})}g.parseNotificationStatusMixin=a}),98);
__d("WASmaxInAccountSyncNotificationStatusNoPayloadMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"status");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"action","modify");return!b.success?b:d("WAResultOrError").makeResult({action:b.value})}g.parseNotificationStatusNoPayloadMixin=a}),98);
__d("WASmaxInAccountSyncStatusNotificationType",["WAResultOrError","WASmaxInAccountSyncNotificationStatusMixin","WASmaxInAccountSyncNotificationStatusNoPayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInAccountSyncNotificationStatusMixin").parseNotificationStatusMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NotificationStatus",value:b.value});var c=d("WASmaxInAccountSyncNotificationStatusNoPayloadMixin").parseNotificationStatusNoPayloadMixin(a);return c.success?d("WAResultOrError").makeResult({name:"NotificationStatusNoPayload",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Status","StatusNoPayload"],[b,c])}g.parseStatusNotificationType=a}),98);
__d("WASmaxInAccountSyncNotificationStatusNotificationMixin",["WAResultOrError","WASmaxInAccountSyncStatusNotificationType","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"status");if(!b.success)return b;a=d("WASmaxInAccountSyncStatusNotificationType").parseStatusNotificationType(b.value);return!a.success?a:d("WAResultOrError").makeResult({statusStatusNotificationType:a.value})}g.parseNotificationStatusNotificationMixin=a}),98);
__d("WASmaxInAccountSyncNotificationTextStatusEmojiMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"emoji");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"content");return!b.success?b:d("WAResultOrError").makeResult({content:b.value})}g.parseNotificationTextStatusEmojiMixin=a}),98);
__d("WASmaxInAccountSyncNotificationTextStatusMixin",["WAResultOrError","WASmaxInAccountSyncNotificationTextStatusEmojiMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"text_status");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"emoji");if(!b.success)return b;var c=d("WASmaxParseUtils").attrString(a,"text");if(!c.success)return c;var e=d("WASmaxParseUtils").attrInt(a,"ephemeral_duration_sec");if(!e.success)return e;a=d("WASmaxParseUtils").attrString(a,"last_update_time");if(!a.success)return a;b=d("WASmaxInAccountSyncNotificationTextStatusEmojiMixin").parseNotificationTextStatusEmojiMixin(b.value);return!b.success?b:d("WAResultOrError").makeResult({text:c.value,ephemeralDurationSec:e.value,lastUpdateTime:a.value,emojiNotificationTextStatusEmojiMixin:b.value})}g.parseNotificationTextStatusMixin=a}),98);
__d("WASmaxInAccountSyncNotificationTextStatusNoPayloadMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"text_status");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"action","modify");return!b.success?b:d("WAResultOrError").makeResult({action:b.value})}g.parseNotificationTextStatusNoPayloadMixin=a}),98);
__d("WASmaxInAccountSyncTextStatusNotificationType",["WAResultOrError","WASmaxInAccountSyncNotificationTextStatusMixin","WASmaxInAccountSyncNotificationTextStatusNoPayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInAccountSyncNotificationTextStatusMixin").parseNotificationTextStatusMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NotificationTextStatus",value:b.value});var c=d("WASmaxInAccountSyncNotificationTextStatusNoPayloadMixin").parseNotificationTextStatusNoPayloadMixin(a);return c.success?d("WAResultOrError").makeResult({name:"NotificationTextStatusNoPayload",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["TextStatus","TextStatusNoPayload"],[b,c])}g.parseTextStatusNotificationType=a}),98);
__d("WASmaxInAccountSyncNotificationTextStatusNotificationMixin",["WAResultOrError","WASmaxInAccountSyncTextStatusNotificationType","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"text_status");if(!b.success)return b;a=d("WASmaxInAccountSyncTextStatusNotificationType").parseTextStatusNotificationType(b.value);return!a.success?a:d("WAResultOrError").makeResult({textStatusTextStatusNotificationType:a.value})}g.parseNotificationTextStatusNotificationMixin=a}),98);
__d("WASmaxInAccountSyncNotificationUsernameChangeMixin",["WAResultOrError","WASmaxInAccountSyncEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"username");if(!b.success)return b;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"username");if(!b.success)return b;var c=d("WASmaxParseUtils").attrStringEnum(a,"status",d("WASmaxInAccountSyncEnums").ENUM_APPROVED_PENDING_REJECTED);if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"reason_code",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({username:b.value,status:c.value,reasonCode:a.value})}g.parseNotificationUsernameChangeMixin=a}),98);
__d("WASmaxInAccountSyncNotificationUsernameNoPayloadMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"username");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"action","modify");return!b.success?b:d("WAResultOrError").makeResult({action:b.value})}g.parseNotificationUsernameNoPayloadMixin=a}),98);
__d("WASmaxInAccountSyncUsernameNotificationType",["WAResultOrError","WASmaxInAccountSyncNotificationUsernameChangeMixin","WASmaxInAccountSyncNotificationUsernameNoPayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInAccountSyncNotificationUsernameNoPayloadMixin").parseNotificationUsernameNoPayloadMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NotificationUsernameNoPayload",value:b.value});var c=d("WASmaxInAccountSyncNotificationUsernameChangeMixin").parseNotificationUsernameChangeMixin(a);return c.success?d("WAResultOrError").makeResult({name:"NotificationUsernameChange",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["UsernameNoPayload","UsernameChange"],[b,c])}g.parseUsernameNotificationType=a}),98);
__d("WASmaxInAccountSyncNotificationUsernameNotificationMixin",["WAResultOrError","WASmaxInAccountSyncUsernameNotificationType","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"username");if(!b.success)return b;a=d("WASmaxInAccountSyncUsernameNotificationType").parseUsernameNotificationType(b.value);return!a.success?a:d("WAResultOrError").makeResult({usernameUsernameNotificationType:a.value})}g.parseNotificationUsernameNotificationMixin=a}),98);
__d("WASmaxInAccountSyncNotificationType",["WAResultOrError","WASmaxInAccountSyncNotificationBlocklistNotificationMixin","WASmaxInAccountSyncNotificationDevicesNotificationMixin","WASmaxInAccountSyncNotificationDisappearingModeNotificationMixin","WASmaxInAccountSyncNotificationNoticeNotificationMixin","WASmaxInAccountSyncNotificationPictureNotificationMixin","WASmaxInAccountSyncNotificationPrivacyNotificationMixin","WASmaxInAccountSyncNotificationStatusNotificationMixin","WASmaxInAccountSyncNotificationTextStatusNotificationMixin","WASmaxInAccountSyncNotificationUsernameNotificationMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInAccountSyncNotificationBlocklistNotificationMixin").parseNotificationBlocklistNotificationMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NotificationBlocklistNotification",value:b.value});var c=d("WASmaxInAccountSyncNotificationDevicesNotificationMixin").parseNotificationDevicesNotificationMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"NotificationDevicesNotification",value:c.value});var e=d("WASmaxInAccountSyncNotificationPictureNotificationMixin").parseNotificationPictureNotificationMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"NotificationPictureNotification",value:e.value});var f=d("WASmaxInAccountSyncNotificationPrivacyNotificationMixin").parseNotificationPrivacyNotificationMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"NotificationPrivacyNotification",value:f.value});var g=d("WASmaxInAccountSyncNotificationStatusNotificationMixin").parseNotificationStatusNotificationMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"NotificationStatusNotification",value:g.value});var h=d("WASmaxInAccountSyncNotificationTextStatusNotificationMixin").parseNotificationTextStatusNotificationMixin(a);if(h.success)return d("WAResultOrError").makeResult({name:"NotificationTextStatusNotification",value:h.value});var i=d("WASmaxInAccountSyncNotificationUsernameNotificationMixin").parseNotificationUsernameNotificationMixin(a);if(i.success)return d("WAResultOrError").makeResult({name:"NotificationUsernameNotification",value:i.value});var j=d("WASmaxInAccountSyncNotificationDisappearingModeNotificationMixin").parseNotificationDisappearingModeNotificationMixin(a);if(j.success)return d("WAResultOrError").makeResult({name:"NotificationDisappearingModeNotification",value:j.value});var k=d("WASmaxInAccountSyncNotificationNoticeNotificationMixin").parseNotificationNoticeNotificationMixin(a);return k.success?d("WAResultOrError").makeResult({name:"NotificationNoticeNotification",value:k.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["BlocklistNotification","DevicesNotification","PictureNotification","PrivacyNotification","StatusNotification","TextStatusNotification","UsernameNotification","DisappearingModeNotification","NoticeNotification"],[b,c,e,f,g,h,i,j,k])}g.parseNotificationType=a}),98);
__d("WASmaxInAccountSyncServerNotificationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"offline",0,1024);return!a.success?a:d("WAResultOrError").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);
__d("WASmaxInAccountSyncNotificationRequest",["WAResultOrError","WASmaxInAccountSyncNotificationType","WASmaxInAccountSyncServerNotificationMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseJid").attrDeviceJid(a,"from");if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","account_sync");if(!c.success)return c;var e=d("WASmaxInAccountSyncServerNotificationMixin").parseServerNotificationMixin(a);if(!e.success)return e;a=d("WASmaxInAccountSyncNotificationType").parseNotificationType(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({from:b.value,type:c.value},e.value,{notificationType:a.value}))}g.parseNotificationRequest=a}),98);
__d("WASmaxOutAccountSyncNotificationClientAckMixin",["WASmaxJsx","WASmaxMixins","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrDeviceJid,a,["from"]);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(b.value),to:d("WAWap").DEVICE_JID(c.value),"class":"notification",type:d("WAWap").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);
__d("WASmaxOutAccountSyncNotificationResponseAck",["WASmaxJsx","WASmaxOutAccountSyncNotificationClientAckMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutAccountSyncNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",null),a);return a}g.makeNotificationResponseAck=a}),98);
__d("WASmaxAccountSyncNotificationRPC",["WASmaxInAccountSyncNotificationRequest","WASmaxOutAccountSyncNotificationResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInAccountSyncNotificationRequest").parseNotificationRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Notification",{Request:b}));return{parsedRequest:b.value,makeNotificationResponseAck:function(){return d("WASmaxOutAccountSyncNotificationResponseAck").makeNotificationResponseAck(a)}}}g.receiveNotificationRPC=a}),98);
__d("WACreateHandleAccountSyncNotificationBranch",["Promise","WAResultOrError","WASmaxAccountSyncNotificationRPC","WAUnknownStanzaError"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var c=(a=a.accountSync)!=null?a:{};return function(a){a=d("WASmaxAccountSyncNotificationRPC").receiveNotificationRPC(a);var e=a.parsedRequest.notificationType;a=a.makeNotificationResponseAck;switch(e.name){case"NotificationBlocklistNotification":return i(e.value.blocklistBlocklistNotificationType,c.handleBlocklistNotification,a);case"NotificationDevicesNotification":return j(e.value.devicesDevicesNotificationType,c.handleDevicesNotification,a)}return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError)}}function i(a,c,e){if(c==null)return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError);if(a.name==="NotificationBlocklist"){var f=a.value,g=f.dhash,i=f.prevDhash,j=f.itemAction;f=f.itemJid;return c({dhash:g,displayName:null,action:j,jid:f,prevDhash:i,makeAck:e}).then(d("WAResultOrError").makeResult)}else{a.name;return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError)}}function j(a,c,e){if(c==null)return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError);if(a.name==="NotificationDevices"){var f=a.value,g=f.dhash,i=f.device;f=f.keyIndexList;return c({dhash:g,devices:i,keyIndexList:f,makeAck:e}).then(d("WAResultOrError").makeResult)}else{a.name;return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError)}}g.createHandleAccountSyncNotification=a}),98);
__d("WASmaxInUsyncNotificationAddDevicesNotificationMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"device");if(!b.success)return b;b=d("WASmaxParseJid").attrDeviceJid(a,"jid");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrDeviceJid,a,"lid");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"key-index",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({jid:b.value,lid:c.value,keyIndex:a.value})}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"key-index-list");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"ts",-1,void 0);if(!b.success)return b;a=d("WASmaxParseUtils").contentBytesRange(a,0,100);return!a.success?a:d("WAResultOrError").makeResult({ts:b.value,elementValue:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"add");if(!b.success)return b;a=d("WASmaxParseUtils").optionalChildWithTag(b.value,"key-index-list",i);if(!a.success)return a;var c=d("WASmaxParseUtils").attrString(b.value,"device_hash");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,b.value,"device_lid_hash");if(!e.success)return e;b=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"device",0,1e3,h);return!b.success?b:d("WAResultOrError").makeResult({addDeviceHash:c.value,addDeviceLidHash:e.value,addKeyIndexList:a.value,addDevice:b.value})}g.parseNotificationAddDevicesNotificationAddDevice=h;g.parseNotificationAddDevicesNotificationAddKeyIndexList=i;g.parseNotificationAddDevicesNotificationMixin=a}),98);
__d("WASmaxInUsyncNotificationRemoveDevicesNotificationMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"device");if(!b.success)return b;b=d("WASmaxParseJid").attrDeviceJid(a,"jid");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrDeviceJid,a,"lid");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"key-index",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({jid:b.value,lid:c.value,keyIndex:a.value})}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"key-index-list");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"ts",-1,void 0);if(!b.success)return b;a=d("WASmaxParseUtils").contentBytesRange(a,0,100);return!a.success?a:d("WAResultOrError").makeResult({ts:b.value,elementValue:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"remove");if(!b.success)return b;a=d("WASmaxParseUtils").optionalChildWithTag(b.value,"key-index-list",i);if(!a.success)return a;var c=d("WASmaxParseUtils").attrString(b.value,"device_hash");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,b.value,"device_lid_hash");if(!e.success)return e;b=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"device",0,1e3,h);return!b.success?b:d("WAResultOrError").makeResult({removeDeviceHash:c.value,removeDeviceLidHash:e.value,removeKeyIndexList:a.value,removeDevice:b.value})}g.parseNotificationRemoveDevicesNotificationRemoveDevice=h;g.parseNotificationRemoveDevicesNotificationRemoveKeyIndexList=i;g.parseNotificationRemoveDevicesNotificationMixin=a}),98);
__d("WASmaxInUsyncNotificationUpdateDevicesNotificationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"update");if(!b.success)return b;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"notify");if(!a.success)return a;b=d("WASmaxParseUtils").attrString(b.value,"hash");return!b.success?b:d("WAResultOrError").makeResult({notify:a.value,updateHash:b.value})}g.parseNotificationUpdateDevicesNotificationMixin=a}),98);
__d("WASmaxInUsyncDevicesNotification",["WAResultOrError","WASmaxInUsyncNotificationAddDevicesNotificationMixin","WASmaxInUsyncNotificationRemoveDevicesNotificationMixin","WASmaxInUsyncNotificationUpdateDevicesNotificationMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInUsyncNotificationAddDevicesNotificationMixin").parseNotificationAddDevicesNotificationMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NotificationAddDevicesNotification",value:b.value});var c=d("WASmaxInUsyncNotificationRemoveDevicesNotificationMixin").parseNotificationRemoveDevicesNotificationMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"NotificationRemoveDevicesNotification",value:c.value});var e=d("WASmaxInUsyncNotificationUpdateDevicesNotificationMixin").parseNotificationUpdateDevicesNotificationMixin(a);return e.success?d("WAResultOrError").makeResult({name:"NotificationUpdateDevicesNotification",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["AddDevicesNotification","RemoveDevicesNotification","UpdateDevicesNotification"],[b,c,e])}g.parseDevicesNotification=a}),98);
__d("WASmaxInUsyncServerNotificationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"offline",0,1024);return!a.success?a:d("WAResultOrError").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);
__d("WASmaxInUsyncNotificationRequest",["WAResultOrError","WASmaxInUsyncDevicesNotification","WASmaxInUsyncServerNotificationMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"from");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"lid");if(!c.success)return c;var e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","devices");if(!e.success)return e;var f=d("WASmaxInUsyncServerNotificationMixin").parseServerNotificationMixin(a);if(!f.success)return f;a=d("WASmaxInUsyncDevicesNotification").parseDevicesNotification(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({from:b.value,lid:c.value,type:e.value},f.value,{devicesNotification:a.value}))}g.parseNotificationRequest=a}),98);
__d("WASmaxOutUsyncNotificationClientAckMixin",["WASmaxJsx","WASmaxMixins","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrUserJid,a,["from"]);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(b.value),to:d("WAWap").USER_JID(c.value),"class":"notification",type:d("WAWap").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);
__d("WASmaxOutUsyncNotificationResponseAck",["WASmaxJsx","WASmaxOutUsyncNotificationClientAckMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutUsyncNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",null),a);return a}g.makeNotificationResponseAck=a}),98);
__d("WASmaxUsyncNotificationRPC",["WASmaxInUsyncNotificationRequest","WASmaxOutUsyncNotificationResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInUsyncNotificationRequest").parseNotificationRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Notification",{Request:b}));return{parsedRequest:b.value,makeNotificationResponseAck:function(){return d("WASmaxOutUsyncNotificationResponseAck").makeNotificationResponseAck(a)}}}g.receiveNotificationRPC=a}),98);
__d("WACreateHandleDevicesNotificationBranch",["Promise","WAResultOrError","WASmaxUsyncNotificationRPC","WATimeUtils","WAUnknownStanzaError"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){a=(a=a.usync)!=null?a:{};var c=a.handleAddDeviceNotification,e=a.handleRemoveDeviceNotification,f=a.handleUpdateDeviceNotification;return function(a){a=d("WASmaxUsyncNotificationRPC").receiveNotificationRPC(a);var g=a.parsedRequest,i=g.from,j=g.lid;g=g.devicesNotification;a=a.makeNotificationResponseAck;switch(g.name){case"NotificationAddDevicesNotification":var k=g.value,l=k.addDeviceHash,m=k.addDeviceLidHash,n=k.addDevice;k=k.addKeyIndexList;return(l=c==null?void 0:c({lid:j,from:i,makeAck:a,hash:l,lidHash:m,deviceList:n,keyIndexList:k==null?null:{ts:d("WATimeUtils").castToUnixTime(k.ts),signedADVListBytes:k.elementValue}}).then(d("WAResultOrError").makeResult))!=null?l:(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError);case"NotificationRemoveDevicesNotification":m=g.value;n=m.removeDevice;k=m.removeDeviceHash;l=m.removeDeviceLidHash;m=m.removeKeyIndexList;return(k=e==null?void 0:e({from:i,lid:j,makeAck:a,hash:k,lidHash:l,deviceList:n,keyIndexList:m==null?null:{ts:d("WATimeUtils").castToUnixTime(m.ts),signedADVListBytes:m.elementValue}}).then(d("WAResultOrError").makeResult))!=null?k:(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError);case"NotificationUpdateDevicesNotification":l=g.value.updateHash;return(n=f==null?void 0:f({from:i,lid:j,hash:l,makeAck:a}).then(d("WAResultOrError").makeResult))!=null?n:(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError)}g.name}}g.createHandleDevicesNotification=a}),98);
__d("WASmaxInPreKeysCloudAPIGroupListMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"group");if(!b.success)return b;b=d("WASmaxParseJid").attrGroupJid(a,"jid");return!b.success?b:d("WAResultOrError").makeResult({jid:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"groups");if(!b.success)return b;a=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"group",1,1e4,h);return!a.success?a:d("WAResultOrError").makeResult({groupsGroup:a.value})}g.parseCloudAPIGroupListGroupsGroup=h;g.parseCloudAPIGroupListMixin=a}),98);
__d("WASmaxInPreKeysDisplayNameMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrString(a,"display_name");return!a.success?a:d("WAResultOrError").makeResult({displayName:a.value})}g.parseDisplayNameMixin=a}),98);
__d("WASmaxInPreKeysNotificationContactIDChangedLIDAttrMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseJid").attrDeviceJid(a,"lid");return!b.success?b:d("WAResultOrError").makeResult({lid:b.value})}g.parseNotificationContactIDChangedLIDAttrMixin=a}),98);
__d("WASmaxInPreKeysNotificationContactIDChangedLIDAttrOrDisplayNameMixinGroup",["WAResultOrError","WASmaxInPreKeysDisplayNameMixin","WASmaxInPreKeysNotificationContactIDChangedLIDAttrMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPreKeysNotificationContactIDChangedLIDAttrMixin").parseNotificationContactIDChangedLIDAttrMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NotificationContactIDChangedLIDAttr",value:b.value});var c=d("WASmaxInPreKeysDisplayNameMixin").parseDisplayNameMixin(a);return c.success?d("WAResultOrError").makeResult({name:"DisplayName",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["LIDAttr","DisplayName"],[b,c])}g.parseNotificationContactIDChangedLIDAttrOrDisplayNameMixinGroup=a}),98);
__d("WASmaxInPreKeysServerNotificationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"offline",0,1024);return!a.success?a:d("WAResultOrError").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);
__d("WASmaxInPreKeysNotificationContactIDChangedRequest",["WAResultOrError","WASmaxInPreKeysCloudAPIGroupListMixin","WASmaxInPreKeysNotificationContactIDChangedLIDAttrOrDisplayNameMixinGroup","WASmaxInPreKeysServerNotificationMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"identity");if(!b.success)return b;b=d("WASmaxParseJid").attrDeviceJid(a,"from");if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","encrypt");if(!c.success)return c;var e=d("WASmaxInPreKeysServerNotificationMixin").parseServerNotificationMixin(a);if(!e.success)return e;var f=d("WASmaxInPreKeysCloudAPIGroupListMixin").parseCloudAPIGroupListMixin(a);a=d("WASmaxInPreKeysNotificationContactIDChangedLIDAttrOrDisplayNameMixinGroup").parseNotificationContactIDChangedLIDAttrOrDisplayNameMixinGroup(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({from:b.value,type:c.value},e.value,{cloudAPIGroupListMixin:f.success?f.value:null,notificationContactIDChangedLIDAttrOrDisplayNameMixinGroup:a.success?a.value:null}))}g.parseNotificationContactIDChangedRequest=a}),98);
__d("WASmaxOutPreKeysNotificationClientAckMixin",["WASmaxInPreKeysEnums","WASmaxJsx","WASmaxMixins","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrJidEnum,a,["from"],d("WASmaxInPreKeysEnums").DEVICEJID_DOMAINJID);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(b.value),to:d("WAWap").JID(c.value),"class":"notification",type:d("WAWap").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);
__d("WASmaxOutPreKeysNotificationContactIDChangedResponseAck",["WASmaxJsx","WASmaxOutPreKeysNotificationClientAckMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutPreKeysNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",null),a);return a}g.makeNotificationContactIDChangedResponseAck=a}),98);
__d("WASmaxPreKeysNotificationContactIDChangedRPC",["WASmaxInPreKeysNotificationContactIDChangedRequest","WASmaxOutPreKeysNotificationContactIDChangedResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPreKeysNotificationContactIDChangedRequest").parseNotificationContactIDChangedRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("NotificationContactIDChanged",{Request:b}));return{parsedRequest:b.value,makeNotificationContactIDChangedResponseAck:function(){return d("WASmaxOutPreKeysNotificationContactIDChangedResponseAck").makeNotificationContactIDChangedResponseAck(a)}}}g.receiveNotificationContactIDChangedRPC=a}),98);
__d("WASmaxInPreKeysNotificationDigestRequest",["WAResultOrError","WASmaxInPreKeysServerNotificationMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"digest");if(!b.success)return b;b=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","encrypt");if(!c.success)return c;a=d("WASmaxInPreKeysServerNotificationMixin").parseServerNotificationMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({from:b.value,type:c.value},a.value))}g.parseNotificationDigestRequest=a}),98);
__d("WASmaxOutPreKeysNotificationDigestResponseAck",["WASmaxJsx","WASmaxOutPreKeysNotificationClientAckMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutPreKeysNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",null),a);return a}g.makeNotificationDigestResponseAck=a}),98);
__d("WASmaxPreKeysNotificationDigestRPC",["WASmaxInPreKeysNotificationDigestRequest","WASmaxOutPreKeysNotificationDigestResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPreKeysNotificationDigestRequest").parseNotificationDigestRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("NotificationDigest",{Request:b}));return{parsedRequest:b.value,makeNotificationDigestResponseAck:function(){return d("WASmaxOutPreKeysNotificationDigestResponseAck").makeNotificationDigestResponseAck(a)}}}g.receiveNotificationDigestRPC=a}),98);
__d("WASmaxInPreKeysNotificationLowCountRequest",["WAResultOrError","WASmaxInPreKeysServerNotificationMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"count");if(!b.success)return b;var c=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!c.success)return c;var e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","encrypt");if(!e.success)return e;b=d("WASmaxParseUtils").attrIntRange(b.value,"value",0,100);if(!b.success)return b;a=d("WASmaxInPreKeysServerNotificationMixin").parseServerNotificationMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({from:c.value,type:e.value,countValue:b.value},a.value))}g.parseNotificationLowCountRequest=a}),98);
__d("WASmaxOutPreKeysNotificationLowCountResponseAck",["WASmaxJsx","WASmaxOutPreKeysNotificationClientAckMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutPreKeysNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",null),a);return a}g.makeNotificationLowCountResponseAck=a}),98);
__d("WASmaxPreKeysNotificationLowCountRPC",["WASmaxInPreKeysNotificationLowCountRequest","WASmaxOutPreKeysNotificationLowCountResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPreKeysNotificationLowCountRequest").parseNotificationLowCountRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("NotificationLowCount",{Request:b}));return{parsedRequest:b.value,makeNotificationLowCountResponseAck:function(){return d("WASmaxOutPreKeysNotificationLowCountResponseAck").makeNotificationLowCountResponseAck(a)}}}g.receiveNotificationLowCountRPC=a}),98);
__d("WACreateHandleEncryptNotificationBranch",["Promise","WALogger","WAResultOrError","WASmaxDecisionTreeUtils","WASmaxPreKeysNotificationContactIDChangedRPC","WASmaxPreKeysNotificationDigestRPC","WASmaxPreKeysNotificationLowCountRPC","WATimeUtils","WAUnknownStanzaError"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["parseEncryptNotification notification without children"]);i=function(){return a};return a}function a(a){a=(a=a.prekey)!=null?a:{};var c=a.handlePrekeyLowCountNotification,e=a.handlePrekeyDigestNotification,f=a.handlePrekeyContactIDChangedNotification;return function(a){var g=d("WASmaxDecisionTreeUtils").firstChild(a);if(g.success===!1){d("WALogger").ERROR(i());return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError)}g=g.value.tag;switch(g){case"count":if(c!=null){var j=d("WASmaxPreKeysNotificationLowCountRPC").receiveNotificationLowCountRPC(a),k=j.makeNotificationLowCountResponseAck;j=j.parsedRequest;var l=j.t,m=j.offline;j=j.id;l=d("WATimeUtils").castToUnixTime(l);return c({makeAck:k,id:j,offline:m,serverTs:l,encryptType:g}).then(d("WAResultOrError").makeResult)}break;case"digest":if(e!=null){k=d("WASmaxPreKeysNotificationDigestRPC").receiveNotificationDigestRPC(a);j=k.makeNotificationDigestResponseAck;m=k.parsedRequest;l=m.t;k=m.offline;m=m.id;l=d("WATimeUtils").castToUnixTime(l);return e({makeAck:j,id:m,offline:k,serverTs:l,encryptType:g}).then(d("WAResultOrError").makeResult)}break;case"identity":if(f!=null){j=d("WASmaxPreKeysNotificationContactIDChangedRPC").receiveNotificationContactIDChangedRPC(a);m=j.makeNotificationContactIDChangedResponseAck;k=j.parsedRequest;l=k.t;a=k.offline;j=k.id;k=d("WATimeUtils").castToUnixTime(l);return f({makeAck:m,id:j,offline:a,serverTs:k,encryptType:g}).then(d("WAResultOrError").makeResult)}break}return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError)}}g.createHandleEncryptNotification=a}),98);
__d("WAHandleFbDeviceChangeNotificationProtocol",["WAICDCUtils","WAResultOrError","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a.dhash}function b(a){var b;b=((b=a.iCDCDirtyMixin)==null?void 0:b.dirty)==="true";var c=d("WATimeUtils").castToUnixTime(a.ts),e=a.seq;a=d("WAICDCUtils").decodeICDCInfo(a.elementValue);e=d("WAICDCUtils").validateAndPrepareICDCFromNotification(e,b,c,a);return e==null?d("WAResultOrError").makeError("icdc-validation-failure"):d("WAResultOrError").makeResult(e)}g.parseDhash=a;g.parseICDCFromServer=b}),98);
__d("WASmaxInDevicesDeviceModelInfoMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"platform");if(!b.success)return b;b=d("WASmaxParseUtils").contentString(a);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"model");if(!b.success)return b;b=d("WASmaxParseUtils").contentString(a);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}function a(a){var b=d("WASmaxParseUtils").optionalChildWithTag(a,"platform",h);if(!b.success)return b;a=d("WASmaxParseUtils").optionalChildWithTag(a,"model",i);return!a.success?a:d("WAResultOrError").makeResult({platform:b.value,model:a.value})}g.parseDeviceModelInfoPlatform=h;g.parseDeviceModelInfoModel=i;g.parseDeviceModelInfoMixin=a}),98);
__d("WASmaxInDevicesDhashMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrString(a,"dhash");return!a.success?a:d("WAResultOrError").makeResult({dhash:a.value})}g.parseDhashMixin=a}),98);
__d("WASmaxInDevicesDeviceListMixin",["WAResultOrError","WASmaxInDevicesDeviceModelInfoMixin","WASmaxInDevicesDhashMixin","WASmaxInDevicesIdentityKeyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"device");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"id",1,999);if(!b.success)return b;var c=d("WASmaxInDevicesIdentityKeyMixin").parseIdentityKeyMixin(a);if(!c.success)return c;a=d("WASmaxInDevicesDeviceModelInfoMixin").parseDeviceModelInfoMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({id:b.value},c.value,{deviceModelInfoMixin:a.success?a.value:null}))}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"devices");if(!b.success)return b;b=d("WASmaxInDevicesDhashMixin").parseDhashMixin(a);a=d("WASmaxParseUtils").mapChildrenWithTag(a,"device",0,25,h);return!a.success?a:d("WAResultOrError").makeResult({dhashMixin:b.success?b.value:null,device:a.value})}g.parseDeviceListDevice=h;g.parseDeviceListMixin=a}),98);
__d("WASmaxInDevicesICDCDirtyMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"icdc");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"dirty","true");return!b.success?b:d("WAResultOrError").makeResult({dirty:b.value})}g.parseICDCDirtyMixin=a}),98);
__d("WASmaxInDevicesICDCSeqMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrIntRange(a,"seq",0,2147483647);return!a.success?a:d("WAResultOrError").makeResult({seq:a.value})}g.parseICDCSeqMixin=a}),98);
__d("WASmaxInDevicesICDCSignedListMixin",["WAResultOrError","WASmaxInDevicesICDCSeqMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"icdc");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"ts",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").contentBytesRange(a,1,40072);if(!c.success)return c;a=d("WASmaxInDevicesICDCSeqMixin").parseICDCSeqMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({ts:b.value,elementValue:c.value},a.value))}g.parseICDCSignedListMixin=a}),98);
__d("WASmaxInDevicesICDCFromServerMixin",["WAResultOrError","WASmaxInDevicesICDCDirtyMixin","WASmaxInDevicesICDCSignedListMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"icdc");if(!b.success)return b;b=d("WASmaxInDevicesICDCSignedListMixin").parseICDCSignedListMixin(a);if(!b.success)return b;a=d("WASmaxInDevicesICDCDirtyMixin").parseICDCDirtyMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{iCDCDirtyMixin:a.success?a.value:null}))}g.parseICDCFromServerMixin=a}),98);
__d("WASmaxInDevicesServerNotificationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"offline",0,1024);return!a.success?a:d("WAResultOrError").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);
__d("WASmaxInDevicesChangeNotificationRequest",["WAResultOrError","WASmaxInDevicesDeviceListMixin","WASmaxInDevicesICDCFromServerMixin","WASmaxInDevicesServerNotificationMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"devices");if(!b.success)return b;b=d("WASmaxInDevicesDeviceListMixin").parseDeviceListMixin(a);return!b.success?b:b}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"icdc");if(!b.success)return b;b=d("WASmaxInDevicesICDCFromServerMixin").parseICDCFromServerMixin(a);return!b.success?b:b}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"devices",h);if(!b.success)return b;var c=d("WASmaxParseUtils").optionalChildWithTag(a,"icdc",i);if(!c.success)return c;var e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","fbid:devices");if(!e.success)return e;var f=d("WASmaxParseJid").attrUserJid(a,"from");if(!f.success)return f;a=d("WASmaxInDevicesServerNotificationMixin").parseServerNotificationMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({type:e.value,from:f.value},a.value,{devices:b.value,icdc:c.value}))}g.parseChangeNotificationRequestDevices=h;g.parseChangeNotificationRequestIcdc=i;g.parseChangeNotificationRequest=a}),98);
__d("WASmaxOutDevicesNotificationClientAckMixin",["WASmaxJsx","WASmaxMixins","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrUserJid,a,["from"]);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(b.value),to:d("WAWap").USER_JID(c.value),"class":"notification",type:d("WAWap").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);
__d("WASmaxOutDevicesChangeNotificationResponseAck",["WASmaxJsx","WASmaxOutDevicesNotificationClientAckMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutDevicesNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",null),a);return a}g.makeChangeNotificationResponseAck=a}),98);
__d("WASmaxDevicesChangeNotificationRPC",["WASmaxInDevicesChangeNotificationRequest","WASmaxOutDevicesChangeNotificationResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInDevicesChangeNotificationRequest").parseChangeNotificationRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("ChangeNotification",{Request:b}));return{parsedRequest:b.value,makeChangeNotificationResponseAck:function(){return d("WASmaxOutDevicesChangeNotificationResponseAck").makeChangeNotificationResponseAck(a)}}}g.receiveChangeNotificationRPC=a}),98);
__d("WACreateHandleFbDeviceChangeNotificationBranch",["WAHandleFbDeviceChangeNotificationProtocol","WAJids","WAResultOrError","WASignalKeys","WASmaxDevicesChangeNotificationRPC","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return function(b,c){var e;b=d("WASmaxDevicesChangeNotificationRPC").receiveChangeNotificationRPC(b);var f=b.makeChangeNotificationResponseAck;b=b.parsedRequest;var g=b.from,h=b.devices,i=b.t,j=b.id,k=b.icdc;b=b.offline;e=((e=h==null?void 0:h.device)!=null?e:[]).map(function(a){var b;return{device:d("WAJids").toDeviceJid(g,d("WAJids").interpretAsDeviceId(a.id)),identity:d("WASignalKeys").serializeIdentity(a.elementValue),platform:(b=a.deviceModelInfoMixin)==null?void 0:(b=b.platform)==null?void 0:b.elementValue,model:(b=a.deviceModelInfoMixin)==null?void 0:(a=b.model)==null?void 0:a.elementValue}});h=h==null?void 0:h.dhashMixin;k=k==null?null:d("WAHandleFbDeviceChangeNotificationProtocol").parseICDCFromServer(k);return a({devices:e,userJid:g,offline:b,serverTs:d("WATimeUtils").castToUnixTime(i),id:j,dhash:h==null?null:d("WAHandleFbDeviceChangeNotificationProtocol").parseDhash(h),icdcInfo:(k==null?void 0:k.success)?k.value:null,makeAck:f,ctx:{cryptoManager:c}}).then(d("WAResultOrError").makeResult)}}g.createHandleFbDeviceChangeNotification=a}),98);
__d("WASmaxInMultiwaydServerNotificationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"offline",0,1024);return!a.success?a:d("WAResultOrError").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);
__d("WASmaxInMultiwaydMultiwayNotificationRequest",["WAResultOrError","WASmaxInMultiwaydServerNotificationMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"multiway");if(!b.success)return b;var c=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!c.success)return c;var e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","fb:multiway");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,b.value,"transaction_id");if(!f.success)return f;var g=d("WASmaxParseUtils").attrInt(b.value,"binary_version");if(!g.success)return g;b=d("WASmaxParseUtils").contentBytesRange(b.value,1,void 0);if(!b.success)return b;a=d("WASmaxInMultiwaydServerNotificationMixin").parseServerNotificationMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({from:c.value,type:e.value,multiwayTransactionId:f.value,multiwayBinaryVersion:g.value,multiwayElementValue:b.value},a.value))}g.parseMultiwayNotificationRequest=a}),98);
__d("WASmaxOutMultiwaydNotificationClientAckMixin",["WASmaxJsx","WASmaxMixins","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrDomainJid,a,["from"]);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(b.value),to:d("WAWap").DOMAIN_JID(c.value),"class":"notification",type:d("WAWap").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);
__d("WASmaxOutMultiwaydMultiwayNotificationResponseAck",["WASmaxJsx","WASmaxOutMultiwaydNotificationClientAckMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutMultiwaydNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",null),a);return a}g.makeMultiwayNotificationResponseAck=a}),98);
__d("WASmaxMultiwaydMultiwayNotificationRPC",["WASmaxInMultiwaydMultiwayNotificationRequest","WASmaxOutMultiwaydMultiwayNotificationResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMultiwaydMultiwayNotificationRequest").parseMultiwayNotificationRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("MultiwayNotification",{Request:b}));return{parsedRequest:b.value,makeMultiwayNotificationResponseAck:function(){return d("WASmaxOutMultiwaydMultiwayNotificationResponseAck").makeMultiwayNotificationResponseAck(a)}}}g.receiveMultiwayNotificationRPC=a}),98);
__d("WACreateHandleFbMultiwayNotificationBranch",["WAResultOrError","WASmaxMultiwaydMultiwayNotificationRPC","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return function(b){b=d("WASmaxMultiwaydMultiwayNotificationRPC").receiveMultiwayNotificationRPC(b);var c=b.makeMultiwayNotificationResponseAck;b=b.parsedRequest;var e=b.from,f=b.multiwayTransactionId,g=b.multiwayBinaryVersion,h=b.multiwayElementValue,i=b.t,j=b.id;b=b.offline;return a({domainJid:e,multiwayTransactionId:f,multiwayBinaryVersion:g,multiwayElementValue:h,offline:b,serverTs:d("WATimeUtils").castToUnixTime(i),id:j,makeAck:c}).then(d("WAResultOrError").makeResult)}}g.createHandleFbMultiwayNotification=a}),98);
__d("WASmaxInMessageRequestConnectedMixin",["WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"thread_actions");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"connected");return!b.success?b:d("WASmaxParseUtils").voidSuccess}g.parseConnectedMixin=a}),98);
__d("WASmaxInMessageRequestFolderIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrInt(a,"folder_id");return!a.success?a:d("WAResultOrError").makeResult({folderId:a.value})}g.parseFolderIDMixin=a}),98);
__d("WASmaxInMessageRequestFolderMixin",["WASmaxInMessageRequestFolderIDMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"thread_actions");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"folder");if(!b.success)return b;a=d("WASmaxInMessageRequestFolderIDMixin").parseFolderIDMixin(b.value);return!a.success?a:a}g.parseFolderMixin=a}),98);
__d("WASmaxInMessageRequestServerNotificationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"offline",0,1024);return!a.success?a:d("WAResultOrError").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);
__d("WASmaxInMessageRequestThreadNotificationRequest",["WAResultOrError","WASmaxInMessageRequestConnectedMixin","WASmaxInMessageRequestFolderMixin","WASmaxInMessageRequestServerNotificationMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"thread_actions");if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","fbid:thread");if(!c.success)return c;var e=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"to");if(!f.success)return f;var g=d("WASmaxParseUtils").attrString(b.value,"thread_id");if(!g.success)return g;var h=d("WASmaxInMessageRequestFolderMixin").parseFolderMixin(b.value);b=d("WASmaxInMessageRequestConnectedMixin").parseConnectedMixin(b.value);a=d("WASmaxInMessageRequestServerNotificationMixin").parseServerNotificationMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({type:c.value,from:e.value,to:f.value,threadActionsThreadId:g.value,threadActionsFolderMixin:h.success?h.value:null,hasThreadActionsConnectedMixin:b.success},a.value))}g.parseThreadNotificationRequest=a}),98);
__d("WASmaxOutMessageRequestNotificationClientAckMixin",["WASmaxJsx","WASmaxMixins","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrDomainJid,a,["from"]);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(b.value),to:d("WAWap").DOMAIN_JID(c.value),"class":"notification",type:d("WAWap").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);
__d("WASmaxOutMessageRequestThreadNotificationResponseAck",["WASmaxJsx","WASmaxOutMessageRequestNotificationClientAckMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutMessageRequestNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",null),a);return a}g.makeThreadNotificationResponseAck=a}),98);
__d("WASmaxMessageRequestThreadNotificationRPC",["WASmaxInMessageRequestThreadNotificationRequest","WASmaxOutMessageRequestThreadNotificationResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessageRequestThreadNotificationRequest").parseThreadNotificationRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("ThreadNotification",{Request:b}));return{parsedRequest:b.value,makeThreadNotificationResponseAck:function(){return d("WASmaxOutMessageRequestThreadNotificationResponseAck").makeThreadNotificationResponseAck(a)}}}g.receiveThreadNotificationRPC=a}),98);
__d("WACreateHandleFbThreadNotificationBranch",["WAGlobals","WAJids","WAResultOrError","WASmaxMessageRequestThreadNotificationRPC","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return function(b){b=d("WASmaxMessageRequestThreadNotificationRPC").receiveThreadNotificationRPC(b);var c=b.makeThreadNotificationResponseAck;b=b.parsedRequest;var e=b.id,f=b.threadActionsThreadId,g=b.t,h=b.threadActionsFolderMixin,i=b.offline;b=b.hasThreadActionsConnectedMixin;var j;f.endsWith("@g.us")?j=d("WAJids").toGroupJid(f):j=d("WAGlobals").getJidUtilsApi().toUserJid(f);return a({id:e,serverTs:d("WATimeUtils").castToUnixTime(g),chatJid:j,offline:i,folderId:h==null?void 0:h.folderId,hasConnected:b,makeAck:c}).then(d("WAResultOrError").makeResult)}}g.createHandleFbThreadNotification=a}),98);
__d("WASmaxInGroupsServerNotificationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"offline",0,1024);return!a.success?a:d("WAResultOrError").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);
__d("WASmaxInGroupsCommonNotificationMixin",["WAResultOrError","WASmaxInGroupsServerNotificationMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseJid").attrGroupJid(a,"from");if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","w:gp2");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"notify");if(!e.success)return e;a=d("WASmaxInGroupsServerNotificationMixin").parseServerNotificationMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({from:b.value,type:c.value,notify:e.value},a.value))}g.parseCommonNotificationMixin=a}),98);
__d("WASmaxInGroupsParticipantWithJidMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"jid");return!b.success?b:d("WAResultOrError").makeResult({jid:b.value})}g.parseParticipantWithJidMixin=a}),98);
__d("WASmaxInGroupsParticipantWithLidMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"lid");return!b.success?b:d("WAResultOrError").makeResult({lid:b.value})}g.parseParticipantWithLidMixin=a}),98);
__d("WASmaxInGroupsParticipantWithJidAndLidMixin",["WAResultOrError","WASmaxInGroupsParticipantWithJidMixin","WASmaxInGroupsParticipantWithLidMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxInGroupsParticipantWithJidMixin").parseParticipantWithJidMixin(a);if(!b.success)return b;a=d("WASmaxInGroupsParticipantWithLidMixin").parseParticipantWithLidMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,a.value))}g.parseParticipantWithJidAndLidMixin=a}),98);
__d("WASmaxInGroupsParticipantWithJidAndPnMixin",["WAResultOrError","WASmaxInGroupsParticipantWithJidMixin","WASmaxInGroupsPhoneNumberMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxInGroupsParticipantWithJidMixin").parseParticipantWithJidMixin(a);if(!b.success)return b;a=d("WASmaxInGroupsPhoneNumberMixin").parsePhoneNumberMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,a.value))}g.parseParticipantWithJidAndPnMixin=a}),98);
__d("WASmaxInGroupsDisplayNameMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrString(a,"display_name");return!a.success?a:d("WAResultOrError").makeResult({displayName:a.value})}g.parseDisplayNameMixin=a}),98);
__d("WASmaxInGroupsParticipantWithJidContainingLidAndDisplayNameMixin",["WAResultOrError","WASmaxInGroupsDisplayNameMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"jid");if(!b.success)return b;a=d("WASmaxInGroupsDisplayNameMixin").parseDisplayNameMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({jid:b.value},a.value))}g.parseParticipantWithJidContainingLidAndDisplayNameMixin=a}),98);
__d("WASmaxInGroupsParticipantWithJidLidAndDisplayNameMixin",["WAResultOrError","WASmaxInGroupsDisplayNameMixin","WASmaxInGroupsParticipantWithJidAndLidMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxInGroupsParticipantWithJidAndLidMixin").parseParticipantWithJidAndLidMixin(a);if(!b.success)return b;a=d("WASmaxInGroupsDisplayNameMixin").parseDisplayNameMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,a.value))}g.parseParticipantWithJidLidAndDisplayNameMixin=a}),98);
__d("WASmaxInGroupsParticipantMixins",["WAResultOrError","WASmaxInGroupsParticipantWithJidAndLidMixin","WASmaxInGroupsParticipantWithJidAndPnMixin","WASmaxInGroupsParticipantWithJidContainingLidAndDisplayNameMixin","WASmaxInGroupsParticipantWithJidLidAndDisplayNameMixin","WASmaxInGroupsParticipantWithJidMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsParticipantWithJidLidAndDisplayNameMixin").parseParticipantWithJidLidAndDisplayNameMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"ParticipantWithJidLidAndDisplayName",value:b.value});var c=d("WASmaxInGroupsParticipantWithJidContainingLidAndDisplayNameMixin").parseParticipantWithJidContainingLidAndDisplayNameMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"ParticipantWithJidContainingLidAndDisplayName",value:c.value});var e=d("WASmaxInGroupsParticipantWithJidAndLidMixin").parseParticipantWithJidAndLidMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"ParticipantWithJidAndLid",value:e.value});var f=d("WASmaxInGroupsParticipantWithJidAndPnMixin").parseParticipantWithJidAndPnMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"ParticipantWithJidAndPn",value:f.value});var g=d("WASmaxInGroupsParticipantWithJidMixin").parseParticipantWithJidMixin(a);return g.success?d("WAResultOrError").makeResult({name:"ParticipantWithJid",value:g.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ParticipantWithJidLidAndDisplayName","ParticipantWithJidContainingLidAndDisplayName","ParticipantWithJidAndLid","ParticipantWithJidAndPn","ParticipantWithJid"],[b,c,e,f,g])}g.parseParticipantMixins=a}),98);
__d("WASmaxInGroupsParticipantMixin",["WAResultOrError","WASmaxInGroupsParticipantMixins","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxInGroupsParticipantMixins").parseParticipantMixins(a);return!b.success?b:d("WAResultOrError").makeResult({participantMixins:b.value})}g.parseParticipantMixin=a}),98);
__d("WASmaxInGroupsParticipantPhoneNumberMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"participant");if(!b.success)return b;a=d("WASmaxParseJid").attrUserJid(a,"participant_pn");return!a.success?a:d("WAResultOrError").makeResult({participant:b.value,participantPn:a.value})}g.parseParticipantPhoneNumberMixin=a}),98);
__d("WASmaxInGroupsShadowGroupNotificationIndicatorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,b.value,"shadow","true");return!a.success?a:d("WAResultOrError").makeResult({metaShadow:a.value})}g.parseShadowGroupNotificationIndicatorMixin=a}),98);
__d("WASmaxInGroupsAddNotificationRequest",["WAResultOrError","WASmaxInGroupsCommonNotificationMixin","WASmaxInGroupsEnums","WASmaxInGroupsGroupAddressingModeMixin","WASmaxInGroupsParticipantMixin","WASmaxInGroupsParticipantNotAddressableMixin","WASmaxInGroupsParticipantPhoneNumberMixin","WASmaxInGroupsShadowGroupNotificationIndicatorMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxInGroupsParticipantMixin").parseParticipantMixin(a);if(!b.success)return b;a=d("WASmaxInGroupsParticipantNotAddressableMixin").parseParticipantNotAddressableMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{participantNotAddressableMixin:a.success?a.value:null}))}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"add");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"participant");if(!c.success)return c;var e=d("WASmaxParseUtils").attrString(b.value,"v_id");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,b.value,"prev_v_id");if(!f.success)return f;var g=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,b.value,"reason",d("WASmaxInGroupsEnums").ENUM_ACCEPT_DEFAULTSUBGROUPPROMOTE_INVITE_INVITEAUTOADD_LINKEDGROUPJOIN);if(!g.success)return g;var i=d("WASmaxInGroupsCommonNotificationMixin").parseCommonNotificationMixin(a);if(!i.success)return i;var j=d("WASmaxInGroupsShadowGroupNotificationIndicatorMixin").parseShadowGroupNotificationIndicatorMixin(a),k=d("WASmaxInGroupsGroupAddressingModeMixin").parseGroupAddressingModeMixin(a);a=d("WASmaxInGroupsParticipantPhoneNumberMixin").parseParticipantPhoneNumberMixin(a);b=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"participant",1,1024,h);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({participant:c.value,addVId:e.value,addPrevVId:f.value,addReason:g.value},i.value,{shadowGroupNotificationIndicatorMixin:j.success?j.value:null,groupAddressingModeMixin:k.success?k.value:null,participantPhoneNumberMixin:a.success?a.value:null,addParticipant:b.value}))}g.parseAddNotificationRequestAddParticipant=h;g.parseAddNotificationRequest=a}),98);
__d("WASmaxOutGroupsNotificationClientAckMixin",["WASmaxJsx","WASmaxMixins","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrGroupJid,a,["from"]);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(b.value),to:d("WAWap").GROUP_JID(c.value),"class":"notification",type:d("WAWap").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);
__d("WASmaxOutGroupsAddNotificationResponseAck",["WASmaxAttrs","WASmaxJsx","WASmaxOutGroupsNotificationClientAckMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrUserJid,a,["participant"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);b=d("WASmaxOutGroupsNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",{participant:d("WASmaxAttrs").OPTIONAL(d("WAWap").USER_JID,b.value)}),a);return b}g.makeAddNotificationResponseAck=a}),98);
__d("WASmaxGroupsAddNotificationRPC",["WASmaxInGroupsAddNotificationRequest","WASmaxOutGroupsAddNotificationResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsAddNotificationRequest").parseAddNotificationRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("AddNotification",{Request:b}));return{parsedRequest:b.value,makeAddNotificationResponseAck:function(){return d("WASmaxOutGroupsAddNotificationResponseAck").makeAddNotificationResponseAck(a)}}}g.receiveAddNotificationRPC=a}),98);
__d("WASmaxInGroupsDeleteNotificationRequest",["WAResultOrError","WASmaxInGroupsCommonNotificationMixin","WASmaxInGroupsEnums","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"delete");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"participant");if(!c.success)return c;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,b.value,"reason",d("WASmaxInGroupsEnums").ENUM_DELETEPARENT_INTEGRITYDELETEPARENT);if(!b.success)return b;a=d("WASmaxInGroupsCommonNotificationMixin").parseCommonNotificationMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({participant:c.value,deleteReason:b.value},a.value))}g.parseDeleteNotificationRequest=a}),98);
__d("WASmaxOutGroupsDeleteNotificationResponseAck",["WASmaxAttrs","WASmaxJsx","WASmaxOutGroupsNotificationClientAckMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrUserJid,a,["participant"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);b=d("WASmaxOutGroupsNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",{participant:d("WASmaxAttrs").OPTIONAL(d("WAWap").USER_JID,b.value)}),a);return b}g.makeDeleteNotificationResponseAck=a}),98);
__d("WASmaxGroupsDeleteNotificationRPC",["WASmaxInGroupsDeleteNotificationRequest","WASmaxOutGroupsDeleteNotificationResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsDeleteNotificationRequest").parseDeleteNotificationRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("DeleteNotification",{Request:b}));return{parsedRequest:b.value,makeDeleteNotificationResponseAck:function(){return d("WASmaxOutGroupsDeleteNotificationResponseAck").makeDeleteNotificationResponseAck(a)}}}g.receiveDeleteNotificationRPC=a}),98);
__d("WASmaxInGroupsDemoteNotificationRequest",["WAResultOrError","WASmaxInGroupsCommonNotificationMixin","WASmaxInGroupsGroupAddressingModeMixin","WASmaxInGroupsParticipantMixins","WASmaxInGroupsParticipantPhoneNumberMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxInGroupsParticipantMixins").parseParticipantMixins(a);return!b.success?b:d("WAResultOrError").makeResult({participantMixins:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"demote");if(!b.success)return b;var c=d("WASmaxParseJid").attrUserJid(a,"participant");if(!c.success)return c;var e=d("WASmaxParseUtils").attrString(b.value,"v_id");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,b.value,"prev_v_id");if(!f.success)return f;var g=d("WASmaxInGroupsCommonNotificationMixin").parseCommonNotificationMixin(a);if(!g.success)return g;var i=d("WASmaxInGroupsGroupAddressingModeMixin").parseGroupAddressingModeMixin(a);a=d("WASmaxInGroupsParticipantPhoneNumberMixin").parseParticipantPhoneNumberMixin(a);b=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"participant",1,19999,h);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({participant:c.value,demoteVId:e.value,demotePrevVId:f.value},g.value,{groupAddressingModeMixin:i.success?i.value:null,participantPhoneNumberMixin:a.success?a.value:null,demoteParticipant:b.value}))}g.parseDemoteNotificationRequestDemoteParticipant=h;g.parseDemoteNotificationRequest=a}),98);
__d("WASmaxOutGroupsDemoteNotificationResponseAck",["WASmaxJsx","WASmaxOutGroupsNotificationClientAckMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrUserJid,a,["participant"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);b=d("WASmaxOutGroupsNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",{participant:d("WAWap").USER_JID(b.value)}),a);return b}g.makeDemoteNotificationResponseAck=a}),98);
__d("WASmaxGroupsDemoteNotificationRPC",["WASmaxInGroupsDemoteNotificationRequest","WASmaxOutGroupsDemoteNotificationResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsDemoteNotificationRequest").parseDemoteNotificationRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("DemoteNotification",{Request:b}));return{parsedRequest:b.value,makeDemoteNotificationResponseAck:function(){return d("WASmaxOutGroupsDemoteNotificationResponseAck").makeDemoteNotificationResponseAck(a)}}}g.receiveDemoteNotificationRPC=a}),98);
__d("WASmaxInGroupsDedupAttrsMixin",["WAResultOrError","WASmaxInGroupsEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").attrString(a,"key");if(!b.success)return b;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"create_ctx",d("WASmaxInGroupsEnums").ENUM_E2EEMIGRATION_REGULAR_RTC);return!a.success?a:d("WAResultOrError").makeResult({key:b.value,createCtx:a.value})}g.parseDedupAttrsMixin=a}),98);
__d("WASmaxInGroupsNamedSubjectMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrString(a,"subject");return!a.success?a:d("WAResultOrError").makeResult({subject:a.value})}g.parseNamedSubjectMixin=a}),98);
__d("WASmaxInGroupsUnnamedSubjectFallbackMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"subject");return!a.success?a:d("WAResultOrError").makeResult({subject:a.value})}g.parseUnnamedSubjectFallbackMixin=a}),98);
__d("WASmaxInGroupsNamedSubjectOrUnnamedSubjectFallbackMixinGroup",["WAResultOrError","WASmaxInGroupsNamedSubjectMixin","WASmaxInGroupsUnnamedSubjectFallbackMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsNamedSubjectMixin").parseNamedSubjectMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NamedSubject",value:b.value});var c=d("WASmaxInGroupsUnnamedSubjectFallbackMixin").parseUnnamedSubjectFallbackMixin(a);return c.success?d("WAResultOrError").makeResult({name:"UnnamedSubjectFallback",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["NamedSubject","UnnamedSubjectFallback"],[b,c])}g.parseNamedSubjectOrUnnamedSubjectFallbackMixinGroup=a}),98);
__d("WASmaxInGroupsGroupInfoAttributesMixin",["WAResultOrError","WASmaxInGroupsGroupAddressingModeMixin","WASmaxInGroupsNamedSubjectOrUnnamedSubjectFallbackMixinGroup","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"group");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"id");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"creator");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"creator_pn");if(!e.success)return e;var f=d("WASmaxParseUtils").attrIntRange(a,"creation",0,void 0);if(!f.success)return f;var g=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"p_v_id");if(!g.success)return g;var h=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"a_v_id");if(!h.success)return h;var i=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"s_t",0,void 0);if(!i.success)return i;var j=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"s_o");if(!j.success)return j;var k=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"s_o_pn");if(!k.success)return k;var l=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"open_thread_id");if(!l.success)return l;var m=d("WASmaxInGroupsGroupAddressingModeMixin").parseGroupAddressingModeMixin(a);a=d("WASmaxInGroupsNamedSubjectOrUnnamedSubjectFallbackMixinGroup").parseNamedSubjectOrUnnamedSubjectFallbackMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({id:b.value,creator:c.value,creatorPn:e.value,creation:f.value,pVId:g.value,aVId:h.value,sT:i.value,sO:j.value,sOPn:k.value,openThreadId:l.value,groupAddressingModeMixin:m.success?m.value:null,namedSubjectOrUnnamedSubjectFallbackMixinGroup:a.value})}g.parseGroupInfoAttributesMixin=a}),98);
__d("WASmaxInGroupsGroupInfoDescriptionMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"description");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"body");if(!b.success)return b;var c=d("WASmaxParseUtils").attrString(a,"id");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"participant");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"participant_pn");if(!f.success)return f;a=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!a.success)return a;b=d("WASmaxParseUtils").contentString(b.value);return!b.success?b:d("WAResultOrError").makeResult({id:c.value,participant:e.value,participantPn:f.value,t:a.value,bodyElementValue:b.value})}g.parseGroupInfoDescriptionMixin=a}),98);
__d("WASmaxInGroupsGroupInfoParticipantAdminMixins",["WAResultOrError","WASmaxInGroupsParticipantWithJidAndLidMixin","WASmaxInGroupsParticipantWithJidAndPnMixin","WASmaxInGroupsParticipantWithJidLidAndDisplayNameMixin","WASmaxInGroupsParticipantWithJidMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsParticipantWithJidLidAndDisplayNameMixin").parseParticipantWithJidLidAndDisplayNameMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"ParticipantWithJidLidAndDisplayName",value:b.value});var c=d("WASmaxInGroupsParticipantWithJidAndLidMixin").parseParticipantWithJidAndLidMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"ParticipantWithJidAndLid",value:c.value});var e=d("WASmaxInGroupsParticipantWithJidAndPnMixin").parseParticipantWithJidAndPnMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"ParticipantWithJidAndPn",value:e.value});var f=d("WASmaxInGroupsParticipantWithJidMixin").parseParticipantWithJidMixin(a);return f.success?d("WAResultOrError").makeResult({name:"ParticipantWithJid",value:f.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ParticipantWithJidLidAndDisplayName","ParticipantWithJidAndLid","ParticipantWithJidAndPn","ParticipantWithJid"],[b,c,e,f])}g.parseGroupInfoParticipantAdminMixins=a}),98);
__d("WASmaxInGroupsGroupInfoParticipantAdminMixin",["WAResultOrError","WASmaxInGroupsEnums","WASmaxInGroupsGroupInfoParticipantAdminMixins","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"type",d("WASmaxInGroupsEnums").ENUM_ADMIN_SUPERADMIN);if(!b.success)return b;a=d("WASmaxInGroupsGroupInfoParticipantAdminMixins").parseGroupInfoParticipantAdminMixins(a);return!a.success?a:d("WAResultOrError").makeResult({type:b.value,groupInfoParticipantAdminMixins:a.value})}g.parseGroupInfoParticipantAdminMixin=a}),98);
__d("WASmaxInGroupsGroupInfoParticipantNonAdminMixin",["WASmaxInGroupsParticipantMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxInGroupsParticipantMixin").parseParticipantMixin(a);return!b.success?b:b}g.parseGroupInfoParticipantNonAdminMixin=a}),98);
__d("WASmaxInGroupsGroupInfoParticipantMixins",["WAResultOrError","WASmaxInGroupsGroupInfoParticipantAdminMixin","WASmaxInGroupsGroupInfoParticipantNonAdminMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsGroupInfoParticipantAdminMixin").parseGroupInfoParticipantAdminMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"GroupInfoParticipantAdmin",value:b.value});var c=d("WASmaxInGroupsGroupInfoParticipantNonAdminMixin").parseGroupInfoParticipantNonAdminMixin(a);return c.success?d("WAResultOrError").makeResult({name:"GroupInfoParticipantNonAdmin",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["GroupInfoParticipantAdmin","GroupInfoParticipantNonAdmin"],[b,c])}g.parseGroupInfoParticipantMixins=a}),98);
__d("WASmaxInGroupsGroupInfoParticipantMixin",["WAResultOrError","WASmaxInGroupsGroupInfoParticipantMixins","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxInGroupsGroupInfoParticipantMixins").parseGroupInfoParticipantMixins(a);return!b.success?b:d("WAResultOrError").makeResult({groupInfoParticipantMixins:b.value})}g.parseGroupInfoParticipantMixin=a}),98);
__d("WASmaxInGroupsAdminAddModeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"member_add_mode");if(!b.success)return b;b=d("WASmaxParseUtils").literalContent(d("WASmaxParseUtils").contentString,a,"admin_add");return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}g.parseAdminAddModeMixin=a}),98);
__d("WASmaxInGroupsAllMembersAddModeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"member_add_mode");if(!b.success)return b;b=d("WASmaxParseUtils").literalContent(d("WASmaxParseUtils").contentString,a,"all_member_add");return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}g.parseAllMembersAddModeMixin=a}),98);
__d("WASmaxInGroupsUnknownAddModeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"member_add_mode");if(!b.success)return b;b=d("WASmaxParseUtils").contentString(a);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}g.parseUnknownAddModeMixin=a}),98);
__d("WASmaxInGroupsAdminOrAllMembersOrUnknownAddModeMixinGroup",["WAResultOrError","WASmaxInGroupsAdminAddModeMixin","WASmaxInGroupsAllMembersAddModeMixin","WASmaxInGroupsUnknownAddModeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsAdminAddModeMixin").parseAdminAddModeMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"AdminAddMode",value:b.value});var c=d("WASmaxInGroupsAllMembersAddModeMixin").parseAllMembersAddModeMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"AllMembersAddMode",value:c.value});var e=d("WASmaxInGroupsUnknownAddModeMixin").parseUnknownAddModeMixin(a);return e.success?d("WAResultOrError").makeResult({name:"UnknownAddMode",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["AdminAddMode","AllMembersAddMode","UnknownAddMode"],[b,c,e])}g.parseAdminOrAllMembersOrUnknownAddModeMixinGroup=a}),98);
__d("WASmaxInGroupsGroupMemberAddModeMixin",["WAResultOrError","WASmaxInGroupsAdminOrAllMembersOrUnknownAddModeMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"member_add_mode");if(!a.success)return a;a=d("WASmaxInGroupsAdminOrAllMembersOrUnknownAddModeMixinGroup").parseAdminOrAllMembersOrUnknownAddModeMixinGroup(a.value);return!a.success?a:d("WAResultOrError").makeResult({memberAddModeAdminOrAllMembersOrUnknownAddModeMixinGroup:a.value})}g.parseGroupMemberAddModeMixin=a}),98);
__d("WASmaxInGroupsGroupJoinMembershipApprovalModeEnabledMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"group_join");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"state","on");return!b.success?b:d("WAResultOrError").makeResult({state:b.value})}g.parseGroupJoinMembershipApprovalModeEnabledMixin=a}),98);
__d("WASmaxInGroupsMembershipApprovalGroupJoinModeEnabledMixin",["WASmaxInGroupsGroupJoinMembershipApprovalModeEnabledMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"membership_approval_mode");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"group_join");if(!b.success)return b;a=d("WASmaxInGroupsGroupJoinMembershipApprovalModeEnabledMixin").parseGroupJoinMembershipApprovalModeEnabledMixin(b.value);return!a.success?a:a}g.parseMembershipApprovalGroupJoinModeEnabledMixin=a}),98);
__d("WASmaxInGroupsParentGroupDefaultMembershipApprovalModeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"parent");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"default_membership_approval_mode","request_required");return!b.success?b:d("WAResultOrError").makeResult({defaultMembershipApprovalMode:b.value})}g.parseParentGroupDefaultMembershipApprovalModeMixin=a}),98);
__d("WASmaxInGroupsGroupInfoMixin",["WAResultOrError","WASmaxInGroupsEnums","WASmaxInGroupsGroupInfoAttributesMixin","WASmaxInGroupsGroupInfoDescriptionMixin","WASmaxInGroupsGroupInfoParticipantMixin","WASmaxInGroupsGroupMemberAddModeMixin","WASmaxInGroupsMembershipApprovalGroupJoinModeEnabledMixin","WASmaxInGroupsParentGroupDefaultMembershipApprovalModeMixin","WASmaxInGroupsParticipantNotAddressableMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxInGroupsGroupInfoParticipantMixin").parseGroupInfoParticipantMixin(a);if(!b.success)return b;a=d("WASmaxInGroupsParticipantNotAddressableMixin").parseParticipantNotAddressableMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{participantNotAddressableMixin:a.success?a.value:null}))}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"description");if(!b.success)return b;b=d("WASmaxInGroupsGroupInfoDescriptionMixin").parseGroupInfoDescriptionMixin(a);return d("WAResultOrError").makeResult({groupInfoDescriptionMixin:b.success?b.value:null})}function j(a){var b=d("WASmaxParseUtils").assertTag(a,"parent");if(!b.success)return b;b=d("WASmaxInGroupsParentGroupDefaultMembershipApprovalModeMixin").parseParentGroupDefaultMembershipApprovalModeMixin(a);return d("WAResultOrError").makeResult({parentGroupDefaultMembershipApprovalModeMixin:b.success?b.value:null})}function k(a){var b=d("WASmaxParseUtils").assertTag(a,"ephemeral");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"expiration",0,2147483647);if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"trigger",d("WASmaxInGroupsEnums").ENUM_ACCOUNTSETTING_BULKCHANGE_CHATSETTING);if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,a,"initiated_by_me",d("WASmaxInGroupsEnums").ENUM_FALSE_TRUE);return!a.success?a:d("WAResultOrError").makeResult({expiration:b.value,trigger:c.value,initiatedByMe:a.value})}function l(a){var b=d("WASmaxParseUtils").assertTag(a,"growth_locked");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","invite");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(a,"expiration",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({type:b.value,expiration:a.value})}function m(a){var b=d("WASmaxParseUtils").assertTag(a,"membership_approval_mode");if(!b.success)return b;b=d("WASmaxInGroupsMembershipApprovalGroupJoinModeEnabledMixin").parseMembershipApprovalGroupJoinModeEnabledMixin(a);return d("WAResultOrError").makeResult({membershipApprovalGroupJoinModeEnabledMixin:b.success?b.value:null})}function n(a){var b=d("WASmaxParseUtils").assertTag(a,"linked_parent");if(!b.success)return b;b=d("WASmaxParseJid").attrGroupJid(a,"jid");return!b.success?b:d("WAResultOrError").makeResult({jid:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"group");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"description",i);if(!b.success)return b;var c=d("WASmaxParseUtils").optionalChild(a,"locked");if(!c.success)return c;var e=d("WASmaxParseUtils").optionalChild(a,"announcement");if(!e.success)return e;var f=d("WASmaxParseUtils").optionalChildWithTag(a,"parent",j);if(!f.success)return f;var g=d("WASmaxParseUtils").optionalChild(a,"no_frequently_forwarded");if(!g.success)return g;var o=d("WASmaxParseUtils").optionalChild(a,"support");if(!o.success)return o;var p=d("WASmaxParseUtils").optionalChildWithTag(a,"ephemeral",k);if(!p.success)return p;var q=d("WASmaxParseUtils").optionalChild(a,"suspended");if(!q.success)return q;var r=d("WASmaxParseUtils").optionalChildWithTag(a,"growth_locked",l);if(!r.success)return r;var s=d("WASmaxParseUtils").optionalChild(a,"default_sub_group");if(!s.success)return s;var t=d("WASmaxParseUtils").optionalChild(a,"shadow");if(!t.success)return t;var u=d("WASmaxParseUtils").optionalChildWithTag(a,"membership_approval_mode",m);if(!u.success)return u;var v=d("WASmaxParseUtils").optionalChild(a,"incognito");if(!v.success)return v;var w=d("WASmaxParseUtils").optionalChild(a,"allow_admin_reports");if(!w.success)return w;var x=d("WASmaxParseUtils").optionalChild(a,"allow_non_admin_sub_group_creation");if(!x.success)return x;var y=d("WASmaxParseUtils").optionalChild(a,"general_chat");if(!y.success)return y;var z=d("WASmaxParseUtils").optionalChild(a,"auto_add_disabled");if(!z.success)return z;var A=d("WASmaxParseUtils").optionalChild(a,"group_history");if(!A.success)return A;var B=d("WASmaxParseUtils").optionalChildWithTag(a,"linked_parent",n);if(!B.success)return B;var C=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,a,"ack","false");if(!C.success)return C;var D=d("WASmaxInGroupsGroupInfoAttributesMixin").parseGroupInfoAttributesMixin(a);if(!D.success)return D;var E=d("WASmaxInGroupsGroupMemberAddModeMixin").parseGroupMemberAddModeMixin(a);a=d("WASmaxParseUtils").mapChildrenWithTag(a,"participant",0,19999,h);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({ack:C.value},D.value,{groupMemberAddModeMixin:E.success?E.value:null,description:b.value,hasLocked:c.value!=null,hasAnnouncement:e.value!=null,parent:f.value,hasNoFrequentlyForwarded:g.value!=null,hasSupport:o.value!=null,ephemeral:p.value,hasSuspended:q.value!=null,growthLocked:r.value,hasDefaultSubGroup:s.value!=null,hasShadow:t.value!=null,membershipApprovalMode:u.value,hasIncognito:v.value!=null,hasAllowAdminReports:w.value!=null,hasAllowNonAdminSubGroupCreation:x.value!=null,hasGeneralChat:y.value!=null,hasAutoAddDisabled:z.value!=null,hasGroupHistory:A.value!=null,linkedParent:B.value,participant:a.value}))}g.parseGroupInfoParticipant=h;g.parseGroupInfoDescription=i;g.parseGroupInfoParent=j;g.parseGroupInfoEphemeral=k;g.parseGroupInfoGrowthLocked=l;g.parseGroupInfoMembershipApprovalMode=m;g.parseGroupInfoLinkedParent=n;g.parseGroupInfoMixin=a}),98);
__d("WASmaxInGroupsOptionalContextGroupMixin",["WAResultOrError","WASmaxParseJid"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseJid").attrGroupJid(a,"context_group_jid");return!a.success?a:d("WAResultOrError").makeResult({contextGroupJid:a.value})}g.parseOptionalContextGroupMixin=a}),98);
__d("WASmaxInGroupsJoinNotificationRequest",["WAResultOrError","WASmaxInGroupsCommonNotificationMixin","WASmaxInGroupsDedupAttrsMixin","WASmaxInGroupsEnums","WASmaxInGroupsGroupAddressingModeMixin","WASmaxInGroupsGroupInfoMixin","WASmaxInGroupsOptionalContextGroupMixin","WASmaxInGroupsParticipantPhoneNumberMixin","WASmaxInGroupsShadowGroupNotificationIndicatorMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"create");if(!b.success)return b;var c=d("WASmaxParseUtils").flattenedChildWithTag(b.value,"group");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"participant");if(!e.success)return e;var f=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,b.value,"type","new");if(!f.success)return f;var g=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,b.value,"reason",d("WASmaxInGroupsEnums").ENUM_ACCEPT_AUTOADD_DEFAULTSUBGROUPADMINADD_GENERALCHATAUTOADD_INVITE_INVITEAUTOADD_LINKEDGROUPJOIN_SUBGROUPSUGGESTIONAPPROVED);if(!g.success)return g;var h=d("WASmaxParseUtils").attrIntRange(c.value,"size",1,19999);if(!h.success)return h;c=d("WASmaxInGroupsGroupInfoMixin").parseGroupInfoMixin(c.value);if(!c.success)return c;var i=d("WASmaxInGroupsOptionalContextGroupMixin").parseOptionalContextGroupMixin(b.value);b=d("WASmaxInGroupsDedupAttrsMixin").parseDedupAttrsMixin(b.value);var j=d("WASmaxInGroupsCommonNotificationMixin").parseCommonNotificationMixin(a);if(!j.success)return j;var k=d("WASmaxInGroupsShadowGroupNotificationIndicatorMixin").parseShadowGroupNotificationIndicatorMixin(a),l=d("WASmaxInGroupsGroupAddressingModeMixin").parseGroupAddressingModeMixin(a);a=d("WASmaxInGroupsParticipantPhoneNumberMixin").parseParticipantPhoneNumberMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({participant:e.value,createType:f.value,createReason:g.value,createGroupSize:h.value,createGroupGroupInfoMixin:c.value,createOptionalContextGroupMixin:i.success?i.value:null,createDedupAttrsMixin:b.success?b.value:null},j.value,{shadowGroupNotificationIndicatorMixin:k.success?k.value:null,groupAddressingModeMixin:l.success?l.value:null,participantPhoneNumberMixin:a.success?a.value:null}))}g.parseJoinNotificationRequest=a}),98);
__d("WASmaxOutGroupsJoinNotificationResponseAck",["WASmaxAttrs","WASmaxJsx","WASmaxOutGroupsNotificationClientAckMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrUserJid,a,["participant"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);b=d("WASmaxOutGroupsNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",{participant:d("WASmaxAttrs").OPTIONAL(d("WAWap").USER_JID,b.value)}),a);return b}g.makeJoinNotificationResponseAck=a}),98);
__d("WASmaxGroupsJoinNotificationRPC",["WASmaxInGroupsJoinNotificationRequest","WASmaxOutGroupsJoinNotificationResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsJoinNotificationRequest").parseJoinNotificationRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("JoinNotification",{Request:b}));return{parsedRequest:b.value,makeJoinNotificationResponseAck:function(){return d("WASmaxOutGroupsJoinNotificationResponseAck").makeJoinNotificationResponseAck(a)}}}g.receiveJoinNotificationRPC=a}),98);
__d("WASmaxInGroupsPromoteNotificationRequest",["WAResultOrError","WASmaxInGroupsCommonNotificationMixin","WASmaxInGroupsGroupAddressingModeMixin","WASmaxInGroupsParticipantMixins","WASmaxInGroupsParticipantPhoneNumberMixin","WASmaxInGroupsShadowGroupNotificationIndicatorMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxInGroupsParticipantMixins").parseParticipantMixins(a);return!b.success?b:d("WAResultOrError").makeResult({participantMixins:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"promote");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"participant");if(!c.success)return c;var e=d("WASmaxParseUtils").attrString(b.value,"v_id");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,b.value,"prev_v_id");if(!f.success)return f;var g=d("WASmaxInGroupsCommonNotificationMixin").parseCommonNotificationMixin(a);if(!g.success)return g;var i=d("WASmaxInGroupsShadowGroupNotificationIndicatorMixin").parseShadowGroupNotificationIndicatorMixin(a),j=d("WASmaxInGroupsGroupAddressingModeMixin").parseGroupAddressingModeMixin(a);a=d("WASmaxInGroupsParticipantPhoneNumberMixin").parseParticipantPhoneNumberMixin(a);b=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"participant",1,19999,h);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({participant:c.value,promoteVId:e.value,promotePrevVId:f.value},g.value,{shadowGroupNotificationIndicatorMixin:i.success?i.value:null,groupAddressingModeMixin:j.success?j.value:null,participantPhoneNumberMixin:a.success?a.value:null,promoteParticipant:b.value}))}g.parsePromoteNotificationRequestPromoteParticipant=h;g.parsePromoteNotificationRequest=a}),98);
__d("WASmaxOutGroupsPromoteNotificationResponseAck",["WASmaxAttrs","WASmaxJsx","WASmaxOutGroupsNotificationClientAckMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrUserJid,a,["participant"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);b=d("WASmaxOutGroupsNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",{participant:d("WASmaxAttrs").OPTIONAL(d("WAWap").USER_JID,b.value)}),a);return b}g.makePromoteNotificationResponseAck=a}),98);
__d("WASmaxGroupsPromoteNotificationRPC",["WASmaxInGroupsPromoteNotificationRequest","WASmaxOutGroupsPromoteNotificationResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsPromoteNotificationRequest").parsePromoteNotificationRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("PromoteNotification",{Request:b}));return{parsedRequest:b.value,makePromoteNotificationResponseAck:function(){return d("WASmaxOutGroupsPromoteNotificationResponseAck").makePromoteNotificationResponseAck(a)}}}g.receivePromoteNotificationRPC=a}),98);
__d("WASmaxInGroupsRemoveNotificationMemberMixin",["WAResultOrError","WASmaxInGroupsParticipantMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxInGroupsParticipantMixin").parseParticipantMixin(a);return!b.success?b:b}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"remove");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"v_id");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"prev_v_id");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"subject");if(!e.success)return e;var f=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,a,"reason","default_sub_group_demote");if(!f.success)return f;a=d("WASmaxParseUtils").mapChildrenWithTag(a,"participant",1,1024,h);return!a.success?a:d("WAResultOrError").makeResult({vId:b.value,prevVId:c.value,subject:e.value,reason:f.value,participant:a.value})}g.parseRemoveNotificationMemberParticipant=h;g.parseRemoveNotificationMemberMixin=a}),98);
__d("WASmaxInGroupsRemoveNotificationNonMemberMixin",["WAResultOrError","WASmaxInGroupsParticipantMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"remove");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"participant");if(!b.success)return b;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"subject");if(!a.success)return a;b=d("WASmaxInGroupsParticipantMixin").parseParticipantMixin(b.value);return!b.success?b:d("WAResultOrError").makeResult({subject:a.value,participantParticipantMixin:b.value})}g.parseRemoveNotificationNonMemberMixin=a}),98);
__d("WASmaxInGroupsRemoveNotificationOrRemoveNotificationNonMemberMixinGroup",["WAResultOrError","WASmaxInGroupsRemoveNotificationMemberMixin","WASmaxInGroupsRemoveNotificationNonMemberMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsRemoveNotificationMemberMixin").parseRemoveNotificationMemberMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"RemoveNotificationMember",value:b.value});var c=d("WASmaxInGroupsRemoveNotificationNonMemberMixin").parseRemoveNotificationNonMemberMixin(a);return c.success?d("WAResultOrError").makeResult({name:"RemoveNotificationNonMember",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Member","NonMember"],[b,c])}g.parseRemoveNotificationOrRemoveNotificationNonMemberMixinGroup=a}),98);
__d("WASmaxInGroupsRemoveNotificationRequest",["WAResultOrError","WASmaxInGroupsCommonNotificationMixin","WASmaxInGroupsGroupAddressingModeMixin","WASmaxInGroupsParticipantPhoneNumberMixin","WASmaxInGroupsRemoveNotificationOrRemoveNotificationNonMemberMixinGroup","WASmaxInGroupsShadowGroupNotificationIndicatorMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"remove");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"participant");if(!c.success)return c;var e=d("WASmaxInGroupsCommonNotificationMixin").parseCommonNotificationMixin(a);if(!e.success)return e;var f=d("WASmaxInGroupsShadowGroupNotificationIndicatorMixin").parseShadowGroupNotificationIndicatorMixin(a),g=d("WASmaxInGroupsGroupAddressingModeMixin").parseGroupAddressingModeMixin(a);a=d("WASmaxInGroupsParticipantPhoneNumberMixin").parseParticipantPhoneNumberMixin(a);b=d("WASmaxInGroupsRemoveNotificationOrRemoveNotificationNonMemberMixinGroup").parseRemoveNotificationOrRemoveNotificationNonMemberMixinGroup(b.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({participant:c.value},e.value,{shadowGroupNotificationIndicatorMixin:f.success?f.value:null,groupAddressingModeMixin:g.success?g.value:null,participantPhoneNumberMixin:a.success?a.value:null,removeRemoveNotificationOrRemoveNotificationNonMemberMixinGroup:b.value}))}g.parseRemoveNotificationRequest=a}),98);
__d("WASmaxOutGroupsRemoveNotificationResponseAck",["WASmaxAttrs","WASmaxJsx","WASmaxOutGroupsNotificationClientAckMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrUserJid,a,["participant"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);b=d("WASmaxOutGroupsNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",{participant:d("WASmaxAttrs").OPTIONAL(d("WAWap").USER_JID,b.value)}),a);return b}g.makeRemoveNotificationResponseAck=a}),98);
__d("WASmaxGroupsRemoveNotificationRPC",["WASmaxInGroupsRemoveNotificationRequest","WASmaxOutGroupsRemoveNotificationResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsRemoveNotificationRequest").parseRemoveNotificationRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("RemoveNotification",{Request:b}));return{parsedRequest:b.value,makeRemoveNotificationResponseAck:function(){return d("WASmaxOutGroupsRemoveNotificationResponseAck").makeRemoveNotificationResponseAck(a)}}}g.receiveRemoveNotificationRPC=a}),98);
__d("WASmaxInGroupsSubjectChangeNotificationRequest",["WAResultOrError","WASmaxInGroupsCommonNotificationMixin","WASmaxInGroupsGroupAddressingModeMixin","WASmaxInGroupsNamedSubjectOrUnnamedSubjectFallbackMixinGroup","WASmaxInGroupsParticipantPhoneNumberMixin","WASmaxInGroupsShadowGroupNotificationIndicatorMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"subject");if(!b.success)return b;var c=d("WASmaxParseJid").attrUserJid(a,"participant");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,b.value,"s_o");if(!e.success)return e;var f=d("WASmaxParseUtils").attrIntRange(b.value,"s_t",0,void 0);if(!f.success)return f;var g=d("WASmaxInGroupsCommonNotificationMixin").parseCommonNotificationMixin(a);if(!g.success)return g;var h=d("WASmaxInGroupsShadowGroupNotificationIndicatorMixin").parseShadowGroupNotificationIndicatorMixin(a),i=d("WASmaxInGroupsGroupAddressingModeMixin").parseGroupAddressingModeMixin(a);a=d("WASmaxInGroupsParticipantPhoneNumberMixin").parseParticipantPhoneNumberMixin(a);b=d("WASmaxInGroupsNamedSubjectOrUnnamedSubjectFallbackMixinGroup").parseNamedSubjectOrUnnamedSubjectFallbackMixinGroup(b.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({participant:c.value,subjectSO:e.value,subjectST:f.value},g.value,{shadowGroupNotificationIndicatorMixin:h.success?h.value:null,groupAddressingModeMixin:i.success?i.value:null,participantPhoneNumberMixin:a.success?a.value:null,subjectNamedSubjectOrUnnamedSubjectFallbackMixinGroup:b.value}))}g.parseSubjectChangeNotificationRequest=a}),98);
__d("WASmaxOutGroupsSubjectChangeNotificationResponseAck",["WASmaxJsx","WASmaxOutGroupsNotificationClientAckMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrUserJid,a,["participant"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);b=d("WASmaxOutGroupsNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",{participant:d("WAWap").USER_JID(b.value)}),a);return b}g.makeSubjectChangeNotificationResponseAck=a}),98);
__d("WASmaxGroupsSubjectChangeNotificationRPC",["WASmaxInGroupsSubjectChangeNotificationRequest","WASmaxOutGroupsSubjectChangeNotificationResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsSubjectChangeNotificationRequest").parseSubjectChangeNotificationRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("SubjectChangeNotification",{Request:b}));return{parsedRequest:b.value,makeSubjectChangeNotificationResponseAck:function(){return d("WASmaxOutGroupsSubjectChangeNotificationResponseAck").makeSubjectChangeNotificationResponseAck(a)}}}g.receiveSubjectChangeNotificationRPC=a}),98);
__d("WASmaxInNotificationFallbackEnums",["WAJids"],(function(a,b,c,d,e,f,g){b={validators:[(a=d("WAJids")).validateBroadcastJid,a.validateCallJid,a.validateDeviceJid,a.validateDomainJid,a.validateGroupJid,a.validateStatusJid,a.validateUserJid],typeName:"BroadcastJid|CallJid|DeviceJid|DomainJid|GroupJid|StatusJid|UserJid"};g.BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID=b}),98);
__d("WASmaxInNotificationFallbackGenericNotificationRequest",["WAResultOrError","WASmaxInNotificationFallbackEnums","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrJidEnum,a,"from",d("WASmaxInNotificationFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrJidEnum,a,"participant",d("WASmaxInNotificationFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!e.success)return e;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"type");return!a.success?a:d("WAResultOrError").makeResult({id:b.value,from:c.value,participant:e.value,type:a.value})}g.parseGenericNotificationRequest=a}),98);
__d("WASmaxOutNotificationFallbackGenericNotificationResponseAck",["WASmaxAttrs","WASmaxInNotificationFallbackEnums","WASmaxJsx","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrJidEnum,a,["from"],d("WASmaxInNotificationFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);var e=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrJidEnum,a,["participant"],d("WASmaxInNotificationFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!e.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(e.error);a=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(b.value),to:d("WASmaxAttrs").OPTIONAL(d("WAWap").JID,c.value),participant:d("WASmaxAttrs").OPTIONAL(d("WAWap").JID,e.value),"class":"notification",type:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a.value)});return b}g.makeGenericNotificationResponseAck=a}),98);
__d("WASmaxOutNotificationFallbackGenericNotificationResponseBadStanza",["WASmaxAttrs","WASmaxInNotificationFallbackEnums","WASmaxJsx","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a,b){a=a.ackError;var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,b,["id"]);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);var e=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrJidEnum,b,["from"],d("WASmaxInNotificationFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!e.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(e.error);var f=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrJidEnum,b,["participant"],d("WASmaxInNotificationFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!f.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(f.error);b=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseUtils").attrString,b,["type"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);c=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(c.value),to:d("WASmaxAttrs").OPTIONAL(d("WAWap").JID,e.value),participant:d("WASmaxAttrs").OPTIONAL(d("WAWap").JID,f.value),"class":"notification",type:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,b.value),error:d("WAWap").INT(a)});return c}g.makeGenericNotificationResponseBadStanza=a}),98);
__d("WASmaxNotificationFallbackGenericNotificationRPC",["WASmaxInNotificationFallbackGenericNotificationRequest","WASmaxOutNotificationFallbackGenericNotificationResponseAck","WASmaxOutNotificationFallbackGenericNotificationResponseBadStanza","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInNotificationFallbackGenericNotificationRequest").parseGenericNotificationRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("GenericNotification",{Request:b}));return{parsedRequest:b.value,makeGenericNotificationResponseBadStanza:function(b){return d("WASmaxOutNotificationFallbackGenericNotificationResponseBadStanza").makeGenericNotificationResponseBadStanza(b,a)},makeGenericNotificationResponseAck:function(){return d("WASmaxOutNotificationFallbackGenericNotificationResponseAck").makeGenericNotificationResponseAck(a)}}}g.receiveGenericNotificationRPC=a}),98);
__d("WAParseGroupNotifications",["WAJids","WALogger","WAResultOrError","WASmaxDecisionTreeUtils","WASmaxGroupsAddNotificationRPC","WASmaxGroupsDeleteNotificationRPC","WASmaxGroupsDemoteNotificationRPC","WASmaxGroupsJoinNotificationRPC","WASmaxGroupsPromoteNotificationRPC","WASmaxGroupsRemoveNotificationRPC","WASmaxGroupsSubjectChangeNotificationRPC","WASmaxInGroupsShadowGroupNotificationIndicatorMixin","WASmaxNotificationFallbackGenericNotificationRPC","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["parseGroupNotification: Unknown notification ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["parseGroupNotification: Received group-dual-send notification"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["parseGroupNotification: Received node with no children"]);j=function(){return a};return a}function a(a){var b=d("WASmaxDecisionTreeUtils").firstChild(a);if(!b.success){d("WALogger").ERROR(j());var c=d("WASmaxNotificationFallbackGenericNotificationRPC").receiveGenericNotificationRPC(a),e=c.makeGenericNotificationResponseBadStanza;c=c.parsedRequest.id;return{action:{type:"unknown"},id:c,ack:function(){return e({ackError:487})}}}c=d("WASmaxInGroupsShadowGroupNotificationIndicatorMixin").parseShadowGroupNotificationIndicatorMixin(a);if(c.success){d("WALogger").WARN(i());c=d("WASmaxNotificationFallbackGenericNotificationRPC").receiveGenericNotificationRPC(a);var f=c.makeGenericNotificationResponseBadStanza;c=c.parsedRequest.id;return{action:{type:"unknown"},id:c,ack:function(){return f({ackError:487})}}}c=b.value.tag;switch(c){case"create":return k(a);case"add":return m(a);case"remove":return n(a);case"delete":b=d("WASmaxGroupsDeleteNotificationRPC").receiveDeleteNotificationRPC(a);var g=b.parsedRequest,l=g.participant,r=g.from,s=g.offline,t=g.t;g=g.id;b=b.makeDeleteNotificationResponseAck;return{action:{type:"delete",participant:l,groupJid:r},ack:b,offline:s,serverTs:d("WATimeUtils").castToUnixTime(t),id:g};case"promote":return o(a);case"demote":return p(a);case"subject":return q(a);default:d("WALogger").ERROR(h(),c)}l=d("WASmaxNotificationFallbackGenericNotificationRPC").receiveGenericNotificationRPC(a);var u=l.makeGenericNotificationResponseBadStanza;r=l.parsedRequest.id;return{action:{type:"unknown"},id:r,ack:function(){return u({ackError:487})}}}function k(a){a=d("WASmaxGroupsJoinNotificationRPC").receiveJoinNotificationRPC(a);var b=a.parsedRequest,c=b.from,e=b.createGroupGroupInfoMixin,f=e.id,g=e.creator,h=e.creation,i=e.participant,j=e.namedSubjectOrUnnamedSubjectFallbackMixinGroup,k=e.sO,l=e.sT,m=e.pVId;e=e.description;var n=b.createDedupAttrsMixin,o=b.createType,p=b.participant,q=b.t,r=b.offline;b=b.id;a=a.makeJoinNotificationResponseAck;e=e==null?void 0:e.groupInfoDescriptionMixin;i={jid:d("WAJids").toGroupJid(f),creator:(f=g)!=null?f:void 0,creationTs:d("WATimeUtils").castToUnixTime(h),participants:i.map(function(a){var b=a.groupInfoParticipantMixins;a=a.participantNotAddressableMixin;return d("WAResultOrError").makeResult({addressable:(a==null?void 0:a.addressable)!=="false",type:b.name==="GroupInfoParticipantAdmin"?b.value.type:"participant",user:b.name==="GroupInfoParticipantAdmin"?b.value.groupInfoParticipantAdminMixins.value.jid:b.value.participantMixins.value.jid})}),subject:{content:j.value.subject,user:(g=k)!=null?g:void 0,ts:l==null?void 0:d("WATimeUtils").castToUnixTime(l)},description:e==null?void 0:{id:e.id,content:e.bodyElementValue,user:e.participant,ts:d("WATimeUtils").castToUnixTime(e.t)},participantVersion:(f=m)!=null?f:void 0,inviter:(h=p)!=null?h:void 0};j=d("WATimeUtils").castToUnixTime(q);return{action:{type:"join",isNew:o==="new",isE2EEMigration:(n==null?void 0:n.createCtx)==="e2ee_migration",key:n==null?void 0:n.key,serverTs:d("WATimeUtils").castToUnixTime(q),groupJid:c,group:i},serverTs:j,offline:r,ack:a,id:b}}function l(a){if(a===null)return;return a==="invite"?"invite":"accept"}function m(a){a=d("WASmaxGroupsAddNotificationRPC").receiveAddNotificationRPC(a);var b=a.parsedRequest,c=b.from,e=b.participant,f=b.addVId,g=b.addPrevVId,h=b.addReason,i=b.addParticipant,j=b.offline,k=b.t;b=b.id;a=a.makeAddNotificationResponseAck;return{action:{type:"add",versionId:f,previousVersionId:g,reason:l(h),participants:i.map(function(a){return{user:a.participantMixins.value.jid,type:"participant",addressable:((a=a.participantNotAddressableMixin)==null?void 0:a.addressable)!=="false"}}),groupJid:c,participant:e},serverTs:d("WATimeUtils").castToUnixTime(k),offline:j,ack:a,id:b}}function n(a){a=d("WASmaxGroupsRemoveNotificationRPC").receiveRemoveNotificationRPC(a);var b=a.parsedRequest,c=b.offline,e=b.from,f=b.participant,g=b.t,h=b.id;b=b.removeRemoveNotificationOrRemoveNotificationNonMemberMixinGroup;a=a.makeRemoveNotificationResponseAck;var i=b.name==="RemoveNotificationMember"?b.value.participant.map(function(a){return{user:a.participantMixins.value.jid,type:"nonparticipant",addressable:!0}}):[{user:b.value.participantParticipantMixin.participantMixins.value.jid,type:"nonparticipant",addressable:!0}];return{action:{type:"remove",versionId:b.value.vId,previousVersionId:b.value.prevVId,participants:i,groupJid:e,participant:f},serverTs:d("WATimeUtils").castToUnixTime(g),ack:a,offline:c,id:h}}function o(a){a=d("WASmaxGroupsPromoteNotificationRPC").receivePromoteNotificationRPC(a);var b=a.parsedRequest,c=b.promoteVId,e=b.promotePrevVId,f=b.promoteParticipant,g=b.from,h=b.participant,i=b.offline,j=b.t;b=b.id;a=a.makePromoteNotificationResponseAck;return{action:{type:"promote",versionId:c,previousVersionId:e,participants:f.map(function(a){a=a.participantMixins.value.jid;return{user:a,type:"admin",addressable:!0}}),groupJid:g,participant:h},serverTs:d("WATimeUtils").castToUnixTime(j),offline:i,ack:a,id:b}}function p(a){a=d("WASmaxGroupsDemoteNotificationRPC").receiveDemoteNotificationRPC(a);var b=a.parsedRequest,c=b.demoteVId,e=b.demotePrevVId,f=b.demoteParticipant,g=b.from,h=b.participant,i=b.offline,j=b.t;b=b.id;a=a.makeDemoteNotificationResponseAck;return{action:{type:"demote",versionId:c,previousVersionId:e,participants:f.map(function(a){a=a.participantMixins.value.jid;return{user:a,type:"participant",addressable:!0}}),groupJid:g,participant:h},serverTs:d("WATimeUtils").castToUnixTime(j),offline:i,ack:a,id:b}}function q(a){a=d("WASmaxGroupsSubjectChangeNotificationRPC").receiveSubjectChangeNotificationRPC(a);var b=a.parsedRequest,c=b.subjectNamedSubjectOrUnnamedSubjectFallbackMixinGroup,e=b.subjectST,f=b.from,g=b.participant,h=b.offline,i=b.t;b=b.id;a=a.makeSubjectChangeNotificationResponseAck;return{action:{type:"subject",subject:c.name==="NamedSubject"?c.value.subject:null,ts:d("WATimeUtils").castToUnixTime(e),groupJid:f,participant:g},serverTs:d("WATimeUtils").castToUnixTime(i),ack:a,offline:h,id:b}}g.parseGroupNotification=a}),98);
__d("WACreateHandleGroupNotificationBranch",["Promise","WAParseGroupNotifications","WAResultOrError","WATagsLogger","WAUnknownStanzaError"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["start handling"]);i=function(){return a};return a}var j=d("WATagsLogger").TAGS(["decision tree","handleGroupNotification"]);function a(a){a=(a=a.groupMessage)!=null?a:{};var c=a.handleGroupNotification;return function(a){j.LOG(i());if(c!=null){a=d("WAParseGroupNotifications").parseGroupNotification(a);var e=a.action,f=a.ack,g=a.offline,k=a.serverTs;a=a.id;if(e.type!=="unknown")return c({makeAck:f,action:e,offline:g,serverTs:k,id:a}).then(d("WAResultOrError").makeResult)}return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError)}}g.createHandleGroupNotification=a}),98);
__d("WASmaxInAbPropsServerNotificationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"offline",0,1024);return!a.success?a:d("WAResultOrError").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);
__d("WASmaxInAbPropsRefreshRequest",["WAResultOrError","WASmaxInAbPropsServerNotificationMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"abprops");if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","server");if(!c.success)return c;var e=d("WASmaxParseJid").attrDeviceJid(a,"from");if(!e.success)return e;b=d("WASmaxParseUtils").attrIntRange(b.value,"protocol",1,10);if(!b.success)return b;a=d("WASmaxInAbPropsServerNotificationMixin").parseServerNotificationMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({type:c.value,from:e.value,abpropsProtocol:b.value},a.value))}g.parseRefreshRequest=a}),98);
__d("WASmaxOutAbPropsNotificationClientAckMixin",["WASmaxJsx","WASmaxMixins","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrDeviceJid,a,["from"]);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(b.value),to:d("WAWap").DEVICE_JID(c.value),"class":"notification",type:d("WAWap").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);
__d("WASmaxOutAbPropsRefreshResponseAck",["WASmaxJsx","WASmaxOutAbPropsNotificationClientAckMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutAbPropsNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",null),a);return a}g.makeRefreshResponseAck=a}),98);
__d("WASmaxAbPropsRefreshRPC",["WASmaxInAbPropsRefreshRequest","WASmaxOutAbPropsRefreshResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInAbPropsRefreshRequest").parseRefreshRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Refresh",{Request:b}));return{parsedRequest:b.value,makeRefreshResponseAck:function(){return d("WASmaxOutAbPropsRefreshResponseAck").makeRefreshResponseAck(a)}}}g.receiveRefreshRPC=a}),98);
__d("WASmaxInClientLogServerNotificationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"offline",0,1024);return!a.success?a:d("WAResultOrError").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);
__d("WASmaxInClientLogLogRequest",["WAResultOrError","WASmaxInClientLogServerNotificationMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"log");if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","server");if(!c.success)return c;var e=d("WASmaxParseJid").attrDeviceJid(a,"from");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,b.value,"start_t");if(!f.success)return f;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,b.value,"end_t");if(!b.success)return b;a=d("WASmaxInClientLogServerNotificationMixin").parseServerNotificationMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({type:c.value,from:e.value,logStartT:f.value,logEndT:b.value},a.value))}g.parseLogRequest=a}),98);
__d("WASmaxOutClientLogNotificationClientAckMixin",["WASmaxJsx","WASmaxMixins","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrDeviceJid,a,["from"]);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(b.value),to:d("WAWap").DEVICE_JID(c.value),"class":"notification",type:d("WAWap").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);
__d("WASmaxOutClientLogLogResponseAck",["WASmaxJsx","WASmaxOutClientLogNotificationClientAckMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutClientLogNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",null),a);return a}g.makeLogResponseAck=a}),98);
__d("WASmaxClientLogLogRPC",["WASmaxInClientLogLogRequest","WASmaxOutClientLogLogResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInClientLogLogRequest").parseLogRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Log",{Request:b}));return{parsedRequest:b.value,makeLogResponseAck:function(){return d("WASmaxOutClientLogLogResponseAck").makeLogResponseAck(a)}}}g.receiveLogRPC=a}),98);
__d("WASmaxInServerPropsServerNotificationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"offline",0,1024);return!a.success?a:d("WAResultOrError").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);
__d("WASmaxInServerPropsTriggerRefreshDeviceFromMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseJid").attrDeviceJid(a,"from");return!b.success?b:d("WAResultOrError").makeResult({from:b.value})}g.parseTriggerRefreshDeviceFromMixin=a}),98);
__d("WASmaxInServerPropsTriggerRefreshServerFromMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");return!b.success?b:d("WAResultOrError").makeResult({from:b.value})}g.parseTriggerRefreshServerFromMixin=a}),98);
__d("WASmaxInServerPropsTriggerRefreshUserFromDeprecatedMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"from");return!b.success?b:d("WAResultOrError").makeResult({from:b.value})}g.parseTriggerRefreshUserFromDeprecatedMixin=a}),98);
__d("WASmaxInServerPropsTriggerRefreshServerFromOrTriggerRefreshDeviceFromOrTriggerRefreshUserFromDeprecatedMixinGroup",["WAResultOrError","WASmaxInServerPropsTriggerRefreshDeviceFromMixin","WASmaxInServerPropsTriggerRefreshServerFromMixin","WASmaxInServerPropsTriggerRefreshUserFromDeprecatedMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInServerPropsTriggerRefreshServerFromMixin").parseTriggerRefreshServerFromMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"TriggerRefreshServerFrom",value:b.value});var c=d("WASmaxInServerPropsTriggerRefreshDeviceFromMixin").parseTriggerRefreshDeviceFromMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"TriggerRefreshDeviceFrom",value:c.value});var e=d("WASmaxInServerPropsTriggerRefreshUserFromDeprecatedMixin").parseTriggerRefreshUserFromDeprecatedMixin(a);return e.success?d("WAResultOrError").makeResult({name:"TriggerRefreshUserFromDeprecated",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ServerFrom","DeviceFrom","UserFromDeprecated"],[b,c,e])}g.parseTriggerRefreshServerFromOrTriggerRefreshDeviceFromOrTriggerRefreshUserFromDeprecatedMixinGroup=a}),98);
__d("WASmaxInServerPropsTriggerRefreshRequest",["WAResultOrError","WASmaxInServerPropsServerNotificationMixin","WASmaxInServerPropsTriggerRefreshServerFromOrTriggerRefreshDeviceFromOrTriggerRefreshUserFromDeprecatedMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"props");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","server");if(!b.success)return b;var c=d("WASmaxInServerPropsServerNotificationMixin").parseServerNotificationMixin(a);if(!c.success)return c;a=d("WASmaxInServerPropsTriggerRefreshServerFromOrTriggerRefreshDeviceFromOrTriggerRefreshUserFromDeprecatedMixinGroup").parseTriggerRefreshServerFromOrTriggerRefreshDeviceFromOrTriggerRefreshUserFromDeprecatedMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({type:b.value},c.value,{triggerRefreshServerFromOrTriggerRefreshDeviceFromOrTriggerRefreshUserFromDeprecatedMixinGroup:a.value}))}g.parseTriggerRefreshRequest=a}),98);
__d("WASmaxInServerPropsEnums",["WAJids"],(function(a,b,c,d,e,f,g){a={validators:[d("WAJids").validateDeviceJid,d("WAJids").validateDomainJid,d("WAJids").validateUserJid],typeName:"DeviceJid|DomainJid|UserJid"};g.DEVICEJID_DOMAINJID_USERJID=a}),98);
__d("WASmaxOutServerPropsNotificationClientAckMixin",["WASmaxInServerPropsEnums","WASmaxJsx","WASmaxMixins","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrJidEnum,a,["from"],d("WASmaxInServerPropsEnums").DEVICEJID_DOMAINJID_USERJID);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(b.value),to:d("WAWap").JID(c.value),"class":"notification",type:d("WAWap").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);
__d("WASmaxOutServerPropsTriggerRefreshResponseAck",["WASmaxJsx","WASmaxOutServerPropsNotificationClientAckMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutServerPropsNotificationClientAckMixin").mergeNotificationClientAckMixin(d("WASmaxJsx").smax("ack",null),a);return a}g.makeTriggerRefreshResponseAck=a}),98);
__d("WASmaxServerPropsTriggerRefreshRPC",["WASmaxInServerPropsTriggerRefreshRequest","WASmaxOutServerPropsTriggerRefreshResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInServerPropsTriggerRefreshRequest").parseTriggerRefreshRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("TriggerRefresh",{Request:b}));return{parsedRequest:b.value,makeTriggerRefreshResponseAck:function(){return d("WASmaxOutServerPropsTriggerRefreshResponseAck").makeTriggerRefreshResponseAck(a)}}}g.receiveTriggerRefreshRPC=a}),98);
__d("WACreateHandleServerNotificationBranch",["Promise","WALogger","WAResultOrError","WASmaxAbPropsRefreshRPC","WASmaxClientLogLogRPC","WASmaxDecisionTreeUtils","WASmaxServerPropsTriggerRefreshRPC","WATimeUtils","WAUnknownStanzaError"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["parseServerNotification notification without children"]);i=function(){return a};return a}function a(a){var c,e=(c=a.abprops)==null?void 0:c.handleAbPropsRefreshNotification,f=(c=a.clientLog)==null?void 0:c.handleClientLogNotification,g=(c=a.serverProps)==null?void 0:c.handleServerPropsRefreshNotification;return function(a){var c=d("WASmaxDecisionTreeUtils").firstChild(a);if(c.success===!1){d("WALogger").ERROR(i());return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError)}c=c.value.tag;switch(c){case"abprops":if(e!=null){c=d("WASmaxAbPropsRefreshRPC").receiveRefreshRPC(a);var j=c.parsedRequest;c=c.makeRefreshResponseAck;return e({serverTs:d("WATimeUtils").castToUnixTime(j.t),id:j.id,offline:j.offline,makeAck:c}).then(d("WAResultOrError").makeResult)}break;case"props":if(g!=null){j=d("WASmaxServerPropsTriggerRefreshRPC").receiveTriggerRefreshRPC(a);c=j.parsedRequest;j=j.makeTriggerRefreshResponseAck;return g({serverTs:d("WATimeUtils").castToUnixTime(c.t),id:c.id,offline:c.offline,makeAck:j}).then(d("WAResultOrError").makeResult)}break;case"log":if(f!=null){c=d("WASmaxClientLogLogRPC").receiveLogRPC(a);j=c.parsedRequest;a=c.makeLogResponseAck;return f({serverTs:d("WATimeUtils").castToUnixTime(j.t),id:j.id,offline:j.offline,makeAck:a}).then(d("WAResultOrError").makeResult)}break}return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError)}}g.createHandleServerNotification=a}),98);
__d("WASmaxInSyncdServerNotificationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!c.success)return c;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"offline",0,1024);return!a.success?a:d("WAResultOrError").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);
__d("WASmaxInSyncdNewPatchRequest",["WAResultOrError","WASmaxInSyncdServerNotificationMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"collection");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"name");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(a,"version",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({name:b.value,version:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notification");if(!b.success)return b;b=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","server_sync");if(!c.success)return c;var e=d("WASmaxInSyncdServerNotificationMixin").parseServerNotificationMixin(a);if(!e.success)return e;a=d("WASmaxParseUtils").mapChildrenWithTag(a,"collection",1,20,h);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({from:b.value,type:c.value},e.value,{collection:a.value}))}g.parseNewPatchRequestCollection=h;g.parseNewPatchRequest=a}),98);
__d("WASmaxOutSyncdNewPatchResponseClientAck",["WASmaxJsx","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrDomainJid,a,["from"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{"class":"notification",type:"server_sync",to:d("WAWap").DOMAIN_JID(b.value),id:d("WAWap").STANZA_ID(a.value)});return b}g.makeNewPatchResponseClientAck=a}),98);
__d("WASmaxSyncdNewPatchRPC",["WASmaxInSyncdNewPatchRequest","WASmaxOutSyncdNewPatchResponseClientAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInSyncdNewPatchRequest").parseNewPatchRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("NewPatch",{Request:b}));return{parsedRequest:b.value,makeNewPatchResponseClientAck:function(){return d("WASmaxOutSyncdNewPatchResponseClientAck").makeNewPatchResponseClientAck(a)}}}g.receiveNewPatchRPC=a}),98);
__d("WACreateHandleServerSyncNotificationBranch",["Promise","WALogger","WAResultOrError","WASmaxSyncdNewPatchRPC","WASyncdConst","WATimeUtils","WAUnknownStanzaError"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleServerSyncNotification: Incorrect collection notification"]);i=function(){return a};return a}function a(a){var c=(a=a.syncd)==null?void 0:a.handleSyncdNewPatchNotification;return function(a){if(c==null)return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError);a=d("WASmaxSyncdNewPatchRPC").receiveNewPatchRPC(a);var e=a.parsedRequest,f=e.collection,g=e.offline,j=e.t;e=e.id;a=a.makeNewPatchResponseClientAck;f=new Map(f.map(function(a){var b=a.name;a=a.version;b=d("WASyncdConst").CollectionName.cast(b);if(b==null)d("WALogger").ERROR(i());else return[b,a]}).filter(Boolean));return c({makeAck:a,collections:f,offline:g,id:e,serverTs:d("WATimeUtils").castToUnixTime(j)}).then(d("WAResultOrError").makeResult)}}g.createHandleServerSyncNotification=a}),98);
__d("WARuntimeError",["WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return d("WAResultOrError").makeError({type:"runtime-error",error:a})}g.runtimeError=a}),98);
__d("WACreateHandleNotification",["Promise","WACreateHandleAccountSyncNotificationBranch","WACreateHandleDevicesNotificationBranch","WACreateHandleEncryptNotificationBranch","WACreateHandleFbDeviceChangeNotificationBranch","WACreateHandleFbMultiwayNotificationBranch","WACreateHandleFbThreadNotificationBranch","WACreateHandleGroupNotificationBranch","WACreateHandleServerNotificationBranch","WACreateHandleServerSyncNotificationBranch","WAResultOrError","WARuntimeError","WASmaxNotificationFallbackGenericNotificationRPC","WASmaxParseUtils","WASmaxParsingFailure","WATagsLogger","WAUnknownStanzaError"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["runtime-error: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["runtime-error: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["received unknown notifcation: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["start handling"]);l=function(){return a};return a}var m={encrypt:"encrypt","w:gp2":"w:gp2",server:"server",server_sync:"server_sync","fbid:devices":"fbid:devices","fbid:thread":"fbid:thread","fb:multiway":"fb:multiway",mediaretry:"mediaretry",picture:"picture",business:"business",contacts:"contacts",devices:"devices",disappearing_mode:"disappearing_mode",status:"status",account_sync:"account_sync",pay:"pay",psa:"psa",privacy_token:"privacy_token",link_code_companion_reg:"link_code_companion_reg"},n=d("WATagsLogger").TAGS(["decision tree","handleNotification"]);function a(a){var c=d("WACreateHandleEncryptNotificationBranch").createHandleEncryptNotification(a),e=d("WACreateHandleServerNotificationBranch").createHandleServerNotification(a),f=d("WACreateHandleServerSyncNotificationBranch").createHandleServerSyncNotification(a),g=d("WACreateHandleGroupNotificationBranch").createHandleGroupNotification(a),o=d("WACreateHandleAccountSyncNotificationBranch").createHandleAccountSyncNotification(a),p=d("WACreateHandleDevicesNotificationBranch").createHandleDevicesNotification(a);return function(q,r,s){n.DEV(l());var t=d("WASmaxParseUtils").attrStringEnum(q,"type",m);return(h||(h=b("Promise"))).resolve().then(function(){if(!t.success)return d("WAUnknownStanzaError").unknownStanzaError;var b=t.value;switch(b){case"fbid:devices":var h;h=(h=a.fb)==null?void 0:h.handleFbDeviceChangeNotification;if(h)return d("WACreateHandleFbDeviceChangeNotificationBranch").createHandleFbDeviceChangeNotification(h)(q,s);break;case"fbid:thread":h=(h=a.fb)==null?void 0:h.handleFbThreadNotification;if(h)return d("WACreateHandleFbThreadNotificationBranch").createHandleFbThreadNotification(h)(q);break;case"fb:multiway":h=(h=a.fb)==null?void 0:h.handleFbMultiwayNotification;if(h)return d("WACreateHandleFbMultiwayNotificationBranch").createHandleFbMultiwayNotification(h)(q);break;case"encrypt":return c(q);case"server":return e(q);case"server_sync":return f(q);case"w:gp2":return g(q);case"devices":return p(q);case"account_sync":return o(q);case"mediaretry":break;case"picture":break;case"business":break;case"contacts":break;case"disappearing_mode":break;case"status":break;case"pay":break;case"psa":break;case"privacy_token":break;case"link_code_companion_reg":break;default:b}return d("WAUnknownStanzaError").unknownStanzaError})["catch"](function(a){return a instanceof d("WASmaxParsingFailure").SmaxParsingFailure?d("WAUnknownStanzaError").unknownStanzaError:d("WARuntimeError").runtimeError(a)}).then(function(a){if(a.success)return a;var b=d("WASmaxNotificationFallbackGenericNotificationRPC").receiveGenericNotificationRPC(q),c=b.makeGenericNotificationResponseAck;b=b.makeGenericNotificationResponseBadStanza;if(a.error.type==="unknown-stanza"){n.WARN(k(),q.toString());return d("WAResultOrError").makeResult(b({ackError:487}))}else{a.error.type;n.WARN(j(),a.error.error.message);n.ERROR(i(),a.error.error);return d("WAResultOrError").makeResult(c())}})}}g.createHandleNotification=a}),98);
__d("WAMapMixinNameToReceiptType",[],(function(a,b,c,d,e,f){var g={SenderType:"sender",ReadType:"read",InactiveType:"inactive",ReadSelfType:"read-self"};function a(a){return g[a]}f.mapMixinNameToReceiptType=a}),66);
__d("WAParseKeyBundleMixing",["WAParsableXmlNode","WASignalKeys"],(function(a,b,c,d,e,f,g){function a(a,b){return{regId:a,identity:d("WASignalKeys").serializeIdentity(b.keysIdentityKeyMixin.elementValue),signedKey:{id:d("WAParsableXmlNode").convertBytesToUint(b.keysSignedPreKeyMixin.skeyIdKeyIDMixin.elementValue,3),publicKey:d("WASignalKeys").serializeIdentity(b.keysSignedPreKeyMixin.skeyValueKeyDataMixin.elementValue),signature:b.keysSignedPreKeyMixin.skeySignatureElementValue},oneTimeKey:null}}g.parseKeyBundleMixin=a}),98);
__d("WATransformToRetryReceipt",["WAParseKeyBundleMixing","WASignalOther","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){var b=a.aggregate,c=a.retryMixin,e=a.recipient;a=a.offline;var f=c.keyBundleMixin,g=c.registrationElementValue,h=c.retryCount,i=c.retryId,j=c.retryT;c.retryV;c.type;c=d("WASignalOther").castRegistrationIdFromBytes(g);return{stanzaId:b.stanzaId,retryStanzaId:i,receiptSender:b.receiptSender,retryCount:h,regId:c,offline:a,timestamp:d("WATimeUtils").castToUnixTime(j),keys:f?d("WAParseKeyBundleMixing").parseKeyBundleMixin(c,f):null,recipient:e}};g.transformToRetryReceipt=a}),98);
__d("WACreateHandleGroupReceiptBranch",["Promise","WAMapMixinNameToReceiptType","WAResultOrError","WATagsLogger","WATransformToRetryReceipt"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleGroupReceipt: receipt type "," is not handled yet"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["retry receipt not supported for aggregated messages"]);j=function(){return a};return a}var k=d("WATagsLogger").TAGS(["decision tree","handleGroupReceiptBranch"]);function a(a){var c=a.handleGroupReceipt,e=a.handleGroupRetryReceipt;return function(a){var f=a.from,g=a.aggregate,l=a.receiptType,m=a.makeAck,n=a.offline,o=a.serverTs,p=a.recipient;a=a.socketId;f=f;n=(n=n)!=null?n:null;if(l==null){var q=p==null?"@me":p;if(c!=null)return c(babelHelpers["extends"]({makeAck:m,author:q,chat:f,offline:n,serverTs:o},g,{receiptType:"delivered"})).then(d("WAResultOrError").makeResult)}else{q=p==null?"@me":l.name==="SenderType"||l.name==="ReadSelfType"?"@me":p;switch(l.name){case"ReadType":case"SenderType":case"InactiveType":case"ReadSelfType":if(c!=null)return c(babelHelpers["extends"]({makeAck:m,author:q,chat:f,offline:n,serverTs:o},g,{receiptType:d("WAMapMixinNameToReceiptType").mapMixinNameToReceiptType(l.name)})).then(d("WAResultOrError").makeResult);break;case"Retry":if(g.aggregatedType!=="none"){k.ERROR(j());return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult(m()))}if(e!=null){g=d("WATransformToRetryReceipt").transformToRetryReceipt({aggregate:g,retryMixin:l.value,recipient:p,offline:n});return e({receiptType:"retry",retryReceipt:g,makeAck:m,author:q,chat:f,offline:n,serverTs:o,socketId:a}).then(d("WAResultOrError").makeResult)}break;case"PlayedType":case"DeliverBizType":case"PlayedSelfType":case"ServerErrorType":case"DeliverLIDFeatureIncapableType":case"EngagedType":case"DeliverMdDowngradeType":case"ViewType":case"DeprecatedDeliveryType":case"UnknownType":k.ERROR(i(),l.name);break;default:l.name}}return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult(m()))}}g.createHandleGroupReceiptBranch=a}),98);
__d("WACreateHandleIndividualReceiptBranch",["Promise","WAJids","WAMapMixinNameToReceiptType","WAResultOrError","WATagsLogger","WATransformToRetryReceipt"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleIndividualReceipt: receipt type "," is not handled yet"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["retry receipt not supported for aggregated messages"]);j=function(){return a};return a}var k=d("WATagsLogger").TAGS(["decision tree","handleIndividualMessageBranch"]);function a(a){var c=a.handleIndividualReceipt,e=a.handleIndividualRetryReceipt;return function(a){var f=a.aggregate,g=a.receiptType,l=a.makeAck,m=a.offline,n=a.serverTs,o=a.recipient;a=a.socketId;m=(m=m)!=null?m:null;var p=f.receiptSender;p=o==null?d("WAJids").extractUserJid(p):o;if(g==null){var q=o==null?"@me":o;if(c!=null)return c(babelHelpers["extends"]({makeAck:l,author:q,chat:p,offline:m,serverTs:n},f,{receiptType:"delivered"})).then(d("WAResultOrError").makeResult)}else{q=o==null?"@me":g.name==="SenderType"||g.name==="ReadSelfType"?"@me":o;switch(g.name){case"ReadType":case"SenderType":case"InactiveType":case"ReadSelfType":if(c!=null)return c(babelHelpers["extends"]({makeAck:l,author:q,chat:p,offline:m,serverTs:n},f,{receiptType:d("WAMapMixinNameToReceiptType").mapMixinNameToReceiptType(g.name)})).then(d("WAResultOrError").makeResult);break;case"Retry":if(f.aggregatedType!=="none"){k.ERROR(j());return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult(l()))}if(e!=null){f=d("WATransformToRetryReceipt").transformToRetryReceipt({aggregate:f,retryMixin:g.value,recipient:o,offline:m});return e({receiptType:"retry",retryReceipt:f,makeAck:l,author:q,chat:p,offline:m,serverTs:n,socketId:a}).then(d("WAResultOrError").makeResult)}break;case"PlayedType":case"DeliverBizType":case"PlayedSelfType":case"ServerErrorType":case"DeliverLIDFeatureIncapableType":case"EngagedType":case"DeliverMdDowngradeType":case"ViewType":case"DeprecatedDeliveryType":case"UnknownType":k.ERROR(i(),g.name);break;default:g.name}}return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult(l()))}}g.createHandleIndividualReceiptBranch=a}),98);
__d("WASmaxInReceiptAppDataPeerCategoryMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"category","peer_appdata");return!b.success?b:d("WAResultOrError").makeResult({category:b.value})}g.parseAppDataPeerCategoryMixin=a}),98);
__d("WASmaxInReceiptDeliverAppDataPeerPeerDeliveryMixin",["WASmaxInReceiptAppDataPeerCategoryMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptAppDataPeerCategoryMixin").parseAppDataPeerCategoryMixin(a);return!b.success?b:b}g.parseDeliverAppDataPeerPeerDeliveryMixin=a}),98);
__d("WASmaxInReceiptRetryTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"retry");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","retry");if(!a.success)return a;var c=d("WASmaxParseUtils").attrStanzaId(b.value,"id");if(!c.success)return c;var e=d("WASmaxParseUtils").attrIntRange(b.value,"count",1,256);if(!e.success)return e;var f=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,b.value,"v","1");if(!f.success)return f;var g=d("WASmaxParseUtils").attrIntRange(b.value,"t",0,void 0);if(!g.success)return g;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,b.value,"error",0,1024);return!b.success?b:d("WAResultOrError").makeResult({type:a.value,retryId:c.value,retryCount:e.value,retryV:f.value,retryT:g.value,retryError:b.value})}g.parseRetryTypeMixin=a}),98);
__d("WASmaxInReceiptAppDataPeerRetryTypeMixin",["WAResultOrError","WASmaxInReceiptAppDataPeerCategoryMixin","WASmaxInReceiptRetryTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptRetryTypeMixin").parseRetryTypeMixin(a);if(!b.success)return b;a=d("WASmaxInReceiptAppDataPeerCategoryMixin").parseAppDataPeerCategoryMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,a.value))}g.parseAppDataPeerRetryTypeMixin=a}),98);
__d("WASmaxInReceiptDeviceIdentityMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"device-identity");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytes(a.value);return!a.success?a:d("WAResultOrError").makeResult({deviceIdentityElementValue:a.value})}g.parseDeviceIdentityMixin=a}),98);
__d("WASmaxInReceiptKeyDataMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").contentBytesRange(a,32,32);return!a.success?a:d("WAResultOrError").makeResult({elementValue:a.value})}g.parseKeyDataMixin=a}),98);
__d("WASmaxInReceiptIdentityKeyMixin",["WASmaxInReceiptKeyDataMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"identity");if(!a.success)return a;a=d("WASmaxInReceiptKeyDataMixin").parseKeyDataMixin(a.value);return!a.success?a:a}g.parseIdentityKeyMixin=a}),98);
__d("WASmaxInReceiptKeyTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"type");if(!a.success)return a;a=d("WASmaxParseUtils").contentLiteralBytes(a.value,new Uint8Array([5]));return!a.success?a:d("WAResultOrError").makeResult({typeElementValue:a.value})}g.parseKeyTypeMixin=a}),98);
__d("WASmaxInReceiptKeyIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"id");if(!b.success)return b;b=d("WASmaxParseUtils").contentBytesRange(a,3,3);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}g.parseKeyIDMixin=a}),98);
__d("WASmaxInReceiptPreKeyMixin",["WAResultOrError","WASmaxInReceiptKeyDataMixin","WASmaxInReceiptKeyIDMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"key");if(!a.success)return a;var b=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"id");if(!b.success)return b;a=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"value");if(!a.success)return a;b=d("WASmaxInReceiptKeyIDMixin").parseKeyIDMixin(b.value);if(!b.success)return b;a=d("WASmaxInReceiptKeyDataMixin").parseKeyDataMixin(a.value);return!a.success?a:d("WAResultOrError").makeResult({keyIdKeyIDMixin:b.value,keyValueKeyDataMixin:a.value})}g.parsePreKeyMixin=a}),98);
__d("WASmaxInReceiptSignedPreKeyMixin",["WAResultOrError","WASmaxInReceiptKeyDataMixin","WASmaxInReceiptKeyIDMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"skey");if(!a.success)return a;var b=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"id");if(!b.success)return b;var c=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"value");if(!c.success)return c;a=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"signature");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytesRange(a.value,64,64);if(!a.success)return a;b=d("WASmaxInReceiptKeyIDMixin").parseKeyIDMixin(b.value);if(!b.success)return b;c=d("WASmaxInReceiptKeyDataMixin").parseKeyDataMixin(c.value);return!c.success?c:d("WAResultOrError").makeResult({skeySignatureElementValue:a.value,skeyIdKeyIDMixin:b.value,skeyValueKeyDataMixin:c.value})}g.parseSignedPreKeyMixin=a}),98);
__d("WASmaxInReceiptKeyBundleMixin",["WAResultOrError","WASmaxInReceiptDeviceIdentityMixin","WASmaxInReceiptIdentityKeyMixin","WASmaxInReceiptKeyTypeMixin","WASmaxInReceiptPreKeyMixin","WASmaxInReceiptSignedPreKeyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"keys");if(!b.success)return b;a=d("WASmaxInReceiptKeyTypeMixin").parseKeyTypeMixin(b.value);if(!a.success)return a;var c=d("WASmaxInReceiptIdentityKeyMixin").parseIdentityKeyMixin(b.value);if(!c.success)return c;var e=d("WASmaxInReceiptSignedPreKeyMixin").parseSignedPreKeyMixin(b.value);if(!e.success)return e;var f=d("WASmaxInReceiptPreKeyMixin").parsePreKeyMixin(b.value);if(!f.success)return f;b=d("WASmaxInReceiptDeviceIdentityMixin").parseDeviceIdentityMixin(b.value);return d("WAResultOrError").makeResult({keysKeyTypeMixin:a.value,keysIdentityKeyMixin:c.value,keysSignedPreKeyMixin:e.value,keysPreKeyMixin:f.value,keysDeviceIdentityMixin:b.success?b.value:null})}g.parseKeyBundleMixin=a}),98);
__d("WASmaxInReceiptRegistrationIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"registration");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytesRange(a.value,4,4);return!a.success?a:d("WAResultOrError").makeResult({registrationElementValue:a.value})}g.parseRegistrationIDMixin=a}),98);
__d("WASmaxInReceiptDeliverAppDataPeerPeerRetryMixin",["WAResultOrError","WASmaxInReceiptAppDataPeerRetryTypeMixin","WASmaxInReceiptKeyBundleMixin","WASmaxInReceiptRegistrationIDMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptAppDataPeerRetryTypeMixin").parseAppDataPeerRetryTypeMixin(a);if(!b.success)return b;var c=d("WASmaxInReceiptRegistrationIDMixin").parseRegistrationIDMixin(a);if(!c.success)return c;a=d("WASmaxInReceiptKeyBundleMixin").parseKeyBundleMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,c.value,{keyBundleMixin:a.success?a.value:null}))}g.parseDeliverAppDataPeerPeerRetryMixin=a}),98);
__d("WASmaxInReceiptPeerDeliverAppDataPeerRetryOrDeliverAppDataPeerDeliveryMixinGroup",["WAResultOrError","WASmaxInReceiptDeliverAppDataPeerPeerDeliveryMixin","WASmaxInReceiptDeliverAppDataPeerPeerRetryMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptDeliverAppDataPeerPeerRetryMixin").parseDeliverAppDataPeerPeerRetryMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"DeliverAppDataPeerPeerRetry",value:b.value});var c=d("WASmaxInReceiptDeliverAppDataPeerPeerDeliveryMixin").parseDeliverAppDataPeerPeerDeliveryMixin(a);return c.success?d("WAResultOrError").makeResult({name:"DeliverAppDataPeerPeerDelivery",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["PeerRetry","PeerDelivery"],[b,c])}g.parsePeerDeliverAppDataPeerRetryOrDeliverAppDataPeerDeliveryMixinGroup=a}),98);
__d("WASmaxInReceiptDeliverAppDataPeerRequest",["WAResultOrError","WASmaxInReceiptPeerDeliverAppDataPeerRetryOrDeliverAppDataPeerDeliveryMixinGroup","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!b.success)return b;var c=d("WASmaxParseJid").attrDeviceJid(a,"from");if(!c.success)return c;a=d("WASmaxInReceiptPeerDeliverAppDataPeerRetryOrDeliverAppDataPeerDeliveryMixinGroup").parsePeerDeliverAppDataPeerRetryOrDeliverAppDataPeerDeliveryMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({id:b.value,from:c.value,peerDeliverAppDataPeerRetryOrDeliverAppDataPeerDeliveryMixinGroup:a.value})}g.parseDeliverAppDataPeerRequest=a}),98);
__d("WASmaxOutReceiptDeliverAppDataPeerResponseSuccess",["WASmaxAttrs","WASmaxJsx","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrDeviceJid,a,["from"]);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(b.value),"class":"receipt",to:d("WAWap").DEVICE_JID(c.value),type:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a.value)});return b}g.makeDeliverAppDataPeerResponseSuccess=a}),98);
__d("WASmaxReceiptDeliverAppDataPeerRPC",["WASmaxInReceiptDeliverAppDataPeerRequest","WASmaxOutReceiptDeliverAppDataPeerResponseSuccess","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptDeliverAppDataPeerRequest").parseDeliverAppDataPeerRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("DeliverAppDataPeer",{Request:b}));return{parsedRequest:b.value,makeDeliverAppDataPeerResponseSuccess:function(){return d("WASmaxOutReceiptDeliverAppDataPeerResponseSuccess").makeDeliverAppDataPeerResponseSuccess(a)}}}g.receiveDeliverAppDataPeerRPC=a}),98);
__d("WACreateHandlePeerAppdataReceiptBranch",["Promise","WAParseKeyBundleMixing","WAResultOrError","WASignalOther","WASmaxReceiptDeliverAppDataPeerRPC","WATagsLogger","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Peer appdata receipt is not handled."]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["start..."]);j=function(){return a};return a}var k=d("WATagsLogger").TAGS(["decision tree","handlePeerAppdataReceiptBranch"]);function a(a){var c=a.handlePeerAppdataReceipt,e=a.handlePeerAppdataRetryReceipt;return function(a,f){k.DEV(j());a=d("WASmaxReceiptDeliverAppDataPeerRPC").receiveDeliverAppDataPeerRPC(a);var g=a.parsedRequest,l=g.id,m=g.from;g=g.peerDeliverAppDataPeerRetryOrDeliverAppDataPeerDeliveryMixinGroup;a=a.makeDeliverAppDataPeerResponseSuccess;switch(g.name){case"DeliverAppDataPeerPeerDelivery":if(c!=null)return c({receiptType:"delivered",stanzaId:l,receiptSender:m,makeAck:a}).then(d("WAResultOrError").makeResult);break;case"DeliverAppDataPeerPeerRetry":if(e!=null){var n=g.value,o=n.keyBundleMixin,p=n.registrationElementValue,q=n.retryCount,r=n.retryId,s=n.retryT;n=n.category;p=d("WASignalOther").castRegistrationIdFromBytes(p);return e({receiptType:"retry",category:n,retryReceipt:{stanzaId:l,retryStanzaId:r,receiptSender:m,retryCount:q,regId:p,timestamp:d("WATimeUtils").castToUnixTime(s),keys:o?d("WAParseKeyBundleMixing").parseKeyBundleMixin(p,o):null},makeAck:a,socketId:f}).then(d("WAResultOrError").makeResult)}break;default:g.name}k.WARN(i());return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult(a()))}}g.createHandlePeerAppdataReceiptBranch=a}),98);
__d("WASmaxInReceiptPeerMessageTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","peer_msg");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parsePeerMessageTypeMixin=a}),98);
__d("WASmaxInReceiptSingleMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").attrStanzaId(a,"id");return!b.success?b:d("WAResultOrError").makeResult({id:b.value})}g.parseSingleMixin=a}),98);
__d("WASmaxInReceiptDeliverPeerDeliveryMixin",["WAResultOrError","WASmaxInReceiptPeerMessageTypeMixin","WASmaxInReceiptSingleMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptSingleMixin").parseSingleMixin(a);if(!b.success)return b;a=d("WASmaxInReceiptPeerMessageTypeMixin").parsePeerMessageTypeMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,a.value))}g.parseDeliverPeerDeliveryMixin=a}),98);
__d("WASmaxInReceiptHSMErrorTypeMixin",["WAResultOrError","WASmaxInReceiptEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");if(!a.success)return a;var c=d("WASmaxParseUtils").attrStringEnum(b.value,"type",d("WASmaxInReceiptEnums").ENUM_HSMENVELOPEMISMATCH_STRUCTUREUNAVAILABLE);if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,b.value,"reason",d("WASmaxInReceiptEnums").ENUM_1002_1007_1008);if(!e.success)return e;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,b.value,"sub_type",d("WASmaxInReceiptEnums").ENUM_CONTENT_TITLE);return!b.success?b:d("WAResultOrError").makeResult({type:a.value,errorType:c.value,errorReason:e.value,errorSubType:b.value})}g.parseHSMErrorTypeMixin=a}),98);
__d("WASmaxInReceiptDeliverPeerErrorMixin",["WAResultOrError","WASmaxInReceiptHSMErrorTypeMixin","WASmaxInReceiptSingleMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptSingleMixin").parseSingleMixin(a);if(!b.success)return b;a=d("WASmaxInReceiptHSMErrorTypeMixin").parseHSMErrorTypeMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,a.value))}g.parseDeliverPeerErrorMixin=a}),98);
__d("WASmaxInReceiptPeerCategoryMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"category","peer");return!b.success?b:d("WAResultOrError").makeResult({category:b.value})}g.parsePeerCategoryMixin=a}),98);
__d("WASmaxInReceiptPeerRetryTypeMixin",["WAResultOrError","WASmaxInReceiptPeerCategoryMixin","WASmaxInReceiptRetryTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptRetryTypeMixin").parseRetryTypeMixin(a);if(!b.success)return b;a=d("WASmaxInReceiptPeerCategoryMixin").parsePeerCategoryMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,a.value))}g.parsePeerRetryTypeMixin=a}),98);
__d("WASmaxInReceiptDeliverPeerPeerRetryMixin",["WAResultOrError","WASmaxInReceiptKeyBundleMixin","WASmaxInReceiptPeerRetryTypeMixin","WASmaxInReceiptRegistrationIDMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptPeerRetryTypeMixin").parsePeerRetryTypeMixin(a);if(!b.success)return b;var c=d("WASmaxInReceiptRegistrationIDMixin").parseRegistrationIDMixin(a);if(!c.success)return c;a=d("WASmaxInReceiptKeyBundleMixin").parseKeyBundleMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,c.value,{keyBundleMixin:a.success?a.value:null}))}g.parseDeliverPeerPeerRetryMixin=a}),98);
__d("WASmaxInReceiptHistorySyncTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","hist_sync");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseHistorySyncTypeMixin=a}),98);
__d("WASmaxInReceiptOfflineMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrIntRange(a,"offline",0,12);return!a.success?a:d("WAResultOrError").makeResult({offline:a.value})}g.parseOfflineMixin=a}),98);
__d("WASmaxInReceiptDeliverPeerReadMixin",["WAResultOrError","WASmaxInReceiptHistorySyncTypeMixin","WASmaxInReceiptOfflineMixin","WASmaxInReceiptSingleMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptSingleMixin").parseSingleMixin(a);if(!b.success)return b;var c=d("WASmaxInReceiptHistorySyncTypeMixin").parseHistorySyncTypeMixin(a);if(!c.success)return c;a=d("WASmaxInReceiptOfflineMixin").parseOfflineMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,c.value,{offlineMixin:a.success?a.value:null}))}g.parseDeliverPeerReadMixin=a}),98);
__d("WASmaxInReceiptDeprecatedEmptyMixin",["WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"empty");return!b.success?b:d("WASmaxParseUtils").voidSuccess}g.parseDeprecatedEmptyMixin=a}),98);
__d("WASmaxInReceiptEncryptMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"encrypt");if(!b.success)return b;a=d("WASmaxParseUtils").flattenedChildWithTag(b.value,"enc_p");if(!a.success)return a;b=d("WASmaxParseUtils").flattenedChildWithTag(b.value,"enc_iv");if(!b.success)return b;a=d("WASmaxParseUtils").contentBytesRange(a.value,1,600);if(!a.success)return a;b=d("WASmaxParseUtils").contentBytesRange(b.value,12,12);return!b.success?b:d("WAResultOrError").makeResult({encryptEncPElementValue:a.value,encryptEncIvElementValue:b.value})}g.parseEncryptMixin=a}),98);
__d("WASmaxInReceiptRmrBroadcastDeprecatedMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"rmr");if(!b.success)return b;b=d("WASmaxParseJid").attrBroadcastJid(a,"jid");return!b.success?b:d("WAResultOrError").makeResult({jid:b.value})}g.parseRmrBroadcastDeprecatedMixin=a}),98);
__d("WASmaxInReceiptRmrBroadcastMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"rmr");if(!b.success)return b;b=d("WASmaxParseJid").attrBroadcastJid(a,"jid");if(!b.success)return b;a=d("WASmaxParseJid").attrUserJid(a,"participant");return!a.success?a:d("WAResultOrError").makeResult({jid:b.value,participant:a.value})}g.parseRmrBroadcastMixin=a}),98);
__d("WASmaxInReceiptRmrGroupDeprecatedMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"rmr");if(!b.success)return b;b=d("WASmaxParseJid").attrGroupJid(a,"jid");return!b.success?b:d("WAResultOrError").makeResult({jid:b.value})}g.parseRmrGroupDeprecatedMixin=a}),98);
__d("WASmaxInReceiptRmrGroupMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"rmr");if(!b.success)return b;b=d("WASmaxParseJid").attrGroupJid(a,"jid");if(!b.success)return b;a=d("WASmaxParseJid").attrUserJid(a,"participant");return!a.success?a:d("WAResultOrError").makeResult({jid:b.value,participant:a.value})}g.parseRmrGroupMixin=a}),98);
__d("WASmaxInReceiptRmrIndividualDeprecatedMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"rmr");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"jid");if(!b.success)return b;a=d("WASmaxParseJid").attrUserJid(a,"participant");return!a.success?a:d("WAResultOrError").makeResult({jid:b.value,participant:a.value})}g.parseRmrIndividualDeprecatedMixin=a}),98);
__d("WASmaxInReceiptRmrIndividualMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"rmr");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"jid");return!b.success?b:d("WAResultOrError").makeResult({jid:b.value})}g.parseRmrIndividualMixin=a}),98);
__d("WASmaxInReceiptRmrBroadcastOrGroupOrIndividualDeprecatedOrIndividualOrGroupDeprecatedOrBroadcastDeprecatedMixinGroup",["WAResultOrError","WASmaxInReceiptRmrBroadcastDeprecatedMixin","WASmaxInReceiptRmrBroadcastMixin","WASmaxInReceiptRmrGroupDeprecatedMixin","WASmaxInReceiptRmrGroupMixin","WASmaxInReceiptRmrIndividualDeprecatedMixin","WASmaxInReceiptRmrIndividualMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptRmrBroadcastMixin").parseRmrBroadcastMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"RmrBroadcast",value:b.value});var c=d("WASmaxInReceiptRmrGroupMixin").parseRmrGroupMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"RmrGroup",value:c.value});var e=d("WASmaxInReceiptRmrIndividualDeprecatedMixin").parseRmrIndividualDeprecatedMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"RmrIndividualDeprecated",value:e.value});var f=d("WASmaxInReceiptRmrIndividualMixin").parseRmrIndividualMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"RmrIndividual",value:f.value});var g=d("WASmaxInReceiptRmrGroupDeprecatedMixin").parseRmrGroupDeprecatedMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"RmrGroupDeprecated",value:g.value});var h=d("WASmaxInReceiptRmrBroadcastDeprecatedMixin").parseRmrBroadcastDeprecatedMixin(a);return h.success?d("WAResultOrError").makeResult({name:"RmrBroadcastDeprecated",value:h.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["RmrBroadcast","RmrGroup","RmrIndividualDeprecated","RmrIndividual","RmrGroupDeprecated","RmrBroadcastDeprecated"],[b,c,e,f,g,h])}g.parseRmrBroadcastOrGroupOrIndividualDeprecatedOrIndividualOrGroupDeprecatedOrBroadcastDeprecatedMixinGroup=a}),98);
__d("WASmaxInReceiptServerErrorTypeMixin",["WAResultOrError","WASmaxInReceiptDeprecatedEmptyMixin","WASmaxInReceiptEncryptMixin","WASmaxInReceiptEnums","WASmaxInReceiptRmrBroadcastOrGroupOrIndividualDeprecatedOrIndividualOrGroupDeprecatedOrBroadcastDeprecatedMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"rmr");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"from_me",d("WASmaxInReceiptEnums").ENUM_FALSE_TRUE);if(!b.success)return b;a=d("WASmaxInReceiptRmrBroadcastOrGroupOrIndividualDeprecatedOrIndividualOrGroupDeprecatedOrBroadcastDeprecatedMixinGroup").parseRmrBroadcastOrGroupOrIndividualDeprecatedOrIndividualOrGroupDeprecatedOrBroadcastDeprecatedMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({fromMe:b.value,rmrBroadcastOrGroupOrIndividualDeprecatedOrIndividualOrGroupDeprecatedOrBroadcastDeprecatedMixinGroup:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"rmr",h);if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","server-error");if(!c.success)return c;var e=d("WASmaxInReceiptDeprecatedEmptyMixin").parseDeprecatedEmptyMixin(a);a=d("WASmaxInReceiptEncryptMixin").parseEncryptMixin(a);return d("WAResultOrError").makeResult({type:c.value,hasDeprecatedEmptyMixin:e.success,encryptMixin:a.success?a.value:null,rmr:b.value})}g.parseServerErrorTypeRmr=h;g.parseServerErrorTypeMixin=a}),98);
__d("WASmaxInReceiptPeerServerErrorTypeMixin",["WAResultOrError","WASmaxInReceiptPeerCategoryMixin","WASmaxInReceiptServerErrorTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptServerErrorTypeMixin").parseServerErrorTypeMixin(a);if(!b.success)return b;a=d("WASmaxInReceiptPeerCategoryMixin").parsePeerCategoryMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,a.value))}g.parsePeerServerErrorTypeMixin=a}),98);
__d("WASmaxInReceiptDeliverPeerServerErrorMixin",["WAResultOrError","WASmaxInReceiptPeerServerErrorTypeMixin","WASmaxInReceiptSingleMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptSingleMixin").parseSingleMixin(a);if(!b.success)return b;a=d("WASmaxInReceiptPeerServerErrorTypeMixin").parsePeerServerErrorTypeMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,a.value))}g.parseDeliverPeerServerErrorMixin=a}),98);
__d("WASmaxInReceiptDeliverPeerPeerRetryOrDeliverPeerReadOrDeliverPeerServerErrorOrDeliverPeerErrorOrDeliverPeerDeliveryMixinGroup",["WAResultOrError","WASmaxInReceiptDeliverPeerDeliveryMixin","WASmaxInReceiptDeliverPeerErrorMixin","WASmaxInReceiptDeliverPeerPeerRetryMixin","WASmaxInReceiptDeliverPeerReadMixin","WASmaxInReceiptDeliverPeerServerErrorMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptDeliverPeerPeerRetryMixin").parseDeliverPeerPeerRetryMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"DeliverPeerPeerRetry",value:b.value});var c=d("WASmaxInReceiptDeliverPeerReadMixin").parseDeliverPeerReadMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"DeliverPeerRead",value:c.value});var e=d("WASmaxInReceiptDeliverPeerServerErrorMixin").parseDeliverPeerServerErrorMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"DeliverPeerServerError",value:e.value});var f=d("WASmaxInReceiptDeliverPeerErrorMixin").parseDeliverPeerErrorMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"DeliverPeerError",value:f.value});var g=d("WASmaxInReceiptDeliverPeerDeliveryMixin").parseDeliverPeerDeliveryMixin(a);return g.success?d("WAResultOrError").makeResult({name:"DeliverPeerDelivery",value:g.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["PeerRetry","Read","ServerError","Error","Delivery"],[b,c,e,f,g])}g.parseDeliverPeerPeerRetryOrDeliverPeerReadOrDeliverPeerServerErrorOrDeliverPeerErrorOrDeliverPeerDeliveryMixinGroup=a}),98);
__d("WASmaxInReceiptDeliverPeerRequest",["WAResultOrError","WASmaxInReceiptDeliverPeerPeerRetryOrDeliverPeerReadOrDeliverPeerServerErrorOrDeliverPeerErrorOrDeliverPeerDeliveryMixinGroup","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!b.success)return b;var c=d("WASmaxParseJid").attrDeviceJid(a,"from");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"t",0,void 0);if(!e.success)return e;a=d("WASmaxInReceiptDeliverPeerPeerRetryOrDeliverPeerReadOrDeliverPeerServerErrorOrDeliverPeerErrorOrDeliverPeerDeliveryMixinGroup").parseDeliverPeerPeerRetryOrDeliverPeerReadOrDeliverPeerServerErrorOrDeliverPeerErrorOrDeliverPeerDeliveryMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({id:b.value,from:c.value,t:e.value,deliverPeerPeerRetryOrDeliverPeerReadOrDeliverPeerServerErrorOrDeliverPeerErrorOrDeliverPeerDeliveryMixinGroup:a.value})}g.parseDeliverPeerRequest=a}),98);
__d("WASmaxOutReceiptDeliverPeerResponseSuccess",["WASmaxJsx","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrDeviceJid,a,["from"]);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);a=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(b.value),"class":"receipt",to:d("WAWap").DEVICE_JID(c.value),type:d("WAWap").CUSTOM_STRING(a.value)});return b}g.makeDeliverPeerResponseSuccess=a}),98);
__d("WASmaxReceiptDeliverPeerRPC",["WASmaxInReceiptDeliverPeerRequest","WASmaxOutReceiptDeliverPeerResponseSuccess","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptDeliverPeerRequest").parseDeliverPeerRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("DeliverPeer",{Request:b}));return{parsedRequest:b.value,makeDeliverPeerResponseSuccess:function(){return d("WASmaxOutReceiptDeliverPeerResponseSuccess").makeDeliverPeerResponseSuccess(a)}}}g.receiveDeliverPeerRPC=a}),98);
__d("WASmaxInReceiptMessageAggregatedMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxParseJid").attrDeviceJid(a,"jid");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({jid:b.value,t:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"participants");if(!b.success)return b;a=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!a.success)return a;var c=d("WASmaxParseUtils").attrStanzaId(b.value,"key");if(!c.success)return c;b=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"user",1,1024,h);return!b.success?b:d("WAResultOrError").makeResult({id:a.value,participantsKey:c.value,participantsUser:b.value})}g.parseMessageAggregatedParticipantsUser=h;g.parseMessageAggregatedMixin=a}),98);
__d("WASmaxInReceiptInactiveTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","inactive");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseInactiveTypeMixin=a}),98);
__d("WASmaxInReceiptPlayedSelfTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","played-self");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parsePlayedSelfTypeMixin=a}),98);
__d("WASmaxInReceiptPlayedTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","played");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parsePlayedTypeMixin=a}),98);
__d("WASmaxInReceiptReadSelfTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","read-self");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseReadSelfTypeMixin=a}),98);
__d("WASmaxInReceiptReadTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","read");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseReadTypeMixin=a}),98);
__d("WASmaxInReceiptSenderTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","sender");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseSenderTypeMixin=a}),98);
__d("WASmaxInReceiptUnknownTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"type");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseUnknownTypeMixin=a}),98);
__d("WASmaxInReceiptMessageAggregatedStyleReceiptType",["WAResultOrError","WASmaxInReceiptInactiveTypeMixin","WASmaxInReceiptPlayedSelfTypeMixin","WASmaxInReceiptPlayedTypeMixin","WASmaxInReceiptReadSelfTypeMixin","WASmaxInReceiptReadTypeMixin","WASmaxInReceiptSenderTypeMixin","WASmaxInReceiptUnknownTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptSenderTypeMixin").parseSenderTypeMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"SenderType",value:b.value});var c=d("WASmaxInReceiptInactiveTypeMixin").parseInactiveTypeMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"InactiveType",value:c.value});var e=d("WASmaxInReceiptReadTypeMixin").parseReadTypeMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"ReadType",value:e.value});var f=d("WASmaxInReceiptReadSelfTypeMixin").parseReadSelfTypeMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"ReadSelfType",value:f.value});var g=d("WASmaxInReceiptPlayedTypeMixin").parsePlayedTypeMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"PlayedType",value:g.value});var h=d("WASmaxInReceiptPlayedSelfTypeMixin").parsePlayedSelfTypeMixin(a);if(h.success)return d("WAResultOrError").makeResult({name:"PlayedSelfType",value:h.value});var i=d("WASmaxInReceiptUnknownTypeMixin").parseUnknownTypeMixin(a);return i.success?d("WAResultOrError").makeResult({name:"UnknownType",value:i.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["SenderType","InactiveType","ReadType","ReadSelfType","PlayedType","PlayedSelfType","UnknownType"],[b,c,e,f,g,h,i])}g.parseMessageAggregatedStyleReceiptType=a}),98);
__d("WASmaxInReceiptRecipientMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"recipient");return!b.success?b:d("WAResultOrError").makeResult({recipient:b.value})}g.parseRecipientMixin=a}),98);
__d("WASmaxInReceiptDeliverMessageAggregatedStyleMixin",["WAResultOrError","WASmaxInReceiptEnums","WASmaxInReceiptMessageAggregatedMixin","WASmaxInReceiptMessageAggregatedStyleReceiptType","WASmaxInReceiptRecipientMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseJid").attrJidEnum(a,"from",d("WASmaxInReceiptEnums").BROADCASTJID_GROUPJID_NEWSLETTERJID_STATUSJID);if(!b.success)return b;var c=d("WASmaxInReceiptRecipientMixin").parseRecipientMixin(a),e=d("WASmaxInReceiptMessageAggregatedMixin").parseMessageAggregatedMixin(a);if(!e.success)return e;a=d("WASmaxInReceiptMessageAggregatedStyleReceiptType").parseMessageAggregatedStyleReceiptType(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({from:b.value,recipientMixin:c.success?c.value:null},e.value,{messageAggregatedStyleReceiptType:a.success?a.value:null}))}g.parseDeliverMessageAggregatedStyleMixin=a}),98);
__d("WASmaxInReceiptDeliverBizRolesMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(b.value,"actual_actors",0,100);if(!a.success)return a;var c=d("WASmaxParseUtils").attrIntRange(b.value,"host_storage",0,100);if(!c.success)return c;b=d("WASmaxParseUtils").attrIntRange(b.value,"privacy_mode_ts",0,void 0);return!b.success?b:d("WAResultOrError").makeResult({bizActualActors:a.value,bizHostStorage:c.value,bizPrivacyModeTs:b.value})}g.parseDeliverBizRolesMixin=a}),98);
__d("WASmaxInReceiptDeliverPaidConversationAggregatedMixin",["WAResultOrError","WASmaxInReceiptEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"delivery_context");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"optimization_goal",d("WASmaxInReceiptEnums").ENUM_DELIVERY_NOOPTIMIZATION);return!b.success?b:d("WAResultOrError").makeResult({optimizationGoal:b.value})}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"source_url");if(!b.success)return b;b=d("WASmaxParseUtils").contentString(a);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}function j(a){var b=d("WASmaxParseUtils").assertTag(a,"referral");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"source_url",i);if(!b.success)return b;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"source_type");return!a.success?a:d("WAResultOrError").makeResult({sourceType:a.value,sourceUrl:b.value})}function k(a){var b=d("WASmaxParseUtils").assertTag(a,"origin");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"referral",j);if(!b.success)return b;a=d("WASmaxParseUtils").attrString(a,"type");return!a.success?a:d("WAResultOrError").makeResult({type:a.value,referral:b.value})}function l(a){var b=d("WASmaxParseUtils").assertTag(a,"item");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"delivery_context",h);if(!b.success)return b;var c=d("WASmaxParseUtils").optionalChildWithTag(a,"origin",k);if(!c.success)return c;var e=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!e.success)return e;var f=d("WASmaxParseUtils").attrString(a,"paid_convo_id");if(!f.success)return f;var g=d("WASmaxParseUtils").attrStringEnum(a,"pricing_model",d("WASmaxInReceiptEnums").ENUM_CBP_NBP);if(!g.success)return g;var i=d("WASmaxParseUtils").attrStringEnum(a,"billable",d("WASmaxInReceiptEnums").ENUM_FALSE_TRUE);if(!i.success)return i;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"pricing_category");return!a.success?a:d("WAResultOrError").makeResult({id:e.value,paidConvoId:f.value,pricingModel:g.value,billable:i.value,pricingCategory:a.value,deliveryContext:b.value,origin:c.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxParseUtils").flattenedChildWithTag(b.value,"paid_messaging");if(!a.success)return a;b=d("WASmaxParseUtils").mapChildrenWithTag(a.value,"item",0,128e3,l);return!b.success?b:d("WAResultOrError").makeResult({bizPaidMessagingItem:b.value})}g.parseDeliverPaidConversationAggregatedBizPaidMessagingItemDeliveryContext=h;g.parseDeliverPaidConversationAggregatedBizPaidMessagingItemOriginReferralSourceUrl=i;g.parseDeliverPaidConversationAggregatedBizPaidMessagingItemOriginReferral=j;g.parseDeliverPaidConversationAggregatedBizPaidMessagingItemOrigin=k;g.parseDeliverPaidConversationAggregatedBizPaidMessagingItem=l;g.parseDeliverPaidConversationAggregatedMixin=a}),98);
__d("WASmaxInReceiptBroadcastMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseJid").attrBroadcastJid(a,"from");if(!b.success)return b;a=d("WASmaxParseJid").attrDeviceJid(a,"participant");return!a.success?a:d("WAResultOrError").makeResult({from:b.value,participant:a.value})}g.parseBroadcastMixin=a}),98);
__d("WASmaxInReceiptDeliverStatusMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseJid").attrStatusJid(a,"from");if(!b.success)return b;a=d("WASmaxParseJid").attrDeviceJid(a,"participant");return!a.success?a:d("WAResultOrError").makeResult({from:b.value,participant:a.value})}g.parseDeliverStatusMixin=a}),98);
__d("WASmaxInReceiptGroupMixin",["WAResultOrError","WASmaxInReceiptEnums","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseJid").attrGroupJid(a,"from");if(!b.success)return b;a=d("WASmaxParseJid").attrJidEnum(a,"participant",d("WASmaxInReceiptEnums").DEVICEJID_DEVICEJID);return!a.success?a:d("WAResultOrError").makeResult({from:b.value,participant:a.value})}g.parseGroupMixin=a}),98);
__d("WASmaxInReceiptIndividualMixin",["WAResultOrError","WASmaxInReceiptEnums","WASmaxInReceiptRecipientMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseJid").attrJidEnum(a,"from",d("WASmaxInReceiptEnums").DEVICEJID_DEVICEJID);if(!b.success)return b;a=d("WASmaxInReceiptRecipientMixin").parseRecipientMixin(a);return d("WAResultOrError").makeResult({from:b.value,recipientMixin:a.success?a.value:null})}g.parseIndividualMixin=a}),98);
__d("WASmaxInReceiptIndividualOrGroupOrDeliverStatusOrBroadcastMixinGroup",["WAResultOrError","WASmaxInReceiptBroadcastMixin","WASmaxInReceiptDeliverStatusMixin","WASmaxInReceiptGroupMixin","WASmaxInReceiptIndividualMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptIndividualMixin").parseIndividualMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"Individual",value:b.value});var c=d("WASmaxInReceiptGroupMixin").parseGroupMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"Group",value:c.value});var e=d("WASmaxInReceiptDeliverStatusMixin").parseDeliverStatusMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"DeliverStatus",value:e.value});var f=d("WASmaxInReceiptBroadcastMixin").parseBroadcastMixin(a);return f.success?d("WAResultOrError").makeResult({name:"Broadcast",value:f.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Individual","Group","Status","Broadcast"],[b,c,e,f])}g.parseIndividualOrGroupOrDeliverStatusOrBroadcastMixinGroup=a}),98);
__d("WASmaxInReceiptSenderAggregatedDeliverMixin",["WAResultOrError","WASmaxInReceiptDeprecatedEditMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"item");if(!b.success)return b;b=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!b.success)return b;a=d("WASmaxInReceiptDeprecatedEditMixin").parseDeprecatedEditMixin(a);return d("WAResultOrError").makeResult({id:b.value,deprecatedEditMixin:a.success?a.value:null})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"list");if(!b.success)return b;a=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!a.success)return a;b=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"item",0,128e3,h);return!b.success?b:d("WAResultOrError").makeResult({id:a.value,listItem:b.value})}g.parseSenderAggregatedDeliverListItem=h;g.parseSenderAggregatedDeliverMixin=a}),98);
__d("WASmaxInReceiptDeprecatedDeliveryTypeMixin",["WAResultOrError","WASmaxInReceiptEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"type",d("WASmaxInReceiptEnums").ENUM_DELIVER_DELIVERY);return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseDeprecatedDeliveryTypeMixin=a}),98);
__d("WASmaxInReceiptViewTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","view");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseViewTypeMixin=a}),98);
__d("WASmaxInReceiptSenderAggregatedStyleReceiptType",["WAResultOrError","WASmaxInReceiptDeprecatedDeliveryTypeMixin","WASmaxInReceiptInactiveTypeMixin","WASmaxInReceiptPlayedSelfTypeMixin","WASmaxInReceiptPlayedTypeMixin","WASmaxInReceiptReadSelfTypeMixin","WASmaxInReceiptReadTypeMixin","WASmaxInReceiptUnknownTypeMixin","WASmaxInReceiptViewTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptInactiveTypeMixin").parseInactiveTypeMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"InactiveType",value:b.value});var c=d("WASmaxInReceiptReadTypeMixin").parseReadTypeMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"ReadType",value:c.value});var e=d("WASmaxInReceiptReadSelfTypeMixin").parseReadSelfTypeMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"ReadSelfType",value:e.value});var f=d("WASmaxInReceiptPlayedTypeMixin").parsePlayedTypeMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"PlayedType",value:f.value});var g=d("WASmaxInReceiptPlayedSelfTypeMixin").parsePlayedSelfTypeMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"PlayedSelfType",value:g.value});var h=d("WASmaxInReceiptViewTypeMixin").parseViewTypeMixin(a);if(h.success)return d("WAResultOrError").makeResult({name:"ViewType",value:h.value});var i=d("WASmaxInReceiptDeprecatedDeliveryTypeMixin").parseDeprecatedDeliveryTypeMixin(a);if(i.success)return d("WAResultOrError").makeResult({name:"DeprecatedDeliveryType",value:i.value});var j=d("WASmaxInReceiptUnknownTypeMixin").parseUnknownTypeMixin(a);return j.success?d("WAResultOrError").makeResult({name:"UnknownType",value:j.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["InactiveType","ReadType","ReadSelfType","PlayedType","PlayedSelfType","ViewType","DeprecatedDeliveryType","UnknownType"],[b,c,e,f,g,h,i,j])}g.parseSenderAggregatedStyleReceiptType=a}),98);
__d("WASmaxInReceiptDeliverSenderAggregatedStyleMixin",["WAResultOrError","WASmaxInReceiptDeliverBizRolesMixin","WASmaxInReceiptDeliverPaidConversationAggregatedMixin","WASmaxInReceiptIndividualOrGroupOrDeliverStatusOrBroadcastMixinGroup","WASmaxInReceiptRecipientMixin","WASmaxInReceiptSenderAggregatedDeliverMixin","WASmaxInReceiptSenderAggregatedStyleReceiptType","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptRecipientMixin").parseRecipientMixin(a);var c=d("WASmaxInReceiptSenderAggregatedDeliverMixin").parseSenderAggregatedDeliverMixin(a);if(!c.success)return c;var e=d("WASmaxInReceiptDeliverPaidConversationAggregatedMixin").parseDeliverPaidConversationAggregatedMixin(a),f=d("WASmaxInReceiptDeliverBizRolesMixin").parseDeliverBizRolesMixin(a),g=d("WASmaxInReceiptIndividualOrGroupOrDeliverStatusOrBroadcastMixinGroup").parseIndividualOrGroupOrDeliverStatusOrBroadcastMixinGroup(a);if(!g.success)return g;a=d("WASmaxInReceiptSenderAggregatedStyleReceiptType").parseSenderAggregatedStyleReceiptType(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({recipientMixin:b.success?b.value:null},c.value,{deliverPaidConversationAggregatedMixin:e.success?e.value:null,deliverBizRolesMixin:f.success?f.value:null,individualOrGroupOrDeliverStatusOrBroadcastMixinGroup:g.value,senderAggregatedStyleReceiptType:a.success?a.value:null}))}g.parseDeliverSenderAggregatedStyleMixin=a}),98);
__d("WASmaxInReceiptIndividualWithRecipientMixin",["WAResultOrError","WASmaxInReceiptRecipientMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseJid").attrDeviceJid(a,"from");if(!b.success)return b;a=d("WASmaxInReceiptRecipientMixin").parseRecipientMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({from:b.value},a.value))}g.parseIndividualWithRecipientMixin=a}),98);
__d("WASmaxInReceiptIndividualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup",["WAResultOrError","WASmaxInReceiptBroadcastMixin","WASmaxInReceiptDeliverStatusMixin","WASmaxInReceiptGroupMixin","WASmaxInReceiptIndividualWithRecipientMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptIndividualWithRecipientMixin").parseIndividualWithRecipientMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IndividualWithRecipient",value:b.value});var c=d("WASmaxInReceiptGroupMixin").parseGroupMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"Group",value:c.value});var e=d("WASmaxInReceiptDeliverStatusMixin").parseDeliverStatusMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"DeliverStatus",value:e.value});var f=d("WASmaxInReceiptBroadcastMixin").parseBroadcastMixin(a);return f.success?d("WAResultOrError").makeResult({name:"Broadcast",value:f.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IndividualWithRecipient","Group","Status","Broadcast"],[b,c,e,f])}g.parseIndividualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup=a}),98);
__d("WASmaxInReceiptDeliverSenderAggregatedStyleSenderTypeMixin",["WAResultOrError","WASmaxInReceiptIndividualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup","WASmaxInReceiptSenderAggregatedDeliverMixin","WASmaxInReceiptSenderTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptSenderAggregatedDeliverMixin").parseSenderAggregatedDeliverMixin(a);if(!b.success)return b;var c=d("WASmaxInReceiptSenderTypeMixin").parseSenderTypeMixin(a);if(!c.success)return c;a=d("WASmaxInReceiptIndividualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup").parseIndividualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,c.value,{individualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup:a.value}))}g.parseDeliverSenderAggregatedStyleSenderTypeMixin=a}),98);
__d("WASmaxInReceiptNewsletterDeliverMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseJid").attrNewsletterJid(a,"from");if(!b.success)return b;a=d("WASmaxParseJid").attrDeviceJid(a,"participant");return!a.success?a:d("WAResultOrError").makeResult({from:b.value,participant:a.value})}g.parseNewsletterDeliverMixin=a}),98);
__d("WASmaxInReceiptSenderAggregatedDeliverServerIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"item");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"server_id",99,2147476647);return!b.success?b:d("WAResultOrError").makeResult({serverId:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"list");if(!b.success)return b;a=d("WASmaxParseUtils").attrStanzaId(a,"id");if(!a.success)return a;b=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"item",0,128e3,h);return!b.success?b:d("WAResultOrError").makeResult({id:a.value,listItem:b.value})}g.parseSenderAggregatedDeliverServerIDListItem=h;g.parseSenderAggregatedDeliverServerIDMixin=a}),98);
__d("WASmaxInReceiptDeliverSenderAggregatedStyleViewTypeMixin",["WAResultOrError","WASmaxInReceiptNewsletterDeliverMixin","WASmaxInReceiptSenderAggregatedDeliverServerIDMixin","WASmaxInReceiptViewTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptNewsletterDeliverMixin").parseNewsletterDeliverMixin(a);if(!b.success)return b;var c=d("WASmaxInReceiptSenderAggregatedDeliverServerIDMixin").parseSenderAggregatedDeliverServerIDMixin(a);if(!c.success)return c;a=d("WASmaxInReceiptViewTypeMixin").parseViewTypeMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,c.value,a.value))}g.parseDeliverSenderAggregatedStyleViewTypeMixin=a}),98);
__d("WASmaxInReceiptSingleStyleChatType",["WAResultOrError","WASmaxInReceiptBroadcastMixin","WASmaxInReceiptDeliverStatusMixin","WASmaxInReceiptGroupMixin","WASmaxInReceiptIndividualMixin","WASmaxInReceiptNewsletterDeliverMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptIndividualMixin").parseIndividualMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"Individual",value:b.value});var c=d("WASmaxInReceiptGroupMixin").parseGroupMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"Group",value:c.value});var e=d("WASmaxInReceiptDeliverStatusMixin").parseDeliverStatusMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"DeliverStatus",value:e.value});var f=d("WASmaxInReceiptBroadcastMixin").parseBroadcastMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"Broadcast",value:f.value});var g=d("WASmaxInReceiptNewsletterDeliverMixin").parseNewsletterDeliverMixin(a);return g.success?d("WAResultOrError").makeResult({name:"NewsletterDeliver",value:g.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Individual","Group","Status","Broadcast","NewsletterDeliver"],[b,c,e,f,g])}g.parseSingleStyleChatType=a}),98);
__d("WASmaxInReceiptDeliverFeatureIncapableErrorTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");if(!a.success)return a;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,b.value,"type","feature-incapable");return!b.success?b:d("WAResultOrError").makeResult({type:a.value,errorType:b.value})}g.parseDeliverFeatureIncapableErrorTypeMixin=a}),98);
__d("WASmaxInReceiptDeliverBizFeatureIncapableTypeWithReasonMixin",["WAResultOrError","WASmaxInReceiptDeliverFeatureIncapableErrorTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(b.value,"reason");if(!b.success)return b;a=d("WASmaxInReceiptDeliverFeatureIncapableErrorTypeMixin").parseDeliverFeatureIncapableErrorTypeMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({bizReason:b.value},a.value))}g.parseDeliverBizFeatureIncapableTypeWithReasonMixin=a}),98);
__d("WASmaxInReceiptOrderStatusErrorTypeMixin",["WAResultOrError","WASmaxInReceiptEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!b.success)return b;var c=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!c.success)return c;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");if(!a.success)return a;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,b.value,"type","order-status-update-failed");if(!b.success)return b;c=d("WASmaxParseUtils").attrStringEnum(c.value,"reason",d("WASmaxInReceiptEnums").ENUM_CANCELLATIONFAILED_INVALIDTRANSITION);return!c.success?c:d("WAResultOrError").makeResult({type:a.value,errorType:b.value,bizReason:c.value})}g.parseOrderStatusErrorTypeMixin=a}),98);
__d("WASmaxInReceiptBizErrorType",["WAResultOrError","WASmaxInReceiptDeliverBizFeatureIncapableTypeWithReasonMixin","WASmaxInReceiptDeliverFeatureIncapableErrorTypeMixin","WASmaxInReceiptHSMErrorTypeMixin","WASmaxInReceiptOrderStatusErrorTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptDeliverBizFeatureIncapableTypeWithReasonMixin").parseDeliverBizFeatureIncapableTypeWithReasonMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"DeliverBizFeatureIncapableTypeWithReason",value:b.value});var c=d("WASmaxInReceiptDeliverFeatureIncapableErrorTypeMixin").parseDeliverFeatureIncapableErrorTypeMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"DeliverFeatureIncapableErrorType",value:c.value});var e=d("WASmaxInReceiptHSMErrorTypeMixin").parseHSMErrorTypeMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"HSMErrorType",value:e.value});var f=d("WASmaxInReceiptOrderStatusErrorTypeMixin").parseOrderStatusErrorTypeMixin(a);return f.success?d("WAResultOrError").makeResult({name:"OrderStatusErrorType",value:f.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["BizFeatureIncapableTypeWithReason","FeatureIncapableErrorType","HSMErrorType","OrderStatusErrorType"],[b,c,e,f])}g.parseBizErrorType=a}),98);
__d("WASmaxInReceiptDeliverBizTypeMixin",["WAResultOrError","WASmaxInReceiptBizErrorType","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptBizErrorType").parseBizErrorType(a);return!b.success?b:d("WAResultOrError").makeResult({bizErrorType:b.value})}g.parseDeliverBizTypeMixin=a}),98);
__d("WASmaxInReceiptDeliverLIDFeatureIncapableTypeMixin",["WAResultOrError","WASmaxInReceiptDeliverFeatureIncapableErrorTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,b.value,"type","feature-incapable");if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,b.value,"reason","lid");if(!b.success)return b;a=d("WASmaxInReceiptDeliverFeatureIncapableErrorTypeMixin").parseDeliverFeatureIncapableErrorTypeMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({errorType:c.value,errorReason:b.value},a.value))}g.parseDeliverLIDFeatureIncapableTypeMixin=a}),98);
__d("WASmaxInReceiptRoiTemplateSourceMixin",["WAResultOrError","WASmaxInReceiptEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"biz");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"source",d("WASmaxInReceiptEnums").ENUM_BODYLINK_CTACALL_CTAURL_MEDIADOC_MEDIAIMAGE_MEDIAVIDEO_QUICKREPLY);return!b.success?b:d("WAResultOrError").makeResult({source:b.value})}g.parseRoiTemplateSourceMixin=a}),98);
__d("WASmaxInReceiptEngagedTypeMixin",["WAResultOrError","WASmaxInReceiptRoiTemplateSourceMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","engaged");if(!a.success)return a;var c=d("WASmaxParseUtils").attrString(b.value,"value");if(!c.success)return c;b=d("WASmaxInReceiptRoiTemplateSourceMixin").parseRoiTemplateSourceMixin(b.value);return!b.success?b:d("WAResultOrError").makeResult({type:a.value,bizValue:c.value,bizRoiTemplateSourceMixin:b.value})}g.parseEngagedTypeMixin=a}),98);
__d("WASmaxInReceiptRetryMixin",["WAResultOrError","WASmaxInReceiptKeyBundleMixin","WASmaxInReceiptRegistrationIDMixin","WASmaxInReceiptRetryTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptRetryTypeMixin").parseRetryTypeMixin(a);if(!b.success)return b;var c=d("WASmaxInReceiptRegistrationIDMixin").parseRegistrationIDMixin(a);if(!c.success)return c;a=d("WASmaxInReceiptKeyBundleMixin").parseKeyBundleMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,c.value,{keyBundleMixin:a.success?a.value:null}))}g.parseRetryMixin=a}),98);
__d("WASmaxInReceiptSingleStyleReceiptType",["WAResultOrError","WASmaxInReceiptDeliverBizTypeMixin","WASmaxInReceiptDeliverLIDFeatureIncapableTypeMixin","WASmaxInReceiptEngagedTypeMixin","WASmaxInReceiptInactiveTypeMixin","WASmaxInReceiptPlayedSelfTypeMixin","WASmaxInReceiptPlayedTypeMixin","WASmaxInReceiptReadSelfTypeMixin","WASmaxInReceiptReadTypeMixin","WASmaxInReceiptRetryMixin","WASmaxInReceiptServerErrorTypeMixin","WASmaxInReceiptUnknownTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptServerErrorTypeMixin").parseServerErrorTypeMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"ServerErrorType",value:b.value});var c=d("WASmaxInReceiptInactiveTypeMixin").parseInactiveTypeMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"InactiveType",value:c.value});var e=d("WASmaxInReceiptReadTypeMixin").parseReadTypeMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"ReadType",value:e.value});var f=d("WASmaxInReceiptReadSelfTypeMixin").parseReadSelfTypeMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"ReadSelfType",value:f.value});var g=d("WASmaxInReceiptPlayedTypeMixin").parsePlayedTypeMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"PlayedType",value:g.value});var h=d("WASmaxInReceiptPlayedSelfTypeMixin").parsePlayedSelfTypeMixin(a);if(h.success)return d("WAResultOrError").makeResult({name:"PlayedSelfType",value:h.value});var i=d("WASmaxInReceiptRetryMixin").parseRetryMixin(a);if(i.success)return d("WAResultOrError").makeResult({name:"Retry",value:i.value});var j=d("WASmaxInReceiptDeliverLIDFeatureIncapableTypeMixin").parseDeliverLIDFeatureIncapableTypeMixin(a);if(j.success)return d("WAResultOrError").makeResult({name:"DeliverLIDFeatureIncapableType",value:j.value});var k=d("WASmaxInReceiptDeliverBizTypeMixin").parseDeliverBizTypeMixin(a);if(k.success)return d("WAResultOrError").makeResult({name:"DeliverBizType",value:k.value});var l=d("WASmaxInReceiptEngagedTypeMixin").parseEngagedTypeMixin(a);if(l.success)return d("WAResultOrError").makeResult({name:"EngagedType",value:l.value});var m=d("WASmaxInReceiptUnknownTypeMixin").parseUnknownTypeMixin(a);return m.success?d("WAResultOrError").makeResult({name:"UnknownType",value:m.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ServerErrorType","InactiveType","ReadType","ReadSelfType","PlayedType","PlayedSelfType","Retry","LIDFeatureIncapableType","BizType","EngagedType","UnknownType"],[b,c,e,f,g,h,i,j,k,l,m])}g.parseSingleStyleReceiptType=a}),98);
__d("WASmaxInReceiptDeliverSingleStyleMixin",["WAResultOrError","WASmaxInReceiptDeliverBizRolesMixin","WASmaxInReceiptDeliverPaidConversationAggregatedMixin","WASmaxInReceiptRecipientMixin","WASmaxInReceiptSingleMixin","WASmaxInReceiptSingleStyleChatType","WASmaxInReceiptSingleStyleReceiptType","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptRecipientMixin").parseRecipientMixin(a);var c=d("WASmaxInReceiptSingleMixin").parseSingleMixin(a);if(!c.success)return c;var e=d("WASmaxInReceiptDeliverPaidConversationAggregatedMixin").parseDeliverPaidConversationAggregatedMixin(a),f=d("WASmaxInReceiptDeliverBizRolesMixin").parseDeliverBizRolesMixin(a),g=d("WASmaxInReceiptSingleStyleChatType").parseSingleStyleChatType(a);if(!g.success)return g;a=d("WASmaxInReceiptSingleStyleReceiptType").parseSingleStyleReceiptType(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({recipientMixin:b.success?b.value:null},c.value,{deliverPaidConversationAggregatedMixin:e.success?e.value:null,deliverBizRolesMixin:f.success?f.value:null,singleStyleChatType:g.value,singleStyleReceiptType:a.success?a.value:null}))}g.parseDeliverSingleStyleMixin=a}),98);
__d("WASmaxInReceiptDeliverMdDowngradeTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","md-downgrade");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseDeliverMdDowngradeTypeMixin=a}),98);
__d("WASmaxInReceiptSenderTypeOrDeliverMdDowngradeTypeOrRetryMixinGroup",["WAResultOrError","WASmaxInReceiptDeliverMdDowngradeTypeMixin","WASmaxInReceiptRetryMixin","WASmaxInReceiptSenderTypeMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptSenderTypeMixin").parseSenderTypeMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"SenderType",value:b.value});var c=d("WASmaxInReceiptDeliverMdDowngradeTypeMixin").parseDeliverMdDowngradeTypeMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"DeliverMdDowngradeType",value:c.value});var e=d("WASmaxInReceiptRetryMixin").parseRetryMixin(a);return e.success?d("WAResultOrError").makeResult({name:"Retry",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["SenderType","MdDowngradeType","Retry"],[b,c,e])}g.parseSenderTypeOrDeliverMdDowngradeTypeOrRetryMixinGroup=a}),98);
__d("WASmaxInReceiptDeliverSingleStyleWithRecipientMixin",["WAResultOrError","WASmaxInReceiptIndividualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup","WASmaxInReceiptSenderTypeOrDeliverMdDowngradeTypeOrRetryMixinGroup","WASmaxInReceiptSingleMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxInReceiptSingleMixin").parseSingleMixin(a);if(!b.success)return b;var c=d("WASmaxInReceiptIndividualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup").parseIndividualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup(a);if(!c.success)return c;a=d("WASmaxInReceiptSenderTypeOrDeliverMdDowngradeTypeOrRetryMixinGroup").parseSenderTypeOrDeliverMdDowngradeTypeOrRetryMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{individualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup:c.value,senderTypeOrDeliverMdDowngradeTypeOrRetryMixinGroup:a.value}))}g.parseDeliverSingleStyleWithRecipientMixin=a}),98);
__d("WASmaxInReceiptReceiptStyles",["WAResultOrError","WASmaxInReceiptDeliverMessageAggregatedStyleMixin","WASmaxInReceiptDeliverSenderAggregatedStyleMixin","WASmaxInReceiptDeliverSenderAggregatedStyleSenderTypeMixin","WASmaxInReceiptDeliverSenderAggregatedStyleViewTypeMixin","WASmaxInReceiptDeliverSingleStyleMixin","WASmaxInReceiptDeliverSingleStyleWithRecipientMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptDeliverMessageAggregatedStyleMixin").parseDeliverMessageAggregatedStyleMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"DeliverMessageAggregatedStyle",value:b.value});var c=d("WASmaxInReceiptDeliverSenderAggregatedStyleSenderTypeMixin").parseDeliverSenderAggregatedStyleSenderTypeMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"DeliverSenderAggregatedStyleSenderType",value:c.value});var e=d("WASmaxInReceiptDeliverSenderAggregatedStyleViewTypeMixin").parseDeliverSenderAggregatedStyleViewTypeMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"DeliverSenderAggregatedStyleViewType",value:e.value});var f=d("WASmaxInReceiptDeliverSenderAggregatedStyleMixin").parseDeliverSenderAggregatedStyleMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"DeliverSenderAggregatedStyle",value:f.value});var g=d("WASmaxInReceiptDeliverSingleStyleWithRecipientMixin").parseDeliverSingleStyleWithRecipientMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"DeliverSingleStyleWithRecipient",value:g.value});var h=d("WASmaxInReceiptDeliverSingleStyleMixin").parseDeliverSingleStyleMixin(a);return h.success?d("WAResultOrError").makeResult({name:"DeliverSingleStyle",value:h.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["MessageAggregatedStyle","SenderAggregatedStyleSenderType","SenderAggregatedStyleViewType","SenderAggregatedStyle","SingleStyleWithRecipient","SingleStyle"],[b,c,e,f,g,h])}g.parseReceiptStyles=a}),98);
__d("WASmaxInReceiptToAgentParticipantMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"participant");return!b.success?b:d("WAResultOrError").makeResult({participant:b.value})}g.parseToAgentParticipantMixin=a}),98);
__d("WASmaxInReceiptToProxyAccountMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"actual_to");return!b.success?b:d("WAResultOrError").makeResult({actualTo:b.value})}g.parseToProxyAccountMixin=a}),98);
__d("WASmaxInReceiptDeliverRequest",["WAResultOrError","WASmaxInReceiptDeprecatedEditMixin","WASmaxInReceiptOfflineMixin","WASmaxInReceiptReceiptStyles","WASmaxInReceiptToAgentParticipantMixin","WASmaxInReceiptToProxyAccountMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"receipt");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxInReceiptOfflineMixin").parseOfflineMixin(a),e=d("WASmaxInReceiptDeprecatedEditMixin").parseDeprecatedEditMixin(a),f=d("WASmaxInReceiptToProxyAccountMixin").parseToProxyAccountMixin(a),g=d("WASmaxInReceiptToAgentParticipantMixin").parseToAgentParticipantMixin(a);a=d("WASmaxInReceiptReceiptStyles").parseReceiptStyles(a);return!a.success?a:d("WAResultOrError").makeResult({t:b.value,offlineMixin:c.success?c.value:null,deprecatedEditMixin:e.success?e.value:null,toProxyAccountMixin:f.success?f.value:null,toAgentParticipantMixin:g.success?g.value:null,receiptStyles:a.value})}g.parseDeliverRequest=a}),98);
__d("WASmaxOutReceiptDeliverResponseSuccess",["WASmaxAttrs","WASmaxInReceiptEnums","WASmaxJsx","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseReference").attrFromReference(d("WASmaxParseUtils").attrStanzaId,a,["id"]);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(b.error);var c=d("WASmaxParseReference").attrFromReference(d("WASmaxParseJid").attrJidEnum,a,["from"],d("WASmaxInReceiptEnums").DEVICEJID_BROADCASTJID_DEVICEJID_GROUPJID_NEWSLETTERJID_STATUSJID);if(!c.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(c.error);var e=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseUtils").attrString,a,["type"]);if(!e.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(e.error);var f=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrJidEnum,a,["participant"],d("WASmaxInReceiptEnums").DEVICEJID_USERJID_DEVICEJID);if(!f.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(f.error);a=d("WASmaxParseReference").optionalAttrFromReference(d("WASmaxParseJid").attrUserJid,a,["recipient"]);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(a.error);b=d("WASmaxJsx").smax("ack",{id:d("WAWap").STANZA_ID(b.value),"class":"receipt",to:d("WAWap").JID(c.value),type:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,e.value),participant:d("WASmaxAttrs").OPTIONAL(d("WAWap").JID,f.value),recipient:d("WASmaxAttrs").OPTIONAL(d("WAWap").USER_JID,a.value)});return b}g.makeDeliverResponseSuccess=a}),98);
__d("WASmaxReceiptDeliverRPC",["WASmaxInReceiptDeliverRequest","WASmaxOutReceiptDeliverResponseSuccess","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInReceiptDeliverRequest").parseDeliverRequest(a);if(!b.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Deliver",{Request:b}));return{parsedRequest:b.value,makeDeliverResponseSuccess:function(){return d("WASmaxOutReceiptDeliverResponseSuccess").makeDeliverResponseSuccess(a)}}}g.receiveDeliverRPC=a}),98);
__d("WACreateHandleReceipt",["Promise","WACreateHandleGroupReceiptBranch","WACreateHandleIndividualReceiptBranch","WACreateHandlePeerAppdataReceiptBranch","WAJids","WAResultOrError","WASmaxReceiptDeliverPeerRPC","WASmaxReceiptDeliverRPC","WATagsLogger","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([""," server aggregated receipt is not supported"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(['<receipt category="peer"> is not supported yet.']);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["start handling..."]);k=function(){return a};return a}var l=d("WATagsLogger").TAGS(["decision tree","handleReceipt"]);function a(a){var c,e=d("WACreateHandleIndividualReceiptBranch").createHandleIndividualReceiptBranch({handleIndividualReceipt:(c=a.individualMessage)==null?void 0:c.handleIndividualReceipt,handleIndividualRetryReceipt:(c=a.individualMessage)==null?void 0:c.handleIndividualRetryReceipt}),f=d("WACreateHandleGroupReceiptBranch").createHandleGroupReceiptBranch({handleGroupReceipt:(c=a.groupMessage)==null?void 0:c.handleGroupReceipt,handleGroupRetryReceipt:(c=a.groupMessage)==null?void 0:c.handleGroupRetryReceipt}),g=d("WACreateHandlePeerAppdataReceiptBranch").createHandlePeerAppdataReceiptBranch({handlePeerAppdataReceipt:(c=a.appdataMessage)==null?void 0:c.handlePeerAppdataReceipt,handlePeerAppdataRetryReceipt:(c=a.appdataMessage)==null?void 0:c.handlePeerAppdataRetryReceipt});function m(a){var c=a.singleReceiptMixin,g=a.makeAck,i=a.offline,j=a.serverTs;a=a.socketId;var k=c.singleStyleChatType,l=c.singleStyleReceiptType,m=c.id,n=c.recipientMixin;c.deliverBizRolesMixin;c.deliverPaidConversationAggregatedMixin;switch(k.name){case"Individual":return e({aggregate:{aggregatedType:"none",stanzaId:m,receiptSender:k.value.from},receiptType:l,makeAck:g,offline:i,serverTs:j,recipient:n==null?void 0:n.recipient,socketId:a});case"Group":return f({from:k.value.from,aggregate:{aggregatedType:"none",stanzaId:m,receiptSender:k.value.participant},receiptType:l,makeAck:g,offline:i,serverTs:j,recipient:n==null?void 0:n.recipient,socketId:a});case"DeliverStatus":break;case"Broadcast":break;case"NewsletterDeliver":break;default:k.name}return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult(g()))}function n(a){var c=a.aggregateReceiptMixin,g=a.makeAck,i=a.offline,j=a.serverTs;a=a.socketId;var k=c.recipientMixin,l=c.id,m=c.listItem,n=c.individualOrGroupOrDeliverStatusOrBroadcastMixinGroup,o=c.senderAggregatedStyleReceiptType;c.deliverBizRolesMixin;c.deliverPaidConversationAggregatedMixin;c=[l].concat(m.map(function(a){return a.id}));switch(n.name){case"Individual":return e({aggregate:{aggregatedType:"sender",receiptSender:n.value.from,stanzaIds:c},receiptType:o,makeAck:g,offline:i,serverTs:j,recipient:k==null?void 0:k.recipient,socketId:a});case"Group":return f({from:n.value.from,aggregate:{aggregatedType:"sender",stanzaIds:c,receiptSender:n.value.participant},receiptType:o,makeAck:g,offline:i,serverTs:j,recipient:k==null?void 0:k.recipient,socketId:a});case"DeliverStatus":break;case"Broadcast":break}return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult(g()))}return function(a,c){l.DEV(k());if(a.attrs.category==="peer"){l.ERROR(j());var o=d("WASmaxReceiptDeliverPeerRPC").receiveDeliverPeerRPC(a);o=o.makeDeliverPeerResponseSuccess;return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult(o()))}if(a.attrs.category==="peer_appdata")return g(a,c);o=d("WASmaxReceiptDeliverRPC").receiveDeliverRPC(a);a=o.parsedRequest;var p=a.t,q=a.receiptStyles;a=a.offlineMixin;o=o.makeDeliverResponseSuccess;p=d("WATimeUtils").castToUnixTime(p);a=a==null?void 0:a.offline;switch(q.name){case"DeliverMessageAggregatedStyle":var r=q.value,s=r.from,t=r.recipientMixin,u=r.id,v=r.participantsUser;r=r.messageAggregatedStyleReceiptType;var w=d("WAJids").validateGroupJid(s);if(w==null){l.ERROR(i(),s);break}return f({aggregate:{aggregatedType:"server",stanzaId:u,receiptSenders:v.map(function(a){var b=a.jid;a=a.t;return{device:b,ts:d("WATimeUtils").castToUnixTime(a)}})},from:w,receiptType:r,makeAck:o,offline:a,serverTs:p,recipient:t==null?void 0:t.recipient,socketId:c});case"DeliverSenderAggregatedStyleSenderType":s=q.value;u=s.individualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup;v=s.id;w=s.type;r=s.listItem;w;t={value:{type:w},name:"SenderType"};s=[v].concat(r.map(function(a){return a.id}));switch(u.name){case"Group":return f({aggregate:{aggregatedType:"sender",stanzaIds:s,receiptSender:u.value.participant},from:u.value.from,receiptType:t,makeAck:o,offline:a,serverTs:p,recipient:null,socketId:c});case"Broadcast":break;case"DeliverStatus":break;case"IndividualWithRecipient":return e({aggregate:{aggregatedType:"sender",receiptSender:u.value.from,stanzaIds:s},receiptType:t,makeAck:o,offline:a,serverTs:p,recipient:u.value.recipient,socketId:c})}break;case"DeliverSenderAggregatedStyle":return n({aggregateReceiptMixin:q.value,makeAck:o,serverTs:p,offline:a,socketId:c});case"DeliverSingleStyleWithRecipient":w=q.value;v=w.id;r=w.senderTypeOrDeliverMdDowngradeTypeOrRetryMixinGroup;s=w.individualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup;switch(s.name){case"IndividualWithRecipient":return e({aggregate:{aggregatedType:"none",receiptSender:s.value.from,stanzaId:v},receiptType:r,makeAck:o,offline:a,serverTs:p,recipient:s.value.recipient,socketId:c});case"Group":return f({from:s.value.from,aggregate:{aggregatedType:"none",stanzaId:v,receiptSender:s.value.participant},receiptType:r,makeAck:o,offline:a,serverTs:p,recipient:null,socketId:c});case"DeliverStatus":break;case"Broadcast":break;default:s.name}break;case"DeliverSingleStyle":return m({singleReceiptMixin:q.value,makeAck:o,serverTs:p,offline:a,socketId:c})}return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult(o()))}}g.createHandleReceipt=a}),98);
__d("WASmaxInStreamErrorEnums",[],(function(a,b,c,d,e,f){a={appdata:"appdata",call:"call",message:"message",notification:"notification",receipt:"receipt"};f.ENUM_APPDATA_CALL_MESSAGE_NOTIFICATION_RECEIPT=a}),66);
__d("WASmaxInStreamErrorAckKickRequest",["WAResultOrError","WASmaxInStreamErrorEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"stream:error");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"ack");if(!b.success)return b;a=d("WASmaxParseUtils").attrStringEnum(b.value,"class",d("WASmaxInStreamErrorEnums").ENUM_APPDATA_CALL_MESSAGE_NOTIFICATION_RECEIPT);if(!a.success)return a;var c=d("WASmaxParseUtils").attrString(b.value,"type");if(!c.success)return c;b=d("WASmaxParseUtils").attrStanzaId(b.value,"id");return!b.success?b:d("WAResultOrError").makeResult({ackClass:a.value,ackType:c.value,ackId:b.value})}g.parseAckKickRequest=a}),98);
__d("WASmaxStreamErrorAckKickRPC",["WASmaxInStreamErrorAckKickRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInStreamErrorAckKickRequest").parseAckKickRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("AckKick",{Request:a}));return{parsedRequest:a.value}}g.receiveAckKickRPC=a}),98);
__d("WASmaxInStreamErrorBadMacRequest",["WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"stream:error");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"bad-mac");return!b.success?b:d("WASmaxParseUtils").voidSuccess}g.parseBadMacRequest=a}),98);
__d("WASmaxStreamErrorBadMacRPC",["WASmaxInStreamErrorBadMacRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInStreamErrorBadMacRequest").parseBadMacRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("BadMac",{Request:a}));return{parsedRequest:a.value}}g.receiveBadMacRPC=a}),98);
__d("WASmaxInStreamErrorCodeRequest",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"stream:error");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"code");return!b.success?b:d("WAResultOrError").makeResult({code:b.value})}g.parseCodeRequest=a}),98);
__d("WASmaxStreamErrorCodeRPC",["WASmaxInStreamErrorCodeRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInStreamErrorCodeRequest").parseCodeRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Code",{Request:a}));return{parsedRequest:a.value}}g.receiveCodeRPC=a}),98);
__d("WASmaxInStreamErrorConflictRequest",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"stream:error");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"conflict");if(!b.success)return b;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"code");if(!a.success)return a;var c=d("WASmaxParseUtils").attrString(b.value,"type");if(!c.success)return c;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,b.value,"reason");return!b.success?b:d("WAResultOrError").makeResult({code:a.value,conflictType:c.value,conflictReason:b.value})}g.parseConflictRequest=a}),98);
__d("WASmaxStreamErrorConflictRPC",["WASmaxInStreamErrorConflictRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInStreamErrorConflictRequest").parseConflictRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Conflict",{Request:a}));return{parsedRequest:a.value}}g.receiveConflictRPC=a}),98);
__d("WASmaxInStreamErrorPingKickRequest",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"stream:error");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"ping");if(!b.success)return b;a=d("WASmaxParseUtils").attrStanzaId(b.value,"id");return!a.success?a:d("WAResultOrError").makeResult({pingId:a.value})}g.parsePingKickRequest=a}),98);
__d("WASmaxStreamErrorPingKickRPC",["WASmaxInStreamErrorPingKickRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInStreamErrorPingKickRequest").parsePingKickRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("PingKick",{Request:a}));return{parsedRequest:a.value}}g.receivePingKickRPC=a}),98);
__d("WASmaxInStreamErrorXMLNotWellFormedRequest",["WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"stream:error");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"xml-not-well-formed");return!b.success?b:d("WASmaxParseUtils").voidSuccess}g.parseXMLNotWellFormedRequest=a}),98);
__d("WASmaxStreamErrorXMLNotWellFormedRPC",["WASmaxInStreamErrorXMLNotWellFormedRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInStreamErrorXMLNotWellFormedRequest").parseXMLNotWellFormedRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("XMLNotWellFormed",{Request:a}));return{parsedRequest:a.value}}g.receiveXMLNotWellFormedRPC=a}),98);
__d("WACreateHandleStreamError",["Promise","WAResultOrError","WASmaxDecisionTreeUtils","WASmaxStreamErrorAckKickRPC","WASmaxStreamErrorBadMacRPC","WASmaxStreamErrorCodeRPC","WASmaxStreamErrorConflictRPC","WASmaxStreamErrorPingKickRPC","WASmaxStreamErrorXMLNotWellFormedRPC","WAUnknownStanzaError"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var c=a.md,e=a.streamError;return function(a){var f=d("WASmaxDecisionTreeUtils").firstChild(a);if(f.success){f=f.value;switch(f.tag){case"ack":f=d("WASmaxStreamErrorAckKickRPC").receiveAckKickRPC(a);f=f.parsedRequest;return e.handleAckKick(f).then(d("WAResultOrError").makeResult);case"ping":f=d("WASmaxStreamErrorPingKickRPC").receivePingKickRPC(a);f=f.parsedRequest;return e.handlePingKick(f).then(d("WAResultOrError").makeResult);case"xml-not-well-formed":d("WASmaxStreamErrorXMLNotWellFormedRPC").receiveXMLNotWellFormedRPC(a);return e.handleXmlNotWellFormed().then(d("WAResultOrError").makeResult);case"bad-mac":d("WASmaxStreamErrorBadMacRPC").receiveBadMacRPC(a);return e.handleBadMac().then(d("WAResultOrError").makeResult);case"conflict":f=d("WASmaxStreamErrorConflictRPC").receiveConflictRPC(a);f=f.parsedRequest;return e.handleConflict(f).then(d("WAResultOrError").makeResult);default:return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError)}}else{f=d("WASmaxStreamErrorCodeRPC").receiveCodeRPC(a);a=f.parsedRequest;f=a.code;switch(f){case"515":a=c==null?void 0:c.handleRegistrateCompanionSuccess;if(a!=null)return a().then(d("WAResultOrError").makeResult);break;case"516":a=c==null?void 0:c.handleRegistrateCompanionFailure;if(a!=null)return a().then(d("WAResultOrError").makeResult);break;default:return e.handleStreamErrorCode({code:f}).then(d("WAResultOrError").makeResult)}return(h||(h=b("Promise"))).resolve(d("WAUnknownStanzaError").unknownStanzaError)}}}g.createHandleStreamError=a}),98);
__d("WASmaxInLoginDisplayNameMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrString(a,"display_name");return!a.success?a:d("WAResultOrError").makeResult({displayName:a.value})}g.parseDisplayNameMixin=a}),98);
__d("WASmaxInLoginSuccessRequest",["WAResultOrError","WASmaxInLoginDisplayNameMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"success");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").attrIntRange(a,"props",0,void 0);if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"abprops",0,void 0);if(!e.success)return e;var f=d("WASmaxParseUtils").attrString(a,"location");if(!f.success)return f;var g=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"shard_count",0,4095);if(!g.success)return g;var h=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"creation",0,void 0);if(!h.success)return h;var i=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"companion_enc_static");if(!i.success)return i;var j=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrDeviceJid,a,"lid");if(!j.success)return j;a=d("WASmaxInLoginDisplayNameMixin").parseDisplayNameMixin(a);return d("WAResultOrError").makeResult({t:b.value,props:c.value,abprops:e.value,location:f.value,shardCount:g.value,creation:h.value,companionEncStatic:i.value,lid:j.value,displayNameMixin:a.success?a.value:null})}g.parseSuccessRequest=a}),98);
__d("WASmaxLoginSuccessRPC",["WASmaxInLoginSuccessRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInLoginSuccessRequest").parseSuccessRequest(a);if(!a.success)throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Success",{Request:a}));return{parsedRequest:a.value}}g.receiveSuccessRPC=a}),98);
__d("WACreateHandleSuccess",["Promise","WAResultOrError","WASmaxLoginSuccessRPC","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var c=(a=a.login)==null?void 0:a.handleLoginSuccess;return function(a){if(c!=null){a=d("WASmaxLoginSuccessRPC").receiveSuccessRPC(a);a=a.parsedRequest;var e=a.t,f=a.props,g=a.abprops,i=a.location,j=a.shardCount,k=a.creation,l=a.companionEncStatic,m=a.lid;a=a.displayNameMixin;return c({timestamp:d("WATimeUtils").castToUnixTime(e),props:f,abprops:g,location:i,shardCount:j,creation:k,companionEncStatic:l,lid:m,displayName:a==null?void 0:a.displayName}).then(d("WAResultOrError").makeResult)}return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult("NO_ACK"))}}g.createHandleSuccess=a}),98);
__d("WAHandleDecisionTreeResult",["WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] unexpected-runtime-error: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] runtime-error ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["unrecognized stanza: ",""]);j=function(){return a};return a}function a(a,b){var c=d("WATagsLogger").TAGS(["decision tree"]);return b.then(function(b){if(b.success)return b.value;else if(b.error.type==="unknown-stanza"){c.ERROR(j(),a);return"NO_ACK"}else{b.error.type;c.ERROR(i(),a.tag,b.error.error);return"NO_ACK"}})["catch"](function(b){c.ERROR(h(),a.tag,b);return"NO_ACK"})}g.handleDecisionTreeResult=a}),98);
__d("WAOneQueueHandler",["WAGlobals","WAHandleDecisionTreeResult","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return function(b,c){var e={offline:b.attrs.offline?parseInt(b.attrs.offline,10):null,serverTs:b.attrs.t?d("WATimeUtils").castToUnixTime(parseInt(b.attrs.t,10)):null,tag:b.tag};return d("WAGlobals").getWaOneQueue().handleStanza(function(e){return d("WAHandleDecisionTreeResult").handleDecisionTreeResult(b,a(b,c,e))},e)}}g.handleWithOneQueue=a}),98);
__d("WAServerRPC",["Promise","WACreateHandleAppdata","WACreateHandleChatState","WACreateHandleErrorStanza","WACreateHandleFailure","WACreateHandleInfoBulletin","WACreateHandleIq","WACreateHandleMessage","WACreateHandleNotification","WACreateHandleReceipt","WACreateHandleStreamError","WACreateHandleSuccess","WAHandleDecisionTreeResult","WAOneQueueHandler","WAServerRPCLogger","WAStanzaRootTag"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Received unsupported stanza: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unsupported stanza: ",""]);j=function(){return a};return a}function a(a){var c=d("WACreateHandleInfoBulletin").createHandleInfoBulletin(a),e=d("WACreateHandleStreamError").createHandleStreamError(a),f=d("WACreateHandleFailure").createHandleFailure(a),g=d("WACreateHandleSuccess").createHandleSuccess(a),k=d("WACreateHandleMessage").createHandleMessage(a),l=d("WACreateHandleIq").createHandleIq(a),m=d("WACreateHandleChatState").createHandleChatState(a),n=d("WACreateHandleErrorStanza").createHandleErrorStanza(a),o=d("WACreateHandleNotification").createHandleNotification(a),p=d("WACreateHandleAppdata").createHandleAppdata(a),q=d("WACreateHandleReceipt").createHandleReceipt(a);a=function(a,r){switch(a.tag){case d("WAStanzaRootTag").STANZA_ROOT_TAG.MESSAGE:return d("WAOneQueueHandler").handleWithOneQueue(k)(a,r);case d("WAStanzaRootTag").STANZA_ROOT_TAG.NOTIFICATION:return d("WAOneQueueHandler").handleWithOneQueue(o)(a,r);case d("WAStanzaRootTag").STANZA_ROOT_TAG.RECEIPT:return d("WAOneQueueHandler").handleWithOneQueue(q)(a,r);case d("WAStanzaRootTag").STANZA_ROOT_TAG.CHATSTATE:return d("WAHandleDecisionTreeResult").handleDecisionTreeResult(a,m(a));case d("WAStanzaRootTag").STANZA_ROOT_TAG.APPDATA:return d("WAOneQueueHandler").handleWithOneQueue(p)(a,r);case d("WAStanzaRootTag").STANZA_ROOT_TAG.FAILURE:return d("WAHandleDecisionTreeResult").handleDecisionTreeResult(a,f(a));case d("WAStanzaRootTag").STANZA_ROOT_TAG.STREAM_ERROR:return d("WAHandleDecisionTreeResult").handleDecisionTreeResult(a,e(a));case d("WAStanzaRootTag").STANZA_ROOT_TAG.IQ:return d("WAHandleDecisionTreeResult").handleDecisionTreeResult(a,l(a));case d("WAStanzaRootTag").STANZA_ROOT_TAG.IB:return d("WAHandleDecisionTreeResult").handleDecisionTreeResult(a,c(a));case d("WAStanzaRootTag").STANZA_ROOT_TAG.ERROR:return d("WAHandleDecisionTreeResult").handleDecisionTreeResult(a,n(a));case d("WAStanzaRootTag").STANZA_ROOT_TAG.SUCCESS:return d("WAHandleDecisionTreeResult").handleDecisionTreeResult(a,g(a));case d("WAStanzaRootTag").STANZA_ROOT_TAG.XML_STREAM_END:return(h||(h=b("Promise"))).resolve("NO_ACK");default:d("WAServerRPCLogger").logger.WARN(j(),a);d("WAServerRPCLogger").logger.ERROR(i(),a.tag);return(h||(h=b("Promise"))).resolve("NO_ACK")}};return{handleStanza:a}}g.makeServerRPC=a}),98);
__d("WABatcher",["Promise","WAErr","WAResolvable"],(function(a,b,c,d,e,f,g){var h;function i(a,d){var e=a.delayMs,f=a.maxSize,g=null;function i(a){g&&g.args===a&&(g=null);return d(a)}var j=function(){if(g==null)return(h||(h=b("Promise"))).resolve();var a=g;g=null;clearTimeout(a.timer);a.run();return a.batchPromise};a=function(a){if(g)g.args.push(a);else{var d,k=[a];a=new(h||(h=b("Promise")))(function(a){d=function(){return void a(k)}}).then(i);var l=d;g={args:k,batchPromise:a,run:l,timer:setTimeout(l,e)}}if(g==null)throw c("WAErr")("activeBatch should not be null here");a=g;l=a.args;a=a.batchPromise;var m=l.length-1;f!=null&&l.length>=f&&j();return a.then(function(a){return a[m]})};return{accept:a,runActiveBatch:j}}function a(a,b){var c=i(a,b);return function(a){return c.accept(a)}}function e(a){var e=[],f=new(d("WAResolvable").Resolvable)(),g=function(c){if(e.length===0)return(h||(h=b("Promise"))).resolve(new Map());var g=e,i=f;e=[];f=new(d("WAResolvable").Resolvable)();return(h||(h=b("Promise"))).resolve(a(g,c)).then(function(a){i.resolve(a);return a})},i=function(a){e.push(a);return f.promise.then(function(b){b=b.get(a);if(b==null)throw c("WAErr")("This should not happen because we just added it to the batch");return b})};return{accept:i,runActiveBatch:g}}g.createSimpleBatcher=i;g.batch=a;g.createBatcher=e}),98);
__d("WAStateMachine",["WAPromiseQueue","WAResolvable","WAWorkerGlobalScope"],(function(a,b,c,d,e,f,g){"use strict";var h=function(){var b=a.prototype;b.getState=function(){return this.$2};b.getContext=function(){return this.$4};function a(a){this.$5=new(d("WAPromiseQueue").PromiseQueue)(),this.$1=new Set(),this.$2=a.initial,this.$3=a,this.$4=a.context}b.wait=function(a,b){var c=this,e=new(d("WAResolvable").Resolvable)(),f=b!=null?d("WAWorkerGlobalScope").workerGlobalScope.setTimeout(function(){e.reject("Max timeout of "+b+" milliseconds has ellapsed")},b):null;if(this.$2===a)e.resolve(this.$4),d("WAWorkerGlobalScope").workerGlobalScope.clearTimeout(f);else{var g=function b(g){g===a&&(e.resolve(c.$4),c.$1["delete"](b),d("WAWorkerGlobalScope").workerGlobalScope.clearTimeout(f))};this.$1.add(g)}return e.promise};b.$6=function(){for(var a=this.$1,b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;d(this.$2)}};b.$7=function(a,b){var c=a.actions,d=a.cond;a=a.target;c!=null&&(this.$4=c(this.$4,b));if(d!=null&&d(this.$4)===!1)return;this.$2=a;this.$6();d=(c=this.$3.states[this.$2])==null?void 0:c.invoke;d!=null&&this.$8(d,b)};b.$8=function(a,b){var c=this,d=this.$2;this.$5.enqueue(function(){return a.src(c.$4,b).then(function(b){return{actions:a.onDone.actions,target:a.onDone.target,payload:b,cond:a.onDone.cond}})["catch"](function(b){return{actions:a.onError.actions,target:a.onError.target,payload:b,cond:a.onError.cond}}).then(function(a){var e=a.actions,f=a.target,g=a.cond;a=a.payload;if(d!==c.$2)return;e!=null&&(c.$4=e(c.$4,a));if(g!=null&&g(c.$4)===!1)return;c.$2=f;c.$6();a=(e=c.$3.states[c.$2])==null?void 0:e.invoke;a!=null&&c.$8(a,b)})})};b.send=function(a){var b;b=(b=(b=this.$3.states[this.$2])==null?void 0:b.on[a])!=null?b:(b=this.$3.states[this.$2])==null?void 0:b.on[a==null?void 0:a.type];b!=null&&this.$7(b,a);return this};return a}();function a(a){return new h(a)}g.StateMachine=h;g.interpret=a}),98);
__d("WADevicesStateMachine",["Promise","WABatcher","WAMapWithDefault","WAStateMachine"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(a){var b=this;this.$4=function(a,c){return b.$2.fetchAndSaveDevices(new Set(a),c)};this.$2=a;this.$1=d("WABatcher").createBatcher(this.$4);this.$3=new(d("WAMapWithDefault").MapWithDefault)(function(a){return d("WAStateMachine").interpret({context:void 0,initial:"INITIAL",states:{INITIAL:{on:{LOAD:{target:"LOADING"}}},LOADED:{on:{RESET:{target:"INITIAL"}}},LOADING:{invoke:{onDone:{target:"LOADED"},onError:{target:"INITIAL"},src:function(){return b.$1.accept(a)}},on:{RESET:{target:"INITIAL"}}}}})})}var c=a.prototype;c.waitForUserDevices=function(a,c){var d=this;c===void 0&&(c=!1);var e=a.map(function(a){return d.$3.get(a)});return(h||(h=b("Promise"))).all(e.map(function(a){return a.send("LOAD")})).then(function(){return d.$1.runActiveBatch(c)}).then(function(){return(h||(h=b("Promise"))).all(e.map(function(a){return a.wait("LOADED",1e4)}))}).then(function(){})};c.reset=function(a){var c=this;a=a.map(function(a){return c.$3.get(a)});return(h||(h=b("Promise"))).all(a.map(function(a){return a.send("RESET")})).then(function(){})};return a}();g.DevicesStateMachine=a}),98);
__d("WASetContactsApi",["WAGlobals"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){return d("WAGlobals").runInTransaction({ContactsStore:!0},function(b){b=b.ContactsStore;return b.bulkPut(a)},"setContacts")};g.setContacts=a}),98);
__d("WADeviceUpdateUtils",["Promise","WAGlobals","WAICDCUtils","WAJids","WAJobDefinitions","WAJobs","WALogger","WASetContactsApi","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Update user devices signal and DB"]);i=function(){return a};return a}function a(a){var c,e,f,g,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:if(!(a.length===0)){k.next=2;break}return k.abrupt("return");case 2:c=[];k.next=5;return b("regeneratorRuntime").awrap(d("WAGlobals").getWaOneQueue().enqueue(function(e){var f=e.cryptoManager;d("WALogger").LOG(i());return(h||(h=b("Promise"))).all(a.map(function(a){var b;c.push({contactJid:a.jid,dhash:a.dhash,lastSyncTs:a.lastSyncTs,icdcInfo:(b=a.icdcInfo)!=null?b:void 0,identities:a.devices.map(function(b){var c=b.id,e=b.identity,f=b.model;b=b.platform;return{device:d("WAJids").toDeviceJid(a.jid,c),identity:e,model:f,platform:b}})});return f.storage.updateUserDevicesInfo(a)}))},{operationType:"get_devices",flush:!0,afterInit:!0}));case 5:k.next=7;return b("regeneratorRuntime").awrap(d("WASetContactsApi").setContacts(c));case 7:e=d("WAGlobals").getMyUserJid();f=a.find(function(a){return a.jid===e});if(!(f!=null)){k.next=15;break}g=f.icdcInfo;if(!(g==null||d("WAICDCUtils").isICDCIndexInvalid(g)||(g==null?void 0:g.dirty))){k.next=15;break}g==null?j="empty":g.dirty?j="dirty":j="invalidIndex";k.next=15;return b("regeneratorRuntime").awrap(d("WAJobs").getJobManager().waitUntilPersisted(d("WAJobDefinitions").jobSerializers.computeAndUploadICDCInfo(j,"get_devices",g==null?void 0:g.sequence)));case 15:case"end":return k.stop()}},null,this)}g.updateUsersDevicesSignalAndDB=a}),98);
__d("WAGetContactsApi",["WAGlobals"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){a=a.ContactsStore;return a.bulkGet(b)}a=function(a){return d("WAGlobals").runInTransaction({ContactsStore:!0},function(b){b=b.ContactsStore;return h({ContactsStore:b},a)},"getContacts")};g.getContactsTransactor=h;g.getContacts=a}),98);
__d("WASmaxInDevicesFetchResponseError",["WAResultOrError","WASmaxInDevicesIQErrorResponseMixin","WASmaxInDevicesRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInDevicesIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInDevicesRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup").parseRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup:b.value}))}g.parseFetchResponseError=a}),98);
__d("WASmaxInDevicesFetchNonRetryableUserErrorMixin",["WASmaxInDevicesIQErrorItemNotFoundMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxInDevicesIQErrorItemNotFoundMixin").parseIQErrorItemNotFoundMixin(a);return!b.success?b:b}g.parseFetchNonRetryableUserErrorMixin=a}),98);
__d("WASmaxInDevicesFetchRetryableUserErrorMixin",["WAResultOrError","WASmaxInDevicesIQErrorInternalServerErrorOrServiceUnavailableMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxInDevicesIQErrorInternalServerErrorOrServiceUnavailableMixinGroup").parseIQErrorInternalServerErrorOrServiceUnavailableMixinGroup(a);return!b.success?b:d("WAResultOrError").makeResult({iQErrorInternalServerErrorOrServiceUnavailableMixinGroup:b.value})}g.parseFetchRetryableUserErrorMixin=a}),98);
__d("WASmaxInDevicesFetchOrFetchNonRetryableUserErrorMixinGroup",["WAResultOrError","WASmaxInDevicesFetchNonRetryableUserErrorMixin","WASmaxInDevicesFetchRetryableUserErrorMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInDevicesFetchRetryableUserErrorMixin").parseFetchRetryableUserErrorMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"FetchRetryableUserError",value:b.value});var c=d("WASmaxInDevicesFetchNonRetryableUserErrorMixin").parseFetchNonRetryableUserErrorMixin(a);return c.success?d("WAResultOrError").makeResult({name:"FetchNonRetryableUserError",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["RetryableUserError","NonRetryableUserError"],[b,c])}g.parseFetchOrFetchNonRetryableUserErrorMixinGroup=a}),98);
__d("WASmaxInDevicesFetchUserResponseFailureMixin",["WAResultOrError","WASmaxInDevicesFetchOrFetchNonRetryableUserErrorMixinGroup","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!b.success)return b;a=d("WASmaxParseJid").attrUserJid(a,"jid");if(!a.success)return a;b=d("WASmaxInDevicesFetchOrFetchNonRetryableUserErrorMixinGroup").parseFetchOrFetchNonRetryableUserErrorMixinGroup(b.value);return!b.success?b:d("WAResultOrError").makeResult({jid:a.value,errorFetchOrFetchNonRetryableUserErrorMixinGroup:b.value})}g.parseFetchUserResponseFailureMixin=a}),98);
__d("WASmaxInDevicesFetchUserResponseSuccessMixin",["WAResultOrError","WASmaxInDevicesDeviceListMixin","WASmaxInDevicesICDCFromServerMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"devices");if(!b.success)return b;b=d("WASmaxInDevicesDeviceListMixin").parseDeviceListMixin(a);return!b.success?b:b}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"icdc");if(!b.success)return b;b=d("WASmaxInDevicesICDCFromServerMixin").parseICDCFromServerMixin(a);return!b.success?b:b}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"devices",h);if(!b.success)return b;var c=d("WASmaxParseUtils").optionalChildWithTag(a,"icdc",i);if(!c.success)return c;a=d("WASmaxParseJid").attrUserJid(a,"jid");return!a.success?a:d("WAResultOrError").makeResult({jid:a.value,devices:b.value,icdc:c.value})}g.parseFetchUserResponseSuccessDevices=h;g.parseFetchUserResponseSuccessIcdc=i;g.parseFetchUserResponseSuccessMixin=a}),98);
__d("WASmaxInDevicesUserResponseFetchFailureOrFetchSuccessMixinGroup",["WAResultOrError","WASmaxInDevicesFetchUserResponseFailureMixin","WASmaxInDevicesFetchUserResponseSuccessMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInDevicesFetchUserResponseFailureMixin").parseFetchUserResponseFailureMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"FetchUserResponseFailure",value:b.value});var c=d("WASmaxInDevicesFetchUserResponseSuccessMixin").parseFetchUserResponseSuccessMixin(a);return c.success?d("WAResultOrError").makeResult({name:"FetchUserResponseSuccess",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["UserResponseFailure","UserResponseSuccess"],[b,c])}g.parseUserResponseFetchFailureOrFetchSuccessMixinGroup=a}),98);
__d("WASmaxInDevicesFetchUserResponseMixin",["WAResultOrError","WASmaxInDevicesUserResponseFetchFailureOrFetchSuccessMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxInDevicesUserResponseFetchFailureOrFetchSuccessMixinGroup").parseUserResponseFetchFailureOrFetchSuccessMixinGroup(a);return!b.success?b:d("WAResultOrError").makeResult({userResponseFetchFailureOrFetchSuccessMixinGroup:b.value})}g.parseFetchUserResponseMixin=a}),98);
__d("WASmaxInDevicesFetchResponseSuccess",["WAResultOrError","WASmaxInDevicesFetchUserResponseMixin","WASmaxInDevicesIQResultResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxInDevicesFetchUserResponseMixin").parseFetchUserResponseMixin(a);return!b.success?b:b}function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"users");if(!c.success)return c;a=d("WASmaxInDevicesIQResultResponseMixin").parseIQResultResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxParseUtils").mapChildrenWithTag(c.value,"user",0,25,h);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{usersUser:b.value}))}g.parseFetchResponseSuccessUsersUser=h;g.parseFetchResponseSuccess=a}),98);
__d("WASmaxOutDevicesDhashMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.anyDhash;a=d("WASmaxJsx").smax("smax$any",{dhash:d("WAWap").CUSTOM_STRING(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeDhashMixin=a}),98);
__d("WASmaxOutDevicesICDCSeqMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.anySeq;a=d("WASmaxJsx").smax("smax$any",{seq:d("WAWap").INT(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeICDCSeqMixin=a}),98);
__d("WASmaxOutDevicesFetchRequest",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutDevicesBaseIQGetRequestMixin","WASmaxOutDevicesDhashMixin","WASmaxOutDevicesICDCSeqMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.userJid,c=a.dhashMixinArgs;a=a.iCDCSeqMixinArgs;b=d("WASmaxMixins").optionalMerge(d("WASmaxOutDevicesICDCSeqMixin").mergeICDCSeqMixin,d("WASmaxMixins").optionalMerge(d("WASmaxOutDevicesDhashMixin").mergeDhashMixin,d("WASmaxJsx").smax("user",{jid:d("WAWap").USER_JID(b)}),c),a);return b}function a(a){a=a.userArgs;a=d("WASmaxOutDevicesBaseIQGetRequestMixin").mergeBaseIQGetRequestMixin(d("WASmaxJsx").smax("iq",{to:d("WAWap").S_WHATSAPP_NET,xmlns:"fbid:devices"},d("WASmaxJsx").smax("users",null,d("WASmaxChildren").REPEATED_CHILD(h,a,1,25))));return a}g.makeFetchRequestUsersUser=h;g.makeFetchRequest=a}),98);
__d("WASmaxDevicesFetchRPC",["WAComms","WASmaxInDevicesFetchResponseError","WASmaxInDevicesFetchResponseSuccess","WASmaxOutDevicesFetchRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:e=d("WASmaxOutDevicesFetchRequest").makeFetchRequest(a);i.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(e,c));case 3:f=i.sent;g=d("WASmaxInDevicesFetchResponseSuccess").parseFetchResponseSuccess(f,e);if(!g.success){i.next=7;break}return i.abrupt("return",{name:"FetchResponseSuccess",value:g.value});case 7:h=d("WASmaxInDevicesFetchResponseError").parseFetchResponseError(f,e);if(!h.success){i.next=10;break}return i.abrupt("return",{name:"FetchResponseError",value:h.value});case 10:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Fetch",{Success:g,Error:h}));case 11:case"end":return i.stop()}},null,this)}g.sendFetchRPC=a}),98);
__d("WAFetchFbDevicesProtocol",["Promise","WAArrayChunk","WAErr","WAGetContactsApi","WAHandleFbDeviceChangeNotificationProtocol","WAJids","WAResultOrError","WAResultOrErrorUtils","WASignalKeys","WASmaxDevicesFetchRPC","WATimeUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=25;function a(a,e,f){var g,k,l,m,n,o;return b("regeneratorRuntime").async(function(p){while(1)switch(p.prev=p.next){case 0:g=f.onDhashDone,k=f.onAckReturned;if(!(a.length===0)){p.next=3;break}return p.abrupt("return",new Map());case 3:l=d("WAArrayChunk").chunk(a,i);if(!e){p.next=8;break}p.t0=[];p.next=11;break;case 8:p.next=10;return b("regeneratorRuntime").awrap(d("WAGetContactsApi").getContacts(a).then(d("WAResultOrErrorUtils").unpackValues));case 10:p.t0=p.sent;case 11:m=p.t0;n=m.reduce(function(a,b){b&&b.dhash!=null&&a.set(b.contactJid,b.dhash);return a},new Map());g==null?void 0:g();o=new Map(a.map(function(a){return[a,d("WAResultOrError").makeResult({type:"dhash-match"})]}));return p.abrupt("return",(h||(h=b("Promise"))).all(l.map(function(a){return d("WASmaxDevicesFetchRPC").sendFetchRPC({userArgs:a.map(function(a){var b=n.get(a);b=b!=null?{anyDhash:b}:null;return{userJid:a,dhashMixinArgs:b}})}).then(function(a){if(a.name==="FetchResponseError")throw c("WAErr")("Failed to fetch user devices");k==null?void 0:k();return a.value.usersUser.map(function(a){a=a.userResponseFetchFailureOrFetchSuccessMixinGroup;if(a.name==="FetchUserResponseFailure"){o.set(a.value.jid,d("WAResultOrError").makeError());return}a=a.value;var b=a.jid,c=a.devices;a=a.icdc;o.set(b,d("WAResultOrError").makeResult(j(b,c,a,d("WATimeUtils").unixTime())))})})})).then(function(){return o}));case 16:case"end":return p.stop()}},null,this)}function e(a){return Array.from(a.values()).flatMap(function(a){return a.success&&a.value.type!=="dhash-match"?[a.value]:[]})}function j(a,b,c,e){e===void 0&&(e=null);var f=[],g=null;if(b){f=b.device.map(function(a){var b;return{id:d("WAJids").interpretAsDeviceId(a.id),identity:d("WASignalKeys").serializeIdentity(a.elementValue),platform:(b=a.deviceModelInfoMixin)==null?void 0:(b=b.platform)==null?void 0:b.elementValue,model:(b=a.deviceModelInfoMixin)==null?void 0:(a=b.model)==null?void 0:a.elementValue}});g=(b=b.dhashMixin)==null?void 0:b.dhash}b=null;if(c){c=d("WAHandleFbDeviceChangeNotificationProtocol").parseICDCFromServer(c);b=c.success?c.value:null}return{jid:a,devices:f,lastSyncTs:d("WATimeUtils").unixTime(),dhash:g,icdcInfo:b,notificationTs:e}}g.fetchFbDevicesProtocol=a;g.extractUserDevicesInfo=e}),98);
__d("WAFetchAndSaveDevices",["WABridge","WADeviceUpdateUtils","WAFetchFbDevicesProtocol","WALogger","WAOdsEnums","WAPREList","WAPREMetrics","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["getDevices -> update devices signal"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["getDevices called for users ",""]);i=function(){return a};return a}function a(a,b){b===void 0&&(b=!1);return j(a,b)}function j(a,b){b===void 0&&(b=!1);d("WALogger").LOG(i(),Array.from(a));var c=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.GET_DEVICES,{"int":{usersAmount:a.size},bool:{ignoreDhash:b,stateMachine:!0}});return d("WAFetchFbDevicesProtocol").fetchFbDevicesProtocol(Array.from(a),b,{onDhashDone:function(){return c.addPoint("db_dhash_done")},onAckReturned:function(){return c.addPoint("ack_returned")}}).then(function(a){c.addPoint("request_devices");d("WALogger").LOG(h());return d("WADeviceUpdateUtils").updateUsersDevicesSignalAndDB(d("WAFetchFbDevicesProtocol").extractUserDevicesInfo(a)).then(function(){c.addPoint("user_devices_signal_and_db_updated");return new Map(Array.from(a.keys()).map(function(a){return[a,d("WAResultOrError").makeResult()]}))})}).then(function(a){d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.GET_DEVICES,key:"success"});c.endSuccess();return a})["catch"](function(a){d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.GET_DEVICES,key:"fail"});c.endFail("get_devices_fail");throw a})}g.fetchAndSaveDevicesWithResults=a}),98);
__d("WAMetrics",["Promise","WATimeUtils"],(function(a,b,c,d,e,f,g){var h;function a(){var a=d("WATimeUtils").performanceAbsoluteNow();return new(h||(h=b("Promise")))(function(b){setTimeout(function(){b(d("WATimeUtils").performanceAbsoluteNow()-a)},0)})}g.getEventLoopDelay=a}),98);
__d("WAOfflineBatchIb",["WADeprecatedSendIq","WAWap"],(function(a,b,c,d,e,f,g){"use strict";function a(a){d("WADeprecatedSendIq").deprecatedCastStanza(d("WAWap").wap("ib",null,d("WAWap").wap("offline_batch",{count:d("WAWap").INT(a)})))}g.sendBatchRequestIb=a}),98);
__d("WAPullMode",["WAGlobals","WAOfflineBatchIb","WAServerRPCLogger","WAShiftTimer"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Request next batch: ",". Total requested amount: ",". Downloaded: ",". Processed: ",". Next batch on ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([""," processed < "," next batch check"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([""," downloaded > "," expected"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Already requested next batch"]);k=function(){return a};return a}var l=0,m=100,n=d("WAServerRPCLogger").logger.TAGS(["PullMode"]);a=function(){function a(){var a=this;this.$1=!1;this.$2=0;this.$3=0;this.$4=0;this.$5=0;this.$6=0;this.$7=new(d("WAShiftTimer").ShiftTimer)(function(){a.$8()})}var b=a.prototype;b.offlineStart=function(a){this.clear(),this.$5=a,this.$9()};b.$10=function(){this.$7.cancel(),this.$7.onOrAfter(l)};b.stanzaReceived=function(){this.$1=!1,this.$4++,this.$10()};b.$9=function(){d("WAOfflineBatchIb").sendBatchRequestIb(d("WAGlobals").getConfig().batchSize()),this.$1=!0,this.$3+=d("WAGlobals").getConfig().batchSize(),this.$2=this.$3-m};b.$8=function(){if(this.$1){n.LOG(k());return}if(this.$4>=this.$5){n.LOG(j(),this.$4,this.$5);return}if(this.$6<this.$2){n.LOG(i(),this.$6,this.$2);return}this.$9();n.LOG(h(),d("WAGlobals").getConfig().batchSize(),this.$3,this.$4,this.$6,this.$2)};b.stanzaProcessed=function(){this.$6++,this.$10()};b.clear=function(){this.$7.cancel(),this.$2=0,this.$4=0,this.$5=0,this.$6=0,this.$3=0,this.$1=!1};return a}();g.PullMode=a}),98);
__d("WAOneQueue",["Promise","WACastStanzas","WAComms","WADanglingQueue","WAGlobals","WAMetrics","WAOfflineUtils","WAPREList","WAPREMetrics","WAProtocolQueue","WAPubSub","WAPullMode","WAResolvable","WAScheduleAfterOfflineResume","WAShiftTimer","WATagsLogger","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error while casting ack: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Cast stanzas ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Acking"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Flushing signal"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Flushing protocol queue"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Processing stanza with tag "," is done"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Processing stanza with tag ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Drop offline queue as per loosing connection"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["Offline queue end"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["Offline queue end received while the connection gets dropped"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error while processing: ",""]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["Execution of "," is done."]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["Execution of ",""]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["Timeout while processing "," offline: ",". Tag: ",", status: ",""]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["Enqueuing "," offline: "," queue size: ","."]);w=function(){return a};return a}var x=6e4,y=1e4,z=d("WATagsLogger").TAGS(["OneQueue"]);a=function(){function a(a){var c=this,e=a.mode;a=a.cryptoManager;this.$1=d("WAPubSub").simplePubSub();this.$2=(h||(h=b("Promise"))).resolve();this.$3=[];this.$7=0;this.$8={};this.$9=[];this.$10=0;this.$4=e;this.$12=a;this.$6=new(d("WAPullMode").PullMode)();this.$5=new(d("WAShiftTimer").ShiftTimer)(function(){c.$13({operationType:"flush_by_timer"},function(a){return c.$14(a).then(function(){return a.endSuccess()})}).then(function(){})["catch"](function(a){throw a})})}var c=a.prototype;c.$13=function(a,c){var e=this,f=this.$4!==d("WAOfflineUtils").ServerRPCMode.ONLINE,g=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.ONE_QUEUE,{string:{operationType:a.operationType},bool:{offline:f},"int":{size:this.$7,serverOfflineSize:this.$10}});void d("WAMetrics").getEventLoopDelay().then(function(a){g.isActive()&&g.addPoint("measure_event_loop_delay",{"int":{eventLoopDelay:a}})});var i=this.$7++;z.LOG(w(),a.operationType,f,i);g.addPoint("enqueueing_start");var j="enqueueing",k=setTimeout(function(){var b;g.addPoint("enqueueing_timeout");z.ERROR(v(),a.operationType,f,(b=a.stanzaHandlerProps)==null?void 0:b.tag,j)},y);return new(h||(h=b("Promise")))(function(b,d){e.$2=e.$2.then(function(){g.addPoint("enqueueing_end");j="execution";g.addPoint("execution_start");z.LOG(u(),a.operationType);C(g,function(){return g.addPoint("execution_end")});return c(g)}).then(function(c){z.LOG(t(),a.operationType),b(c)})["catch"](function(a){A(g,a),z.ERROR(s(),a),d(a)})["finally"](function(){e.$7--,clearTimeout(k)})})};c.subscribe=function(a){return this.$1.subscribe(a)};c.getMode=function(){return this.$4};c.$15=function(){d("WAProtocolQueue").protocolQueue().config({cacheSize:null}),this.$12.storage.useCache()};c.$16=function(){d("WAProtocolQueue").protocolQueue().config({cacheSize:1}),this.$12.storage.useImmediateFlushing()};c.handleStanza=function(a,b){var c=this,d=this.$11;return this.$13({operationType:"process_stanza",stanzaHandlerProps:b},function(e){return c.$17(e,a,b,d)}).then(function(){return"NO_ACK"})};c.offlineStart=function(a){if(a.count===0)return;this.$4=d("WAOfflineUtils").ServerRPCMode.OFFLINE_RESUME;this.$1.publish({type:"offline-start",offlineStats:a});this.$10=a.count;this.$5.onOrAfter(x);this.$6.offlineStart(a.count)};c.offlineEnd=function(){var a=this;return this.$13({operationType:"offline_end"},function(b){var c;if(a.$11!==((c=d("WAComms").getComms())==null?void 0:c.socketId)){z.LOG(r());a.$5.cancel();a.$6.clear();return a.$14(b).then(function(){return b.endSuccess()})}z.LOG(q());a.$5.cancel();a.$6.clear();return a.$14(b).then(function(){a.$4=d("WAOfflineUtils").ServerRPCMode.ONLINE,void d("WADanglingQueue").danglingQueueClear(),d("WAScheduleAfterOfflineResume").flushPostponedActions(),a.$1.publish({type:"offline-end"}),b.endSuccess()})}).then(function(){var b=a.$9;a.$9=[];b.forEach(function(a){return a()})})};c.newConnection=function(){var a;this.$11=(a=d("WAComms").getComms())==null?void 0:a.socketId};c.connectionDropped=function(){var a=this;return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:z.WARN(p());this.$11=null;this.$6.clear();c.next=5;return b("regeneratorRuntime").awrap(this.$13({operationType:"flush_on_connection_drop"},function(b){return a.$14(b).then(function(){return b.endSuccess()})}));case 5:this.$1.publish({type:"connection-lost"}),d("WAScheduleAfterOfflineResume").flushPostponedActions();case 7:case"end":return c.stop()}},null,this)};c.$18=function(){return this.$4===d("WAOfflineUtils").ServerRPCMode.OFFLINE_RESUME?d("WAGlobals").getConfig().batchSize():1};c.$19=function(a,b){a!=null&&(this.$15(),this.$1.publish({type:"offline-entity",serverTs:b,offline:a}),this.$6.stanzaReceived(),this.$5.cancel(),this.$5.onOrAfter(x))};c.$17=function(a,c,d,e){var f=this,g=d.tag,i=d.offline;d=d.serverTs;this.$19(i,d);z.LOG(o(),g);a.addPoint("handling_stanza_start",{string:{stanza_tag:g}});this.$8[g]=((i=this.$8[g])!=null?i:0)+1;return(h||(h=b("Promise"))).resolve(c(this.$12)).then(function(b){a.addPoint("handling_stanza_end");z.LOG(n(),g);!B(b)?f.$3.push({response:b,socketId:e}):(a.addPoint("pending_ack_start"),C(a,function(){return a.addPoint("pending_ack_end")}),f.$3.push({response:b,socketId:e,eventFlow:a}));return b}).then(function(b){return f.$20(a).then(function(){f.$6.stanzaProcessed(),B(b)||a.endSuccess()})})};c.$20=function(a){return this.$3.length>=this.$18()?this.$14(a):(h||(h=b("Promise"))).resolve()};c.$14=function(a){var b=this;z.LOG(m());var c=0,e=Object.entries(this.$8).reduce(function(a,b){var d=b[0];b=b[1];c+=b;return babelHelpers["extends"]({},a,(a={},a["flush_"+d]=b,a))},{});this.$8={};a.addPoint("flushing_start",{"int":babelHelpers["extends"]({},e,{flush_total:c})});C(a,function(){return a.addPoint("flushing_end")});return this.$21().then(function(){z.LOG(l());return b.$22()}).then(function(){z.LOG(k());return b.$23()}).then(function(){})["finally"](function(){b.$4===d("WAOfflineUtils").ServerRPCMode.OFFLINE_RESUME&&b.$1.publish({type:"offline-processed",count:c}),b.$16()})};c.$21=function(){return d("WAProtocolQueue").protocolQueue().flush()};c.$22=function(){return this.$12.storage.savePendingToDatabase().then(function(){})};c.isPendingAcksEmpty=function(){return this.$3.length===0};c.$23=function(){var a;return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:z.LOG(j(),this.$3);a=this.$3;this.$3=[];c.prev=3;c.next=6;return b("regeneratorRuntime").awrap(d("WACastStanzas").castStanzasByCategories(a,{send:!0,store:d("WAGlobals").getConfig().waDanglingQueue()&&this.$4===d("WAOfflineUtils").ServerRPCMode.OFFLINE_RESUME}));case 6:c.next=13;break;case 8:c.prev=8;c.t0=c["catch"](3);z.ERROR(i(),c.t0.toString());this.$24().forEach(function(a){(a==null?void 0:a.isActive())&&A(a,c.t0)});throw c.t0;case 13:return c.abrupt("return",(h||(h=b("Promise"))).resolve());case 14:case"end":return c.stop()}},null,this,[[3,8]])};c.enqueue=function(a,c){var e=this,f=c.operationType,g=c.flush;c=c.afterInit;c=c===void 0?!1:c;var h=function(){return e.$13({operationType:f},function(c){return a({cryptoManager:e.$12}).then(function(a){return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:if(!g){d.next=3;break}d.next=3;return b("regeneratorRuntime").awrap(e.$14(c));case 3:c.endSuccess();return d.abrupt("return",a);case 5:case"end":return d.stop()}},null,this)})})};if(c&&this.$4!==d("WAOfflineUtils").ServerRPCMode.ONLINE){var i=new(d("WAResolvable").Resolvable)();this.$9.push(function(){h().then(function(a){return i.resolve(a)})["catch"](function(a){return i.reject(a)})});return i.promise}return h()};c.$24=function(){return this.$3.map(function(a){return a.eventFlow})};return a}();function A(a,b){a==null?void 0:a.endFail("error",{string:{error:""+b.toString()}})}function B(a){return!(a==="NO_ACK"||a==="CLOSE_SOCKET")}function C(a,b){var c=a.endSuccess;a.endSuccess=function(a){b(),c(a)}}g.logger=z;g.WAOneQueue=a}),98);
__d("WAJobPriorityBucket",["WAJobOrchestratorTypes","WALogger"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed::markJobTaskDone found jobId: "," in scheduled tasks"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed::markJobTaskPending found jobId: "," in pending tasks"]);i=function(){return a};return a}a=function(){function a(a){this.tasks=[];this.pendingTasks=[];this.lastJobStartedTimestampMs=null;this.jobMaxConcurrency=(a=a.jobMaxConcurrencyMap)!=null?a:{}}var b=a.prototype;b.updateConfig=function(a){this.jobMaxConcurrency=(a=a.jobMaxConcurrencyMap)!=null?a:{}};b.getStats=function(){return[].concat(this.tasks,this.pendingTasks).reduce(function(a,b){var c;c=(c=a[b.jobName])!=null?c:0;a[b.jobName]=c+1;return a},{})};b.next=function(){var a=this;if(this.tasks.length===0)return null;var b=this.pendingTasks.reduce(function(a,b){var c;c=(c=a.get(b.jobName))!=null?c:0;a.set(b.jobName,c+1);return a},new Map()),c=this.tasks.filter(function(c){var e;return((e=b.get(c.jobName))!=null?e:0)<((e=a.jobMaxConcurrency[c.jobName])!=null?e:d("WAJobOrchestratorTypes").DEFAULT_CONCURRENCY)});return c.length>0?[c[0]]:null};b.add=function(a,b,c,d){c={jobId:c,jobInfo:b,jobName:a,run:d};this.tasks.push(c);return c};b.markJobTaskPending=function(a){this.pendingTasks.includes(function(b){return b.jobId===a.jobId})&&d("WALogger").ERROR(i(),a.jobId).sendLogs("JobOrchestrator::markJobTaskPending"),this.lastJobStartedTimestampMs=Date.now(),this.pendingTasks.push(a),this.tasks=this.tasks.filter(function(b){return b.jobId!==a.jobId})};b.markJobTaskDone=function(a){this.pendingTasks=this.pendingTasks.filter(function(b){return b.jobId!==a}),this.tasks.includes(function(b){return b.jobId===a})&&d("WALogger").ERROR(h(),a).sendLogs("JobOrchestrator::markJobTaskDone")};b.count=function(){return this.tasks.length};b.pendingCount=function(){return this.pendingTasks.length};b.clearWaitingTasks=function(){this.tasks=[]};b.clear=function(){this.tasks=[],this.pendingTasks=[]};b.getLastJobStartedTimestamp=function(){return this.lastJobStartedTimestampMs};return a}();b=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var c=b.prototype;c.next=function(){var a=this,b,c;if(this.tasks.length===0)return null;var d=this.pendingTasks.reduce(function(a,b){var c;c=(c=a.get(b.jobName))!=null?c:0;a.set(b.jobName,c+1);return a},new Map()),e=this.tasks.filter(function(b){var c;return((c=d.get(b.jobName))!=null?c:0)<((c=a.jobMaxConcurrency[b.jobName])!=null?c:1)});if(e.length===0)return null;b=(b=this.jobMaxConcurrency[e[0].jobName])!=null?b:1;c=(c=d.get(e[0].jobName))!=null?c:0;if(b>1&&c<b){var f=e.filter(function(a){return a.jobName===e[0].jobName});b=Math.min(f.length,b-c);return f.slice(0,b)}return[e[0]]};return b}(a);g.BaseJobBucket=a;g.LowJobBucket=b}),98);
__d("WAPromiseTimeout",["Promise","WACustomError","WAErr"],(function(a,b,c,d,e,f,g){var h;a=function(a,e,f){var g=null,i=null,j=new(h||(h=b("Promise")))(function(a,b){i=b,g=setTimeout(function(){b(new(d("WACustomError").TimeoutError)(f)),clearTimeout(g)},e)});return h.race([a,j])["finally"](function(){i&&i(c("WAErr")()),clearTimeout(g)})};g.promiseTimeout=a}),98);
__d("WAConcurrentBucketJobQueue",["Promise","WABase64","WACustomError","WAErr","WAJobOrchestratorTypes","WAJobPriorityBucket","WALogger","WAMetrics","WANullthrows","WAPromiseTimeout","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[job-orchestator]: "," exceeding the timeout, release the thread."]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[job-orchestator]: updated WAConcurrentBucketJobQueue config"]);j=function(){return a};return a}var k=30,l=new Map([[d("WAJobOrchestratorTypes").JOB_PRIORITY.HIGH,5],[d("WAJobOrchestratorTypes").JOB_PRIORITY.LOW,1]]);a=function(){function a(){this.$1=!1,this.$2=0,this.$3=0,this.$4=0,this.$5=new Map(),this.$6=new Map(),this.$7=new Map(),this.$9=0}var e=a.prototype;e.init=function(a,b){var e,f,g;if(this.$1)throw c("WAErr")("WAConcurrentBucketJobQueue has already initialized");this.$4=(e=a==null?void 0:a.bestEffortWaitTimeoutSec)!=null?e:k;this.$2=a.maxConcurrency;this.$3=a.maxConcurrency;this.$8=b;this.$7=this.$11(a==null?void 0:a.jobPrioritiesQuota);this.$6=new Map(this.$7);this.$5=new Map();this.$9=Date.now();b=new(d("WAJobPriorityBucket").BaseJobBucket)({jobMaxConcurrencyMap:(e=a.maxConcurrencyPerJob)!=null?e:{}});e=new(d("WAJobPriorityBucket").LowJobBucket)({jobMaxConcurrencyMap:(e=a.maxConcurrencyPerJob)!=null?e:{}});f=new(d("WAJobPriorityBucket").LowJobBucket)({jobMaxConcurrencyMap:(f=a.maxConcurrencyPerJob)!=null?f:{}});g=new(d("WAJobPriorityBucket").BaseJobBucket)({jobMaxConcurrencyMap:(g=a.maxConcurrencyPerJob)!=null?g:{}});a=new(d("WAJobPriorityBucket").BaseJobBucket)({jobMaxConcurrencyMap:(a=a.maxConcurrencyPerJob)!=null?a:{}});this.$5.set(d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION,b);this.$5.set(d("WAJobOrchestratorTypes").JOB_PRIORITY.HIGH,b);this.$5.set(d("WAJobOrchestratorTypes").JOB_PRIORITY.OFFLINE,g);this.$5.set(d("WAJobOrchestratorTypes").JOB_PRIORITY.HISTORY_SYNC,a);this.$5.set(d("WAJobOrchestratorTypes").JOB_PRIORITY.LOW,e);this.$5.set(d("WAJobOrchestratorTypes").JOB_PRIORITY.BEST_EFFORT,f);this.$1=!0};e.updateConfig=function(a){this.$3+=a.maxConcurrency-this.$2,this.$2=a.maxConcurrency,this.$5.forEach(function(b){return b.updateConfig({jobMaxConcurrencyMap:(b=a.maxConcurrencyPerJob)!=null?b:{}})}),this.$7=this.$11(a==null?void 0:a.jobPrioritiesQuota),d("WALogger").LOG(j())};e.isInitialized=function(){return this.$1};e.clearQueue=function(){if(!this.$1)throw c("WAErr")("WAConcurrentBucketJobQueue not initialized");this.$5.forEach(function(a){return a.clear()})};e.clearQueueByPriority=function(a){if(!this.$1)throw c("WAErr")("WAConcurrentBucketJobQueue not initialized");(a=this.$5.get(a))==null?void 0:a.clearWaitingTasks()};e.getIntStats=function(){var a=this,b=function(b){var c;b=a.$5.get(b);return((c=b==null?void 0:b.count())!=null?c:0)+((c=b==null?void 0:b.pendingCount())!=null?c:0)};return{highPriorityBucketSize:b(d("WAJobOrchestratorTypes").JOB_PRIORITY.HIGH),lowPriorityBucketSize:b(d("WAJobOrchestratorTypes").JOB_PRIORITY.LOW),bestEffortPriorityBucketSize:b(d("WAJobOrchestratorTypes").JOB_PRIORITY.BEST_EFFORT)}};e.getStringStats=function(){var a=this,b=function(b){var c=(b=(b=a.$5.get(b))==null?void 0:b.getStats())!=null?b:{};b=Object.keys(c).reduce(function(a,b){var d=a[0];a=a[1];var e=c[b];return e>d?[e,b]:[d,a]},[0,null]);b=b[1];return b};return{highPriorityMaxJob:b(d("WAJobOrchestratorTypes").JOB_PRIORITY.HIGH),lowPriorityMaxJob:b(d("WAJobOrchestratorTypes").JOB_PRIORITY.LOW),bestEffortPriorityMaxJob:b(d("WAJobOrchestratorTypes").JOB_PRIORITY.BEST_EFFORT)}};e.enqueue=function(a,e,f,g){var i,j=this;if(!this.$1)return(h||(h=b("Promise"))).reject(c("WAErr")("WAConcurrentBucketJobQueue not initialized"));var k,l,m=new(h||(h=b("Promise")))(function(a,b){k=a,l=b}),n=babelHelpers["extends"]({priority:d("WAJobOrchestratorTypes").DEFAULT_JOB_PRIORITY},f),o=this.getJobBucketByType(n.priority);if(!o)return(h||(h=b("Promise"))).reject(c("WAErr")("WAConcurrentBucketJobQueue no bucket for job with name "+a+" was found."));d("WAMetrics").getEventLoopDelay().then(function(a){(g==null?void 0:g.isActive())&&(g==null?void 0:g.addPoint("measure_event_loop_delay",{"int":{eventLoopDelay:a}}))});g==null?void 0:g.addPoint("scheduling_job",{string:babelHelpers["extends"]({},this.getStringStats(),{priority:n.priority}),"int":babelHelpers["extends"]({},this.getIntStats(),{maxTimeoutMs:(i=f==null?void 0:f.maxTimeoutMs)!=null?i:0})});var p=n.priority+"-"+a+"-"+((i=f==null?void 0:f.jobId)!=null?i:d("WABase64").randomBase64(8));i=o.add(a,n,p,function(){var a;return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.prev=0;j.$8.logJobStarted(p);c.next=4;return b("regeneratorRuntime").awrap(j.$12(e(),f==null?void 0:f.maxTimeoutMs));case 4:a=c.sent;j.$8.logJobCompleted(p);k(a);c.next=13;break;case 9:c.prev=9,c.t0=c["catch"](0),c.t0 instanceof d("WACustomError").TimeoutError?j.$8.logJobTimeout(p):j.$8.logJobError(p),l(c.t0);case 13:case"end":return c.stop()}},null,this,[[0,9]])});this.$8.logJobCreated({jobId:p,jobName:a,jobPriority:n.priority,pendingJobsCount:o.count()});f&&f.priority===d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION&&this.$13(i);this.$14();return m};e.getAvailableThreadsCount=function(){return this.$3};e.getJobQuotaConfig=function(){return this.$7};e.getRemainingJobCountMap=function(){return this.$6};e.getJobBucketByType=function(a){return this.$5.get(a)};e.$11=function(a){var b;!a?b=new Map(l):b=new Map(a);b.set(d("WAJobOrchestratorTypes").JOB_PRIORITY.BEST_EFFORT,0);return b};e.$15=function(a){return(a=this.$6.get(a))!=null?a:0};e.$16=function(){this.$6=new Map(this.$7)};e.$17=function(a){var b=this;a===void 0&&(a=!0);var c=0,e=null,f=0;this.$5.forEach(function(a,d){c+=a==null?void 0:a.count();f+=b.$15(d);if(e!=null)return;a.count()>0&&b.$15(d)>0&&(e=a)});var g=e==null||f===0;g&&this.$16();if(this.$18(c,g))return this.getJobBucketByType(d("WAJobOrchestratorTypes").JOB_PRIORITY.BEST_EFFORT);return e==null&&a?this.$17(!1):e};e.$18=function(a,b){var c=this;function e(a,b){var c=Date.now();return a>c?!1:c-a<b*1e3}function f(a,b){a=Math.ceil(a-Date.now())+b*1e3;return a>0?a:0}var g=this.getJobBucketByType(d("WAJobOrchestratorTypes").JOB_PRIORITY.BEST_EFFORT);a=a-((a=g==null?void 0:g.count())!=null?a:0);var h=g==null?void 0:g.getLastJobStartedTimestamp();if((g==null?void 0:g.count())===0)return!1;if(h==null&&e(this.$9,this.$4)){if(this.$10==null){g=f(this.$9,this.$4);this.$10=setTimeout(function(){c.$14(),c.$10=null},g)}return!1}return a>0&&h!=null&&e(h,this.$4)?!1:b};e.$19=function(a){a=this.$20(a);return c("WANullthrows")(this.$5.get(a))};e.$20=function(a){var b=a.split("-")[0];b=d("WAJobOrchestratorTypes").JOB_PRIORITY.cast(b);if(!b)throw c("WAErr")("ConcurrentBucketQueue cannot extract known job priority type from id: "+a);return b};e.$21=function(a){a=this.$20(a);this.$15(a)>0?this.$6.set(a,this.$15(a)-1):this.$6.set(a,0)};e.$14=function(){var a=this;while(this.$3>0){var b=this.$17();b=b==null?void 0:b.next();if(b==null)break;b.forEach(function(b){a.$21(b.jobId),a.$13(b)})}};e.$12=function(a,b){return b!==void 0?d("WAPromiseTimeout").promiseTimeout(a,b):a};e.$13=function(a){var c=this,e,f,g,h,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:e=this.$19(a.jobId);this.$3--;e.markJobTaskPending(a);f=a.run,g=a.jobId,h=a.jobName;k.prev=4;k.next=7;return b("regeneratorRuntime").awrap(this.$12(f(),((j=a.jobInfo)==null?void 0:j.maxTimeoutMs)===void 0?d("WAJobOrchestratorTypes").DEFAULT_JOB_TIMEOUT_MS:void 0));case 7:k.next=17;break;case 9:k.prev=9;k.t0=k["catch"](4);if(!(k.t0 instanceof d("WACustomError").TimeoutError)){k.next=16;break}this.$8.logJobTimeout(g);d("WALogger").LOG(i(),h);k.next=17;break;case 16:throw k.t0;case 17:k.prev=17;this.$3++;e.markJobTaskDone(g);this.$3>0&&setTimeout(function(){return c.$14()},0);return k.finish(17);case 22:case"end":return k.stop()}},null,this,[[4,9,17,22]])};return a}();g.WAConcurrentBucketJobQueue=a}),98);
__d("WAConcurrentPreemptiveJobQueue",["Promise","WACustomError","WAErr","WAHex","WAJobOrchestratorTypes","WALogger","WAPromiseTimeout","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed::markJobTaskDone found jobId: "," in scheduled tasks"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed::markJobTaskPending found jobId: "," in pending tasks"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[job-orchestator]: "," exceeding the timeout, release the thread."]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[job-orchestator]: updated ConcurrentPreemptiveJobQueue config"]);l=function(){return a};return a}a=function(){function a(){this.$1=!1,this.$2=0,this.$3=0,this.$4={},this.$5=[],this.$6=[]}var e=a.prototype;e.init=function(a,b){if(this.$1)throw c("WAErr")("ConcurrentPreemptiveJobQueue has already initialized");this.$2=a.maxConcurrency;this.$3=a.maxConcurrency;this.$4=(a=a.maxConcurrencyPerJob)!=null?a:{};this.$7=b;this.$1=!0};e.updateConfig=function(a){this.$3+=a.maxConcurrency-this.$2;this.$2=a.maxConcurrency;this.$4=(a=a.maxConcurrencyPerJob)!=null?a:{};d("WALogger").LOG(l())};e.isInitialized=function(){return this.$1};e.clearQueueByPriority=function(a){if(!this.$1)throw c("WAErr")("ConcurrentPreemptiveJobQueue not initialized");this.$5=this.$5.filter(function(b){return((b=b.jobInfo)==null?void 0:b.priority)!==a})};e.clearQueue=function(){if(!this.$1)throw c("WAErr")("ConcurrentPreemptiveJobQueue not initialized");this.$5=[];this.$6=[]};e.enqueue=function(a,e,f){var g,i=this;if(!this.$1)return(h||(h=b("Promise"))).reject(c("WAErr")("ConcurrentPreemptiveJobQueue not initialized"));var j,k,l=new(h||(h=b("Promise")))(function(a,b){j=a,k=b}),m=babelHelpers["extends"]({priority:d("WAJobOrchestratorTypes").DEFAULT_JOB_PRIORITY},f),n=(g=f==null?void 0:f.jobId)!=null?g:d("WAHex").randomHex(8).substr(0,64);g=this.$8(a,m,n,function(){var a;return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.prev=0;i.$7.logJobStarted(n);c.next=4;return b("regeneratorRuntime").awrap(i.$9(e(),f==null?void 0:f.maxTimeoutMs));case 4:a=c.sent;i.$7.logJobCompleted(n);j(a);c.next=13;break;case 9:c.prev=9,c.t0=c["catch"](0),c.t0 instanceof d("WACustomError").TimeoutError?i.$7.logJobTimeout(n):i.$7.logJobError(n),k(c.t0);case 13:case"end":return c.stop()}},null,this,[[0,9]])});f&&f.priority===d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION&&this.$10(g);this.$11();return l};e.getAvailableThreadsCount=function(){return this.$3};e.getJobMaxConcurrency=function(){return this.$4};e.$11=function(){while(this.$3>0){var a=this.$12();if(a==null)break;this.$10(a)}};e.$9=function(a,b){return b!==void 0?d("WAPromiseTimeout").promiseTimeout(a,b):a};e.$10=function(a){var c=this,e,f,g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:this.$3--;this.$13(a);e=a.run,f=a.jobId,g=a.jobName;i.prev=3;i.next=6;return b("regeneratorRuntime").awrap(this.$9(e(),((h=a.jobInfo)==null?void 0:h.maxTimeoutMs)===void 0?d("WAJobOrchestratorTypes").DEFAULT_JOB_TIMEOUT_MS:void 0));case 6:i.next=16;break;case 8:i.prev=8;i.t0=i["catch"](3);if(!(i.t0 instanceof d("WACustomError").TimeoutError)){i.next=15;break}this.$7.logJobTimeout(f);d("WALogger").LOG(k(),g);i.next=16;break;case 15:throw i.t0;case 16:i.prev=16;this.$3++;this.$14(f);setTimeout(function(){return c.$11()},0);return i.finish(16);case 21:case"end":return i.stop()}},null,this,[[3,8,16,21]])};e.$8=function(a,b,c,d){d={jobId:c,jobInfo:b,jobName:a,run:d};this.$7.logJobCreated({jobId:c,jobName:a,jobPriority:b.priority,pendingJobsCount:this.$5.length});this.$5.push(d);return d};e.$13=function(a){this.$6.includes(function(b){return b.jobId===a.jobId})&&d("WALogger").ERROR(j(),a.jobId).sendLogs("JobOrchestrator::markJobTaskPending"),this.$6.push(a),this.$5=this.$5.filter(function(b){return b.jobId!==a.jobId})};e.$14=function(a){this.$6=this.$6.filter(function(b){return b.jobId!==a}),this.$5.includes(function(b){return b.jobId===a})&&d("WALogger").ERROR(i(),a).sendLogs("JobOrchestrator::markJobTaskDone")};e.$12=function(){var a=this;if(this.$5.length===0)return null;var b=this.$6.reduce(function(a,b){var c;c=(c=a.get(b.jobName))!=null?c:0;a.set(b.jobName,c+1);return a},new Map()),c=this.$5.filter(function(c){var d;return((d=b.get(c.jobName))!=null?d:0)<((d=a.$4[c.jobName])!=null?d:1)});return c[0]};return a}();g.WAConcurrentPreemptiveJobQueue=a}),98);
__d("WADefaultJobNoQueue",["WAErr","WAHex","WAJobOrchestratorTypes","regeneratorRuntime"],(function(a,b,c,d,e,f,g){a=function(){function a(){this.$2=!1}var e=a.prototype;e.init=function(a,b){if(this.$2)throw c("WAErr")("DefaultNoQueue has already initialized");this.$1=b;this.$2=!0};e.updateConfig=function(a){};e.isInitialized=function(){return this.$2};e.clearQueue=function(){};e.clearQueueByPriority=function(a){};e.enqueue=function(a,c,e){var f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:h=(f=e==null?void 0:e.jobId)!=null?f:d("WAHex").randomHex(8).substr(0,64);this.$1.logJobCreated({jobId:h,jobName:a,jobPriority:(g=e==null?void 0:e.priority)!=null?g:d("WAJobOrchestratorTypes").JOB_PRIORITY.LOW,pendingJobsCount:0});j.prev=2;this.$1.logJobStarted(h);j.next=6;return b("regeneratorRuntime").awrap(c());case 6:i=j.sent;this.$1.logJobCompleted(h);return j.abrupt("return",i);case 11:j.prev=11;j.t0=j["catch"](2);this.$1.logJobError(h);throw j.t0;case 15:case"end":return j.stop()}},null,this,[[2,11]])};return a}();g.WADefaultJobNoQueue=a}),98);
__d("WAOrchestratorJobStatsLogger",["WABaseGlobals","WAPREList","WAPREMetrics"],(function(a,b,c,d,e,f,g){var h=function(){function a(a,b,c){this.jobName=a,this.pendingJobsCount=c,this.jobPriority=b}var b=a.prototype;b.logJobAdded=function(){this.webcJobAddedT=Date.now(),this.eventFlow=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.WA_JOBS_ORCHESTRATOR,{string:{name:this.jobName,jobPriority:this.jobPriority,orchestratorVersion:d("WABaseGlobals").getConfig().orchestratorVersion()},"int":{pendingJobsCount:this.pendingJobsCount,addedAt:this.webcJobAddedT}})};b.logJobStarted=function(){this.webcJobStartedT=Date.now(),this.eventFlow.addPoint("start_job",{"int":{startedAt:this.webcJobStartedT}})};b.logJobCompleted=function(a){this.webcJobCompletedT=Date.now();this.jobResultType=a;var b={"int":{pendingJobsCount:this.pendingJobsCount,completedAt:this.webcJobCompletedT}};a==="completed"?this.eventFlow.endSuccess(b):this.eventFlow.endFail(a,b)};return a}();a=function(){function a(){this.$1=new Map()}var b=a.prototype;b.logJobCreated=function(a){var b=a.jobName,c=a.jobId,d=a.jobPriority;a=a.pendingJobsCount;b=new h(b,d,a);b.logJobAdded();this.$1.set(c,b)};b.logJobStarted=function(a){a=this.$1.get(a);a==null?void 0:a.logJobStarted()};b.logJobCompleted=function(a){this.$2(a,"completed")};b.logJobError=function(a){this.$2(a,"error")};b.logJobTimeout=function(a){this.$2(a,"timeout")};b.logJobAborted=function(a){this.$2(a,"aborted")};b.$2=function(a,b){var c=this.$1.get(a);c==null?void 0:c.logJobCompleted(b);this.$1["delete"](a)};return a}();g.JobInfoEvent=h;g.JobStatsLogger=a}),98);
__d("WAOrchestrator",["WABaseGlobals","WAConcurrentBucketJobQueue","WAConcurrentPreemptiveJobQueue","WADefaultJobNoQueue","WAJobOrchestratorTypes","WAOrchestratorJobStatsLogger"],(function(a,b,c,d,e,f,g){function a(){var a={maxConcurrency:1},b="default",c={},e=a,f=new(d("WAOrchestratorJobStatsLogger").JobStatsLogger)();return function(g,i){var j;g===void 0&&(g=!1);g=g?b:d("WABaseGlobals").getConfig().orchestratorVersion();j=(j=d("WABaseGlobals").getConfig().orchestratorConfig())!=null?j:a;var k;i==null?void 0:i.addPoint("get_orchestrator",{string:{orchestrator:g},"int":{maxConcurrency:j.maxConcurrency,highPriorityQuota:(i=(i=j.jobPrioritiesQuota)==null?void 0:i.get(d("WAJobOrchestratorTypes").JOB_PRIORITY.HIGH))!=null?i:0,lowPriorityQuota:(i=(i=j.jobPrioritiesQuota)==null?void 0:i.get(d("WAJobOrchestratorTypes").JOB_PRIORITY.LOW))!=null?i:0}});if(c[g]){h(e,j)&&(e=j,c[g].updateConfig(j));return c[g]}switch(g){case"preemptive":k=new(d("WAConcurrentPreemptiveJobQueue").WAConcurrentPreemptiveJobQueue)();break;case"bucket":k=new(d("WAConcurrentBucketJobQueue").WAConcurrentBucketJobQueue)();break;default:k=new(d("WADefaultJobNoQueue").WADefaultJobNoQueue)();break}k.init(j,f);c[g]=k;e=j;return k}}function h(a,b){var c;if(a.maxConcurrency!==b.maxConcurrency)return!0;if(((c=a.jobPrioritiesQuota)==null?void 0:c.size)!==((c=b.jobPrioritiesQuota)==null?void 0:c.size))return!0;return Object.keys((c=a.maxConcurrencyPerJob)!=null?c:{}).length!==Object.keys((c=b.maxConcurrencyPerJob)!=null?c:{}).length?!0:JSON.stringify(a)!==JSON.stringify(b)}g.getInstanceDelegate=a}),98);
__d("WaJobInMemoryAccessors",["Promise","WAHex","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){var a=-1,c=new Map();return{deletePersistedJob:function(a){return(h||(h=b("Promise"))).resolve(c["delete"](a))},loadAllJobs:function(){return(h||(h=b("Promise"))).resolve(Array.from(c.values()))},maybeCreateJob:function(e){var f,g=JSON.stringify([e.type,(f=e.uniqKey)!=null?f:d("WAHex").randomHex(32)]),i={backedOffCount:0,current:e.args,original:e.args,startTime:d("WATimeUtils").unixTime(),step:"$unstarted",stepFirstStartTime:null,stepHardStartCountAfterTimeout:0,stepUnexpectedErrorCount:0,type:e.type,uniqKey:g,version:e.version,waitUntil:null,scheduleConfig:e.scheduleConfig};f=function(){var d=a--,e=babelHelpers["extends"]({},i,{jobId:d});c.set(d,e);return(h||(h=b("Promise"))).resolve({id:d,newlyCreated:!0})};if(e.uniqKey!=null){e=Array.from(c.values()).filter(function(a){return a.uniqKey===g});if(e.length===0)return f();var j=null;e.forEach(function(a){a.step!=="$finished"?j=a:c["delete"](a.jobId)});return j!=null?(h||(h=b("Promise"))).resolve({id:j.jobId,newlyCreated:!1}):f()}return f()},readPersistedJob:function(a){a=c.get(a);return(h||(h=b("Promise"))).resolve(a&&babelHelpers["extends"]({},a))},updatePersistedJob:function(a){return(h||(h=b("Promise"))).resolve(c.set(a.jobId,babelHelpers["extends"]({},a)))}}}g.getJobInMemoryAccessors=a}),98);
__d("WAPersistedJobManagerV2",["Promise","WABaseGlobals","WAErr","WAJids","WAJobOrchestratorTypes","WAJobRequirement","WALogger","WAOrchestrator","WAPREList","WAPREMetrics","WAPersistedJobManager","WAPromiseBackoffs","WAResolvable","WATimeUtils","WaJobInMemoryAccessors","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([""," waiting on ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([""," halting because of ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": running in forced non-persisted mode"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": running in forced non-persisted mode"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": running in forced non-persisted mode"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([""," has been loaded and is marked as deprecated"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["addPersistedJobImplementation called twice for ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["onJobStarted for "," threw exception ",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": "," step not found"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose([""," failed with error ",""]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["onJobFinished for "," threw exception ",""]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": finished job"]);t=function(){return a};return a}function a(){var b=babelHelpers.taggedTemplateLiteralLoose(["",": Unhandled exception: ",""]);a=function(){return b};return b}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": Unhandled exception. Tried "," times"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": RetryOnBackoff"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": delaying until ",""]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": trim wait from "," to ",""]);x=function(){return a};return a}function y(){var a=babelHelpers.taggedTemplateLiteralLoose(["No implementation for ",".",""]);y=function(){return a};return a}function z(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": removing completed, expired job from db"]);z=function(){return a};return a}function A(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": skew detected, adjusting accordingly"]);A=function(){return a};return a}function B(){var a=babelHelpers.taggedTemplateLiteralLoose(["Running deprecated job ",""]);B=function(){return a};return a}function C(){var a=babelHelpers.taggedTemplateLiteralLoose(["No implementation for deprecated ",", job deleted"]);C=function(){return a};return a}function D(){var a=babelHelpers.taggedTemplateLiteralLoose(["No implementation for ",". Maybe it should have been put to the deprecated list?"]);D=function(){return a};return a}function E(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": InterruptJob"]);E=function(){return a};return a}function F(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": running step"]);F=function(){return a};return a}function G(){var a=babelHelpers.taggedTemplateLiteralLoose(["Persisted job missing for given ID"]);G=function(){return a};return a}function H(){var a=babelHelpers.taggedTemplateLiteralLoose(["[JOB MANAGER] Restarting job with the same id"]);H=function(){return a};return a}function I(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": stuck on the step ",", aborting the job"]);I=function(){return a};return a}var J=1;function K(a){var b=a.code,c=a.annotations;c=c===void 0?{}:c;a=a.eventFlow;var d=a===void 0?L(c):a;return b(d).then(function(a){d.endSuccess();return a})["catch"](function(a){d.endFail("error",{string:{error:""+a}});throw a})}function L(a){a===void 0&&(a={});return d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.WA_JOB_MANAGER,babelHelpers["extends"]({},a,{string:babelHelpers["extends"]({},(a=(a=a)==null?void 0:a.string)!=null?a:{},{userHash:d("WABaseGlobals").getConfig().isEmployee()&&d("WABaseGlobals").getConfig().isUseridAnnotationEnabled()?d("WAJids").extractUserId(d("WABaseGlobals").getMyUserJid()).slice(-5):null})}))}e=function(){function a(a){var c=this,e=a.isRestartAfterCrash,f=a.accessors,g=a.unfinishedJobEntries;this.getOrchestratorDelegate=d("WAOrchestrator").getInstanceDelegate();this.activeJobs=new Map();this.implementationLoaders=new Map();this.implementations=new Map();this.stepBlockers=new WeakMap();this.accessors=f;this.isRestartAfterCrash=e||!1;this.listeners=a.listeners;this.deprecatedJobs=a.deprecatedJobs;this.inMemoryAccessors=d("WaJobInMemoryAccessors").getJobInMemoryAccessors();this.offlineQueueMode=!0;a.offlineQueueCompletePromise!=null?a.offlineQueueCompletePromise.promise["finally"](function(){c.offlineQueueMode=!1}):this.offlineQueueMode=!1;this.initialJobsPromise=g.then(function(a){var e=[],f=[];a.forEach(function(a){a.stepHardStartCountAfterTimeout>=5?e.push(a):f.push(a)});return(h||(h=b("Promise"))).all(e.map(function(a){d("WALogger").ERROR(I(),N(a),a.step).devConsole(M(a)).sendLogs("job-stuck-"+a.type);return c.accessors.deletePersistedJob(a.jobId)})).then(function(){f.forEach(function(a){var b=c.$1(a.jobId);if(b.alreadyActive===!0){d("WALogger").ERROR(H());return}b.deferred.resolve(K({code:function(b){return c.$2(a,c.accessors,{eventFlow:b})},annotations:{string:{name:a.type},bool:{offlineQueueMode:c.offlineQueueMode}}}))})})})}var e=a.prototype;e.$3=function(a,e,f){var g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:f===void 0&&(f={});h=this.$1(a);(g=f.eventFlow)==null?void 0:g.addPoint("start_load_and_run",{bool:{skipped:h.alreadyActive}});if(!(h.alreadyActive===!0)){j.next=5;break}return j.abrupt("return",h.deferred);case 5:j.next=7;return b("regeneratorRuntime").awrap(e.readPersistedJob(a));case 7:i=j.sent;if(!(i==null)){j.next=11;break}d("WALogger").ERROR(G()).sendLogs("missing-job-entry");throw c("WAErr")("Persisted job missing for given ID "+a);case 11:h.deferred.resolve(this.$2(i,e,f));return j.abrupt("return",h.deferred.promise);case 13:case"end":return j.stop()}},null,this)};e.$2=function(a,b,c){var e;c===void 0&&(c={});(e=c.eventFlow)==null?void 0:e.addPoint("enqueueing_job",{string:{name:a.type}});return this.getOrchestratorDelegate(((e=a.scheduleConfig)==null?void 0:e.priority)===d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP,c.eventFlow).enqueue(a.type,this.$4(a,b,c),a.scheduleConfig,c.eventFlow)};e.$5=function(a,b,c){var d=this;c===void 0&&(c={});return b.maybeCreateJob(a).then(function(a){var e;a=a.id;(e=c.eventFlow)==null?void 0:e.addPoint("job_persisted",{"int":{jobId:a},bool:{nonPersisted:b===d.inMemoryAccessors}});return a})};e.$1=function(a){var b=this.activeJobs.get(a);if(b!=null)return{alreadyActive:!0,deferred:b};b=new(d("WAResolvable").Resolvable)();this.activeJobs.set(a,b.promise);return{alreadyActive:!1,deferred:b}};e.$4=function(a,b,c){var d=this;return function(){return d.$6(a,b,c)}};e.$7=function(a){var b=this.implementations,c=this.implementationLoaders,d=b.get(a);if(d)return d;d=c.get(a);if(!d)return null;c=d();b.set(a,c);return c};e.$8=function(a,c){if(c==null||c.length===0)return(h||(h=b("Promise"))).resolve();var e=this.stepBlockers,f=e.get(c);f==null&&(f=d("WAJobRequirement").joinRequirements(c.map(function(a){return a()}),P),e.set(c,f));return f(a)};e.$9=function(a,b,c,e,f){var g,h=this;f===void 0&&(f={});var i=a.step;(g=f.eventFlow)==null?void 0:g.addPoint("start_step");var j=b.findIndex(function(a){return a.stepName===i});g=b[j].info(a.current,a.original,Q(a,this.isRestartAfterCrash));var k=g.requirements,l=g.code;g=this.$8(a,k);e&&(g=g.then(e));return g.then(function(){var b;d("WALogger").LOG(F(),O(a));(b=f.eventFlow)==null?void 0:b.addPoint("run_step");return l(a.current,a.original,Q(a,h.isRestartAfterCrash,f.eventFlow))}).then(function(e){var g;(g=f.eventFlow)==null?void 0:g.addPoint("step_is_complete");if(e instanceof d("WAPersistedJobManager").InterruptJob){d("WALogger").LOG(E(),O(a));return e.result}g=j+1;if(g>=b.length)return e;g=b[g];a.step=g.stepName;a.current=e;a.stepHardStartCountAfterTimeout=0;a.stepFirstStartTime=d("WATimeUtils").unixTime();a.stepUnexpectedErrorCount=0;a.waitUntil=null;a.backedOffCount=0;return c.updatePersistedJob(a).then(function(){return h.$9(a,b,c,void 0,f)})})};e.$6=function(a,c,e){var f,g,i=this,j,k,l,m,n,o,E,F,G,H,I,K,L,N,P;return b("regeneratorRuntime").async(function(R){while(1)switch(R.prev=R.next){case 0:e===void 0&&(e={});j=this.activeJobs,k=this.deprecatedJobs,l=this.listeners,m=l.onJobFinished,n=l.onJobStarted;(f=e.eventFlow)==null?void 0:f.addPoint("run_job");R.next=5;return b("regeneratorRuntime").awrap(this.$7(a.type));case 5:o=R.sent;E=k[a.type];if(o){R.next=23;break}if(E){R.next=15;break}d("WALogger").ERROR(D(),a.type).sendLogs("missing-job-implementation");R.next=12;return b("regeneratorRuntime").awrap(c.deletePersistedJob(a.jobId));case 12:return R.abrupt("return",null);case 15:if(!(E==="NOOP")){R.next=20;break}d("WALogger").WARN(C(),a.type);R.next=19;return b("regeneratorRuntime").awrap(c.deletePersistedJob(a.jobId));case 19:return R.abrupt("return",null);case 20:R.next=22;return b("regeneratorRuntime").awrap(E());case 22:o=R.sent;case 23:F=o;E&&d("WALogger").LOG(B(),a.type);G=(g=a.stepFirstStartTime)!=null?g:d("WATimeUtils").unixTime();a.stepFirstStartTime=G;a.stepUnexpectedErrorCount=a.stepUnexpectedErrorCount||0;a.backedOffCount=a.backedOffCount||0;if(!(a.step===d("WAPersistedJobManager").FINISHED_JOB)){R.next=46;break}H=a.waitUntil;I=d("WATimeUtils").secondsUntil(G);if(!(H!=null&&d("WATimeUtils").isInFuture(H)&&I>0)){R.next=40;break}d("WALogger").LOG(A(),M(a));H=d("WATimeUtils").castToUnixTime(H-I);if(!d("WATimeUtils").isInFuture(H)){R.next=40;break}a.stepFirstStartTime=d("WATimeUtils").castToUnixTime(G-I);a.waitUntil=H;R.next=40;return b("regeneratorRuntime").awrap(c.updatePersistedJob(a));case 40:if(!(H==null||!d("WATimeUtils").isInFuture(H))){R.next=44;break}d("WALogger").LOG(z(),M(a));R.next=44;return b("regeneratorRuntime").awrap(c.deletePersistedJob(a.jobId));case 44:j["delete"](a.jobId);return R.abrupt("return",a.current);case 46:K=a.step!==d("WAPersistedJobManager").UNSTARTED_JOB?o.find(function(b){return b.stepName===a.step}):o[0];if(K){R.next=52;break}d("WALogger").ERROR(y(),a.type,a.step).sendLogs("missing-job-step");R.next=51;return b("regeneratorRuntime").awrap(c.deletePersistedJob(a.jobId));case 51:return R.abrupt("return",null);case 52:a.step=K.stepName;L=function f(){var g=a.waitUntil,j=(h||(h=b("Promise"))).resolve();if(g!=null){var k=d("WATimeUtils").futureUnixTime(d("WATimeUtils").DAY_SECONDS);g>k?(d("WALogger").LOG(x(),O(a),g,k),a.waitUntil=k,j=c.updatePersistedJob(a).then(function(){return d("WATimeUtils").delayUntil(k)})):(d("WALogger").LOG(w(),O(a),g),j=d("WATimeUtils").delayUntil(g))}return j.then(function(){var b=function(){a.waitUntil=null;d("WATimeUtils").happenedWithin(G,d("WATimeUtils").DAY_SECONDS)||a.stepHardStartCountAfterTimeout++;return c.updatePersistedJob(a)};return i.$9(a,F,c,b,e)["catch"](function(b){if(b instanceof d("WAPersistedJobManager").RetryOnBackoff){var g;d("WALogger").LOG(v(),O(a));(g=e.eventFlow)==null?void 0:g.addPoint("retry_on_backoff");g=d("WAPromiseBackoffs").getDelay(++a.backedOffCount,b.backoffOptions);a.waitUntil=d("WATimeUtils").futureUnixTime(Math.ceil(g/1e3));a.stepHardStartCountAfterTimeout>0&&--a.stepHardStartCountAfterTimeout;return c.updatePersistedJob(a).then(f)}else{if(a.stepUnexpectedErrorCount<J){(g=e.eventFlow)==null?void 0:g.addPoint("retry_on_unexpected_error");d("WALogger").WARN(u(),O(a),a.stepUnexpectedErrorCount);a.stepUnexpectedErrorCount++;return c.updatePersistedJob(a).then(f)}throw b}})})};N=L();P=N.then(function(e){var f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:d("WALogger").LOG(t(),O(a));f=null;try{f=m(a.jobId,a.type,a.original,e)}catch(b){d("WALogger").ERROR(s(),a.type,b).sendLogs("onJobFinished-threw")}if(!(f!=null&&f>0)){g.next=12;break}a.waitUntil=d("WATimeUtils").futureUnixTime(Math.ceil(f/1e3));a.step=d("WAPersistedJobManager").FINISHED_JOB;a.current=e;a.stepFirstStartTime=d("WATimeUtils").unixTime();g.next=10;return b("regeneratorRuntime").awrap(c.updatePersistedJob(a));case 10:g.next=15;break;case 12:g.next=14;return b("regeneratorRuntime").awrap(c.deletePersistedJob(a.jobId));case 14:j["delete"](a.jobId);case 15:case"end":return g.stop()}},null,this)},function(e){var f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:d("WALogger").ERROR(r(),a.type,e).sendLogs("job-threw-exception-"+a.type);f=F.find(function(b){return b.stepName===a.step});if(f){h.next=6;break}d("WALogger").ERROR(q(),a.type,a.step);h.next=10;break;case 6:g=f.info(a.current,a.original,Q(a,i.isRestartAfterCrash));if(!(g.stopRetryIf!=null)){h.next=10;break}h.next=10;return b("regeneratorRuntime").awrap(g.stopRetryIf.onStopRetry(a.current,a.original,Q(a,i.isRestartAfterCrash)));case 10:h.next=12;return b("regeneratorRuntime").awrap(c.deletePersistedJob(a.jobId));case 12:j["delete"](a.jobId);case 13:case"end":return h.stop()}},null,this)});try{n(a.jobId,a.type,a.original)}catch(b){d("WALogger").ERROR(p(),a.type,b).sendLogs("onJobStarted-threw")}return R.abrupt("return",P.then(function(){return N}));case 58:case"end":return R.stop()}},null,this)};e.addPersistedJobImplementation=function(a,b){var c=this.implementationLoaders,e=this.deprecatedJobs;if(c.has(a)){d("WALogger").ERROR(o(),a).sendLogs("repeat-job-loader");return}e&&e[a]&&d("WALogger").DEV(n(),a);c.set(a,b)};e.fireAndForget=function(a){var c=this,e=d("WABaseGlobals").getConfig().ignoreForceNonPersistedJobList()||[];if(e.indexOf(a.type)===-1){d("WALogger").LOG(m(),a.type);this.fireAndForgetNonPersisted(a);return}K({code:function(d){var e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:e={eventFlow:d};f.next=3;return b("regeneratorRuntime").awrap(c.initialJobsPromise);case 3:d.addPoint("initial_jobs_promise_fulfilled");return f.abrupt("return",c.$5(a,c.accessors,e).then(function(a){return c.$3(a,c.accessors,e)}));case 5:case"end":return f.stop()}},null,this)},annotations:{string:{name:a.type},bool:{offlineQueueMode:this.offlineQueueMode}}})};e.waitUntilPersisted=function(a){var c=this,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:e=d("WABaseGlobals").getConfig().ignoreForceNonPersistedJobList()||[];if(!(e.indexOf(a.type)===-1)){g.next=5;break}d("WALogger").LOG(l(),a.type);this.fireAndForgetNonPersisted(a);return g.abrupt("return",(h||(h=b("Promise"))).resolve());case 5:f=L({string:{name:a.type},bool:{offlineQueueMode:this.offlineQueueMode}});g.next=8;return b("regeneratorRuntime").awrap(this.initialJobsPromise);case 8:f.addPoint("initial_jobs_promise_fulfilled");return g.abrupt("return",this.$5(a,this.accessors,{eventFlow:f}).then(function(a){K({code:function(b){b={eventFlow:b};return c.$3(a,c.accessors,b)},eventFlow:f})})["catch"](function(a){f.endFail("error",{string:{error:""+a}});throw a}));case 10:case"end":return g.stop()}},null,this)};e.waitUntilCompleted=function(a){var c=this,e=d("WABaseGlobals").getConfig().ignoreForceNonPersistedJobList()||[];if(e.indexOf(a.type)===-1){d("WALogger").LOG(k(),a.type);return this.waitUntilCompletedNonPersisted(a)}return K({code:function(d){var e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:e={eventFlow:d};f.next=3;return b("regeneratorRuntime").awrap(c.initialJobsPromise);case 3:d.addPoint("initial_jobs_promise_fulfilled");return f.abrupt("return",c.$5(a,c.accessors,e).then(function(a){return c.$3(a,c.accessors,e)}));case 5:case"end":return f.stop()}},null,this)},annotations:{string:{name:a.type},bool:{offlineQueueMode:this.offlineQueueMode}}})};e.fireAndForgetNonPersisted=function(a){var c=this;K({code:function(d){var e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:e={eventFlow:d};f.next=3;return b("regeneratorRuntime").awrap(c.initialJobsPromise);case 3:d.addPoint("initial_jobs_promise_fulfilled");return f.abrupt("return",c.$5(a,c.inMemoryAccessors,e).then(function(a){return c.$3(a,c.inMemoryAccessors,e)}));case 5:case"end":return f.stop()}},null,this)},annotations:{string:{name:a.type},bool:{offlineQueueMode:this.offlineQueueMode}}})};e.waitUntilCompletedNonPersisted=function(a){var c=this;return K({code:function(d){var e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:e={eventFlow:d};f.next=3;return b("regeneratorRuntime").awrap(c.initialJobsPromise);case 3:d.addPoint("initial_jobs_promise_fulfilled");return f.abrupt("return",c.$5(a,c.inMemoryAccessors,e).then(function(a){return c.$3(a,c.inMemoryAccessors,e)}));case 5:case"end":return f.stop()}},null,this)},annotations:{string:{name:a.type},bool:{offlineQueueMode:this.offlineQueueMode}}})};return a}();function M(a){return"Job["+a.jobId+"] ("+a.type+")"}function N(a){return"[Job "+a.type+"] "}function O(a){return"Job["+a.jobId+"] ("+a.type+"."+a.step+")"}function P(a,b,c){a==="unsatisfiable"?d("WALogger").LOG(j(),O(c),b):a==="unsatisfied"?d("WALogger").LOG(i(),O(c),b):a}function Q(a,b,c){b===void 0&&(b=!1);return{jobStartTime:a.startTime,afterCrash:b,interruptJob:R,eventFlow:c}}function R(a){return new(d("WAPersistedJobManager").InterruptJob)(a)}g.PersistedJobManager=e}),98);
__d("WASmaxOutPresenceAvailabilityRequest",["WASmaxAttrs","WASmaxJsx","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=a.presenceType;a=a.presenceName;b=d("WASmaxJsx").smax("presence",{type:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,b),name:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a)});return b}g.makeAvailabilityRequest=a}),98);
__d("WASmaxPresenceAvailabilityRPC",["WAComms","WASmaxOutPresenceAvailabilityRequest","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){var c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:c=d("WASmaxOutPresenceAvailabilityRequest").makeAvailabilityRequest(a);e.next=3;return b("regeneratorRuntime").awrap(d("WAComms").castSmaxStanza(c));case 3:case"end":return e.stop()}},null,this)}g.sendAvailabilityRPC=a}),98);
__d("WASendPresenceStatusProtocol",["WASmaxPresenceAvailabilityRPC"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.status;a=a.name;return d("WASmaxPresenceAvailabilityRPC").sendAvailabilityRPC({presenceType:b,presenceName:a})}g.sendPresenceStatusProtocol=a}),98);
__d("WASessionsStateMachine",["Promise","WACryptoLibrary","WAMapWithDefault","WARequestKeys","WAResultOrError","WAStateMachine"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(a){var b=this;this.$1=a;this.$3=a.regInfo;this.$2=new(d("WAMapWithDefault").MapWithDefault)(function(a){return d("WAStateMachine").interpret({context:void 0,initial:"INITIAL",states:{INITIAL:{on:{LOAD:{target:"LOADING"}}},LOADED:{on:{RESET:{target:"INITIAL"}}},LOADING:{invoke:{onDone:{target:"LOADED"},onError:{target:"INITIAL"},src:function(){return b.$4(a)}},on:{RESET:{target:"INITIAL"}}}}})})}var c=a.prototype;c.$4=function(a){var c=this;return this.$1.loadSessions(a).then(function(e){if(e.size===0)return(h||(h=b("Promise"))).reject("user with jid "+a+" has no devices");e=Array.from(e.entries()).flatMap(function(a){var b=a[0];a=a[1];return a==null?[b]:[]});return(h||(h=b("Promise"))).all(e.map(function(a){return d("WARequestKeys").requestKeys(a).then(function(a){return a.success===!1?d("WAResultOrError").makeError():d("WACryptoLibrary").createOutgoingSession(c.$3,a.value.keys)}).then(function(d){return d.success===!1?(h||(h=b("Promise"))).reject():c.$1.saveSession(a,d.value)})})).then(function(){})})};c.waitForSessions=function(a){var c=this,d=a.map(function(a){return c.$2.get(a)});return this.$1.devicesStateMachine.waitForUserDevices(a).then(function(){return(h||(h=b("Promise"))).all(d.map(function(a){return a.send("LOAD")}))}).then(function(){return(h||(h=b("Promise"))).all(d.map(function(a){return a.wait("LOADED",5e3)}))}).then(function(){})};c.reset=function(a){var c=this;a=a.map(function(a){return c.$2.get(a)});return(h||(h=b("Promise"))).all(a.map(function(a){return a.send("RESET").send("LOAD")})).then(function(){})};return a}();g.SessionsStateMachine=a}),98);
__d("WorkerBanzaiLazyQueueChannelWorker",["BanzaiLazyQueue","WorkerFuncChannel"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=d("WorkerFuncChannel").importChannel({queuePost:null},a,"banzai_lazyqueue_channel");c("BanzaiLazyQueue").onQueue.add(function(){h(b)});h(b)}function h(a){c("BanzaiLazyQueue").flushQueue().forEach(function(b){a.queuePost.apply(a,b)})}g.init=a}),98);
__d("WorkerSelf",["WorkerBanzaiLazyQueueChannelWorker","WorkerFuncChannel","WorkerQPLChannel"],(function(a,b,c,d,e,f,g){"use strict";function a(a){d("WorkerFuncChannel").activateChannels(a,"worker","client"),d("WorkerBanzaiLazyQueueChannelWorker").init(a),d("WorkerQPLChannel").setMessagePort(a)}g.init=a}),98);
__d("WASyncdAction",["Promise","WASyncdConst"],(function(a,b,c,d,e,f,g){var h;a=function(){function a(){}var c=a.prototype;c.getChatJidAndMessageKey=function(a){return};c.resolveConflicts=function(a,c){c=c.timestamp;return c>=a.timestamp?(h||(h=b("Promise"))).resolve(d("WASyncdConst").ConflictResolutionState.ApplyRemoteAndDropLocal):(h||(h=b("Promise"))).resolve(d("WASyncdConst").ConflictResolutionState.SkipRemote)};c.dropMutationDueToCrossIndexConflict=function(a,c){return(h||(h=b("Promise"))).resolve(!1)};return a}();g.SyncActionBase=a}),98);
__d("WASyncdActionUtils",["WASyncAction.pb","encodeProtobuf"],(function(a,b,c,d,e,f,g){function h(a,b){return JSON.stringify([a].concat(b))}function a(a){var b=a.action,c=a.indexArgs,e=a.collection,f=a.value,g=a.version,i=a.operation;a=a.timestamp;return{collection:e,index:h(b,c),binarySyncAction:d("encodeProtobuf").encodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,babelHelpers["extends"]({},f,{timestamp:a})).readBuffer(),version:g,operation:i,timestamp:a,action:b}}function b(a){var b=a.remoteJid,c=a.id,d=a.fromMe;a=a.participant;return[b,c,d?"1":"0",a!=null&&!d?a:"0"]}g.buildIndex=h;g.buildPendingMutation=a;g.buildMessageKey=b}),98);
__d("WASentinelMutationSync",["Promise","WAGetSyncKey","WALogger","WAServerSync.pb","WASyncdAction","WASyncdActionUtils","WASyncdConst","WASyncdKeyManagement","WATagsLogger","WATimeUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["sentinel mutation sync: no key pairs"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["preparing mutations..."]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["sentinel mutation sync: operation not supported"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["sentinel mutation sync: malformed mutation"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["applying mutations..."]);m=function(){return a};return a}var n=d("WATagsLogger").TAGS(["syncd","SentinelMutationSync"]);a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(b=c=a.call.apply(a,[this].concat(f))||this,c.version=3,c.action=d("WASyncdConst").Actions.Sentinel,b)||babelHelpers.assertThisInitialized(c)}var e=c.prototype;e.applyMutations=function(a){n.LOG(m());return(h||(h=b("Promise"))).all(a.map(function(a){var c,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.prev=0;if(!(a.operation==="set")){f.next=9;break}e=(c=a.value.keyExpiration)==null?void 0:c.expiredKeyEpoch;if(!(e==null)){f.next=6;break}d("WALogger").ERROR(l());return f.abrupt("return",{actionState:d("WASyncdConst").SyncActionState.Malformed});case 6:f.next=8;return b("regeneratorRuntime").awrap(d("WAGetSyncKey").expireSyncKeyInTransaction(e));case 8:return f.abrupt("return",{actionState:d("WASyncdConst").SyncActionState.Success});case 9:d("WALogger").WARN(k());return f.abrupt("return",{actionState:d("WASyncdConst").SyncActionState.Unsupported});case 13:f.prev=13;f.t0=f["catch"](0);return f.abrupt("return",{actionState:d("WASyncdConst").SyncActionState.Failed});case 16:case"end":return f.stop()}},null,this,[[0,13]])}))};e.getSentinelMutations=function(){var a=this,c,e,f,g,h;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:n.LOG(j());c=d("WATimeUtils").unixTimeMs();e=Array.from(d("WASyncdConst").CollectionName.members());k.next=5;return b("regeneratorRuntime").awrap(d("WASyncdKeyManagement").getNewestKeyPair());case 5:f=k.sent;if(!(f==null)){k.next=9;break}d("WALogger").ERROR(i());return k.abrupt("return",[]);case 9:g=f.keyEpoch;h={keyExpiration:{expiredKeyEpoch:g}};return k.abrupt("return",e.map(function(b){return d("WASyncdActionUtils").buildPendingMutation({collection:b,indexArgs:[b],operation:d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET,version:a.version,value:h,timestamp:c,action:a.action})}));case 12:case"end":return k.stop()}},null,this)};return c}(d("WASyncdAction").SyncActionBase);c=new a();Object.freeze(c);e=c;g["default"]=e}),98);
__d("WABaseConfigValues",["Promise","WAErr","WASentinelMutationSync"],(function(a,b,c,d,e,f,g){"use strict";var h;a={isCompanion:function(){return!1},logoutInProgress:function(){return!1},consumerOrientedProtocolQueue:function(){return{outOfOrderMessagesEnabled:!1,prioritizeSnippet:!1,scheduleReceiptsLater:!1,usePoisonQueue:!1,logPoisonQueueData:!1}},mediaImagePreviewHkdfInfo:function(){throw c("WAErr")("config: No config for mediaImagePreviewHkdfInfo")},mediaVideoPreviewHkdfInfo:function(){throw c("WAErr")("config: No config for mediaVideoPreviewHkdfInfo")},removeStanzasWithTooManyFailures:function(){return!1},offlineProcessingState:function(){return"idle"},orchestratorVersion:function(){return"default"},primaryPlatform:function(){return void 0},syncdAdditionalMutations:function(){return 1},syncdActionHandlers:function(){return[c("WASentinelMutationSync")]},syncdDisabled:function(){return!0},syncdInlineMutationsMaxCount:function(){return 1e3},syncdKeyMaxUseDays:function(){return 30},syncdMaxMutationsToProcessDuringResume:function(){return 1e3},syncdPatchDeviceIndexIncluded:function(){return!1},syncdPatchProtobufMaxSize:function(){return 100},syncdQPLLoggingEnabled:function(){return!1},syncdShouldFatalOnMissingPatch:function(){return!0},syncdShouldNotFatalOnSnapshotMacMismatchInPatches:function(){return!1},syncdShouldParsePatchDebugData:function(){return!1},syncdWaitForKeyTimeoutDays:function(){return 2},syncShouldCalculateLtHashFromScratch:function(){return!1},maxPrekeysToUpload:function(){return 812},getAreThereMoreCompanions:function(){return(h||(h=b("Promise"))).resolve(!1)},ignoreForceNonPersistedJobList:function(){return[]},orchestratorConfig:function(){return void 0},isUseridAnnotationEnabled:function(){return!1},isEmployee:function(){return!1},useUpdatedSenderKeySession:function(){return!1},useEbRestoreQueue:function(){return!1},useEbUploadQueue:function(){return!1}};a;d=a;g["default"]=d}),98);
__d("MAWMainWebWorker",["FalcoLoggerTransports","MAWBackend","MAWCommonMainWebWorker","MAWLowLevelApiImpl","MAWMainWebWorkerConfig","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h=!((b=c("gkx")("9024"))!=null?b:!1);function a(a){if("SharedWorkerGlobalScope"in self&&self instanceof SharedWorkerGlobalScope&&a!=null){var b=new(d("MAWCommonMainWebWorker").BridgeAdaptor)(a,"MAWMainWebWorker");d("MAWCommonMainWebWorker").initWorker(b,d("MAWLowLevelApiImpl").makeLowLevelApi,c("MAWMainWebWorkerConfig"),d("MAWBackend").startMAWBackend)}else if("DedicatedWorkerGlobalScope"in self&&self instanceof DedicatedWorkerGlobalScope){a=new(d("MAWCommonMainWebWorker").BridgeAdaptor)((b=a)!=null?b:self,"MAWMainWebWorker");d("MAWCommonMainWebWorker").initWorker(a,d("MAWLowLevelApiImpl").makeLowLevelApi,c("MAWMainWebWorkerConfig"),d("MAWBackend").startMAWBackend)}h&&d("FalcoLoggerTransports").attach()}g["default"]=a}),98);
__d("WorkerBootstrap",["HasteSupportData","ServerJSDefine"],(function(a,b,c,d,e,f,g){"use strict";function h(a){Object.keys(a).forEach(function(b){c("ServerJSDefine").handleDefine(b,[],a[b],-1,null)})}function a(a,c){var f,g;a.hsdp&&d("HasteSupportData").handle(a.hsdp);var i=(f=(g=a.jsmods)!=null?g:a.dynamicModules)!=null?f:{};h(i);var j=b.call(null,c);a.rds!=null&&a.rds.length>0&&e.call(null,a.rds,function(){});if(typeof j==="function"||j!==null)try{for(var k=arguments.length,l=new Array(k>2?k-2:0),m=2;m<k;m++)l[m-2]=arguments[m];j.apply(void 0,l)}catch(a){}}function f(a){a=a;if(typeof a==="function"||a!==null)try{a()}catch(a){}}g.initDynamicModules=h;g.start=a;g.startServerJS=f}),98);
__d("CurrentSharedWorker",["HasteSupportData","SharedWorkerStatusLock","WorkerBootstrap","emptyFunction","err"],(function(a,b,c,d,e,f,g){"use strict";var h=null,i=[],j=new Set(),k=[],l=!1,m=!1,n=null,o=!1,p=d("SharedWorkerStatusLock").getStatusLock();self.setTimeout(function(){if(!o){try{var a;(a=j.values().next().value)==null?void 0:a.postMessage({type:"self-terminate",response:{from:"bundle"}})}catch(a){v(a)}self.close()}},3e5);function q(){m=!0,n=null,h!==null&&(i.forEach(function(a){return a()}),i=[])}function r(a,c){var f=a.data;if(typeof f==="object"&&(f==null?void 0:f.type)==="execute-worker"){var g=!l;if(!l&&f.args instanceof Array){var k=f.args[0],t=k.hsdp,u=k.jsmods,v=k.dynamicModules;k=k.rds;t!=null&&d("HasteSupportData").handle(t);d("WorkerBootstrap").initDynamicModules((u=(t=u)!=null?t:v)!=null?u:{});k!=null&&k.length>0&&e.call(null,k,function(){});p.init();l=!0;n!=null&&(n(),q())}try{t=b.call(b,"SiteData");j.size>1&&c.postMessage({type:"execute-worker-imports",response:{}});c.postMessage({type:"execute-worker-ack",response:{firstInit:g,workerRevision:t.client_revision,spinMode:t.spin,spinTime:t.__spin_t}});o=!0}catch(a){c.postMessage({type:"execute-worker-ack",response:{firstInit:g,errorGettingSiteData:a.message}})}}else if(typeof f==="object"&&(f==null?void 0:f.type)==="sw-get-rev")try{v=b.call(b,"SiteData");c.postMessage({type:"sw-get-rev",response:{workerRevision:v.client_revision,spinMode:v.spin,spinTime:v.__spin_t}})}catch(a){c.postMessage({type:"sw-get-rev",response:{error:a.message}})}else if(typeof f==="object"&&(f==null?void 0:f.type)==="sw-shutdown"){u=Array.isArray(f.args)?f.args[0]:null;p.release();typeof u==="object"&&(u==null?void 0:u.upgrade)===!0?s({type:"sw-shutdown",response:{reason:"requested-upgrade",workerID:self.worker_id,isInitialized:o}}):typeof u==="object"&&typeof (u==null?void 0:u.reason)==="string"?s({type:"sw-shutdown",response:{reason:u==null?void 0:u.reason,workerID:self.worker_id,isInitialized:o}}):c.postMessage({type:"sw-shutdown",response:{workerID:self.worker_id,isInitialized:o}});self.close()}else if(typeof f==="object"&&(f==null?void 0:f.type)==="sw-uptime-tracking"){t=typeof (f==null?void 0:f.args)==="object"?(k=f.args)==null?void 0:k.trackerID:null;c.postMessage({type:"sw-uptime-tracking",response:{trackerID:t}})}else typeof f==="object"&&(f==null?void 0:f.type)==="ww-hrp-init"&&j.size>1?c.postMessage({type:"ww-hrp-init",response:{}}):h!==null&&m?h(f):i.push(function(){return r(a,c)})}function a(a){var b=h==null;h=(a=a)!=null?a:c("emptyFunction");b&&m&&(i.forEach(function(a){return a()}),i=[])}function s(a,b){j.forEach(function(c){c.postMessage(a,b)})}function f(a){if(l){a();q();return}n=a}["log","error","info","debug","warn"].forEach(function(a){if(self.console[a]==null)throw c("err")('"'+a+'" is not a valid console method.');var b=self.console[a];self.console[a]=function(){for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];b.apply(void 0,d);s({type:"console",response:{method:a,args:d}})}});try{var t=self.shared_worker_bootstrap_buffer==null?void 0:self.shared_worker_bootstrap_buffer();if(t!=null){var u=t.ports;t=t.messages;u==null?void 0:u.forEach(function(a){try{a.addEventListener("message",function(b){return r(b,a)}),j.add(a)}catch(a){v(a)}});t==null?void 0:t.forEach(function(a){try{r(a.e,a.port)}catch(a){v(a)}})}}catch(a){v(a)}function v(a){try{s({type:"sw-uncaught-error",e:{message:a.message,lineno:a.lineno,colno:a.colno,filename:a.filename,error:a.error}})}catch(a){}}self.addEventListener("error",function(a){if(j.size===0){k.push(a);return}v(a)});self.addEventListener("connect",function(a){var b=a.ports[0];b.postMessage({type:"connection-ack",response:{from:"bundle",workerID:self.worker_id}});b.addEventListener("message",function(a){return r(a,b)});b.start();j.add(b);k.length>0&&(k.forEach(v),k.splice(0,k.length))});g.setMessageHandler=a;g.postMessage=s;g.onInitComplete=f}),98);
__d("CurrentSharedWorkerAdapter",["CurrentSharedWorker","FBLogger"],(function(a,b,c,d,e,f,g){a=function(){function a(){}var b=a.prototype;b.addEventListener=function(a,b,e){switch(a){case"message":d("CurrentSharedWorker").setMessageHandler(function(a){return b({data:a})});break;case"error":break;default:c("FBLogger")("worker").mustfix("Unexpected message type %",a)}};b.removeEventListener=function(a,b,e){switch(a){case"message":d("CurrentSharedWorker").setMessageHandler(null);break;case"error":break;default:c("FBLogger")("worker").mustfix("Unexpected message type %",a)}};b.postMessage=function(a,b){d("CurrentSharedWorker").postMessage(a,b)};return a}();g.CurrentSharedWorkerAdapter=a}),98);
__d("SharedWorkerBootstrap",["CurrentSharedWorker","CurrentSharedWorkerAdapter"],(function(a,b,c,d,e,f,g){"use strict";function a(a){h(function(){return b.call(null,a)})}function c(a){h(function(){return a})}function h(a){d("CurrentSharedWorker").onInitComplete(function(){var b=a();if(typeof b==="function"||b!==null)try{b(new(d("CurrentSharedWorkerAdapter").CurrentSharedWorkerAdapter)())}catch(a){}})}g.start=a;g.startServerJS=c}),98);
__d("SharedOrWebWorkerBootstrapInit",["SharedWorkerBootstrap","WorkerBootstrap"],(function(a,b,c,d,e,f){"use strict";function a(a){"SharedWorkerGlobalScope"in self&&self instanceof self.SharedWorkerGlobalScope?b("SharedWorkerBootstrap").startServerJS(a):b("WorkerBootstrap").startServerJS(a)}f.startServerJS=a}),66);